<?php

use \PhpOffice\PhpSpreadsheet\Spreadsheet;
use \PhpOffice\PhpSpreadsheet\Writer\Xlsx;

class Report extends Controller {
	public function __construct()
	{	
		if($_SESSION['session_login'] != 'sudah_login') {
			Flasher::setMessage('Login','Tidak ditemukan.','danger');
			header('location: '. base_url . '/Login');
			exit;
		}
	}

	public function index()
	{
		$data['title'] = 'Report';
	}

	public function sellingin_RAW()
	{
		$data['title'] = 'Selling In - Raw Data';

		/* $data['nama'] = $_SESSION['nama'];
		$data['username'] = $_SESSION['username'];
		$username = $_SESSION['username']; */

		if(isset($_POST['by_month']))
		{
			$data['by_month'] = $_POST['by_month'];
		}else
		{
			$data['by_month'] = date('m');
		}
		if(isset($_POST['by_year']))
		{
			$data['by_year'] = $_POST['by_year'];
		}else
		{
			$data['by_year'] = date('Y');
		}
		

		$data['sellingin'] = $this->model('SellingInModel')->getAllSellingin();
		
		$this->template('header', $data);
		$this->template('sidebar', $data);
		$this->view('report/sellingin_raw', $data);
		$this->view('templates/footer');
	}

	public function sellingout_RAW()
	{
		$data['title'] = 'Selling Out - Raw Data';

		if(isset($_POST['by_big_code']))
		{
			$data['by_big_code'] = $_POST['by_big_code'];
		}
		else
		{
			$data['by_big_code'] = "";
		}

		if(isset($_POST['by_outlet_name']))
		{
			$data['by_outlet_name'] = $_POST['by_outlet_name'];
		}
		else
		{
			$data['by_outlet_name'] = "";
		}

		if(isset($_POST['by_dist_code']))
		{
			$data['by_dist_code'] = $_POST['by_dist_code'];
		}
		else
		{
			$data['by_dist_code'] = "";
		}

		if(isset($_POST['by_area']))
		{
			$data['by_area'] = $_POST['by_area'];
		}
		elseif ($_SESSION['area'] != 'ALL')
		{
			$data['by_area'] = explode(', ', $_SESSION['area']);
		}
		else
		{
			$data['by_area'] = "";
		}

		if(isset($_POST['by_region']))
		{
			$data['by_region'] = $_POST['by_region'];
		}
		else
		{
			$data['by_region'] = "";
		}

		if(isset($_POST['by_month']))
		{
			$data['by_month'] = $_POST['by_month'];
		}else
		{
			$data['by_month'] = date('m');
		}
		if(isset($_POST['by_year']))
		{
			$data['by_year'] = $_POST['by_year'];
		}else
		{
			$data['by_year'] = date('Y');
		}

		$data['outlet'] = $this->model('OutletModel')->getOutletName();
		$data['dist'] = $this->model('DistributorModel')->getAllDist();
		$data['area'] = $this->model('ReportModel')->getAreaOut();
		$data['region'] = $this->model('ReportModel')->getRegionOut();
		// $data['sellingout'] = $this->model('SellingOutModel')->getAllSellingout();
		
		$this->template('header', $data);
		$this->template('sidebar', $data);
		$this->view('report/sellingout_raw', $data);
		$this->view('templates/footer');
	}

	public function sellingout_RAW2($direct)
	{
		$data['title'] = 'Selling Out - Raw Data';

		$data['dist'] = $this->model('DistributorModel')->getAllDist();
		$data['area'] = $this->model('ReportModel')->getAreaOut();
		$data['sellingout'] = $this->model('SellingOutModel')->getSellingout2($direct);

		$data_direct = explode(",", $direct);

		$principal = $data_direct[0];
		$dist_code = str_replace("*_*", " ", $data_direct[1]);
		$month = $data_direct[2];
		$year = $data_direct[3];

		$data['by_principal'] = $principal;
		$data['by_dist_code'] = $dist_code;
		$data['by_month'] = $month;
		$data['by_year'] = $year;
		
		$this->template('header', $data);
		$this->template('sidebar', $data);
		$this->view('report/sellingout_raw', $data);
		$this->view('templates/footer');
	}

	public function sellingout_RAW_show()
	{	
		$data['data'] = $this->model('SellingOutModel')->getAllSellingout();

		$json = json_encode($data);
		echo $json;
	}

	public function sellingoutYear_show()
	{	
		$data['data'] = $this->model('ReportModel')->getSellingOut_Year();

		$json = json_encode($data);
		echo $json;
	}

	public function sellingout_show()
	{	
		$total_ol['total_ol'] = $this->model('ReportModel')->getTotalOL();
		$total_mtka['total_mtka'] = $this->model('ReportModel')->getTotalMTKA();
		$total_mti['total_mti'] = $this->model('ReportModel')->getTotalMTI();
		$total_mt['total_mt'] = $this->model('ReportModel')->getTotalMT();
		$total_gt_w['total_gt_w'] = $this->model('ReportModel')->getTotalGTW();
		$total_gt_pv['total_gt_pv'] = $this->model('ReportModel')->getTotalGTPV();
		$total_gt_bb['total_gt_bb'] = $this->model('ReportModel')->getTotalGTBB();
		$total_gt_bs['total_gt_bs'] = $this->model('ReportModel')->getTotalGTBS();
		$total_gt_ph['total_gt_ph'] = $this->model('ReportModel')->getTotalGTPH();
		$total_gt['total_gt'] = $this->model('ReportModel')->getTotalGT();
		$grand_total['grand_total'] = $this->model('ReportModel')->getGrandTotal();
		$data_ol['sellingout_online'] = $this->model('ReportModel')->getSellingOutOL();
		$data_mtka['sellingout_mtka'] = $this->model('ReportModel')->getSellingOutMTKA();
		$data_mti['sellingout_mti'] = $this->model('ReportModel')->getSellingOutMTI();
		$data_gt_w['sellingout_gt_w'] = $this->model('ReportModel')->getSellingOutGT_W();
		$data_gt_pv['sellingout_gt_pv'] = $this->model('ReportModel')->getSellingOutGT_PV();
		$data_gt_bb['sellingout_gt_bb'] = $this->model('ReportModel')->getSellingOutGT_BB();
		$data_gt_bs['sellingout_gt_bs'] = $this->model('ReportModel')->getSellingOutGT_BS();
		$data_gt_ph['sellingout_gt_ph'] = $this->model('ReportModel')->getSellingOutGT_PH();

		$data['data'] = array_unique(array_merge($data_ol['sellingout_online'], $total_ol['total_ol'], $data_mtka['sellingout_mtka'], $total_mtka['total_mtka'], $data_mti['sellingout_mti'], $total_mti['total_mti'], $total_mt['total_mt'], $data_gt_w['sellingout_gt_w'], $total_gt_w['total_gt_w'], $data_gt_pv['sellingout_gt_pv'], $total_gt_pv['total_gt_pv'], $data_gt_bb['sellingout_gt_bb'], $total_gt_bb['total_gt_bb'], $data_gt_bs['sellingout_gt_bs'], $total_gt_bs['total_gt_bs'], $data_gt_ph['sellingout_gt_ph'], $total_gt_ph['total_gt_ph'], $total_gt['total_gt'], $grand_total['grand_total']), SORT_REGULAR);

		$json = json_encode($data);
		echo $json;
	}

	public function Sellingin_ASM()
	{
		$data['title'] = 'Report Selling In - ASM';

		$this->template('header', $data);
		$this->template('sidebar', $data);

		$data['principal'] = $this->model('ReportModel')->getPrincipalOut();

		$data['sellingin_asm'] = $this->model('ReportModel')->getSellingIn_ASM();

		if(isset($_POST['by_principal']))
		{
			$data['by_principal'] = $_POST['by_principal'];
		}else
		{
			$data['by_principal'] = "";
		}
		if(isset($_POST['by_year']))
		{
			$data['by_year'] = $_POST['by_year'];
		}else
		{
			$data['by_year'] = date('Y');
		}
		if(isset($_POST['by_month']))
		{
			$data['by_month'] = $_POST['by_month'];
		}else
		{
			$data['by_month'] = date('m');
		}

		$this->view('report/sellingin_asm', $data);
		$this->view('templates/footer');
	}

	public function Sellingout_ASM()
	{
		$data['title'] = 'Report Selling Out - ASM';

		$this->template('header', $data);
		$this->template('sidebar', $data);

		$data['principal'] = $this->model('ReportModel')->getPrincipalOut();

		$data['sellingout_asm'] = $this->model('ReportModel')->getSellingOut_ASM();

		if(isset($_POST['by_principal']))
		{
			$data['by_principal'] = $_POST['by_principal'];
		}else
		{
			$data['by_principal'] = "";
		}
		if(isset($_POST['by_year']))
		{
			$data['by_year'] = $_POST['by_year'];
		}else
		{
			$data['by_year'] = date('Y');
		}
		if(isset($_POST['by_month']))
		{
			$data['by_month'] = $_POST['by_month'];
		}else
		{
			$data['by_month'] = date('m');
		}

		$this->view('report/sellingout_asm', $data);
		$this->view('templates/footer');
	}

	public function Sellingin_Dist_SUM($dataDist)
	{
		$data['title'] = 'Report Selling In - Distributor';

		$this->template('header', $data);
		$this->template('sidebar', $data);

		$data['principal'] = $this->model('ReportModel')->getPrincipalOut();

		$data['sellingin_Dist'] = $this->model('ReportModel')->getSellingIn_Dist_SUM($dataDist);

		$data1 = explode(",", $dataDist);
		$data['by_principal'] = $data1[0];
		$data['by_year'] = $data1[1];

		$this->view('report/sellingin_Dist', $data);
		$this->view('templates/footer');
	}

	public function Sellingin_Dist()
	{
		$data['title'] = 'Report Selling In - Distributor';

		$this->template('header', $data);
		$this->template('sidebar', $data);

		$data['principal'] = $this->model('ReportModel')->getPrincipalOut();
		$data['dist'] = $this->model('DistributorModel')->getAllDist();
		$data['item_name'] = $this->model('ReportModel')->getItemNameOut();
		$data['area'] = $this->model('ReportModel')->getAreaOut();

		$data['sellingin_Dist'] = $this->model('ReportModel')->getSellingIn_Dist();

		if(isset($_POST['by_principal']))
		{
			$data['by_principal'] = $_POST['by_principal'];
		}else
		{
			$data['by_principal'] = "";
		}
		
		if(isset($_POST['by_cust_code']))
		{
			$data['by_cust_code'] = $_POST['by_cust_code'];
		}else
		{
			$data['by_cust_code'] = "";
		}

		if(isset($_POST['by_sku']))
		{
			$data['by_sku'] = $_POST['by_sku'];
		}else
		{
			$data['by_sku'] = "";
		}

		if(isset($_POST['by_area']))
		{
			$data['by_area'] = $_POST['by_area'];
		}
		elseif ($_SESSION['area'] != 'ALL')
		{
			$data['by_area'] = explode(', ', $_SESSION['area']);
		}
		else
		{
			$data['by_area'] = "";
		}

		if(isset($_POST['by_year']))
		{
			$data['by_year'] = $_POST['by_year'];
		}else
		{
			$data['by_year'] = date('Y');
		}

		$this->view('report/sellingin_Dist', $data);
		$this->view('templates/footer');
	}

	public function Sellingin_Contribution()
	{
		$data['title'] = 'Report Selling In - Contribution';

		$this->template('header', $data);
		$this->template('sidebar', $data);

		$data['principal'] = $this->model('ReportModel')->getPrincipalOut();

		$data['sellingin_Dist'] = $this->model('ReportModel')->getSellingIn_Dist();
		$data['total_sellingin_Dist'] = $this->model('ReportModel')->getTotal_SellingIn_Dist();

		if(isset($_POST['by_principal']))
		{
			$data['by_principal'] = $_POST['by_principal'];
		}else
		{
			$data['by_principal'] = "";
		}
		if(isset($_POST['by_year']))
		{
			$data['by_year'] = $_POST['by_year'];
		}else
		{
			$data['by_year'] = date('Y');
		}

		$this->view('report/sellingin_contribution', $data);
		$this->view('templates/footer');
	}

	public function getSellinginOT($ot)
	{
		$data['title'] = 'Report Selling In - Outlet';

		$this->template('header', $data);
		$this->template('sidebar', $data);

		// $data['by_year'] = $ot['2'];
		// $data['by_year'] = $data['by_year'] . $ot['3'];
		// $data['by_year'] = $data['by_year'] . $ot['4'];
		// $data['by_year'] = $data['by_year'] . $ot['5'];
		$data1 = explode(",", $ot);
		$data['by_year'] = $data1[1];

		//$data['by_year'] = $_GET['by_year'];
		$data['principal'] = $this->model('ReportModel')->getPrincipalOut();
		$data['channel'] = $this->model('ReportModel')->getChannel();
		$data['outlet_type'] = $this->model('ReportModel')->getOutletType();

		$data['sellingin_OT'] = $this->model('ReportModel')->getSellingIn_OT($ot);

		$data['by_principal'] = "";
		$data['by_channel'] = "";
		$data['by_outlet_type'] = "";
		foreach($data['sellingin_OT'] as $row):
			$data['by_channel'] = $row['channel'];
			$data['by_outlet_type'] = $row['outlet_type'];
		endforeach;

		//Flasher::setMessage('Berhasil',$year,'success');

		$this->view('report/sellingin_OT', $data);
		$this->view('templates/footer');
	}

	public function Sellingin_OT()
	{
		$data['title'] = 'Report Selling In - Outlet';

		$this->template('header', $data);
		$this->template('sidebar', $data);

		$data['principal'] = $this->model('ReportModel')->getPrincipalOut();
		$data['channel'] = $this->model('ReportModel')->getChannel();
		$data['outlet_type'] = $this->model('ReportModel')->getOutletType();

		$data['sellingin_OT'] = $this->model('ReportModel')->getSellingIn_OT2();

		if(isset($_POST['by_principal']))
		{
			$data['by_principal'] = $_POST['by_principal'];
		}else
		{
			$data['by_principal'] = "";
		}

		if(isset($_POST['by_channel']))
		{
			$data['by_channel'] = $_POST['by_channel'];
		}else
		{
			$data['by_channel'] = "";
		}

		if(isset($_POST['by_outlet_type']))
		{
			$data['by_outlet_type'] = $_POST['by_outlet_type'];
		}else
		{
			$data['by_outlet_type'] = "";
		}

		if(isset($_POST['by_year']))
		{
			$data['by_year'] = $_POST['by_year'];
		}else
		{
			$data['by_year'] = date('Y');
		}

		$this->view('report/sellingin_OT', $data);
		$this->view('templates/footer');
	}

	public function Direct_OT()
	{
		$data['title'] = 'Direct Distribution Outlet';

		$this->template('header', $data);
		$this->template('sidebar', $data);

		$data['principal'] = $this->model('ReportModel')->getPrincipalOut();
		$data['channel'] = $this->model('ReportModel')->getChannel();
		$data['outlet_type'] = $this->model('ReportModel')->getOutletType();

		$data['sellingin_OT'] = $this->model('ReportModel')->getDirect_OT();

		if(isset($_POST['by_principal']))
		{
			$data['by_principal'] = $_POST['by_principal'];
		}else
		{
			$data['by_principal'] = "";
		}

		if(isset($_POST['by_channel']))
		{
			$data['by_channel'] = $_POST['by_channel'];
		}else
		{
			$data['by_channel'] = "";
		}

		if(isset($_POST['by_outlet_type']))
		{
			$data['by_outlet_type'] = $_POST['by_outlet_type'];
		}else
		{
			$data['by_outlet_type'] = "";
		}

		if(isset($_POST['by_year']))
		{
			$data['by_year'] = $_POST['by_year'];
		}else
		{
			$data['by_year'] = date('Y');
		}

		$this->view('report/direct_distribution_OT', $data);
		$this->view('templates/footer');
	}

	public function Direct_OT2($direct)
	{
		$data['title'] = 'Direct Distribution Outlet';

		$this->template('header', $data);
		$this->template('sidebar', $data);

		$data['principal'] = $this->model('ReportModel')->getPrincipalOut();
		$data['channel'] = $this->model('ReportModel')->getChannel();
		$data['outlet_type'] = $this->model('ReportModel')->getOutletType();

		$data['sellingin_OT'] = $this->model('ReportModel')->getDirect_OT2($direct);

		$data_direct = explode(",", $direct);

		$principal = $data_direct[0];
		$outlet_type = str_replace("__", " ", $data_direct[1]);
		$year = $data_direct[2];

		$data['by_principal'] = $principal;
		$data['by_outlet_type'] = $outlet_type;
		$data['by_year'] = $year;

		$this->view('report/direct_distribution_OT', $data);
		$this->view('templates/footer');
	}

	public function RO_outlet()
	{
		$data['title'] = 'RO - Outlet';

		$this->template('header', $data);
		$this->template('sidebar', $data);

		$data['principal'] = $this->model('ReportModel')->getPrincipalOut();
		$data['channel'] = $this->model('ReportModel')->getChannel();
		$data['outlet_type'] = $this->model('ReportModel')->getOutletType();
		$data['area'] = $this->model('ReportModel')->getAreaOut();

		$data['RO_outlet'] = $this->model('ReportModel')->getRO_outlet();

		if(isset($_POST['by_principal']))
		{
			$data['by_principal'] = $_POST['by_principal'];
		}else
		{
			$data['by_principal'] = "";
		}

		if(isset($_POST['by_channel']))
		{
			$data['by_channel'] = $_POST['by_channel'];
		}else
		{
			$data['by_channel'] = "";
		}

		if(isset($_POST['by_outlet_type']))
		{
			$data['by_outlet_type'] = $_POST['by_outlet_type'];
		}else
		{
			$data['by_outlet_type'] = "";
		}

		if(isset($_POST['by_year']))
		{
			$data['by_year'] = $_POST['by_year'];
		}else
		{
			$data['by_year'] = date('Y');
		}

		if(isset($_POST['by_month']))
		{
			$data['by_month'] = $_POST['by_month'];
		}else
		{
			$data['by_month'] = date('m');
		}

		if(isset($_POST['by_area']))
		{
			$data['by_area'] = $_POST['by_area'];
		}
		elseif ($_SESSION['area'] != 'ALL')
		{
			$data['by_area'] = explode(', ', $_SESSION['area']);
		}
		else
		{
			$data['by_area'] = "";
		}

		//Flasher::setMessage('Berhasil', $data['by_area'],'success');

		$this->view('report/RO_outlet', $data);
		$this->view('templates/footer');
	}

	public function RO_outlet2($direct)
	{
		$data['title'] = 'RO - Outlet';

		$this->template('header', $data);
		$this->template('sidebar', $data);

		$data['principal'] = $this->model('ReportModel')->getPrincipalOut();
		$data['channel'] = $this->model('ReportModel')->getChannel();
		$data['outlet_type'] = $this->model('ReportModel')->getOutletType();
		$data['area'] = $this->model('ReportModel')->getAreaOut();

		$data['RO_outlet'] = $this->model('ReportModel')->getRO_outlet3($direct);

		$data_direct = explode(",", $direct);

		$principal = $data_direct[0];
		$outlet_type = str_replace("__", " ", $data_direct[1]);
		$year = $data_direct[2];
		$month = $data_direct[3];
		$area = array();
		$area_count = count($data_direct);

		for ($a = 4; $a <= $area_count-1; $a++) 
		{
			array_push( $area, str_replace("__", " ", $data_direct[$a]));
		}

		$data['by_principal'] = $principal;
		$data['by_channel'] = "";
		$data['by_outlet_type'] = $outlet_type;
		$data['by_year'] = $year;
		$data['by_month'] = $month;
		$data['by_area'] = $area;

		//Flasher::setMessage('Berhasil', $data['by_area'],'success');

		$this->view('report/RO_outlet', $data);
		$this->view('templates/footer');
	}

	public function RO_outlet_all($direct)
	{
		$data['title'] = 'RO - Outlet';

		$this->template('header', $data);
		$this->template('sidebar', $data);

		$data['principal'] = $this->model('ReportModel')->getPrincipalOut();
		$data['channel'] = $this->model('ReportModel')->getChannel();
		$data['outlet_type'] = $this->model('ReportModel')->getOutletType();
		$data['area'] = $this->model('ReportModel')->getAreaOut();

		$data['RO_outlet'] = $this->model('ReportModel')->getRO_outlet_all($direct);

		$data_direct = explode(",", $direct);

		$principal = $data_direct[0];
		$year = $data_direct[1];
		$area = array();
		$area_count = count($data_direct);

		for ($a = 2; $a <= $area_count-1; $a++) 
		{
			array_push( $area, $data_direct[$a]);
		}

		$data['by_principal'] = $principal;
		$data['by_channel'] = "";
		$data['by_year'] = $year;
		$data['by_area'] = $area;

		//Flasher::setMessage('Berhasil', $data['by_area'],'success');

		$this->view('report/RO_outlet', $data);
		$this->view('templates/footer');
	}

	public function Distribution_OT()
	{
		$data['title'] = 'Distribution - Outlet';

		$this->template('header', $data);
		$this->template('sidebar', $data);

		$data['principal'] = $this->model('ReportModel')->getPrincipalOut();
		$data['channel'] = $this->model('ReportModel')->getChannel();
		$data['outlet_type'] = $this->model('ReportModel')->getOutletType();
		$data['area'] = $this->model('ReportModel')->getAreaOut();

		$data['sellingin_OT'] = $this->model('ReportModel')->getDistribution_OT();

		if(isset($_POST['by_principal']))
		{
			$data['by_principal'] = $_POST['by_principal'];
		}else
		{
			$data['by_principal'] = "";
		}

		if(isset($_POST['by_channel']))
		{
			$data['by_channel'] = $_POST['by_channel'];
		}else
		{
			$data['by_channel'] = "";
		}

		if(isset($_POST['by_outlet_type']))
		{
			$data['by_outlet_type'] = $_POST['by_outlet_type'];
		}else
		{
			$data['by_outlet_type'] = "";
		}

		if(isset($_POST['by_year']))
		{
			$data['by_year'] = $_POST['by_year'];
		}else
		{
			$data['by_year'] = date('Y');
		}

		if(isset($_POST['by_area']))
		{
			$data['by_area'] = $_POST['by_area'];
		}
		elseif ($_SESSION['area'] != 'ALL')
		{
			$data['by_area'] = explode(', ', $_SESSION['area']);
		}
		else
		{
			$data['by_area'] = "";
		}

		//Flasher::setMessage('Berhasil', print_r($data['by_area']),'success');

		$this->view('report/distribution_OT', $data);
		$this->view('templates/footer');
	}

	public function Distribution_OT2($direct)
	{
		$data['title'] = 'Distribution - Outlet';

		$this->template('header', $data);
		$this->template('sidebar', $data);

		$data['principal'] = $this->model('ReportModel')->getPrincipalOut();
		$data['channel'] = $this->model('ReportModel')->getChannel();
		$data['outlet_type'] = $this->model('ReportModel')->getOutletType();
		$data['area'] = $this->model('ReportModel')->getAreaOut();

		$data['sellingin_OT'] = $this->model('ReportModel')->getDistribution_OT2($direct);

		$data_direct = explode(",", $direct);

		$principal = $data_direct[0];
		$outlet_type = str_replace("__", " ", $data_direct[1]);
		$year = $data_direct[2];
		$area = array();
		$area_count = count($data_direct);

		for ($a = 4; $a <= $area_count-1; $a++) 
		{
			array_push( $area, str_replace("__", " ", $data_direct[$a]));
		}

		$data['by_principal'] = $principal;
		$data['by_channel'] = "";
		$data['by_outlet_type'] = $outlet_type;
		$data['by_year'] = $year;
		$data['by_area'] = $area;

		//Flasher::setMessage('Berhasil', $data['by_area'],'success');

		$this->view('report/distribution_OT', $data);
		$this->view('templates/footer');
	}

	public function ActiveOutlet_OT()
	{
		$data['title'] = 'Active Outlet - Detail';

		$this->template('header', $data);
		$this->template('sidebar', $data);

		$data['principal'] = $this->model('ReportModel')->getPrincipalOut();
		$data['channel'] = $this->model('ReportModel')->getChannel();
		$data['outlet_type'] = $this->model('ReportModel')->getOutletType();

		$data['sellingin_OT'] = $this->model('ReportModel')->getActiveOutlet_OT();

		if(isset($_POST['by_principal']))
		{
			$data['by_principal'] = $_POST['by_principal'];
		}else
		{
			$data['by_principal'] = "";
		}

		if(isset($_POST['by_channel']))
		{
			$data['by_channel'] = $_POST['by_channel'];
		}else
		{
			$data['by_channel'] = "";
		}

		if(isset($_POST['by_outlet_type']))
		{
			$data['by_outlet_type'] = $_POST['by_outlet_type'];
		}else
		{
			$data['by_outlet_type'] = "";
		}

		if(isset($_POST['by_year']))
		{
			$data['by_year'] = $_POST['by_year'];
		}else
		{
			$data['by_year'] = date('Y');
		}

		$this->view('report/activeoutlet_OT', $data);
		$this->view('templates/footer');
	}

	public function ActiveOutlet_OT2($direct)
	{
		$data['title'] = 'Active Outlet - Detail';

		$this->template('header', $data);
		$this->template('sidebar', $data);

		$data['principal'] = $this->model('ReportModel')->getPrincipalOut();
		$data['channel'] = $this->model('ReportModel')->getChannel();
		$data['outlet_type'] = $this->model('ReportModel')->getOutletType();

		$data['sellingin_OT'] = $this->model('ReportModel')->getActiveOutlet_OT2($direct);

		$data_direct = explode(",", $direct);

		$principal = $data_direct[0];
		$outlet_type = str_replace("__", " ", $data_direct[1]);
		$year = $data_direct[2];
		$area = array();
		$area_count = count($data_direct);

		for ($a = 4; $a <= $area_count-1; $a++) 
		{
			array_push( $area, str_replace("__", " ", $data_direct[$a]));
		}

		$data['by_principal'] = $principal;
		$data['by_channel'] = "";
		$data['by_outlet_type'] = $outlet_type;
		$data['by_year'] = $year;
		$data['by_area'] = $area;

		$this->view('report/activeoutlet_OT', $data);
		$this->view('templates/footer');
	}

	public function AO_Direct_OT()
	{
		$data['title'] = 'Direct Active Outlet - Detail';

		$this->template('header', $data);
		$this->template('sidebar', $data);

		$data['principal'] = $this->model('ReportModel')->getPrincipalOut();
		$data['channel'] = $this->model('ReportModel')->getChannel();
		$data['outlet_type'] = $this->model('ReportModel')->getOutletType();

		$data['sellingin_OT'] = $this->model('ReportModel')->getAO_Direct_OT();

		if(isset($_POST['by_principal']))
		{
			$data['by_principal'] = $_POST['by_principal'];
		}else
		{
			$data['by_principal'] = "";
		}

		if(isset($_POST['by_channel']))
		{
			$data['by_channel'] = $_POST['by_channel'];
		}else
		{
			$data['by_channel'] = "";
		}

		if(isset($_POST['by_outlet_type']))
		{
			$data['by_outlet_type'] = $_POST['by_outlet_type'];
		}else
		{
			$data['by_outlet_type'] = "";
		}

		if(isset($_POST['by_year']))
		{
			$data['by_year'] = $_POST['by_year'];
		}else
		{
			$data['by_year'] = date('Y');
		}

		$this->view('report/ao_direct_OT', $data);
		$this->view('templates/footer');
	}

	public function AO_Direct_OT2($direct)
	{
		$data['title'] = 'Direct Active Outlet - Detail';

		$this->template('header', $data);
		$this->template('sidebar', $data);

		$data['principal'] = $this->model('ReportModel')->getPrincipalOut();
		$data['channel'] = $this->model('ReportModel')->getChannel();
		$data['outlet_type'] = $this->model('ReportModel')->getOutletType();

		$data['sellingin_OT'] = $this->model('ReportModel')->getAO_Direct_OT2($direct);

		$data_direct = explode(",", $direct);

		$principal = $data_direct[0];
		$outlet_type = str_replace("__", " ", $data_direct[1]);
		$year = $data_direct[2];

		$data['by_principal'] = $principal;
		$data['by_channel'] = "";
		$data['by_outlet_type'] = $outlet_type;
		$data['by_year'] = $year;

		$this->view('report/ao_direct_OT', $data);
		$this->view('templates/footer');
	}

	public function sellingin_summary()
	{
		$data['title'] = 'Report Selling In - Summary';

		$this->template('header', $data);
		$this->template('sidebar', $data);

		$data['principal'] = $this->model('ReportModel')->getPrincipalIn();
        $data['item_name'] = $this->model('ReportModel')->getItemNameIn();
        $data['item_group'] = $this->model('ReportModel')->getItemGroupIn();
        $data['area'] = $this->model('ReportModel')->getAreaOut();
        $data['island'] = $this->model('ReportModel')->getIslandOut();
        $data['nama_dist'] = $this->model('ReportModel')->getNamaDistOut();
		$data['qty_channel'] = $this->model('ReportModel')->getQtyIn_Channel2();
		$data['val_channel'] = $this->model('ReportModel')->getValIn_Channel2();

		$data['sellingin'] = $this->model('ReportModel')->getSellingin();
		// $data['sellingin_dist'] = $this->model('ReportModel')->getSellinginDist();

		$get['period_so'] = $this->model('ReportModel')->getMonth_SO();
		$month_so = $get['period_so']['to_month'];
		$year_so = $get['period_so']['year'];

		if(isset($_POST['by_principal']))
		{
			$data['by_principal'] = $_POST['by_principal'];
		}else
		{
			$data['by_principal'] = "";
		}

		if(isset($_POST['by_sku']))
		{
			$data['by_sku'] = $_POST['by_sku'];
		}else
		{
			$data['by_sku'] = "";
		}

		if(isset($_POST['by_group_sku']))
		{
			$data['by_group_sku'] = $_POST['by_group_sku'];
		}else
		{
			$data['by_group_sku'] = "";
		}

		if(isset($_POST['by_distributor']))
		{
			$data['by_distributor'] = $_POST['by_distributor'];
		}else
		{
			$data['by_distributor'] = "";
		}

		if(isset($_POST['by_area']))
		{
			$data['by_area'] = $_POST['by_area'];
		}else
		{
			$data['by_area'] = "";
		}

		if(isset($_POST['by_island']))
		{
			$data['by_island'] = $_POST['by_island'];
		}else
		{
			$data['by_island'] = "";
		}

		if(isset($_POST['by_month1']))
		{
			$data['by_month1'] = $_POST['by_month1'];
		}else
		{
			$data['by_month1'] = '1';
		}

		if(isset($_POST['by_month2']))
		{
			$data['by_month2'] = $_POST['by_month2'];
		}else
		{
			$data['by_month2'] = $month_so;
		}

		if(isset($_POST['by_year']))
		{
			$data['by_year'] = $_POST['by_year'];
		}else
		{
			$data['by_year'] = $year_so;
		}


		$this->view('report/sellingin_summary', $data);
		$this->view('templates/footer');
	}

	public function sellingin_summary_qty()
	{
		$data['title'] = 'Report Selling In - Summary (Quantity)';

		$this->template('header', $data);
		$this->template('sidebar', $data);

		$data['principal'] = $this->model('ReportModel')->getPrincipalOut();
        $data['item_name'] = $this->model('ReportModel')->getItemNameOut();
        $data['item_group'] = $this->model('ReportModel')->getItemGroupOut();
        $data['area'] = $this->model('ReportModel')->getAreaOut();
        $data['island'] = $this->model('ReportModel')->getIslandOut();
        $data['nama_dist'] = $this->model('ReportModel')->getNamaDistOut();
		//$data['channel'] = $this->model('ChannelModel')->getDistinct();
		$data['qty_channel'] = $this->model('ReportModel')->getQtyIn_Channel2();

		$data['sellingin'] = $this->model('ReportModel')->getSellingin();
		$data['sellingin_dist'] = $this->model('ReportModel')->getSellinginDist();

		/* $data['sellingin_qty_ol'] = $this->model('ReportModel')->getQtyInOL();
		$data['sellingin_qty_mtka'] = $this->model('ReportModel')->getQtyInMTKA();
		$data['sellingin_qty_mti'] = $this->model('ReportModel')->getQtyInMTI();
		$data['sellingin_qty_gt_w'] = $this->model('ReportModel')->getQtyInGT_W();
		$data['sellingin_qty_gt_pv'] = $this->model('ReportModel')->getQtyInGT_PV();
		$data['sellingin_qty_gt_bb'] = $this->model('ReportModel')->getQtyInGT_BB();
		$data['ssellingin_qty_gt_bs'] = $this->model('ReportModel')->getQtyInGT_BS();
		$data['sellingin_qty_gt_ph'] = $this->model('ReportModel')->getQtyInGT_PH();  */ 

		if(isset($_POST['by_principal']))
		{
			$data['by_principal'] = $_POST['by_principal'];
		}else
		{
			$data['by_principal'] = "";
		}

		if(isset($_POST['by_sku']))
		{
			$data['by_sku'] = $_POST['by_sku'];
		}else
		{
			$data['by_sku'] = "";
		}

		if(isset($_POST['by_group_sku']))
		{
			$data['by_group_sku'] = $_POST['by_group_sku'];
		}else
		{
			$data['by_group_sku'] = "";
		}

		if(isset($_POST['by_distributor']))
		{
			$data['by_distributor'] = $_POST['by_distributor'];
		}else
		{
			$data['by_distributor'] = "";
		}

		if(isset($_POST['by_area']))
		{
			$data['by_area'] = $_POST['by_area'];
		}else
		{
			$data['by_area'] = "";
		}

		if(isset($_POST['by_island']))
		{
			$data['by_island'] = $_POST['by_island'];
		}else
		{
			$data['by_island'] = "";
		}

		if(isset($_POST['by_month1']))
		{
			$data['by_month1'] = $_POST['by_month1'];
		}else
		{
			$data['by_month1'] = '1';
		}

		if(isset($_POST['by_month2']))
		{
			$data['by_month2'] = $_POST['by_month2'];
		}else
		{
			$data['by_month2'] = date('m');
		}

		if(isset($_POST['by_year']))
		{
			$data['by_year'] = $_POST['by_year'];
		}else
		{
			$data['by_year'] = date('Y');
		}


		$this->view('report/sellingin_summary_qty', $data);
		$this->view('templates/footer');
	}

	public function sellingin_summary_val()
	{
		$data['title'] = 'Report Selling In - Summary (Value)';

		$this->template('header', $data);
		$this->template('sidebar', $data);

		$data['principal'] = $this->model('ReportModel')->getPrincipalOut();
        $data['item_name'] = $this->model('ReportModel')->getItemNameOut();
        $data['item_group'] = $this->model('ReportModel')->getItemGroupOut();
        $data['area'] = $this->model('ReportModel')->getAreaOut();
        $data['island'] = $this->model('ReportModel')->getIslandOut();
        $data['nama_dist'] = $this->model('ReportModel')->getNamaDistOut();
		//$data['channel'] = $this->model('ChannelModel')->getDistinct();
		$data['val_channel'] = $this->model('ReportModel')->getValIn_Channel2();

		$data['sellingin'] = $this->model('ReportModel')->getSellingin();
		$data['sellingin_dist'] = $this->model('ReportModel')->getSellinginDist();

		/* $data['sellingin_qty_ol'] = $this->model('ReportModel')->getQtyInOL();
		$data['sellingin_qty_mtka'] = $this->model('ReportModel')->getQtyInMTKA();
		$data['sellingin_qty_mti'] = $this->model('ReportModel')->getQtyInMTI();
		$data['sellingin_qty_gt_w'] = $this->model('ReportModel')->getQtyInGT_W();
		$data['sellingin_qty_gt_pv'] = $this->model('ReportModel')->getQtyInGT_PV();
		$data['sellingin_qty_gt_bb'] = $this->model('ReportModel')->getQtyInGT_BB();
		$data['ssellingin_qty_gt_bs'] = $this->model('ReportModel')->getQtyInGT_BS();
		$data['sellingin_qty_gt_ph'] = $this->model('ReportModel')->getQtyInGT_PH();  */ 

		if(isset($_POST['by_principal']))
		{
			$data['by_principal'] = $_POST['by_principal'];
		}else
		{
			$data['by_principal'] = "";
		}

		if(isset($_POST['by_sku']))
		{
			$data['by_sku'] = $_POST['by_sku'];
		}else
		{
			$data['by_sku'] = "";
		}

		if(isset($_POST['by_group_sku']))
		{
			$data['by_group_sku'] = $_POST['by_group_sku'];
		}else
		{
			$data['by_group_sku'] = "";
		}

		if(isset($_POST['by_distributor']))
		{
			$data['by_distributor'] = $_POST['by_distributor'];
		}else
		{
			$data['by_distributor'] = "";
		}

		if(isset($_POST['by_area']))
		{
			$data['by_area'] = $_POST['by_area'];
		}else
		{
			$data['by_area'] = "";
		}

		if(isset($_POST['by_island']))
		{
			$data['by_island'] = $_POST['by_island'];
		}else
		{
			$data['by_island'] = "";
		}

		if(isset($_POST['by_month1']))
		{
			$data['by_month1'] = $_POST['by_month1'];
		}else
		{
			$data['by_month1'] = '1';
		}

		if(isset($_POST['by_month2']))
		{
			$data['by_month2'] = $_POST['by_month2'];
		}else
		{
			$data['by_month2'] = date('m');
		}

		if(isset($_POST['by_year']))
		{
			$data['by_year'] = $_POST['by_year'];
		}else
		{
			$data['by_year'] = date('Y');
		}


		$this->view('report/sellingin_summary_val', $data);
		$this->view('templates/footer');
	}

	public function sellingout_summary()
	{
		$data['title'] = 'Report Selling Out - Summary';
		$data['menu'] = "Selling Out";
		//$_SESSION['menu'] = "Selling Out";
		$data['sub_menu'] = "SO - Summary";

		$this->template('header', $data);
		$this->template('sidebar', $data);

		$data['principal'] = $this->model('ReportModel')->getPrincipalOut();
        $data['item_name'] = $this->model('ReportModel')->getItemNameOut();
        $data['item_group'] = $this->model('ReportModel')->getItemGroupOut();
        $data['area'] = $this->model('ReportModel')->getAreaOut();
        $data['island'] = $this->model('ReportModel')->getIslandOut();
        $data['nama_dist'] = $this->model('ReportModel')->getNamaDistOut();
		//$data['channel'] = $this->model('ChannelModel')->getDistinct();

		$data['qty_channel'] = $this->model('ReportModel')->getQtyOut_Channel();
		$data['val_channel'] = $this->model('ReportModel')->getvalOut_Channel();
		$data['sellingout'] = $this->model('ReportModel')->getSellingOut();

		if(isset($_POST['by_principal']))
		{
			$data['by_principal'] = $_POST['by_principal'];
		}else
		{
			$data['by_principal'] = "";
		}

		if(isset($_POST['by_sku']))
		{
			$data['by_sku'] = $_POST['by_sku'];
		}else
		{
			$data['by_sku'] = "";
		}

		if(isset($_POST['by_group_sku']))
		{
			$data['by_group_sku'] = $_POST['by_group_sku'];
		}else
		{
			$data['by_group_sku'] = "";
		}

		if(isset($_POST['by_distributor']))
		{
			$data['by_distributor'] = $_POST['by_distributor'];
		}else
		{
			$data['by_distributor'] = "";
		}

		if(isset($_POST['by_area']))
		{
			$data['by_area'] = $_POST['by_area'];
		}else
		{
			$data['by_area'] = "";
		}

		if(isset($_POST['by_island']))
		{
			$data['by_island'] = $_POST['by_island'];
		}else
		{
			$data['by_island'] = "";
		}

		if(isset($_POST['by_month1']))
		{
			$data['by_month1'] = $_POST['by_month1'];
		}else
		{
			$data['by_month1'] = '1';
		}

		if(isset($_POST['by_month2']))
		{
			$data['by_month2'] = $_POST['by_month2'];
		}else
		{
			$data['by_month2'] = date('m');
		}

		if(isset($_POST['by_year']))
		{
			$data['by_year'] = $_POST['by_year'];
		}else
		{
			$data['by_year'] = date('Y');
		}


		$this->view('report/sellingout_summary', $data);
		$this->view('templates/footer');
	}

	public function sellingout_summary_qty()
	{
		$data['title'] = 'Report Selling Out - Summary (Quantity)';

		$this->template('header', $data);
		$this->template('sidebar', $data);

		$data['principal'] = $this->model('ReportModel')->getPrincipalOut();
        $data['item_name'] = $this->model('ReportModel')->getItemNameOut();
        $data['item_group'] = $this->model('ReportModel')->getItemGroupOut();
        $data['area'] = $this->model('ReportModel')->getAreaOut();
        $data['island'] = $this->model('ReportModel')->getIslandOut();
        $data['nama_dist'] = $this->model('ReportModel')->getNamaDistOut();
		//$data['channel'] = $this->model('ChannelModel')->getDistinct();
		$data['qty_channel'] = $this->model('ReportModel')->getQtyOut_Channel();

		$data['sellingout'] = $this->model('ReportModel')->getSellingOut();
		//$data['sellingin_dist'] = $this->model('ReportModel')->getSellinginDist();

		if(isset($_POST['by_principal']))
		{
			$data['by_principal'] = $_POST['by_principal'];
		}else
		{
			$data['by_principal'] = "";
		}

		if(isset($_POST['by_sku']))
		{
			$data['by_sku'] = $_POST['by_sku'];
		}else
		{
			$data['by_sku'] = "";
		}

		if(isset($_POST['by_group_sku']))
		{
			$data['by_group_sku'] = $_POST['by_group_sku'];
		}else
		{
			$data['by_group_sku'] = "";
		}

		if(isset($_POST['by_distributor']))
		{
			$data['by_distributor'] = $_POST['by_distributor'];
		}else
		{
			$data['by_distributor'] = "";
		}

		if(isset($_POST['by_area']))
		{
			$data['by_area'] = $_POST['by_area'];
		}else
		{
			$data['by_area'] = "";
		}

		if(isset($_POST['by_island']))
		{
			$data['by_island'] = $_POST['by_island'];
		}else
		{
			$data['by_island'] = "";
		}

		if(isset($_POST['by_month1']))
		{
			$data['by_month1'] = $_POST['by_month1'];
		}else
		{
			$data['by_month1'] = '1';
		}

		if(isset($_POST['by_month2']))
		{
			$data['by_month2'] = $_POST['by_month2'];
		}else
		{
			$data['by_month2'] = date('m');
		}

		if(isset($_POST['by_year']))
		{
			$data['by_year'] = $_POST['by_year'];
		}else
		{
			$data['by_year'] = date('Y');
		}

		$this->view('report/sellingout_summary_qty', $data);
		$this->view('templates/footer');
	}

	public function sellingout_summary_val()
	{
		$data['title'] = 'Report Selling Out - Summary (Quantity)';

		$this->template('header', $data);
		$this->template('sidebar', $data);

		$data['principal'] = $this->model('ReportModel')->getPrincipalOut();
        $data['item_name'] = $this->model('ReportModel')->getItemNameOut();
        $data['item_group'] = $this->model('ReportModel')->getItemGroupOut();
        $data['area'] = $this->model('ReportModel')->getAreaOut();
        $data['island'] = $this->model('ReportModel')->getIslandOut();
        $data['nama_dist'] = $this->model('ReportModel')->getNamaDistOut();
		//$data['channel'] = $this->model('ChannelModel')->getDistinct();
		$data['val_channel'] = $this->model('ReportModel')->getValOut_Channel();

		$data['sellingout'] = $this->model('ReportModel')->getSellingOut();
		//$data['sellingin_dist'] = $this->model('ReportModel')->getSellinginDist();

		if(isset($_POST['by_principal']))
		{
			$data['by_principal'] = $_POST['by_principal'];
		}else
		{
			$data['by_principal'] = "";
		}

		if(isset($_POST['by_sku']))
		{
			$data['by_sku'] = $_POST['by_sku'];
		}else
		{
			$data['by_sku'] = "";
		}

		if(isset($_POST['by_group_sku']))
		{
			$data['by_group_sku'] = $_POST['by_group_sku'];
		}else
		{
			$data['by_group_sku'] = "";
		}

		if(isset($_POST['by_distributor']))
		{
			$data['by_distributor'] = $_POST['by_distributor'];
		}else
		{
			$data['by_distributor'] = "";
		}

		if(isset($_POST['by_area']))
		{
			$data['by_area'] = $_POST['by_area'];
		}else
		{
			$data['by_area'] = "";
		}

		if(isset($_POST['by_island']))
		{
			$data['by_island'] = $_POST['by_island'];
		}else
		{
			$data['by_island'] = "";
		}

		if(isset($_POST['by_month1']))
		{
			$data['by_month1'] = $_POST['by_month1'];
		}else
		{
			$data['by_month1'] = '1';
		}

		if(isset($_POST['by_month2']))
		{
			$data['by_month2'] = $_POST['by_month2'];
		}else
		{
			$data['by_month2'] = date('m');
		}

		if(isset($_POST['by_year']))
		{
			$data['by_year'] = $_POST['by_year'];
		}else
		{
			$data['by_year'] = date('Y');
		}

		$this->view('report/sellingout_summary_val', $data);
		$this->view('templates/footer');
	}

	public function getSellingoutOT($ot)
	{
		$data['title'] = 'Report Selling Out - By Outlet';

		$this->template('header', $data);
		$this->template('sidebar', $data);

		$data['by_year'] = substr($ot, -4);

		$data['principal'] = $this->model('ReportModel')->getPrincipalOut();
		$data['channel'] = $this->model('ReportModel')->getChannel();
		$data['outlet_type'] = $this->model('ReportModel')->getOutletType();
		$data['area'] = $this->model('ReportModel')->getAreaOut();
		$data['sellingout_OT'] = $this->model('ReportModel')->getSellingOut_OT($ot);

		$data['by_principal'] = " - ";
		$data['by_channel'] = " - ";
		$data['by_outlet_type'] = " - ";
		foreach($data['sellingout_OT'] as $row):
			$data['by_channel'] = $row['channel'];
			$data['by_outlet_type'] = $row['outlet_type'];
		endforeach;

		$this->view('report/sellingout_OT', $data);
		$this->view('templates/footer');
	}

	public function Sellingout_OT()
	{
		$data['title'] = 'Report Selling Out - Outlet';

		$this->template('header', $data);
		$this->template('sidebar', $data);

		$data['principal'] = $this->model('ReportModel')->getPrincipalOut();
		$data['channel'] = $this->model('ReportModel')->getChannel();
		$data['outlet_type'] = $this->model('ReportModel')->getOutletType();
		$data['outlet'] = $this->model('ReportModel')->getOutletSO();
		$data['item_name'] = $this->model('ReportModel')->getItemNameOut();
		$data['area'] = $this->model('ReportModel')->getAreaOut();
		//$data['sellingout_OT'] = $this->model('ReportModel')->getSellingOut_OT2();

		if(isset($_POST['by_principal']))
		{
			$data['by_principal'] = $_POST['by_principal'];
		}else
		{
			$data['by_principal'] = "";
		}

		if(isset($_POST['by_channel']))
		{
			$data['by_channel'] = $_POST['by_channel'];
		}else
		{
			$data['by_channel'] = "";
		}

		if(isset($_POST['by_outlet_type']))
		{
			$data['by_outlet_type'] = $_POST['by_outlet_type'];
		}else
		{
			$data['by_outlet_type'] = "";
		}

		if(isset($_POST['by_outlet_code']))
		{
			$data['by_outlet_code'] = $_POST['by_outlet_code'];
		}else
		{
			$data['by_outlet_code'] = "";
		}

		if(isset($_POST['by_sku']))
		{
			$data['by_sku'] = $_POST['by_sku'];
		}else
		{
			$data['by_sku'] = "";
		}

		if(isset($_POST['by_area']))
		{
			$data['by_area'] = $_POST['by_area'];
		}
		elseif ($_SESSION['area'] != 'ALL')
		{
			$data['by_area'] = explode(', ', $_SESSION['area']);
		}
		else
		{
			$data['by_area'] = "";
		}

		if(isset($_POST['by_year']))
		{
			$data['by_year'] = $_POST['by_year'];
		}else
		{
			$data['by_year'] = date('Y');
		}

		$this->view('report/sellingout_OT', $data);
		$this->view('templates/footer');
	}

	public function Sellingout_OTshow()
	{
		$data['data'] = $this->model('ReportModel')->getSellingOut_OT2();

		$json = json_encode($data);
		echo $json;
	}

	public function Sellingout_Account()
	{
		$data['title'] = 'Report Selling Out - Group Account';

		$this->template('header', $data);
		$this->template('sidebar', $data);

		$data['principal'] = $this->model('ReportModel')->getPrincipalOut();
		$data['channel'] = $this->model('ReportModel')->getChannel();
		$data['outlet_type'] = $this->model('ReportModel')->getOutletType();
		$data['outlet'] = $this->model('ReportModel')->getOutletSO();
		$data['item_name'] = $this->model('ReportModel')->getItemNameOut();
		$data['area'] = $this->model('ReportModel')->getAreaOut();
		$data['sellingout_Account'] = $this->model('ReportModel')->getSellingOut_Account();

		if(isset($_POST['by_principal']))
		{
			$data['by_principal'] = $_POST['by_principal'];
		}else
		{
			$data['by_principal'] = "";
		}

		if(isset($_POST['by_channel']))
		{
			$data['by_channel'] = $_POST['by_channel'];
		}else
		{
			$data['by_channel'] = "";
		}

		if(isset($_POST['by_outlet_type']))
		{
			$data['by_outlet_type'] = $_POST['by_outlet_type'];
		}else
		{
			$data['by_outlet_type'] = "";
		}

		if(isset($_POST['by_outlet_code']))
		{
			$data['by_outlet_code'] = $_POST['by_outlet_code'];
		}else
		{
			$data['by_outlet_code'] = "";
		}

		if(isset($_POST['by_sku']))
		{
			$data['by_sku'] = $_POST['by_sku'];
		}else
		{
			$data['by_sku'] = "";
		}

		if(isset($_POST['by_area']))
		{
			$data['by_area'] = $_POST['by_area'];
		}
		elseif ($_SESSION['area'] != 'ALL')
		{
			$data['by_area'] = explode(', ', $_SESSION['area']);
		}
		else
		{
			$data['by_area'] = "";
		}

		if(isset($_POST['by_year']))
		{
			$data['by_year'] = $_POST['by_year'];
		}else
		{
			$data['by_year'] = date('Y');
		}

		$this->view('report/sellingout_Account', $data);
		$this->view('templates/footer');
	}

	public function Sellingout_AccountShow()
	{
		$data['data'] = $this->model('ReportModel')->getSellingOut_Account();

		$json = json_encode($data);
		echo $json;
	}

	public function Sellingout_Account_Performance()
	{
		$data['title'] = 'Report Selling Out - Group Account Performance';

		$this->template('header', $data);
		$this->template('sidebar', $data);

		$data['principal'] = $this->model('ReportModel')->getPrincipalOut();
		$data['channel'] = $this->model('ReportModel')->getChannel();
		$data['outlet_type'] = $this->model('ReportModel')->getOutletType();
		$data['outlet'] = $this->model('ReportModel')->getOutletSO();
		$data['item_name'] = $this->model('ReportModel')->getItemNameOut();
		$data['area'] = $this->model('ReportModel')->getAreaOut();
		$data['sellingout_account_performance'] = $this->model('ReportModel')->getSellingOut_Account_performance();

		if(isset($_POST['by_principal']))
		{
			$data['by_principal'] = $_POST['by_principal'];
		}else
		{
			$data['by_principal'] = "";
		}

		if(isset($_POST['by_channel']))
		{
			$data['by_channel'] = $_POST['by_channel'];
		}else
		{
			$data['by_channel'] = "";
		}

		if(isset($_POST['by_outlet_type']))
		{
			$data['by_outlet_type'] = $_POST['by_outlet_type'];
		}else
		{
			$data['by_outlet_type'] = "";
		}

		if(isset($_POST['by_outlet_code']))
		{
			$data['by_outlet_code'] = $_POST['by_outlet_code'];
		}else
		{
			$data['by_outlet_code'] = "";
		}

		if(isset($_POST['by_sku']))
		{
			$data['by_sku'] = $_POST['by_sku'];
		}else
		{
			$data['by_sku'] = "";
		}

		if(isset($_POST['by_area']))
		{
			$data['by_area'] = $_POST['by_area'];
		}
		elseif ($_SESSION['area'] != 'ALL')
		{
			$data['by_area'] = explode(', ', $_SESSION['area']);
		}
		else
		{
			$data['by_area'] = "";
		}

		if(isset($_POST['by_year']))
		{
			$data['by_year'] = $_POST['by_year'];
		}else
		{
			$data['by_year'] = date('Y');
		}

		$this->view('report/sellingout_Account_performance', $data);
		$this->view('templates/footer');
	}

	public function Sellingout_OT_Growth_Exist()
	{
		$data['title'] = 'Report Selling Out - Growth Exist';

		$this->template('header', $data);
		$this->template('sidebar', $data);

		$data['principal'] = $this->model('ReportModel')->getPrincipalOut();
		$data['channel'] = $this->model('ReportModel')->getChannel();
		$data['outlet_type'] = $this->model('ReportModel')->getOutletType();
		$data['area'] = $this->model('ReportModel')->getAreaOut();

		$data['sku_code'] = $this->model('SkuModel')->getItemCodeSKU();

		$data['sellingout_OT_SKU'] = $this->model('ReportModel')->getSellingOut_OT_SKU($data1);

		if(isset($_POST['by_principal']))
		{
			$data['by_principal'] = $_POST['by_principal'];
		}else
		{
			$data['by_principal'] = "JORDAN";
		}

		if(isset($_POST['by_channel']))
		{
			$data['by_channel'] = $_POST['by_channel'];
		}else
		{
			$data['by_channel'] = "";
		}

		if(isset($_POST['by_outlet_type']))
		{
			$data['by_outlet_type'] = $_POST['by_outlet_type'];
		}else
		{
			$data['by_outlet_type'] = "";
		}

		if(isset($_POST['by_area']))
		{
			$data['by_area'] = $_POST['by_area'];
		}
		elseif ($_SESSION['area'] != 'ALL')
		{
			$data['by_area'] = explode(', ', $_SESSION['area']);
		}
		else
		{
			$data['by_area'] = "";
		}

		if(isset($_POST['by_year']))
		{
			$data['by_year'] = $_POST['by_year'];
		}else
		{
			$data['by_year'] = date('Y');
		}

		$this->view('report/sellingout_OT_SKU', $data);
		$this->view('templates/footer');
	}

	public function Sellingout_OT_SKU()
	{
		$data['title'] = 'Report Selling Out - Outlet & SKU';

		$this->template('header', $data);
		$this->template('sidebar', $data);

		$data['principal'] = $this->model('ReportModel')->getPrincipalOut();
		$data['channel'] = $this->model('ReportModel')->getChannel();
		$data['outlet_type'] = $this->model('ReportModel')->getOutletType();
		$data['area'] = $this->model('ReportModel')->getAreaOut();

		$data['sku_code'] = $this->model('SkuModel')->getItemCodeSKU();

		// $data['sellingout_OT_SKU'] = $this->model('ReportModel')->getSellingOut_OT_SKU($data1);

		if(isset($_POST['by_principal']))
		{
			$data['by_principal'] = $_POST['by_principal'];
		}else
		{
			$data['by_principal'] = "JORDAN";
		}

		if(isset($_POST['by_channel']))
		{
			$data['by_channel'] = $_POST['by_channel'];
		}else
		{
			$data['by_channel'] = "";
		}

		if(isset($_POST['by_outlet_type']))
		{
			$data['by_outlet_type'] = $_POST['by_outlet_type'];
		}else
		{
			$data['by_outlet_type'] = "";
		}

		if(isset($_POST['by_area']))
		{
			$data['by_area'] = $_POST['by_area'];
		}
		elseif ($_SESSION['area'] != 'ALL')
		{
			$data['by_area'] = explode(', ', $_SESSION['area']);
		}
		else
		{
			$data['by_area'] = "";
		}

		if(isset($_POST['by_year']))
		{
			$data['by_year'] = $_POST['by_year'];
		}else
		{
			$data['by_year'] = date('Y');
		}

		$this->view('report/sellingout_OT_SKU', $data);
		$this->view('templates/footer');
	}

	public function Sellingout_OT_SKU_show()
	{
		$data1['sku_code'] = $this->model('SkuModel')->getItemCodeSKU();
		$data['data'] = $this->model('ReportModel')->getSellingOut_OT_SKU($data1);

		$json = json_encode($data);
		echo $json;
	}

	public function Sellingout_Growth_OT_Exist()
	{
		$data['title'] = 'Report Selling Out - Growth SKU Existing';

		$this->template('header', $data);
		$this->template('sidebar', $data);

		$data['principal'] = $this->model('ReportModel')->getPrincipalOut();
		$data['channel'] = $this->model('ReportModel')->getChannel();
		$data['outlet_category'] = $this->model('ReportModel')->getOutletCategory();
		$data['outlet_type'] = $this->model('ReportModel')->getOutletType();
		$data['area'] = $this->model('ReportModel')->getAreaOut();

		$data['sku_code'] = $this->model('SkuModel')->getItemCodeSKU();

		$data['sellingout_OT_exist'] = $this->model('ReportModel')->getSellingOut_Growth_OT_Exist2($direct);

		// $data['sellingout_OT_SKU'] = $this->model('ReportModel')->getSellingOut_OT_SKU($data1);

		if(isset($_POST['by_principal']))
		{
			$data['by_principal'] = $_POST['by_principal'];
		}else
		{
			$data['by_principal'] = "JORDAN";
		}

		if(isset($_POST['by_channel']))
		{
			$data['by_channel'] = $_POST['by_channel'];
		}else
		{
			$data['by_channel'] = "";
		}

		if(isset($_POST['by_outlet_category']))
		{
			$data['by_outlet_category'] = $_POST['by_outlet_category'];
		}else
		{
			$data['by_outlet_type'] = "";
		}

		if(isset($_POST['by_outlet_type']))
		{
			$data['by_outlet_type'] = $_POST['by_outlet_type'];
		}else
		{
			$data['by_outlet_type'] = "";
		}

		if(isset($_POST['by_area']))
		{
			$data['by_area'] = $_POST['by_area'];
		}
		elseif ($_SESSION['area'] != 'ALL')
		{
			$data['by_area'] = explode(', ', $_SESSION['area']);
		}
		else
		{
			$data['by_area'] = "";
		}

		if(isset($_POST['by_year']))
		{
			$data['by_year'] = $_POST['by_year'];
		}else
		{
			$data['by_year'] = date('Y');
		}

		$this->view('report/sellingout_growth_ot_exist', $data);
		$this->view('templates/footer');
	}

	public function Sellingout_Growth_OT_Exist2($direct)
	{
		$data['title'] = 'Report Selling Out - Growth SKU Existing';

		$this->template('header', $data);
		$this->template('sidebar', $data);

		$data['principal'] = $this->model('ReportModel')->getPrincipalOut();
		$data['channel'] = $this->model('ReportModel')->getChannel();
		$data['outlet_category'] = $this->model('ReportModel')->getOutletCategory();
		$data['outlet_type'] = $this->model('ReportModel')->getOutletType();
		$data['area'] = $this->model('ReportModel')->getAreaOut();

		$data['sku_code'] = $this->model('SkuModel')->getItemCodeSKU();

		$data['sellingout_OT_exist'] = $this->model('ReportModel')->getSellingOut_Growth_OT_Exist2($direct);

		$data_direct = explode(",", $direct);

		$data_ot_category = str_replace("8", "&", $data_direct[1]);

		$principal = $data_direct[0];
		$outlet_category = str_replace("__", " ", $data_ot_category);
		$outlet_type = str_replace("__", " ", $data_direct[2]);
		$year = $data_direct[3];
		$area = array();
		$area_count = count($data_direct);

		for ($a = 4; $a <= $area_count-1; $a++) 
		{
			array_push( $area, str_replace("__", " ", $data_direct[$a]));
		}

		$data['by_principal'] = $principal;
		$data['by_channel'] = "";
		$data['by_outlet_category'] = $outlet_category;
		$data['by_outlet_type'] = $outlet_type;
		$data['by_year'] = $year;
		$data['by_area'] = $area;

		$this->view('report/sellingout_growth_ot_exist', $data);
		$this->view('templates/footer');
	}

	public function Sellingout_Growth_Add_SKU()
	{
		$data['title'] = 'Report Selling Out - Growth SKU Existing';

		$this->template('header', $data);
		$this->template('sidebar', $data);

		$data['principal'] = $this->model('ReportModel')->getPrincipalOut();
		$data['channel'] = $this->model('ReportModel')->getChannel();
		$data['outlet_category'] = $this->model('ReportModel')->getOutletCategory();
		$data['outlet_type'] = $this->model('ReportModel')->getOutletType();
		$data['area'] = $this->model('ReportModel')->getAreaOut();

		$data['sku_code'] = $this->model('SkuModel')->getItemCodeSKU();

		$data['sellingout_add_sku'] = $this->model('ReportModel')->getSellingOut_Growth_Add_SKU2($direct);

		if(isset($_POST['by_principal']))
		{
			$data['by_principal'] = $_POST['by_principal'];
		}else
		{
			$data['by_principal'] = "JORDAN";
		}

		if(isset($_POST['by_channel']))
		{
			$data['by_channel'] = $_POST['by_channel'];
		}else
		{
			$data['by_channel'] = "";
		}

		if(isset($_POST['by_outlet_category']))
		{
			$data['by_outlet_category'] = $_POST['by_outlet_category'];
		}else
		{
			$data['by_outlet_type'] = "";
		}

		if(isset($_POST['by_outlet_type']))
		{
			$data['by_outlet_type'] = $_POST['by_outlet_type'];
		}else
		{
			$data['by_outlet_type'] = "";
		}

		if(isset($_POST['by_area']))
		{
			$data['by_area'] = $_POST['by_area'];
		}
		elseif ($_SESSION['area'] != 'ALL')
		{
			$data['by_area'] = explode(', ', $_SESSION['area']);
		}
		else
		{
			$data['by_area'] = "";
		}

		if(isset($_POST['by_year']))
		{
			$data['by_year'] = $_POST['by_year'];
		}else
		{
			$data['by_year'] = date('Y');
		}

		$this->view('report/sellingout_growth_add_sku', $data);
		$this->view('templates/footer');
	}

	public function Sellingout_Growth_Add_SKU2($direct)
	{
		$data['title'] = 'Report Selling Out - Growth SKU Existing';

		$this->template('header', $data);
		$this->template('sidebar', $data);

		$data['principal'] = $this->model('ReportModel')->getPrincipalOut();
		$data['channel'] = $this->model('ReportModel')->getChannel();
		$data['outlet_category'] = $this->model('ReportModel')->getOutletCategory();
		$data['outlet_type'] = $this->model('ReportModel')->getOutletType();
		$data['area'] = $this->model('ReportModel')->getAreaOut();

		$data['sku_code'] = $this->model('SkuModel')->getItemCodeSKU();

		$data['sellingout_add_sku'] = $this->model('ReportModel')->getSellingOut_Growth_Add_SKU2($direct);

		$data_direct = explode(",", $direct);

		$data_ot_category = str_replace("8", "&", $data_direct[1]);

		$principal = $data_direct[0];
		$outlet_category = str_replace("__", " ", $data_ot_category);
		$outlet_type = str_replace("__", " ", $data_direct[2]);
		$year = $data_direct[3];
		$area = array();
		$area_count = count($data_direct);

		for ($a = 4; $a <= $area_count-1; $a++) 
		{
			array_push( $area, str_replace("__", " ", $data_direct[$a]));
		}

		$data['by_principal'] = $principal;
		$data['by_channel'] = "";
		$data['by_outlet_category'] = $outlet_category;
		$data['by_outlet_type'] = $outlet_type;
		$data['by_year'] = $year;
		$data['by_area'] = $area;

		$this->view('report/sellingout_growth_add_sku', $data);
		$this->view('templates/footer');
	}

	public function Sellingout_Growth_NOO()
	{
		$data['title'] = 'Report Selling Out - Growth NOO';

		$this->template('header', $data);
		$this->template('sidebar', $data);

		$data['principal'] = $this->model('ReportModel')->getPrincipalOut();
		$data['channel'] = $this->model('ReportModel')->getChannel();
		$data['outlet_category'] = $this->model('ReportModel')->getOutletCategory();
		$data['outlet_type'] = $this->model('ReportModel')->getOutletType();
		$data['area'] = $this->model('ReportModel')->getAreaOut();

		$data['sku_code'] = $this->model('SkuModel')->getItemCodeSKU();

		$data['sellingout_noo'] = $this->model('ReportModel')->getSellingOut_Growth_NOO2($direct);

		if(isset($_POST['by_principal']))
		{
			$data['by_principal'] = $_POST['by_principal'];
		}else
		{
			$data['by_principal'] = "JORDAN";
		}

		if(isset($_POST['by_channel']))
		{
			$data['by_channel'] = $_POST['by_channel'];
		}else
		{
			$data['by_channel'] = "";
		}

		if(isset($_POST['by_outlet_category']))
		{
			$data['by_outlet_category'] = $_POST['by_outlet_category'];
		}else
		{
			$data['by_outlet_type'] = "";
		}

		if(isset($_POST['by_outlet_type']))
		{
			$data['by_outlet_type'] = $_POST['by_outlet_type'];
		}else
		{
			$data['by_outlet_type'] = "";
		}

		if(isset($_POST['by_area']))
		{
			$data['by_area'] = $_POST['by_area'];
		}
		elseif ($_SESSION['area'] != 'ALL')
		{
			$data['by_area'] = explode(', ', $_SESSION['area']);
		}
		else
		{
			$data['by_area'] = "";
		}

		if(isset($_POST['by_year']))
		{
			$data['by_year'] = $_POST['by_year'];
		}else
		{
			$data['by_year'] = date('Y');
		}

		$this->view('report/sellingout_growth_noo', $data);
		$this->view('templates/footer');
	}

	public function Sellingout_Growth_NOO2($direct)
	{
		$data['title'] = 'Report Selling Out - Growth NOO';

		$this->template('header', $data);
		$this->template('sidebar', $data);

		$data['principal'] = $this->model('ReportModel')->getPrincipalOut();
		$data['channel'] = $this->model('ReportModel')->getChannel();
		$data['outlet_category'] = $this->model('ReportModel')->getOutletCategory();
		$data['outlet_type'] = $this->model('ReportModel')->getOutletType();
		$data['area'] = $this->model('ReportModel')->getAreaOut();

		$data['sku_code'] = $this->model('SkuModel')->getItemCodeSKU();

		$data['sellingout_noo'] = $this->model('ReportModel')->getSellingOut_Growth_NOO2($direct);

		$data_direct = explode(",", $direct);

		$data_ot_category = str_replace("8", "&", $data_direct[1]);

		$principal = $data_direct[0];
		$outlet_category = str_replace("__", " ", $data_ot_category);
		$outlet_type = str_replace("__", " ", $data_direct[2]);
		$year = $data_direct[3];
		$area = array();
		$area_count = count($data_direct);

		for ($a = 4; $a <= $area_count-1; $a++) 
		{
			array_push( $area, str_replace("__", " ", $data_direct[$a]));
		}

		$data['by_principal'] = $principal;
		$data['by_channel'] = "";
		$data['by_outlet_category'] = $outlet_category;
		$data['by_outlet_type'] = $outlet_type;
		$data['by_year'] = $year;
		$data['by_area'] = $area;

		$this->view('report/sellingout_growth_noo', $data);
		$this->view('templates/footer');
	}

	public function Sellingout_Growth_OT_Exist_show()
	{
		$data1['sku_code'] = $this->model('SkuModel')->getItemCodeSKU();
		$data['data'] = $this->model('ReportModel')->getSellingOut_Growth_OT_Exist($data1);

		$json = json_encode($data);
		echo $json;
	}

	public function sellingout2()
	{
		$data['title'] = 'Report Selling Out';

		$this->template('header', $data);
		$this->template('sidebar', $data);
		// $this->view('report/sellingout2', $data);
		

		$data['principal'] = $this->model('ReportModel')->getPrincipalOut();
        $data['item_name'] = $this->model('ReportModel')->getItemNameOut();
        $data['item_group'] = $this->model('ReportModel')->getItemGroupOut();
        $data['area'] = $this->model('ReportModel')->getAreaOut();
        $data['island'] = $this->model('ReportModel')->getIslandOut();
        $data['nama_dist'] = $this->model('ReportModel')->getNamaDistOut();
		//$data['sellingout'] = $this->model('ReportModel')->getReportSellingOut();
		$data['sellingout_online'] = $this->model('ReportModel')->getSellingOutOL();
		$data['sellingout_mtka'] = $this->model('ReportModel')->getSellingOutMTKA();
		$data['sellingout_mti'] = $this->model('ReportModel')->getSellingOutMTI();
		//$data['sellingout_gt'] = $this->model('ReportModel')->getSellingOutGT();
		$data['sellingout_gt_w'] = $this->model('ReportModel')->getSellingOutGT_W();
		$data['sellingout_gt_pv'] = $this->model('ReportModel')->getSellingOutGT_PV();
		$data['sellingout_gt_bb'] = $this->model('ReportModel')->getSellingOutGT_BB();
		$data['sellingout_gt_bs'] = $this->model('ReportModel')->getSellingOutGT_BS();
		$data['sellingout_gt_ph'] = $this->model('ReportModel')->getSellingOutGT_PH();

		$data['sellingout_qty_ol'] = $this->model('ReportModel')->getQtyOL();
		$data['sellingout_qty_mtka'] = $this->model('ReportModel')->getQtyMTKA();
		$data['sellingout_qty_mti'] = $this->model('ReportModel')->getQtyMTI();
		$data['sellingout_qty_gt_w'] = $this->model('ReportModel')->getQtyGT_W();
		$data['sellingout_qty_gt_pv'] = $this->model('ReportModel')->getQtyGT_PV();
		$data['sellingout_qty_gt_bb'] = $this->model('ReportModel')->getQtyGT_BB();
		$data['sellingout_qty_gt_bs'] = $this->model('ReportModel')->getQtyGT_BS();
		$data['sellingout_qty_gt_ph'] = $this->model('ReportModel')->getQtyGT_PH(); 

		/* $data['chart_out_week_OL'] =  $this->model('ReportModel')->getChartOutWeekOL();
		$data['chart_out_week_MT'] =  $this->model('ReportModel')->getChartOutWeekMT();
		$data['chart_out_week_GT'] =  $this->model('ReportModel')->getChartOutWeekGT(); */
		//$data['chart_out_week_TOTAL'] =  $this->model('ReportModel')->getChartOutWeekTOTAL();

		if(isset($_POST['by_principal']))
		{
			$data['by_principal'] = $_POST['by_principal'];
		}else
		{
			$data['by_principal'] = "";
		}

		if(isset($_POST['by_sku']))
		{
			$data['by_sku'] = $_POST['by_sku'];
		}else
		{
			$data['by_sku'] = "";
		}

		if(isset($_POST['by_group_sku']))
		{
			$data['by_group_sku'] = $_POST['by_group_sku'];
		}else
		{
			$data['by_group_sku'] = "";
		}

		if(isset($_POST['by_distributor']))
		{
			$data['by_distributor'] = $_POST['by_distributor'];
		}else
		{
			$data['by_distributor'] = "";
		}

		if(isset($_POST['by_area']))
		{
			$data['by_area'] = $_POST['by_area'];
		}else
		{
			$data['by_area'] = "";
		}

		if(isset($_POST['by_island']))
		{
			$data['by_island'] = $_POST['by_island'];
		}else
		{
			$data['by_island'] = "";
		}

		$this->view('report/sellingout2', $data);
		$this->view('templates/footer');

	}

	public function chart()
	{
		if (isset($_POST['by_principal']))
		{
			$data['by_principal'] = $_POST['by_principal'];
		}
		if (isset($_POST['by_sku']))
		{
			$data['by_sku'] = $_POST['by_sku'];
		}
		if (isset($_POST['by_group_sku']))
		{
			$data['by_group_sku'] = $_POST['by_group_sku'];
		}
		if (isset($_POST['by_distributor']))
		{
			$data['by_distributor'] = $_POST['by_distributor'];
		}
		if (isset($_POST['by_area']))
		{
			$data['by_area'] = $_POST['by_area'];
		}
		if (isset($_POST['by_island']))
		{
			$data['by_island'] = $_POST['by_island'];
		}


		$data['title'] = 'Chart Selling Out';

		$this->template('header', $data);
		$this->template('sidebar', $data);

		$data['principal'] = $this->model('ReportModel')->getPrincipalOut();
        $data['item_name'] = $this->model('ReportModel')->getItemNameOut();
        $data['item_group'] = $this->model('ReportModel')->getItemGroupOut();
        $data['area'] = $this->model('ReportModel')->getAreaOut();
        $data['island'] = $this->model('ReportModel')->getIslandOut();
        $data['nama_dist'] = $this->model('ReportModel')->getNamaDistOut();

		//$data['sellingout'] = $this->model('ReportModel')->getReportSellingOut();
		$data['sellingout_online'] = $this->model('ReportModel')->getSellingOutOL();
		$data['sellingout_mtka'] = $this->model('ReportModel')->getSellingOutMTKA();
		$data['sellingout_mti'] = $this->model('ReportModel')->getSellingOutMTI();
		//$data['sellingout_gt'] = $this->model('ReportModel')->getSellingOutGT();
		$data['sellingout_gt_w'] = $this->model('ReportModel')->getSellingOutGT_W();
		$data['sellingout_gt_pv'] = $this->model('ReportModel')->getSellingOutGT_PV();
		$data['sellingout_gt_bb'] = $this->model('ReportModel')->getSellingOutGT_BB();
		$data['sellingout_gt_bs'] = $this->model('ReportModel')->getSellingOutGT_BS();
		$data['sellingout_gt_ph'] = $this->model('ReportModel')->getSellingOutGT_PH();

		$data['sellingout_qty_ol'] = $this->model('ReportModel')->getQtyOL();
		$data['sellingout_qty_mtka'] = $this->model('ReportModel')->getQtyMTKA();
		$data['sellingout_qty_mti'] = $this->model('ReportModel')->getQtyMTI();
		//$data['sellingout_gt'] = $this->model('ReportModel')->getSellingOutGT();
		$data['sellingout_qty_gt_w'] = $this->model('ReportModel')->getQtyGT_W();
		$data['sellingout_qty_gt_pv'] = $this->model('ReportModel')->getQtyGT_PV();
		$data['sellingout_qty_gt_bb'] = $this->model('ReportModel')->getQtyGT_BB();
		$data['sellingout_qty_gt_bs'] = $this->model('ReportModel')->getQtyGT_BS();
		$data['sellingout_qty_gt_ph'] = $this->model('ReportModel')->getQtyGT_PH();

		$this->view('report/chart', $data);
		$this->view('templates/footer');
	}

	public function sellingout_chart()
	{
		$data['title'] = 'Chart Selling Out';

		$this->template('header', $data);
		$this->template('sidebar', $data);

		$data['principal'] = $this->model('ReportModel')->getPrincipalOut();
        $data['item_name'] = $this->model('ReportModel')->getItemNameOut();
        $data['item_group'] = $this->model('ReportModel')->getItemGroupOut();
        $data['area'] = $this->model('ReportModel')->getAreaOut();
        $data['island'] = $this->model('ReportModel')->getIslandOut();
        $data['nama_dist'] = $this->model('ReportModel')->getNamaDistOut();
		
		$this->view('report/sellingout', $data);
		$this->view('templates/footer');
	}

	public function chart2()
	{
		$data['title'] = 'Chart Selling Out - Week';

		$this->template('header', $data);
		$this->template('sidebar', $data);

		$data['chart_out_week_OL'] =  $this->model('ReportModel')->getChartOutWeekOL();
		$data['chart_out_week_MT'] =  $this->model('ReportModel')->getChartOutWeekMT();
		$data['chart_out_week_GT'] =  $this->model('ReportModel')->getChartOutWeekGT();
		$data['chart_out_week_TOTAL'] =  $this->model('ReportModel')->getChartOutWeekTOTAL();
		$data['max_month'] = $this->model('ReportModel')->getMaxMonth();
		

		if(isset($_POST['bulan']))
		{
			$data['bulan'] = $_POST['bulan'];
		}else
		{
			$data['bulan'] = $data['max_month'];
		}

		//Flasher::setMessage('Berhasil',$data['bulan'],'success');
		
		$this->view('report/chart2', $data);
		$this->view('templates/footer');
	}

	public function chart3()
	{
		$data['title'] = 'Chart Selling Out - Month';

		$this->template('header', $data);
		$this->template('sidebar', $data);

		$data['chart_out_month_OL'] =  $this->model('ReportModel')->getChartOutMonthOL();
		$data['chart_out_month_MT'] =  $this->model('ReportModel')->getChartOutMonthMT();
		$data['chart_out_month_GT'] =  $this->model('ReportModel')->getChartOutMonthGT();
		$data['chart_out_month_TOTAL'] =  $this->model('ReportModel')->getChartOutMonthTOTAL();
		$data['max_year'] = $this->model('ReportModel')->getMaxYear();
		

		if(isset($_POST['tahun']))
		{
			$data['tahun'] = $_POST['tahun'];
		}else
		{
			$data['tahun'] = $data['max_year'];
		}

		//Flasher::setMessage('Berhasil',$data['bulan'],'success');
		
		$this->view('report/chart3', $data);
		$this->view('templates/footer');
	}

	public function chart4()
	{
		$data['title'] = 'Chart Selling Out - Month';

		$this->template('header', $data);
		$this->template('sidebar', $data);

		$data['chart_out_quart_OL'] =  $this->model('ReportModel')->getChartOutQuartOL();
		$data['chart_out_quart_MT'] =  $this->model('ReportModel')->getChartOutQuartMT();
		$data['chart_out_quart_GT'] =  $this->model('ReportModel')->getChartOutQuartGT();
		$data['chart_out_quart_TOTAL'] =  $this->model('ReportModel')->getChartOutQuartTOTAL();
		$data['max_year'] = $this->model('ReportModel')->getMaxYear();
		

		if(isset($_POST['tahun']))
		{
			$data['tahun'] = $_POST['tahun'];
		}else
		{
			$data['tahun'] = $data['max_year'];
		}

		//Flasher::setMessage('Berhasil',$data['bulan'],'success');
		
		$this->view('report/chart4', $data);
		$this->view('templates/footer');
	}

	public function sellingin_performance()
	{

		$data['title'] = 'Report Selling In - Performance';
		$this->template('header', $data);
		$this->template('sidebar', $data);

		$get['period_si'] = $this->model('ReportModel')->getMonth_SI();
		$year_si = $get['period_si']['year'];

		if(isset($_POST['by_region']))
		{
			$data['by_region'] = $_POST['by_region'];
		}else
		{
			$data['by_region'] = "";
		}

		if(isset($_POST['by_area']))
		{
			$data['by_area'] = $_POST['by_area'];
		}
		elseif ($_SESSION['area'] != 'ALL')
		{
			$data['by_area'] = explode(', ', $_SESSION['area']);
		}
		else
		{
			$data['by_area'] = "";
		}

		if(isset($_POST['by_island']))
		{
			$data['by_island'] = $_POST['by_island'];
		}else
		{
			$data['by_island'] = "";
		}

		if(isset($_POST['by_year']))
		{
			$data['by_year'] = $_POST['by_year'];
		}else
		{
			$data['by_year'] = $year_si;
		}

		$data['principal'] = $this->model('ReportModel')->getPrincipalOut();
        $data['item_group'] = $this->model('ReportModel')->getItemGroupOut();
        $data['area'] = $this->model('ReportModel')->getAreaOut();
		$data['region'] = $this->model('ReportModel')->getRegionOut();
        $data['island'] = $this->model('ReportModel')->getIslandOut();
        $data['nama_dist'] = $this->model('ReportModel')->getNamaDistOut();

		$data['sellingin'] = $this->model('ReportModel')->getSellingIn_Year_pivot();
		//$data['sellingin'] = $this->model('ReportModel')->getSellingIn_Year_total_price();

		$this->view('report/sellingin_performance', $data);
		$this->view('templates/footer');
		
	}

	public function sellingout_qty()
	{

		$data['title'] = 'Report Selling Out - Quantity';
		$this->template('header', $data);
		$this->template('sidebar', $data);

		$data['principal'] = $this->model('ReportModel')->getPrincipalOut();
        $data['item_group'] = $this->model('ReportModel')->getItemGroupOut();
        $data['area'] = $this->model('ReportModel')->getAreaOut();
		$data['region'] = $this->model('ReportModel')->getRegionOut();
        $data['island'] = $this->model('ReportModel')->getIslandOut();
        $data['nama_dist'] = $this->model('ReportModel')->getNamaDistOut();

		$data['sellingout'] = $this->model('ReportModel')->getSellingOut_Year();
		$data['chart'] = $this->model('ReportModel')->getChart_SellingOut_Qty_Year();

		if(isset($_POST['by_region']))
		{
			$data['by_region'] = $_POST['by_region'];
		}else
		{
			$data['by_region'] = "";
		}

		if(isset($_POST['by_area']))
		{
			$data['by_area'] = $_POST['by_area'];
		}
		elseif ($_SESSION['area'] != 'ALL')
		{
			$data['by_area'] = explode(', ', $_SESSION['area']);
		}
		else
		{
			$data['by_area'] = "";
		}

		if(isset($_POST['by_island']))
		{
			$data['by_island'] = $_POST['by_island'];
		}else
		{
			$data['by_island'] = "";
		}

		if(isset($_POST['by_year']))
		{
			$data['by_year'] = $_POST['by_year'];
		}else
		{
			$data['by_year'] = date('Y');
		}

		$this->view('report/sellingout_qty', $data);
		$this->view('templates/footer');
		
	}

	public function sellingout_val()
	{

		$data['title'] = 'Report Selling Out - Value';
		$this->template('header', $data);
		$this->template('sidebar', $data);

		$data['principal'] = $this->model('ReportModel')->getPrincipalOut();
        $data['item_group'] = $this->model('ReportModel')->getItemGroupOut();
        $data['area'] = $this->model('ReportModel')->getAreaOut();
		$data['region'] = $this->model('ReportModel')->getRegionOut();
        $data['island'] = $this->model('ReportModel')->getIslandOut();
        $data['nama_dist'] = $this->model('ReportModel')->getNamaDistOut();

		$data['sellingout'] = $this->model('ReportModel')->getSellingOut_Year();
		$data['chart'] = $this->model('ReportModel')->getChart_SellingOut_val_Year();

		if(isset($_POST['by_region']))
		{
			$data['by_region'] = $_POST['by_region'];
		}else
		{
			$data['by_region'] = "";
		}

		if(isset($_POST['by_area']))
		{
			$data['by_area'] = $_POST['by_area'];
		}
		elseif ($_SESSION['area'] != 'ALL')
		{
			$data['by_area'] = explode(', ', $_SESSION['area']);
		}
		else
		{
			$data['by_area'] = "";
		}

		if(isset($_POST['by_island']))
		{
			$data['by_island'] = $_POST['by_island'];
		}else
		{
			$data['by_island'] = "";
		}

		if(isset($_POST['by_year']))
		{
			$data['by_year'] = $_POST['by_year'];
		}else
		{
			$data['by_year'] = date('Y');
		}

		//Flasher::setMessage('Berhasil', $data['by_area'],'success');

		$this->view('report/sellingout_val', $data);
		$this->view('templates/footer');
		
	}

	public function showRegion_ByIsland()
	{
		$island = $_POST['id'];
		$data['data'] = $this->model('ReportModel')->getRegionByIsland($island);

		$output ='<option value="">By Region</option>';
		foreach($data['data'] as $row)
		{
			$output .= '<option value="'.$row['region'].'">'.$row['region'].'</option>';
			//$output .= $row['sub_menu'];
		}

		//Flasher::setMessage('Berhasil','echo' .$output,'success');

		echo $output;
	}

	public function showArea_ByIsland()
	{
		$island = $_POST['id'];
		$data['data'] = $this->model('ReportModel')->getAreaByIsland($island);

		$output ='<option value="">By Area</option>';
		foreach($data['data'] as $row)
		{
			$output .= '<option value="'.$row['area'].'">'.$row['area'].'</option>';
			//$output .= $row['sub_menu'];
		}

		//Flasher::setMessage('Berhasil','echo' .$output,'success');

		echo $output;
	}

	public function showArea_ByRegion()
	{
		$region = $_POST['id'];
		$data['data'] = $this->model('ReportModel')->getAreaByRegion($region);

		//$output ='<option value="">By Area</option>';
		foreach($data['data'] as $row)
		{
			$output .= '<option value="'.$row['area'].'">'.$row['area'].'</option>';
			//$output .= $row['sub_menu'];
		}

		//Flasher::setMessage('Berhasil','echo' .$output,'success');

		echo $output;
	}

	public function showArea_ByRegion2()
	{
		$region = $_POST['id'];
		$data['data'] = $this->model('ReportModel')->getAreaByRegion($region);

		$output ='<option value="">By Area</option>';
		foreach($data['data'] as $row)
		{
			$output .= '<option value="'.$row['area'].'">'.$row['area'].'</option>';
			//$output .= $row['sub_menu'];
		}

		//Flasher::setMessage('Berhasil','echo' .$output,'success');

		echo $output;
	}

	public function showSKU_ByGroup()
	{
		$group = $_POST['id'];
		$data['data'] = $this->model('ReportModel')->getItemByGroup($group);

		$output ='<option value="">By SKU</option>';
		foreach($data['data'] as $row)
		{
			$output .= '<option value="'.$row['item_name'].'">'.$row['item_name'].'</option>';
			//$output .= $row['sub_menu'];
		}

		//Flasher::setMessage('Berhasil','echo' .$output,'success');

		echo $output;
	}

	public function sellingin_qty()
	{

		$data['title'] = 'Report Selling In - Quantity';
		$this->template('header', $data);
		$this->template('sidebar', $data);

		$data['principal'] = $this->model('ReportModel')->getPrincipalOut();
        $data['item_group'] = $this->model('ReportModel')->getItemGroupOut();
        $data['area'] = $this->model('ReportModel')->getAreaOut();
		$data['region'] = $this->model('ReportModel')->getRegionOut();
        $data['island'] = $this->model('ReportModel')->getIslandOut();
        $data['nama_dist'] = $this->model('ReportModel')->getNamaDistOut();

		$data['sellingin'] = $this->model('ReportModel')->getSellingIn_Year_pivot();
		$data['chart'] = $this->model('ReportModel')->getChart_SellingIn_Qty_Year();

		if(isset($_POST['by_region']))
		{
			$data['by_region'] = $_POST['by_region'];
		}else
		{
			$data['by_region'] = "";
		}

		if(isset($_POST['by_area']))
		{
			$data['by_area'] = $_POST['by_area'];
		}
		elseif ($_SESSION['area'] != 'ALL')
		{
			$data['by_area'] = explode(', ', $_SESSION['area']);
		}
		else
		{
			$data['by_area'] = "";
		}

		if(isset($_POST['by_island']))
		{
			$data['by_island'] = $_POST['by_island'];
		}else
		{
			$data['by_island'] = "";
		}

		if(isset($_POST['by_year']))
		{
			$data['by_year'] = $_POST['by_year'];
		}else
		{
			$data['by_year'] = date('Y');
		}

		$this->view('report/sellingin_qty', $data);
		$this->view('templates/footer');
		
	}

	public function sellingin_val()
	{

		$data['title'] = 'Report Selling In - Value';
		$this->template('header', $data);
		$this->template('sidebar', $data);

		$data['principal'] = $this->model('ReportModel')->getPrincipalOut();
        $data['item_group'] = $this->model('ReportModel')->getItemGroupOut();
        $data['area'] = $this->model('ReportModel')->getAreaOut();
		$data['region'] = $this->model('ReportModel')->getRegionOut();
        $data['island'] = $this->model('ReportModel')->getIslandOut();
        $data['nama_dist'] = $this->model('ReportModel')->getNamaDistOut();

		$data['sellingin'] = $this->model('ReportModel')->getSellingIn_Year_pivot();
		$data['chart'] = $this->model('ReportModel')->getChart_SellingIn_val_Year();

		if(isset($_POST['by_region']))
		{
			$data['by_region'] = $_POST['by_region'];
		}else
		{
			$data['by_region'] = "";
		}

		if(isset($_POST['by_area']))
		{
			$data['by_area'] = $_POST['by_area'];
		}
		elseif ($_SESSION['area'] != 'ALL')
		{
			$data['by_area'] = explode(', ', $_SESSION['area']);
		}
		else
		{
			$data['by_area'] = "";
		}

		if(isset($_POST['by_island']))
		{
			$data['by_island'] = $_POST['by_island'];
		}else
		{
			$data['by_island'] = "";
		}

		if(isset($_POST['by_year']))
		{
			$data['by_year'] = $_POST['by_year'];
		}else
		{
			$data['by_year'] = date('Y');
		}

		$this->view('report/sellingin_val', $data);
		$this->view('templates/footer');
		
	}

	public function sellingout_performance_salesman()
	{

		$data['title'] = 'Report Selling Out - Performance (by Salesman)';
		$this->template('header', $data);
		$this->template('sidebar', $data);

        $data['area'] = $this->model('ReportModel')->getAreaOut();
		$data['region'] = $this->model('ReportModel')->getRegionOut();
        $data['island'] = $this->model('ReportModel')->getIslandOut();


		$data['sellingout_salesman_year'] = $this->model('ReportModel')->getSellingOut_Salesman_Year2();

		if(isset($_POST['by_region']))
		{
			$data['by_region'] = $_POST['by_region'];
		}else
		{
			$data['by_region'] = "";
		}

		if(isset($_POST['by_area']))
		{
			$data['by_area'] = $_POST['by_area'];
		}else
		{
			$data['by_area'] = "";
		}

		if(isset($_POST['by_island']))
		{
			$data['by_island'] = $_POST['by_island'];
		}else
		{
			$data['by_island'] = "";
		}

		$this->view('report/sellingout_performance_salesman', $data);
		$this->view('templates/footer');
		
	}

	public function sellingout_salesman()
	{

		$data['title'] = 'Report Selling Out - Performance (by Salesman)';
		$this->template('header', $data);
		$this->template('sidebar', $data);

        $data['area'] = $this->model('ReportModel')->getAreaOut();
		$data['region'] = $this->model('ReportModel')->getRegionOut();
        $data['island'] = $this->model('ReportModel')->getIslandOut();
		$data['principal'] = $this->model('ReportModel')->getPrincipalOut();


		$data['so_salesman_year'] = $this->model('ReportModel')->getSellingOut_Salesman_Year2();

		if(isset($_POST['by_region']))
		{
			$data['by_region'] = $_POST['by_region'];
		}else
		{
			$data['by_region'] = "";
		}

		if(isset($_POST['by_area']))
		{
			$data['by_area'] = $_POST['by_area'];
		}else
		{
			$data['by_area'] = "";
		}

		if(isset($_POST['by_island']))
		{
			$data['by_island'] = $_POST['by_island'];
		}else
		{
			$data['by_island'] = "";
		}

		if(isset($_POST['by_principal']))
		{
			$data['by_principal'] = $_POST['by_principal'];
		}else
		{
			$data['by_principal'] = "";
		}

		if(isset($_POST['by_year']))
		{
			$data['by_year'] = $_POST['by_year'];
		}else
		{
			$data['by_year'] = date('Y');
		}

		$this->view('report/sellingout_salesman', $data);
		$this->view('templates/footer');
		
	}

	public function sellingout_performance()
	{

		$data['title'] = 'Report Selling Out - Performance';
		$this->template('header', $data);
		$this->template('sidebar', $data);

		$data['principal'] = $this->model('ReportModel')->getPrincipalOut();
        $data['item_group'] = $this->model('ReportModel')->getItemGroupOut();
        $data['area'] = $this->model('ReportModel')->getAreaOut();
		$data['region'] = $this->model('ReportModel')->getRegionOut();
        $data['island'] = $this->model('ReportModel')->getIslandOut();
        $data['nama_dist'] = $this->model('ReportModel')->getNamaDistOut();

		$data['sellingout'] = $this->model('ReportModel')->getSellingOut_Year();
		

		if(isset($_POST['by_region']))
		{
			$data['by_region'] = $_POST['by_region'];
		}else
		{
			$data['by_region'] = "";
		}

		if(isset($_POST['by_area']))
		{
			$data['by_area'] = $_POST['by_area'];
		}
		elseif ($_SESSION['area'] != 'ALL')
		{
			$data['by_area'] = explode(', ', $_SESSION['area']);
		}
		else
		{
			$data['by_area'] = "";
		}

		if(isset($_POST['by_island']))
		{
			$data['by_island'] = $_POST['by_island'];
		}else
		{
			$data['by_island'] = "";
		}

		if(isset($_POST['by_year']))
		{
			$data['by_year'] = $_POST['by_year'];
		}else
		{
			$data['by_year'] = date('Y');
		}

		$this->view('report/sellingout_performance', $data);
		$this->view('templates/footer');
		
	}

	public function sellingout_performance_weekly()
	{

		$data['title'] = 'Report Selling Out - Performance';
		$this->template('header', $data);
		$this->template('sidebar', $data);

		$data['principal'] = $this->model('ReportModel')->getPrincipalOut();
        $data['item_group'] = $this->model('ReportModel')->getItemGroupOut();
        $data['area'] = $this->model('ReportModel')->getAreaOut();
		$data['region'] = $this->model('ReportModel')->getRegionOut();
        $data['island'] = $this->model('ReportModel')->getIslandOut();
        $data['dist'] = $this->model('DistributorModel')->getDistByArea();

		$data['sellingout'] = $this->model('ReportModel')->getSellingOut_Month();

		if(isset($_POST['by_dist']))
		{
			$data['by_dist'] = $_POST['by_dist'];
		}else
		{
			$data['by_dist'] = "";
		}

		if(isset($_POST['by_year']))
		{
			$data['by_year'] = $_POST['by_year'];
		}else
		{
			$data['by_year'] = date('Y');
		}

		if(isset($_POST['by_month']))
		{
			$data['by_month'] = $_POST['by_month'];
		}else
		{
			$data['by_month'] = date('m');
		}

		$this->view('report/sellingout_performance_weekly', $data);
		$this->view('templates/footer');
		
	}

	public function sellingout_CMO()
	{

		$data['title'] = 'Report Selling Out - Performance';
		$this->template('header', $data);
		$this->template('sidebar', $data);

		// $data['principal'] = $this->model('ReportModel')->getPrincipalOut();
        $data['item_group'] = $this->model('ReportModel')->getItemGroupOut();
        // $data['area'] = $this->model('ReportModel')->getAreaOut();
		// $data['region'] = $this->model('ReportModel')->getRegionOut();
        // $data['island'] = $this->model('ReportModel')->getIslandOut();
        $data['dist'] = $this->model('DistributorModel')->getDistByArea();

		if($_POST['by_dist'] != 'By Distributor')
		{
			$data['buffer_dist'] = $this->model('DistributorModel')->getDistByCode($_POST['by_dist']);
		}

		$data['cmo'] = $this->model('ReportModel')->getSellingOut_CMO();

		if(isset($_POST['by_dist']))
		{
			$data['by_dist'] = $_POST['by_dist'];
		}else
		{
			$data['by_dist'] = "";
		}

		if(isset($_POST['by_year']))
		{
			$data['by_year'] = $_POST['by_year'];
		}else
		{
			$data['by_year'] = date('Y');
		}

		if(isset($_POST['by_month']))
		{
			$data['by_month'] = $_POST['by_month'];
		}else
		{
			$data['by_month'] = date('m');
		}

		$this->view('report/sellingout_CMO', $data);
		$this->view('templates/footer');
		
	}

	public function sellingout_distributor()
	{

		$data['title'] = 'Report Selling Out - Distributor';
		$this->template('header', $data);
		$this->template('sidebar', $data);

		$data['principal'] = $this->model('ReportModel')->getPrincipalOut();

		$data['sellingout_Dist'] = $this->model('ReportModel')->getSellingOut_Distributor();
		
		if(isset($_POST['by_principal']))
		{
			$data['by_principal'] = $_POST['by_principal'];
		}else
		{
			$data['by_principal'] = "";
		}

		if(isset($_POST['by_year']))
		{
			$data['by_year'] = $_POST['by_year'];
		}else
		{
			$data['by_year'] = date('Y');
		}

		$this->view('report/sellingout_distributor', $data);
		$this->view('templates/footer');
		
	}

	public function sellingout_growth_channel()
	{

		$data['title'] = 'Report Selling Out - Growth by Channel';
		$this->template('header', $data);
		$this->template('sidebar', $data);

		$data['principal'] = $this->model('ReportModel')->getPrincipalOut();
		$data['area'] = $this->model('ReportModel')->getAreaOut();
		$data['so_growth_channel'] = $this->model('ReportModel')->getSellingOut_Growth_Channel2();

		if(isset($_POST['by_principal']))
		{
			$data['by_principal'] = $_POST['by_principal'];
		}
		else
		{
			$data['by_principal'] = "JORDAN";
		}

		if(isset($_POST['by_area']))
		{
			$data['by_area'] = $_POST['by_area'];
		}
		elseif ($_SESSION['area'] != 'ALL')
		{
			$data['by_area'] = explode(', ', $_SESSION['area']);
		}
		else
		{
			$data['by_area'] = "";
		}

		if(isset($_POST['by_year']))
		{
			$data['by_year'] = $_POST['by_year'];
		}else
		{
			$data['by_year'] = date('Y');
		}

		$this->view('report/sellingout_growth_channel', $data);
		$this->view('templates/footer');
		
	}

	public function sellingout_growth_outlet_type()
	{

		$data['title'] = 'Report Selling Out - Growth by Outlet Type';
		$this->template('header', $data);
		$this->template('sidebar', $data);

		$data['principal'] = $this->model('ReportModel')->getPrincipalOut();
		$data['area'] = $this->model('ReportModel')->getAreaOut();
		$data['so_growth_outlet_type'] = $this->model('ReportModel')->getSellingOut_Growth_Outlet_Type();

		if(isset($_POST['by_principal']))
		{
			$data['by_principal'] = $_POST['by_principal'];
		}
		else
		{
			$data['by_principal'] = "JORDAN";
		}

		if(isset($_POST['by_area']))
		{
			$data['by_area'] = $_POST['by_area'];
		}
		elseif ($_SESSION['area'] != 'ALL')
		{
			$data['by_area'] = explode(', ', $_SESSION['area']);
		}
		else
		{
			$data['by_area'] = "";
		}

		if(isset($_POST['by_year']))
		{
			$data['by_year'] = $_POST['by_year'];
		}else
		{
			$data['by_year'] = date('Y');
		}

		$this->view('report/sellingout_growth_outlet_type', $data);
		$this->view('templates/footer');
		
	}

	public function sellingout_growth_sku_category()
	{

		$data['title'] = 'Report Selling Out - Growth by Channel';
		$this->template('header', $data);
		$this->template('sidebar', $data);

		$data['principal'] = $this->model('ReportModel')->getPrincipalOut();
		$data['area'] = $this->model('ReportModel')->getAreaOut();
		$data['so_growth_sku'] = $this->model('ReportModel')->getSellingOut_Growth_SKU_Category2();

		if(isset($_POST['by_principal']))
		{
			$data['by_principal'] = $_POST['by_principal'];
		}
		else
		{
			$data['by_principal'] = "JORDAN";
		}

		if(isset($_POST['by_area']))
		{
			$data['by_area'] = $_POST['by_area'];
		}
		elseif ($_SESSION['area'] != 'ALL')
		{
			$data['by_area'] = explode(', ', $_SESSION['area']);
		}
		else
		{
			$data['by_area'] = "";
		}

		if(isset($_POST['by_year']))
		{
			$data['by_year'] = $_POST['by_year'];
		}else
		{
			$data['by_year'] = date('Y');
		}

		$this->view('report/sellingout_growth_sku_category', $data);
		$this->view('templates/footer');
		
	}

	public function activeoutlet_lord()
	{

		$data['title'] = 'Active Outlet - LORD';
		$this->template('header', $data);
		$this->template('sidebar', $data);

        $data['area'] = $this->model('ReportModel')->getAreaOut();
		$data['region'] = $this->model('ReportModel')->getRegionOut();
        $data['island'] = $this->model('ReportModel')->getIslandOut();
		$data['sku_code'] = $this->model('SkuModel')->getItemCodeSKULord();

		$data['distr_lord'] = $this->model('ReportModel')->getAO_lord_ALL($data);

		$data['sku_name'] = $this->model('SkuModel')->getItemNameSKULord();
		$data['sku_group'] = $this->model('SkuModel')->getGroupSKULord();
		$data['sku_count'] = $this->model('SkuModel')->getCountSKULord();


		if(isset($_POST['by_region']))
		{
			$data['by_region'] = $_POST['by_region'];
		}else
		{
			$data['by_region'] = "";
		}

		if(isset($_POST['by_area']))
		{
			$data['by_area'] = $_POST['by_area'];
		}
		elseif ($_SESSION['area'] != 'ALL')
		{
			$data['by_area'] = explode(', ', $_SESSION['area']);
		}
		else
		{
			$data['by_area'] = "";
		}

		if(isset($_POST['by_island']))
		{
			$data['by_island'] = $_POST['by_island'];
		}else
		{
			$data['by_island'] = "";
		}

		if(isset($_POST['by_month1']))
		{
			$data['by_month1'] = $_POST['by_month1'];
		}else
		{
			$data['by_month1'] = date('m');
		}

		if(isset($_POST['by_month2']))
		{
			$data['by_month2'] = $_POST['by_month2'];
		}else
		{
			$data['by_month2'] = date('m');
		}

		if(isset($_POST['by_year']))
		{
			$data['by_year'] = $_POST['by_year'];
		}else
		{
			$data['by_year'] = date('Y');
		}

		$this->view('report/activeoutlet_lord', $data);
		$this->view('templates/footer');
		
	}

	public function activeoutlet_Jordan()
	{

		$data['title'] = 'Active Outlet - JORDAN';
		$this->template('header', $data);
		$this->template('sidebar', $data);

        $data['area'] = $this->model('ReportModel')->getAreaOut();
		$data['region'] = $this->model('ReportModel')->getRegionOut();
        $data['island'] = $this->model('ReportModel')->getIslandOut();
		$data['sku_code'] = $this->model('SkuModel')->getItemCodeSKUJordan();

		//$data['distr_jordan'] = $this->model('ReportModel')->getAO_jordan();
		$data['distr_jordan'] = $this->model('ReportModel')->getAO_jordan_ALL($data);

		$data['sku_name'] = $this->model('SkuModel')->getItemNameSKUJordan();
		$data['sku_group'] = $this->model('SkuModel')->getGroupSKUJordan();
		$data['sku_count'] = $this->model('SkuModel')->getCountSKUJordan();

		if(isset($_POST['by_region']))
		{
			$data['by_region'] = $_POST['by_region'];
		}else
		{
			$data['by_region'] = "";
		}

		if(isset($_POST['by_area']))
		{
			$data['by_area'] = $_POST['by_area'];
		}
		elseif ($_SESSION['area'] != 'ALL')
		{
			$data['by_area'] = explode(', ', $_SESSION['area']);
		}
		else
		{
			$data['by_area'] = "";
		}

		if(isset($_POST['by_island']))
		{
			$data['by_island'] = $_POST['by_island'];
		}else
		{
			$data['by_island'] = "";
		}

		if(isset($_POST['by_month1']))
		{
			$data['by_month1'] = $_POST['by_month1'];
		}else
		{
			$get['period_si'] = $this->model('ReportModel')->getMonth_SO();
			$data['by_month1'] = $get['period_si']['to_month'];
		}

		if(isset($_POST['by_month2']))
		{
			$data['by_month2'] = $_POST['by_month2'];
		}else
		{
			$get['period_si'] = $this->model('ReportModel')->getMonth_SO();
			$data['by_month2'] = $get['period_si']['to_month'];
		}

		if(isset($_POST['by_year']))
		{
			$data['by_year'] = $_POST['by_year'];
		}else
		{
			$data['by_year'] = date('Y');
		}

		$this->view('report/activeoutlet_jordan', $data);
		$this->view('templates/footer');
		
	}

	public function activeoutlet_Riemann()
	{

		$data['title'] = 'Active Outlet - RIEMANN';
		$this->template('header', $data);
		$this->template('sidebar', $data);

        $data['area'] = $this->model('ReportModel')->getAreaOut();
		$data['region'] = $this->model('ReportModel')->getRegionOut();
        $data['island'] = $this->model('ReportModel')->getIslandOut();
		$data['sku_code'] = $this->model('SkuModel')->getItemCodeSKURiemann();

		//$data['distr_jordan'] = $this->model('ReportModel')->getAO_jordan();
		$data['distr_riemann'] = $this->model('ReportModel')->getAO_riemann_ALL($data);

		$data['sku_name'] = $this->model('SkuModel')->getItemNameSKURiemann();
		$data['sku_group'] = $this->model('SkuModel')->getGroupSKURiemann();
		$data['sku_count'] = $this->model('SkuModel')->getCountSKURiemann();

		if(isset($_POST['by_region']))
		{
			$data['by_region'] = $_POST['by_region'];
		}else
		{
			$data['by_region'] = "";
		}

		if(isset($_POST['by_area']))
		{
			$data['by_area'] = $_POST['by_area'];
		}
		elseif ($_SESSION['area'] != 'ALL')
		{
			$data['by_area'] = explode(', ', $_SESSION['area']);
		}
		else
		{
			$data['by_area'] = "";
		}

		if(isset($_POST['by_island']))
		{
			$data['by_island'] = $_POST['by_island'];
		}else
		{
			$data['by_island'] = "";
		}

		if(isset($_POST['by_month1']))
		{
			$data['by_month1'] = $_POST['by_month1'];
		}else
		{
			$get['period_si'] = $this->model('ReportModel')->getMonth_SO();
			$data['by_month1'] = $get['period_si']['to_month'];
		}

		if(isset($_POST['by_month2']))
		{
			$data['by_month2'] = $_POST['by_month2'];
		}else
		{
			$get['period_si'] = $this->model('ReportModel')->getMonth_SO();
			$data['by_month2'] = $get['period_si']['to_month'];
		}

		if(isset($_POST['by_year']))
		{
			$data['by_year'] = $_POST['by_year'];
		}else
		{
			$data['by_year'] = date('Y');
		}

		$this->view('report/activeoutlet_riemann', $data);
		$this->view('templates/footer');
		
	}

	public function distribution_lord()
	{

		$data['title'] = 'Distribution - LORD';
		$this->template('header', $data);
		$this->template('sidebar', $data);

        $data['area'] = $this->model('ReportModel')->getAreaOut();
		$data['region'] = $this->model('ReportModel')->getRegionOut();
        $data['island'] = $this->model('ReportModel')->getIslandOut();
		$data['sku_code'] = $this->model('SkuModel')->getItemCodeSKULord();

		$data['distr_lord'] = $this->model('ReportModel')->getDistr_lord_ALL($data);

		$data['sku_name'] = $this->model('SkuModel')->getItemNameSKULord();
		$data['sku_group'] = $this->model('SkuModel')->getGroupSKULord();
		$data['sku_count'] = $this->model('SkuModel')->getCountSKULord();


		if(isset($_POST['by_region']))
		{
			$data['by_region'] = $_POST['by_region'];
		}else
		{
			$data['by_region'] = "";
		}

		if(isset($_POST['by_area']))
		{
			$data['by_area'] = $_POST['by_area'];
		}
		elseif ($_SESSION['area'] != 'ALL')
		{
			$data['by_area'] = explode(', ', $_SESSION['area']);
		}
		else
		{
			$data['by_area'] = "";
		}

		if(isset($_POST['by_island']))
		{
			$data['by_island'] = $_POST['by_island'];
		}else
		{
			$data['by_island'] = "";
		}

		if(isset($_POST['by_month']))
		{
			$data['by_month'] = $_POST['by_month'];
		}else
		{
			$data['by_month'] = date('m');
		}

		if(isset($_POST['by_year']))
		{
			$data['by_year'] = $_POST['by_year'];
		}else
		{
			$data['by_year'] = date('Y');
		}

		$this->view('report/distribution_lord', $data);
		$this->view('templates/footer');
		
	}

	public function distribution_jordan()
	{

		$data['title'] = 'Distribution - JORDAN';
		$this->template('header', $data);
		$this->template('sidebar', $data);

		//$data['username'] = $_SESSION['username'];
		//$data['user_area'] = $this->model('UserModel')->getUserArea($data['username']);

        $data['area'] = $this->model('ReportModel')->getAreaOut();
		$data['region'] = $this->model('ReportModel')->getRegionOut();
        $data['island'] = $this->model('ReportModel')->getIslandOut();
		$data['sku_code'] = $this->model('SkuModel')->getItemCodeSKUJordan();

		$data['distr_jordan'] = $this->model('ReportModel')->getDistr_jordan_ALL($data);

		$data['sku_name'] = $this->model('SkuModel')->getItemNameSKUJordan();
		$data['sku_group'] = $this->model('SkuModel')->getGroupSKUJordan();
		$data['sku_count'] = $this->model('SkuModel')->getCountSKUJordan();


		if(isset($_POST['by_region']))
		{
			$data['by_region'] = $_POST['by_region'];
		}else
		{
			$data['by_region'] = "";
		}

		if(isset($_POST['by_area']))
		{
			$data['by_area'] = $_POST['by_area'];
		}
		elseif ($_SESSION['area'] != 'ALL')
		{
			$data['by_area'] = explode(', ', $_SESSION['area']);
		}
		else
		{
			$data['by_area'] = "";
		}

		if(isset($_POST['by_island']))
		{
			$data['by_island'] = $_POST['by_island'];
		}else
		{
			$data['by_island'] = "";
		}

		if(isset($_POST['by_month']))
		{
			$data['by_month'] = $_POST['by_month'];
		}else
		{
			$get['period_si'] = $this->model('ReportModel')->getMonth_SO();
			$data['by_month'] = $get['period_si']['to_month'];
		}

		if(isset($_POST['by_year']))
		{
			$data['by_year'] = $_POST['by_year'];
		}else
		{
			$data['by_year'] = date('Y');
		}

		$this->view('report/distribution_jordan', $data);
		$this->view('templates/footer');
		
	}

	public function distribution_riemann()
	{

		$data['title'] = 'Distribution - RIEMANN';
		$this->template('header', $data);
		$this->template('sidebar', $data);

		//$data['username'] = $_SESSION['username'];
		//$data['user_area'] = $this->model('UserModel')->getUserArea($data['username']);

        $data['area'] = $this->model('ReportModel')->getAreaOut();
		$data['region'] = $this->model('ReportModel')->getRegionOut();
        $data['island'] = $this->model('ReportModel')->getIslandOut();
		$data['sku_code'] = $this->model('SkuModel')->getItemCodeSKURiemann();

		$data['distr_riemann'] = $this->model('ReportModel')->getDistr_riemann_ALL($data);

		$data['sku_name'] = $this->model('SkuModel')->getItemNameSKURiemann();
		$data['sku_group'] = $this->model('SkuModel')->getGroupSKURiemann();
		$data['sku_count'] = $this->model('SkuModel')->getCountSKURiemann();


		if(isset($_POST['by_region']))
		{
			$data['by_region'] = $_POST['by_region'];
		}else
		{
			$data['by_region'] = "";
		}

		if(isset($_POST['by_area']))
		{
			$data['by_area'] = $_POST['by_area'];
		}
		elseif ($_SESSION['area'] != 'ALL')
		{
			$data['by_area'] = explode(', ', $_SESSION['area']);
		}
		else
		{
			$data['by_area'] = "";
		}

		if(isset($_POST['by_island']))
		{
			$data['by_island'] = $_POST['by_island'];
		}else
		{
			$data['by_island'] = "";
		}

		if(isset($_POST['by_month']))
		{
			$data['by_month'] = $_POST['by_month'];
		}else
		{
			$get['period_si'] = $this->model('ReportModel')->getMonth_SO();
			$data['by_month'] = $get['period_si']['to_month'];
		}

		if(isset($_POST['by_year']))
		{
			$data['by_year'] = $_POST['by_year'];
		}else
		{
			$data['by_year'] = date('Y');
		}

		$this->view('report/distribution_riemann', $data);
		$this->view('templates/footer');
		
	}

	public function distribution_summary()
	{

		$data['title'] = 'Distribution - Summary';
		$this->template('header', $data);
		$this->template('sidebar', $data);

		//$data['username'] = $_SESSION['username'];
		//$data['user_area'] = $this->model('UserModel')->getUserArea($data['username']);
		if(isset($_POST['by_principal']))
		{
			$data['by_principal'] = $_POST['by_principal'];
		}
		else
		{
			$data['by_principal'] = "JORDAN";
		}

		if(isset($_POST['by_area']))
		{
			$data['by_area'] = $_POST['by_area'];
		}
		elseif ($_SESSION['area'] != 'ALL')
		{
			$data['by_area'] = explode(', ', $_SESSION['area']);
		}
		else
		{
			$data['by_area'] = "";
		}

		if(isset($_POST['by_year']))
		{
			$data['by_year'] = $_POST['by_year'];
		}else
		{
			$data['by_year'] = date('Y');
		}
		
		$data['principal'] = $this->model('ReportModel')->getPrincipalOut();
        $data['area'] = $this->model('ReportModel')->getAreaOut();
		$data['distr_summary'] = $this->model('ReportModel')->getDistr_summary();
		
		$get['period_so'] = $this->model('ReportModel')->getMonth_SO2($data['by_year']);
		$month_so = $get['period_so']['to_month'];
		$year_so = $get['period_so']['year'];

		$data['month_so'] = $month_so;

		$this->view('report/distribution_summary', $data);
		$this->view('templates/footer');
		
	}

	public function distribution_lord_newOT()
	{

		$data['title'] = 'Distribution - LORD (new Outlet)';
		$this->template('header', $data);
		$this->template('sidebar', $data);

        $data['area'] = $this->model('ReportModel')->getAreaOut();
		$data['region'] = $this->model('ReportModel')->getRegionOut();
        $data['island'] = $this->model('ReportModel')->getIslandOut();
		$data['sku_code'] = $this->model('SkuModel')->getItemCodeSKULord();

		$data['distr_lord'] = $this->model('ReportModel')->getDistr_lord_new_OT($data);

		$data['sku_name'] = $this->model('SkuModel')->getItemNameSKULord();
		$data['sku_group'] = $this->model('SkuModel')->getGroupSKULord();
		$data['sku_count'] = $this->model('SkuModel')->getCountSKULord();


		if(isset($_POST['by_region']))
		{
			$data['by_region'] = $_POST['by_region'];
		}else
		{
			$data['by_region'] = "";
		}

		if(isset($_POST['by_area']))
		{
			$data['by_area'] = $_POST['by_area'];
		}else
		{
			$data['by_area'] = "";
		}

		if(isset($_POST['by_island']))
		{
			$data['by_island'] = $_POST['by_island'];
		}else
		{
			$data['by_island'] = "";
		}

		if(isset($_POST['by_month']))
		{
			$data['by_month'] = $_POST['by_month'];
		}else
		{
			$data['by_month'] = date('m');
		}

		if(isset($_POST['by_year']))
		{
			$data['by_year'] = $_POST['by_year'];
		}else
		{
			$data['by_year'] = date('Y');
		}

		$this->view('report/distribution_lord_newOT', $data);
		$this->view('templates/footer');
		
	}

	public function distribution_jordan_newOT()
	{

		$data['title'] = 'Distribution - JORDAN (new Outlet)';
		$this->template('header', $data);
		$this->template('sidebar', $data);

        $data['area'] = $this->model('ReportModel')->getAreaOut();
		$data['region'] = $this->model('ReportModel')->getRegionOut();
        $data['island'] = $this->model('ReportModel')->getIslandOut();
		$data['sku_code'] = $this->model('SkuModel')->getItemCodeSKUJordan();

		$data['distr_jordan'] = $this->model('ReportModel')->getDistr_jordan_new_OT($data);

		$data['sku_name'] = $this->model('SkuModel')->getItemNameSKUJordan();
		$data['sku_group'] = $this->model('SkuModel')->getGroupSKUJordan();
		$data['sku_count'] = $this->model('SkuModel')->getCountSKUJordan();


		if(isset($_POST['by_region']))
		{
			$data['by_region'] = $_POST['by_region'];
		}else
		{
			$data['by_region'] = "";
		}

		if(isset($_POST['by_area']))
		{
			$data['by_area'] = $_POST['by_area'];
		}else
		{
			$data['by_area'] = "";
		}

		if(isset($_POST['by_island']))
		{
			$data['by_island'] = $_POST['by_island'];
		}else
		{
			$data['by_island'] = "";
		}

		if(isset($_POST['by_month']))
		{
			$data['by_month'] = $_POST['by_month'];
		}else
		{
			$data['by_month'] = date('m');
		}

		if(isset($_POST['by_year']))
		{
			$data['by_year'] = $_POST['by_year'];
		}else
		{
			$data['by_year'] = date('Y');
		}

		$this->view('report/distribution_jordan_newOT', $data);
		$this->view('templates/footer');
		
	}

	public function direct_jordan()
	{

		$data['title'] = 'Direct Distribution - JORDAN';
		$this->template('header', $data);
		$this->template('sidebar', $data);

        $data['area'] = $this->model('ReportModel')->getAreaOut();
		$data['region'] = $this->model('ReportModel')->getRegionOut();
        $data['island'] = $this->model('ReportModel')->getIslandOut();
		$data['sku_code'] = $this->model('SkuModel')->getItemCodeSKUJordan();

		$data['distr_jordan'] = $this->model('ReportModel')->getDistr_jordan_direct($data);

		$data['sku_name'] = $this->model('SkuModel')->getItemNameSKUJordan();
		$data['sku_group'] = $this->model('SkuModel')->getGroupSKUJordan();
		$data['sku_count'] = $this->model('SkuModel')->getCountSKUJordan();


		if(isset($_POST['by_region']))
		{
			$data['by_region'] = $_POST['by_region'];
		}else
		{
			$data['by_region'] = "";
		}

		if(isset($_POST['by_area']))
		{
			$data['by_area'] = $_POST['by_area'];
		}else
		{
			$data['by_area'] = "";
		}

		if(isset($_POST['by_island']))
		{
			$data['by_island'] = $_POST['by_island'];
		}else
		{
			$data['by_island'] = "";
		}

		if(isset($_POST['by_month']))
		{
			$data['by_month'] = $_POST['by_month'];
		}else
		{
			$data['by_month'] = date('m');
		}

		if(isset($_POST['by_year']))
		{
			$data['by_year'] = $_POST['by_year'];
		}else
		{
			$data['by_year'] = date('Y');
		}

		$this->view('report/direct_jordan', $data);
		$this->view('templates/footer');
		
	}

	public function direct_lord()
	{

		$data['title'] = 'Distribution - LORD';
		$this->template('header', $data);
		$this->template('sidebar', $data);

        $data['area'] = $this->model('ReportModel')->getAreaOut();
		$data['region'] = $this->model('ReportModel')->getRegionOut();
        $data['island'] = $this->model('ReportModel')->getIslandOut();
		$data['sku_code'] = $this->model('SkuModel')->getItemCodeSKULord();

		$data['distr_jordan'] = $this->model('ReportModel')->getDistr_lord_direct($data);

		$data['sku_name'] = $this->model('SkuModel')->getItemNameSKULord();
		$data['sku_group'] = $this->model('SkuModel')->getGroupSKULord();
		$data['sku_count'] = $this->model('SkuModel')->getCountSKULord();


		if(isset($_POST['by_region']))
		{
			$data['by_region'] = $_POST['by_region'];
		}else
		{
			$data['by_region'] = "";
		}

		if(isset($_POST['by_area']))
		{
			$data['by_area'] = $_POST['by_area'];
		}else
		{
			$data['by_area'] = "";
		}

		if(isset($_POST['by_island']))
		{
			$data['by_island'] = $_POST['by_island'];
		}else
		{
			$data['by_island'] = "";
		}

		if(isset($_POST['by_month']))
		{
			$data['by_month'] = $_POST['by_month'];
		}else
		{
			$data['by_month'] = date('m');
		}

		if(isset($_POST['by_year']))
		{
			$data['by_year'] = $_POST['by_year'];
		}else
		{
			$data['by_year'] = date('Y');
		}

		$this->view('report/direct_lord', $data);
		$this->view('templates/footer');
		
	}

	public function ao_direct_jordan()
	{

		$data['title'] = 'Direct Active Outlet - JORDAN';
		$this->template('header', $data);
		$this->template('sidebar', $data);

        $data['area'] = $this->model('ReportModel')->getAreaOut();
		$data['region'] = $this->model('ReportModel')->getRegionOut();
        $data['island'] = $this->model('ReportModel')->getIslandOut();
		$data['sku_code'] = $this->model('SkuModel')->getItemCodeSKUJordan();

		$data['distr_jordan'] = $this->model('ReportModel')->getAO_direct_jordan($data);

		$data['sku_name'] = $this->model('SkuModel')->getItemNameSKUJordan();
		$data['sku_group'] = $this->model('SkuModel')->getGroupSKUJordan();
		$data['sku_count'] = $this->model('SkuModel')->getCountSKUJordan();


		if(isset($_POST['by_region']))
		{
			$data['by_region'] = $_POST['by_region'];
		}else
		{
			$data['by_region'] = "";
		}

		if(isset($_POST['by_area']))
		{
			$data['by_area'] = $_POST['by_area'];
		}else
		{
			$data['by_area'] = "";
		}

		if(isset($_POST['by_island']))
		{
			$data['by_island'] = $_POST['by_island'];
		}else
		{
			$data['by_island'] = "";
		}

		if(isset($_POST['by_month1']))
		{
			$data['by_month1'] = $_POST['by_month1'];
		}else
		{
			$data['by_month1'] = date('m');
		}

		if(isset($_POST['by_month2']))
		{
			$data['by_month2'] = $_POST['by_month2'];
		}else
		{
			$data['by_month2'] = date('m');
		}

		if(isset($_POST['by_year']))
		{
			$data['by_year'] = $_POST['by_year'];
		}else
		{
			$data['by_year'] = date('Y');
		}

		$this->view('report/ao_direct_jordan', $data);
		$this->view('templates/footer');
		
	}

	public function ao_direct_lord()
	{

		$data['title'] = 'Direct Active Outlet - LORD';
		$this->template('header', $data);
		$this->template('sidebar', $data);

        $data['area'] = $this->model('ReportModel')->getAreaOut();
		$data['region'] = $this->model('ReportModel')->getRegionOut();
        $data['island'] = $this->model('ReportModel')->getIslandOut();
		$data['sku_code'] = $this->model('SkuModel')->getItemCodeSKULord();

		$data['distr_jordan'] = $this->model('ReportModel')->getAO_direct_lord($data);

		$data['sku_name'] = $this->model('SkuModel')->getItemNameSKULord();
		$data['sku_group'] = $this->model('SkuModel')->getGroupSKULord();
		$data['sku_count'] = $this->model('SkuModel')->getCountSKULord();


		if(isset($_POST['by_region']))
		{
			$data['by_region'] = $_POST['by_region'];
		}else
		{
			$data['by_region'] = "";
		}

		if(isset($_POST['by_area']))
		{
			$data['by_area'] = $_POST['by_area'];
		}else
		{
			$data['by_area'] = "";
		}

		if(isset($_POST['by_island']))
		{
			$data['by_island'] = $_POST['by_island'];
		}else
		{
			$data['by_island'] = "";
		}

		if(isset($_POST['by_month1']))
		{
			$data['by_month1'] = $_POST['by_month1'];
		}else
		{
			$data['by_month1'] = date('m');
		}

		if(isset($_POST['by_month2']))
		{
			$data['by_month2'] = $_POST['by_month2'];
		}else
		{
			$data['by_month2'] = date('m');
		}

		if(isset($_POST['by_year']))
		{
			$data['by_year'] = $_POST['by_year'];
		}else
		{
			$data['by_year'] = date('Y');
		}

		$this->view('report/ao_direct_lord', $data);
		$this->view('templates/footer');
		
	}

	public function sellingout_contribution()
	{

		$data['title'] = 'Selling Out Contribution';

		if(isset($_POST['by_month1']))
		{
			$data['by_month1'] = $_POST['by_month1'];
		}else
		{
			$data['by_month1'] = date('m');
		}

		if(isset($_POST['by_month2']))
		{
			$data['by_month2'] = $_POST['by_month2'];
		}else
		{
			$data['by_month2'] = date('m');
		}

		$dateObj1   = DateTime::createFromFormat('!m', $data['by_month1']);
		$dateObj2   = DateTime::createFromFormat('!m', $data['by_month2']);
        $monthName1 = $dateObj1->format('M');
		$monthName2 = $dateObj2->format('M');

		$data['title'] = 'Selling Out Contribution (' . $monthName1 . ' To ' . $monthName2 . ')';

		$this->template('header', $data);
		$this->template('sidebar', $data);

        $data['area'] = $this->model('ReportModel')->getAreaOut();
		$data['region'] = $this->model('ReportModel')->getRegionOut();
        $data['island'] = $this->model('ReportModel')->getIslandOut();

		$this->model('ReportModel')->setSOContribution();
		$data['so_contr'] = $this->model('ReportModel')->getSOContribution();

		$data['total_item'] = $this->model('ReportModel')->getTotal_SO_Contribution();
		$data['sku_code'] = $this->model('SkuModel')->getItemCodeBy_SO_Contribution();
		$data['sku_name'] = $this->model('SkuModel')->getItemNameBy_SO_Contribution();
		$data['sku_group'] = $this->model('SkuModel')->getItemGroupBy_SO_Contribution();
		$data['sku_count'] = $this->model('SkuModel')->getItemRowBy_SO_Contribution();


		if(isset($_POST['by_region']))
		{
			$data['by_region'] = $_POST['by_region'];
		}else
		{
			$data['by_region'] = "";
		}

		if(isset($_POST['by_area']))
		{
			$data['by_area'] = $_POST['by_area'];
		}else
		{
			$data['by_area'] = "";
		}

		if(isset($_POST['by_island']))
		{
			$data['by_island'] = $_POST['by_island'];
		}else
		{
			$data['by_island'] = "";
		}

		if(isset($_POST['by_month1']))
		{
			$data['by_month1'] = $_POST['by_month1'];
		}else
		{
			$data['by_month1'] = date('m');
		}

		if(isset($_POST['by_month2']))
		{
			$data['by_month2'] = $_POST['by_month2'];
		}else
		{
			$data['by_month2'] = date('m');
		}

		if(isset($_POST['by_year']))
		{
			$data['by_year'] = $_POST['by_year'];
		}else
		{
			$data['by_year'] = date('Y');
		}

		$this->view('report/sellingout_contribution', $data);
		$this->view('templates/footer');
		
	}

	public function contribution_lord()
	{

		$data['title'] = 'Contribution - LORD';

		if(isset($_POST['by_month1']))
		{
			$data['by_month1'] = $_POST['by_month1'];
		}else
		{
			$data['by_month1'] = date('m');
		}

		if(isset($_POST['by_month2']))
		{
			$data['by_month2'] = $_POST['by_month2'];
		}else
		{
			$data['by_month2'] = date('m');
		}

		$dateObj1   = DateTime::createFromFormat('!m', $data['by_month1']);
		$dateObj2   = DateTime::createFromFormat('!m', $data['by_month2']);
        $monthName1 = $dateObj1->format('M');
		$monthName2 = $dateObj2->format('M');

		$data['title'] = 'Contribution Summary - LORD (' . $monthName1 . ' To ' . $monthName2 . ')';

		$this->template('header', $data);
		$this->template('sidebar', $data);

        $data['area'] = $this->model('ReportModel')->getAreaOut();
		$data['region'] = $this->model('ReportModel')->getRegionOut();
        $data['island'] = $this->model('ReportModel')->getIslandOut();
		$data['sku_code'] = $this->model('SkuModel')->getItemCodeSKULord();

		$data['cont_lord'] = $this->model('ReportModel')->getCont_lord_ALL($data);

		$data['sku_name'] = $this->model('SkuModel')->getItemNameSKULord();
		$data['sku_group'] = $this->model('SkuModel')->getGroupSKULord();
		$data['sku_count'] = $this->model('SkuModel')->getCountSKULord();

		if(isset($_POST['by_region']))
		{
			$data['by_region'] = $_POST['by_region'];
		}else
		{
			$data['by_region'] = "";
		}

		if(isset($_POST['by_area']))
		{
			$data['by_area'] = $_POST['by_area'];
		}
		elseif ($_SESSION['area'] != 'ALL')
		{
			$data['by_area'] = explode(', ', $_SESSION['area']);
		}
		else
		{
			$data['by_area'] = "";
		}

		if(isset($_POST['by_island']))
		{
			$data['by_island'] = $_POST['by_island'];
		}else
		{
			$data['by_island'] = "";
		}

		if(isset($_POST['by_month1']))
		{
			$data['by_month1'] = $_POST['by_month1'];
		}else
		{
			$data['by_month1'] = date('m');
		}

		if(isset($_POST['by_month2']))
		{
			$data['by_month2'] = $_POST['by_month2'];
		}else
		{
			$data['by_month2'] = date('m');
		}

		if(isset($_POST['by_year']))
		{
			$data['by_year'] = $_POST['by_year'];
		}else
		{
			$data['by_year'] = date('Y');
		}

		$this->view('report/contribution_lord', $data);
		$this->view('templates/footer');
		
	}

	public function contribution_jordan()
	{

		$data['title'] = 'Contribution - JORDAN';

		if(isset($_POST['by_month1']))
		{
			$data['by_month1'] = $_POST['by_month1'];
		}else
		{
			$data['by_month1'] = date('m');
		}

		if(isset($_POST['by_month2']))
		{
			$data['by_month2'] = $_POST['by_month2'];
		}else
		{
			$data['by_month2'] = date('m');
		}

		$dateObj1   = DateTime::createFromFormat('!m', $data['by_month1']);
		$dateObj2   = DateTime::createFromFormat('!m', $data['by_month2']);
        $monthName1 = $dateObj1->format('F');
		$monthName2 = $dateObj2->format('F');

		$data['title'] = 'Contribution - JORDAN (' . $monthName1 . ' To ' . $monthName2 . ')';

		$this->template('header', $data);
		$this->template('sidebar', $data);

        $data['area'] = $this->model('ReportModel')->getAreaOut();
		$data['region'] = $this->model('ReportModel')->getRegionOut();
        $data['island'] = $this->model('ReportModel')->getIslandOut();
		$data['sku_code'] = $this->model('SkuModel')->getItemCodeSKUJordan();

		$data['cont_jordan'] = $this->model('ReportModel')->getCont_jordan_ALL($data);
		// $data['distr_jordan'] = $this->model('ReportModel')->getDistr_jordan_ALL($data);

		
		$data['sku_name'] = $this->model('SkuModel')->getItemNameSKUJordan();
		$data['sku_group'] = $this->model('SkuModel')->getGroupSKUJordan();
		$data['sku_count'] = $this->model('SkuModel')->getCountSKUJordan();


		if(isset($_POST['by_region']))
		{
			$data['by_region'] = $_POST['by_region'];
		}else
		{
			$data['by_region'] = "";
		}

		if(isset($_POST['by_area']))
		{
			$data['by_area'] = $_POST['by_area'];
		}
		elseif ($_SESSION['area'] != 'ALL')
		{
			$data['by_area'] = explode(', ', $_SESSION['area']);
		}
		else
		{
			$data['by_area'] = "";
		}

		if(isset($_POST['by_island']))
		{
			$data['by_island'] = $_POST['by_island'];
		}else
		{
			$data['by_island'] = "";
		}

		if(isset($_POST['by_month1']))
		{
			$data['by_month1'] = $_POST['by_month1'];
		}else
		{
			$get['period_so'] = $this->model('ReportModel')->getMonth_SO();
			$data['by_month1'] = $get['period_so']['to_month'];
		}

		if(isset($_POST['by_month2']))
		{
			$data['by_month2'] = $_POST['by_month2'];
		}else
		{
			$get['period_so'] = $this->model('ReportModel')->getMonth_SO();
			$data['by_month2'] = $get['period_so']['to_month'];
		}

		if(isset($_POST['by_year']))
		{
			$data['by_year'] = $_POST['by_year'];
		}else
		{
			$data['by_year'] = date('Y');
		}

		$this->view('report/contribution_jordan', $data);
		$this->view('templates/footer');
		
	}

	public function export_RO_Outlet()
	{
		$spreadsheet = new Spreadsheet();
		$sheet = $spreadsheet->getActiveSheet();
		// Buat sebuah variabel untuk menampung pengaturan style dari header tabel
		$style_col = [
			'font' => ['bold' => true], // Set font nya jadi bold
			'alignment' => [
				'horizontal' => \PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER, // Set text jadi ditengah secara horizontal (center)
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'top' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border top dengan garis tipis
				'right' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN],  // Set border right dengan garis tipis
				'bottom' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border bottom dengan garis tipis
				'left' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN] // Set border left dengan garis tipis
			]
		];
		// Buat sebuah variabel untuk menampung pengaturan style dari isi tabel
		$style_row = [
			'alignment' => [
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'top' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border top dengan garis tipis
				'right' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN],  // Set border right dengan garis tipis
				'bottom' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border bottom dengan garis tipis
				'left' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN] // Set border left dengan garis tipis
			]
		];


		if (isset($_POST['by_channel']))
		{
			$channel = $_POST['by_channel'];
		}
		else
		{
			$channel = "";
		}

		if (isset($_POST['by_outlet_type']))
		{
			$outlet_type = $_POST['by_outlet_type'];
		}
		else
		{
			$outlet_type = "";
		}
		


		$sheet->setCellValue('A1', "Report RO Outlet"); // Set kolom A1 dengan tulisan "Report Selling In - By Outlet"
		$sheet->setCellValue('A2', "Principal : " . $principal); // Set kolom A2 dengan tulisan "Outlet Type : EC_EC"
		$sheet->setCellValue('A3', "Channel : " . $channel); // Set kolom A3 dengan tulisan "Outlet Type : EC_EC"
		$sheet->setCellValue('A4', "Outlet Type : " . $outlet_type);
		//$sheet->mergeCells('A1:F1'); // Set Merge Cell pada kolom A1 sampai F1
		$sheet->getStyle('A1')->getFont()->setBold(true); // Set bold kolom A1
		$sheet->getStyle('A2')->getFont()->setBold(true); // Set bold kolom A2
		$sheet->getStyle('A3')->getFont()->setBold(true); // Set bold kolom A3
		$sheet->getStyle('A4')->getFont()->setBold(true);
		$sheet->getStyle('A1')->getFont()->setSize(20); // Set font size 15 untuk kolom A1
		// Buat header tabel nya pada baris ke 6
		$sheet->setCellValue('A6', "#"); // Set kolom A6 dengan tulisan "NO"
		$sheet->setCellValue('B6', "BIG Code"); // Set kolom A6 dengan tulisan "NO"
		$sheet->setCellValue('C6', "Outlet Name"); // Set kolom A6 dengan tulisan "NO"
		$sheet->setCellValue('D6', "Area"); // Set kolom A6 dengan tulisan "NO"
		$sheet->setCellValue('E6', "Outlet Type");
		$sheet->setCellValue('F6', "RO");
		$sheet->setCellValue('G6', "Distributor");
		$sheet->setCellValue('H6', "DISTR");
		$sheet->setCellValue('I6', "AO");

		// Apply style header yang telah kita buat tadi ke masing-masing kolom header
		$sheet->getStyle('A6')->applyFromArray($style_col);
		$sheet->getStyle('B6')->applyFromArray($style_col);
		$sheet->getStyle('C6')->applyFromArray($style_col);
		$sheet->getStyle('D6')->applyFromArray($style_col);
		$sheet->getStyle('E6')->applyFromArray($style_col);
		$sheet->getStyle('F6')->applyFromArray($style_col);
		$sheet->getStyle('G6')->applyFromArray($style_col);
		$sheet->getStyle('H6')->applyFromArray($style_col);
		$sheet->getStyle('I6')->applyFromArray($style_col);
		

		$sheet->getStyle('A6:I6')->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');

		// Set height baris ke 1, 2 dan 3
		$sheet->getRowDimension('1')->setRowHeight(40);
		$sheet->getRowDimension('2')->setRowHeight(20);
		$sheet->getRowDimension('3')->setRowHeight(20);
		$sheet->getRowDimension('4')->setRowHeight(20);

		$no = 1; // Untuk penomoran tabel, di awal set dengan 1
		$row = 7;

		// $data1 = array(
		// 	'principal' => $principal,
		// 	'channel' => $channel,
		// 	'outlet_type' => $outlet_type,
		// 	'year' => $year
		// );

		$data['RO_outlet'] = $this->model('ReportModel')->getRO_outlet();
		//$data['sellingin_OT'] = $this->model('ReportModel')->getSellingIn_OT2();

		foreach ($data['RO_outlet'] as $rows) :
			$sheet->setCellValue('A' . $row, $no);
    		$sheet->setCellValue('B' . $row, $rows['big_code']);
			$sheet->setCellValue('C' . $row, $rows['outlet_name']);
			$sheet->setCellValue('D' . $row, $rows['area']);
			$sheet->setCellValue('E' . $row, $rows['outlet_type']);
			$sheet->setCellValue('F' . $row, number_format($rows['ro'], 0));
			$sheet->setCellValue('G' . $row, $rows['distributor']);
			$sheet->setCellValue('H' . $row, $rows['distr']);
			$sheet->setCellValue('I' . $row, $rows['ao']);

			// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
			$sheet->getStyle('A' . $row)->applyFromArray($style_row);
			$sheet->getStyle('B' . $row)->applyFromArray($style_row);
			$sheet->getStyle('C' . $row)->applyFromArray($style_row);
			$sheet->getStyle('D' . $row)->applyFromArray($style_row);
			$sheet->getStyle('E' . $row)->applyFromArray($style_row);
			$sheet->getStyle('F' . $row)->applyFromArray($style_row);
			$sheet->getStyle('G' . $row)->applyFromArray($style_row);
			$sheet->getStyle('H' . $row)->applyFromArray($style_row);
			$sheet->getStyle('I' . $row)->applyFromArray($style_row);

			$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('I' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);

			if($rows['distr'] == 0)
			{
				$sheet->getStyle('H' . $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFA07A');
			}

			if($rows['ao'] == 0)
			{
				$sheet->getStyle('I' . $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFA07A');
			}

			$no++; // Tambah 1 setiap kali looping
    		$row++; // Tambah 1 setiap kali looping

			$total_outlet += $rows['ro'];
			$total_distr += $rows['distr'];
			$total_ao += $rows['ao'];

		endforeach;

		
		$sheet->setCellValue('A' . $row, "");
		$sheet->setCellValue('B' . $row, "");
		$sheet->setCellValue('C' . $row, "TOTAL");
		$sheet->setCellValue('D' . $row, "");
		$sheet->setCellValue('E' . $row, "");
		$sheet->setCellValue('F' . $row, number_format($total_outlet, 0));
		$sheet->setCellValue('G' . $row, "");
		$sheet->setCellValue('H' . $row, number_format($total_distr, 0));
		$sheet->setCellValue('I' . $row, number_format($total_ao, 0));

		// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
		$sheet->getStyle('A' . $row)->applyFromArray($style_row);
		$sheet->getStyle('B' . $row)->applyFromArray($style_row);
		$sheet->getStyle('C' . $row)->applyFromArray($style_row);
		$sheet->getStyle('D' . $row)->applyFromArray($style_row);
		$sheet->getStyle('E' . $row)->applyFromArray($style_row);
		$sheet->getStyle('F' . $row)->applyFromArray($style_row);
		$sheet->getStyle('G' . $row)->applyFromArray($style_row);
		$sheet->getStyle('H' . $row)->applyFromArray($style_row);
		$sheet->getStyle('I' . $row)->applyFromArray($style_row);

		$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('I' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);

		$sheet->getStyle('A' . $row . ':I' . $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFA07A');
		$sheet->getStyle('A' . $row . ':I' . $row)->getFont()->setBold(true);


		$sheet->getColumnDimension('A')->setWidth(5); // Set width kolom A
		$sheet->getColumnDimension('B')->setWidth(15); // Set width kolom B
		$sheet->getColumnDimension('C')->setWidth(40); // Set width kolom C
		$sheet->getColumnDimension('D')->setWidth(15);
		$sheet->getColumnDimension('E')->setWidth(11);
		$sheet->getColumnDimension('F')->setWidth(11);
		$sheet->getColumnDimension('G')->setWidth(50);
		$sheet->getColumnDimension('H')->setWidth(15);
		$sheet->getColumnDimension('I')->setWidth(15);
		

		// Set orientasi kertas jadi LANDSCAPE
		$sheet->getPageSetup()->setOrientation(\PhpOffice\PhpSpreadsheet\Worksheet\PageSetup::ORIENTATION_LANDSCAPE);
		// Set judul file excel nya
		$sheet->setTitle("Report RO Outlet");
		// Proses file excel
		header('Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet');
		header('Content-Disposition: attachment; filename="Report RO Outlet.xlsx"'); // Set nama file excel nya
		header('Cache-Control: max-age=0');

		$writer = new Xlsx($spreadsheet);
		$writer->save('php://output');


	}

	public function export_distribution_OT()
	{
		$spreadsheet = new Spreadsheet();
		$sheet = $spreadsheet->getActiveSheet();
		// Buat sebuah variabel untuk menampung pengaturan style dari header tabel
		$style_col = [
			'font' => ['bold' => true], // Set font nya jadi bold
			'alignment' => [
				'horizontal' => \PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER, // Set text jadi ditengah secara horizontal (center)
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'top' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border top dengan garis tipis
				'right' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN],  // Set border right dengan garis tipis
				'bottom' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border bottom dengan garis tipis
				'left' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN] // Set border left dengan garis tipis
			]
		];
		// Buat sebuah variabel untuk menampung pengaturan style dari isi tabel
		$style_row = [
			'alignment' => [
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'top' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border top dengan garis tipis
				'right' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN],  // Set border right dengan garis tipis
				'bottom' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border bottom dengan garis tipis
				'left' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN] // Set border left dengan garis tipis
			]
		];


		if (isset($_POST['by_principal']))
		{
			$principal = $_POST['by_principal'];
		}
		else
		{
			$principal = "";
		}

		if (isset($_POST['by_channel']))
		{
			$channel = $_POST['by_channel'];
		}
		else
		{
			$channel = "";
		}

		if (isset($_POST['by_outlet_type']))
		{
			$outlet_type = $_POST['by_outlet_type'];
		}
		else
		{
			$outlet_type = "";
		}

		if (isset($_POST['by_year']))
		{
			$year = $_POST['by_year'];
		}
		else
		{
			$year = date('Y');
		}

		$sheet->setCellValue('A1', "Report Distribution Outlet (" . $year . ")"); // Set kolom A1 dengan tulisan "Report Selling In - By Outlet"
		$sheet->setCellValue('A2', "Principal : " . $principal); // Set kolom A2 dengan tulisan "Outlet Type : EC_EC"
		$sheet->setCellValue('A3', "Channel : " . $channel); // Set kolom A3 dengan tulisan "Outlet Type : EC_EC"
		$sheet->setCellValue('A4', "Outlet Type : " . $outlet_type);
		//$sheet->mergeCells('A1:F1'); // Set Merge Cell pada kolom A1 sampai F1
		$sheet->getStyle('A1')->getFont()->setBold(true); // Set bold kolom A1
		$sheet->getStyle('A2')->getFont()->setBold(true); // Set bold kolom A2
		$sheet->getStyle('A3')->getFont()->setBold(true); // Set bold kolom A3
		$sheet->getStyle('A4')->getFont()->setBold(true);
		$sheet->getStyle('A1')->getFont()->setSize(20); // Set font size 15 untuk kolom A1
		// Buat header tabel nya pada baris ke 6
		$sheet->setCellValue('A6', "#"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('A6:A7'); // Set Merge Row pada kolom A6 sampai A8
		$sheet->setCellValue('B6', "BIG Code"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('B6:B7'); // Set Merge Row pada kolom A6 sampai A8
		$sheet->setCellValue('C6', "Outlet Name"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('C6:C7'); // Set Merge Row pada kolom A6 sampai A8
		$sheet->setCellValue('D6', "Area"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('D6:D7');
		$sheet->setCellValue('E6', "Month");
		$sheet->mergeCells('E6:P6');
		$sheet->setCellValue('E7', "Jan");
		$sheet->setCellValue('F7', "Feb");
		$sheet->setCellValue('G7', "Mar");
		$sheet->setCellValue('H7', "Apr");
		$sheet->setCellValue('I7', "May");
		$sheet->setCellValue('J7', "Jun");
		$sheet->setCellValue('K7', "Jul");
		$sheet->setCellValue('L7', "Aug");
		$sheet->setCellValue('M7', "Sep");
		$sheet->setCellValue('N7', "Oct");
		$sheet->setCellValue('O7', "Nov");
		$sheet->setCellValue('P7', "Dec");

		// Apply style header yang telah kita buat tadi ke masing-masing kolom header
		$sheet->getStyle('A6')->applyFromArray($style_col);
		$sheet->getStyle('B6')->applyFromArray($style_col);
		$sheet->getStyle('C6')->applyFromArray($style_col);
		$sheet->getStyle('D6')->applyFromArray($style_col);
		$sheet->getStyle('E6')->applyFromArray($style_col);
		$sheet->getStyle('F6')->applyFromArray($style_col);
		$sheet->getStyle('G6')->applyFromArray($style_col);
		$sheet->getStyle('H6')->applyFromArray($style_col);
		$sheet->getStyle('I6')->applyFromArray($style_col);
		$sheet->getStyle('J6')->applyFromArray($style_col);
		$sheet->getStyle('K6')->applyFromArray($style_col);
		$sheet->getStyle('L6')->applyFromArray($style_col);
		$sheet->getStyle('M6')->applyFromArray($style_col);
		$sheet->getStyle('N6')->applyFromArray($style_col);
		$sheet->getStyle('O6')->applyFromArray($style_col);
		$sheet->getStyle('P6')->applyFromArray($style_col);
		$sheet->getStyle('A7')->applyFromArray($style_col);
		$sheet->getStyle('B7')->applyFromArray($style_col);
		$sheet->getStyle('C7')->applyFromArray($style_col);
		$sheet->getStyle('D7')->applyFromArray($style_col);
		$sheet->getStyle('E7')->applyFromArray($style_col);
		$sheet->getStyle('F7')->applyFromArray($style_col);
		$sheet->getStyle('G7')->applyFromArray($style_col);
		$sheet->getStyle('H7')->applyFromArray($style_col);
		$sheet->getStyle('I7')->applyFromArray($style_col);
		$sheet->getStyle('J7')->applyFromArray($style_col);
		$sheet->getStyle('K7')->applyFromArray($style_col);
		$sheet->getStyle('L7')->applyFromArray($style_col);
		$sheet->getStyle('M7')->applyFromArray($style_col);
		$sheet->getStyle('N7')->applyFromArray($style_col);
		$sheet->getStyle('O7')->applyFromArray($style_col);
		$sheet->getStyle('P7')->applyFromArray($style_col);

		$sheet->getStyle('A6:P7')->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');

		// Set height baris ke 1, 2 dan 3
		$sheet->getRowDimension('1')->setRowHeight(40);
		$sheet->getRowDimension('2')->setRowHeight(20);
		$sheet->getRowDimension('3')->setRowHeight(20);
		$sheet->getRowDimension('4')->setRowHeight(20);

		$no = 1; // Untuk penomoran tabel, di awal set dengan 1
		$row = 8;

		// $data1 = array(
		// 	'principal' => $principal,
		// 	'channel' => $channel,
		// 	'outlet_type' => $outlet_type,
		// 	'year' => $year
		// );

		$data['sellingin_OT'] = $this->model('ReportModel')->getDistribution_OT();
		//$data['sellingin_OT'] = $this->model('ReportModel')->getSellingIn_OT2();

		foreach ($data['sellingin_OT'] as $rows) :
			$sheet->setCellValue('A' . $row, $no);
    		$sheet->setCellValue('B' . $row, $rows['big_code']);
			$sheet->setCellValue('C' . $row, $rows['cust_name']);
			$sheet->setCellValue('D' . $row, $rows['area']);
			$sheet->setCellValue('E' . $row, number_format($rows['qty_jan'], 0));
			$sheet->setCellValue('F' . $row, number_format($rows['qty_feb'], 0));
			$sheet->setCellValue('G' . $row, number_format($rows['qty_mar'], 0));
			$sheet->setCellValue('H' . $row, number_format($rows['qty_apr'], 0));
			$sheet->setCellValue('I' . $row, number_format($rows['qty_mei'], 0));
			$sheet->setCellValue('J' . $row, number_format($rows['qty_jun'], 0));
			$sheet->setCellValue('K' . $row, number_format($rows['qty_jul'], 0));
			$sheet->setCellValue('L' . $row, number_format($rows['qty_agu'], 0));
			$sheet->setCellValue('M' . $row, number_format($rows['qty_sep'], 0));
			$sheet->setCellValue('N' . $row, number_format($rows['qty_okt'], 0));
			$sheet->setCellValue('O' . $row, number_format($rows['qty_nop'], 0));;
			$sheet->setCellValue('P' . $row, number_format($rows['qty_des'], 0));

			// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
			$sheet->getStyle('A' . $row)->applyFromArray($style_row);
			$sheet->getStyle('B' . $row)->applyFromArray($style_row);
			$sheet->getStyle('C' . $row)->applyFromArray($style_row);
			$sheet->getStyle('D' . $row)->applyFromArray($style_row);
			$sheet->getStyle('E' . $row)->applyFromArray($style_row);
			$sheet->getStyle('F' . $row)->applyFromArray($style_row);
			$sheet->getStyle('G' . $row)->applyFromArray($style_row);
			$sheet->getStyle('H' . $row)->applyFromArray($style_row);
			$sheet->getStyle('I' . $row)->applyFromArray($style_row);
			$sheet->getStyle('J' . $row)->applyFromArray($style_row);
			$sheet->getStyle('K' . $row)->applyFromArray($style_row);
			$sheet->getStyle('L' . $row)->applyFromArray($style_row);
			$sheet->getStyle('M' . $row)->applyFromArray($style_row);
			$sheet->getStyle('N' . $row)->applyFromArray($style_row);
			$sheet->getStyle('O' . $row)->applyFromArray($style_row);
			$sheet->getStyle('P' . $row)->applyFromArray($style_row);

			$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('I' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('J' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('K' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('L' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('M' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('N' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('O' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('P' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);

			$no++; // Tambah 1 setiap kali looping
    		$row++; // Tambah 1 setiap kali looping

			$total_jan += $rows['qty_jan'];
			$total_feb += $rows['qty_feb'];
			$total_mar += $rows['qty_mar'];
			$total_apr += $rows['qty_apr'];
			$total_mei += $rows['qty_mei'];
			$total_jun += $rows['qty_jun'];
			$total_jul += $rows['qty_jul'];
			$total_agu += $rows['qty_agu'];
			$total_sep += $rows['qty_sep'];
			$total_okt += $rows['qty_okt'];
			$total_nop += $rows['qty_nop'];
			$total_des += $rows['qty_des'];

		endforeach;

		
		$sheet->setCellValue('A' . $row, "");
		$sheet->setCellValue('B' . $row, "");
		$sheet->setCellValue('C' . $row, "TOTAL");
		$sheet->setCellValue('D' . $row, "");
		$sheet->setCellValue('E' . $row, number_format($total_jan, 0));
		$sheet->setCellValue('F' . $row, number_format($total_feb, 0));
		$sheet->setCellValue('G' . $row, number_format($total_mar, 0));
		$sheet->setCellValue('H' . $row, number_format($total_apr, 0));
		$sheet->setCellValue('I' . $row, number_format($total_mei, 0));
		$sheet->setCellValue('J' . $row, number_format($total_jun, 0));
		$sheet->setCellValue('K' . $row, number_format($total_jul, 0));
		$sheet->setCellValue('L' . $row, number_format($total_agu, 0));
		$sheet->setCellValue('M' . $row, number_format($total_sep, 0));
		$sheet->setCellValue('N' . $row, number_format($total_okt, 0));
		$sheet->setCellValue('O' . $row, number_format($total_nop, 0));;
		$sheet->setCellValue('P' . $row, number_format($total_des, 0));

		// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
		$sheet->getStyle('A' . $row)->applyFromArray($style_row);
		$sheet->getStyle('B' . $row)->applyFromArray($style_row);
		$sheet->getStyle('C' . $row)->applyFromArray($style_row);
		$sheet->getStyle('D' . $row)->applyFromArray($style_row);
		$sheet->getStyle('E' . $row)->applyFromArray($style_row);
		$sheet->getStyle('F' . $row)->applyFromArray($style_row);
		$sheet->getStyle('G' . $row)->applyFromArray($style_row);
		$sheet->getStyle('H' . $row)->applyFromArray($style_row);
		$sheet->getStyle('I' . $row)->applyFromArray($style_row);
		$sheet->getStyle('J' . $row)->applyFromArray($style_row);
		$sheet->getStyle('K' . $row)->applyFromArray($style_row);
		$sheet->getStyle('L' . $row)->applyFromArray($style_row);
		$sheet->getStyle('M' . $row)->applyFromArray($style_row);
		$sheet->getStyle('N' . $row)->applyFromArray($style_row);
		$sheet->getStyle('O' . $row)->applyFromArray($style_row);
		$sheet->getStyle('P' . $row)->applyFromArray($style_row);

		$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('I' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('J' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('K' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('L' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('M' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('N' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('O' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('P' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);

		$sheet->getStyle('A' . $row . ':P' . $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFA07A');
		$sheet->getStyle('A' . $row . ':P' . $row)->getFont()->setBold(true);


		$sheet->getColumnDimension('A')->setWidth(5); // Set width kolom A
		$sheet->getColumnDimension('B')->setWidth(18); // Set width kolom B
		$sheet->getColumnDimension('C')->setWidth(40); // Set width kolom C
		$sheet->getColumnDimension('D')->setWidth(11);
		$sheet->getColumnDimension('E')->setWidth(6);
		$sheet->getColumnDimension('F')->setWidth(6);
		$sheet->getColumnDimension('G')->setWidth(6);
		$sheet->getColumnDimension('H')->setWidth(6);
		$sheet->getColumnDimension('I')->setWidth(6);
		$sheet->getColumnDimension('J')->setWidth(6);
		$sheet->getColumnDimension('K')->setWidth(6);
		$sheet->getColumnDimension('L')->setWidth(6);
		$sheet->getColumnDimension('M')->setWidth(6);
		$sheet->getColumnDimension('N')->setWidth(6);
		$sheet->getColumnDimension('O')->setWidth(6);
		$sheet->getColumnDimension('P')->setWidth(6);

		// Set orientasi kertas jadi LANDSCAPE
		$sheet->getPageSetup()->setOrientation(\PhpOffice\PhpSpreadsheet\Worksheet\PageSetup::ORIENTATION_LANDSCAPE);
		// Set judul file excel nya
		$sheet->setTitle("Report Distribution Outlet");
		// Proses file excel
		header('Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet');
		header('Content-Disposition: attachment; filename="Report Distribution Outlet ("' . $year . '").xlsx"'); // Set nama file excel nya
		header('Cache-Control: max-age=0');

		$writer = new Xlsx($spreadsheet);
		$writer->save('php://output');


	}

	public function export_AO_Direct_OT()
	{
		$spreadsheet = new Spreadsheet();
		$sheet = $spreadsheet->getActiveSheet();
		// Buat sebuah variabel untuk menampung pengaturan style dari header tabel
		$style_col = [
			'font' => ['bold' => true], // Set font nya jadi bold
			'alignment' => [
				'horizontal' => \PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER, // Set text jadi ditengah secara horizontal (center)
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'top' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border top dengan garis tipis
				'right' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN],  // Set border right dengan garis tipis
				'bottom' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border bottom dengan garis tipis
				'left' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN] // Set border left dengan garis tipis
			]
		];
		// Buat sebuah variabel untuk menampung pengaturan style dari isi tabel
		$style_row = [
			'alignment' => [
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'top' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border top dengan garis tipis
				'right' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN],  // Set border right dengan garis tipis
				'bottom' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border bottom dengan garis tipis
				'left' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN] // Set border left dengan garis tipis
			]
		];


		if (isset($_POST['by_principal']))
		{
			$principal = $_POST['by_principal'];
		}
		else
		{
			$principal = "";
		}

		if (isset($_POST['by_channel']))
		{
			$channel = $_POST['by_channel'];
		}
		else
		{
			$channel = "";
		}

		if (isset($_POST['by_outlet_type']))
		{
			$outlet_type = $_POST['by_outlet_type'];
		}
		else
		{
			$outlet_type = "";
		}

		if (isset($_POST['by_year']))
		{
			$year = $_POST['by_year'];
		}
		else
		{
			$year = date('Y');
		}

		$sheet->setCellValue('A1', "Direct Active Outlet - Detail (" . $year . ")"); // Set kolom A1 dengan tulisan "Report Selling In - By Outlet"
		$sheet->setCellValue('A2', "Principal : " . $principal); // Set kolom A2 dengan tulisan "Outlet Type : EC_EC"
		$sheet->setCellValue('A3', "Channel : " . $channel); // Set kolom A3 dengan tulisan "Outlet Type : EC_EC"
		$sheet->setCellValue('A4', "Outlet Type : " . $outlet_type);
		//$sheet->mergeCells('A1:F1'); // Set Merge Cell pada kolom A1 sampai F1
		$sheet->getStyle('A1')->getFont()->setBold(true); // Set bold kolom A1
		$sheet->getStyle('A2')->getFont()->setBold(true); // Set bold kolom A2
		$sheet->getStyle('A3')->getFont()->setBold(true); // Set bold kolom A3
		$sheet->getStyle('A4')->getFont()->setBold(true);
		$sheet->getStyle('A1')->getFont()->setSize(20); // Set font size 15 untuk kolom A1
		// Buat header tabel nya pada baris ke 6
		$sheet->setCellValue('A6', "#"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('A6:A7'); // Set Merge Row pada kolom A6 sampai A8
		$sheet->setCellValue('B6', "Cust Code"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('B6:B7'); // Set Merge Row pada kolom A6 sampai A8
		$sheet->setCellValue('C6', "Outlet Name"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('C6:C7'); // Set Merge Row pada kolom A6 sampai A8
		$sheet->setCellValue('D6', "Area"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('D6:D7');
		$sheet->setCellValue('E6', "Month");
		$sheet->mergeCells('E6:P6');
		$sheet->setCellValue('E7', "Jan");
		$sheet->setCellValue('F7', "Feb");
		$sheet->setCellValue('G7', "Mar");
		$sheet->setCellValue('H7', "Apr");
		$sheet->setCellValue('I7', "May");
		$sheet->setCellValue('J7', "Jun");
		$sheet->setCellValue('K7', "Jul");
		$sheet->setCellValue('L7', "Aug");
		$sheet->setCellValue('M7', "Sep");
		$sheet->setCellValue('N7', "Oct");
		$sheet->setCellValue('O7', "Nov");
		$sheet->setCellValue('P7', "Dec");

		// Apply style header yang telah kita buat tadi ke masing-masing kolom header
		$sheet->getStyle('A6')->applyFromArray($style_col);
		$sheet->getStyle('B6')->applyFromArray($style_col);
		$sheet->getStyle('C6')->applyFromArray($style_col);
		$sheet->getStyle('D6')->applyFromArray($style_col);
		$sheet->getStyle('E6')->applyFromArray($style_col);
		$sheet->getStyle('F6')->applyFromArray($style_col);
		$sheet->getStyle('G6')->applyFromArray($style_col);
		$sheet->getStyle('H6')->applyFromArray($style_col);
		$sheet->getStyle('I6')->applyFromArray($style_col);
		$sheet->getStyle('J6')->applyFromArray($style_col);
		$sheet->getStyle('K6')->applyFromArray($style_col);
		$sheet->getStyle('L6')->applyFromArray($style_col);
		$sheet->getStyle('M6')->applyFromArray($style_col);
		$sheet->getStyle('N6')->applyFromArray($style_col);
		$sheet->getStyle('O6')->applyFromArray($style_col);
		$sheet->getStyle('P6')->applyFromArray($style_col);
		$sheet->getStyle('A7')->applyFromArray($style_col);
		$sheet->getStyle('B7')->applyFromArray($style_col);
		$sheet->getStyle('C7')->applyFromArray($style_col);
		$sheet->getStyle('D7')->applyFromArray($style_col);
		$sheet->getStyle('E7')->applyFromArray($style_col);
		$sheet->getStyle('F7')->applyFromArray($style_col);
		$sheet->getStyle('G7')->applyFromArray($style_col);
		$sheet->getStyle('H7')->applyFromArray($style_col);
		$sheet->getStyle('I7')->applyFromArray($style_col);
		$sheet->getStyle('J7')->applyFromArray($style_col);
		$sheet->getStyle('K7')->applyFromArray($style_col);
		$sheet->getStyle('L7')->applyFromArray($style_col);
		$sheet->getStyle('M7')->applyFromArray($style_col);
		$sheet->getStyle('N7')->applyFromArray($style_col);
		$sheet->getStyle('O7')->applyFromArray($style_col);
		$sheet->getStyle('P7')->applyFromArray($style_col);

		$sheet->getStyle('A6:P7')->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');

		// Set height baris ke 1, 2 dan 3
		$sheet->getRowDimension('1')->setRowHeight(40);
		$sheet->getRowDimension('2')->setRowHeight(20);
		$sheet->getRowDimension('3')->setRowHeight(20);
		$sheet->getRowDimension('4')->setRowHeight(20);

		$no = 1; // Untuk penomoran tabel, di awal set dengan 1
		$row = 8;

		// $data1 = array(
		// 	'principal' => $principal,
		// 	'channel' => $channel,
		// 	'outlet_type' => $outlet_type,
		// 	'year' => $year
		// );

		$data['sellingin_OT'] = $this->model('ReportModel')->getAO_Direct_OT();
		//$data['sellingin_OT'] = $this->model('ReportModel')->getSellingIn_OT2();

		foreach ($data['sellingin_OT'] as $rows) :
			$sheet->setCellValue('A' . $row, $no);
    		$sheet->setCellValue('B' . $row, $rows['cust_code']);
			$sheet->setCellValue('C' . $row, $rows['cust_name']);
			$sheet->setCellValue('D' . $row, $rows['area']);
			$sheet->setCellValue('E' . $row, number_format($rows['qty_jan'], 0));
			$sheet->setCellValue('F' . $row, number_format($rows['qty_feb'], 0));
			$sheet->setCellValue('G' . $row, number_format($rows['qty_mar'], 0));
			$sheet->setCellValue('H' . $row, number_format($rows['qty_apr'], 0));
			$sheet->setCellValue('I' . $row, number_format($rows['qty_mei'], 0));
			$sheet->setCellValue('J' . $row, number_format($rows['qty_jun'], 0));
			$sheet->setCellValue('K' . $row, number_format($rows['qty_jul'], 0));
			$sheet->setCellValue('L' . $row, number_format($rows['qty_agu'], 0));
			$sheet->setCellValue('M' . $row, number_format($rows['qty_sep'], 0));
			$sheet->setCellValue('N' . $row, number_format($rows['qty_okt'], 0));
			$sheet->setCellValue('O' . $row, number_format($rows['qty_nop'], 0));;
			$sheet->setCellValue('P' . $row, number_format($rows['qty_des'], 0));

			// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
			$sheet->getStyle('A' . $row)->applyFromArray($style_row);
			$sheet->getStyle('B' . $row)->applyFromArray($style_row);
			$sheet->getStyle('C' . $row)->applyFromArray($style_row);
			$sheet->getStyle('D' . $row)->applyFromArray($style_row);
			$sheet->getStyle('E' . $row)->applyFromArray($style_row);
			$sheet->getStyle('F' . $row)->applyFromArray($style_row);
			$sheet->getStyle('G' . $row)->applyFromArray($style_row);
			$sheet->getStyle('H' . $row)->applyFromArray($style_row);
			$sheet->getStyle('I' . $row)->applyFromArray($style_row);
			$sheet->getStyle('J' . $row)->applyFromArray($style_row);
			$sheet->getStyle('K' . $row)->applyFromArray($style_row);
			$sheet->getStyle('L' . $row)->applyFromArray($style_row);
			$sheet->getStyle('M' . $row)->applyFromArray($style_row);
			$sheet->getStyle('N' . $row)->applyFromArray($style_row);
			$sheet->getStyle('O' . $row)->applyFromArray($style_row);
			$sheet->getStyle('P' . $row)->applyFromArray($style_row);

			$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('I' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('J' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('K' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('L' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('M' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('N' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('O' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('P' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);

			$no++; // Tambah 1 setiap kali looping
    		$row++; // Tambah 1 setiap kali looping

			$total_jan += $rows['qty_jan'];
			$total_feb += $rows['qty_feb'];
			$total_mar += $rows['qty_mar'];
			$total_apr += $rows['qty_apr'];
			$total_mei += $rows['qty_mei'];
			$total_jun += $rows['qty_jun'];
			$total_jul += $rows['qty_jul'];
			$total_agu += $rows['qty_agu'];
			$total_sep += $rows['qty_sep'];
			$total_okt += $rows['qty_okt'];
			$total_nop += $rows['qty_nop'];
			$total_des += $rows['qty_des'];

		endforeach;

		
		$sheet->setCellValue('A' . $row, "");
		$sheet->setCellValue('B' . $row, "");
		$sheet->setCellValue('C' . $row, "TOTAL");
		$sheet->setCellValue('D' . $row, "");
		$sheet->setCellValue('E' . $row, number_format($total_jan, 0));
		$sheet->setCellValue('F' . $row, number_format($total_feb, 0));
		$sheet->setCellValue('G' . $row, number_format($total_mar, 0));
		$sheet->setCellValue('H' . $row, number_format($total_apr, 0));
		$sheet->setCellValue('I' . $row, number_format($total_mei, 0));
		$sheet->setCellValue('J' . $row, number_format($total_jun, 0));
		$sheet->setCellValue('K' . $row, number_format($total_jul, 0));
		$sheet->setCellValue('L' . $row, number_format($total_agu, 0));
		$sheet->setCellValue('M' . $row, number_format($total_sep, 0));
		$sheet->setCellValue('N' . $row, number_format($total_okt, 0));
		$sheet->setCellValue('O' . $row, number_format($total_nop, 0));;
		$sheet->setCellValue('P' . $row, number_format($total_des, 0));

		// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
		$sheet->getStyle('A' . $row)->applyFromArray($style_row);
		$sheet->getStyle('B' . $row)->applyFromArray($style_row);
		$sheet->getStyle('C' . $row)->applyFromArray($style_row);
		$sheet->getStyle('D' . $row)->applyFromArray($style_row);
		$sheet->getStyle('E' . $row)->applyFromArray($style_row);
		$sheet->getStyle('F' . $row)->applyFromArray($style_row);
		$sheet->getStyle('G' . $row)->applyFromArray($style_row);
		$sheet->getStyle('H' . $row)->applyFromArray($style_row);
		$sheet->getStyle('I' . $row)->applyFromArray($style_row);
		$sheet->getStyle('J' . $row)->applyFromArray($style_row);
		$sheet->getStyle('K' . $row)->applyFromArray($style_row);
		$sheet->getStyle('L' . $row)->applyFromArray($style_row);
		$sheet->getStyle('M' . $row)->applyFromArray($style_row);
		$sheet->getStyle('N' . $row)->applyFromArray($style_row);
		$sheet->getStyle('O' . $row)->applyFromArray($style_row);
		$sheet->getStyle('P' . $row)->applyFromArray($style_row);

		$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('I' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('J' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('K' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('L' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('M' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('N' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('O' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('P' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);

		$sheet->getStyle('A' . $row . ':P' . $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFA07A');
		$sheet->getStyle('A' . $row . ':P' . $row)->getFont()->setBold(true);


		$sheet->getColumnDimension('A')->setWidth(5); // Set width kolom A
		$sheet->getColumnDimension('B')->setWidth(11); // Set width kolom B
		$sheet->getColumnDimension('C')->setWidth(40); // Set width kolom C
		$sheet->getColumnDimension('D')->setWidth(11);
		$sheet->getColumnDimension('E')->setWidth(6);
		$sheet->getColumnDimension('F')->setWidth(6);
		$sheet->getColumnDimension('G')->setWidth(6);
		$sheet->getColumnDimension('H')->setWidth(6);
		$sheet->getColumnDimension('I')->setWidth(6);
		$sheet->getColumnDimension('J')->setWidth(6);
		$sheet->getColumnDimension('K')->setWidth(6);
		$sheet->getColumnDimension('L')->setWidth(6);
		$sheet->getColumnDimension('M')->setWidth(6);
		$sheet->getColumnDimension('N')->setWidth(6);
		$sheet->getColumnDimension('O')->setWidth(6);
		$sheet->getColumnDimension('P')->setWidth(6);

		// Set orientasi kertas jadi LANDSCAPE
		$sheet->getPageSetup()->setOrientation(\PhpOffice\PhpSpreadsheet\Worksheet\PageSetup::ORIENTATION_LANDSCAPE);
		// Set judul file excel nya
		$sheet->setTitle("Direct Active Outlet - Detail");
		// Proses file excel
		header('Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet');
		header('Content-Disposition: attachment; filename="Direct Active Outlet - Detail ("' . $year . '").xlsx"'); // Set nama file excel nya
		header('Cache-Control: max-age=0');

		$writer = new Xlsx($spreadsheet);
		$writer->save('php://output');


	}

	public function export_ActiveOutlet_OT()
	{
		$spreadsheet = new Spreadsheet();
		$sheet = $spreadsheet->getActiveSheet();
		// Buat sebuah variabel untuk menampung pengaturan style dari header tabel
		$style_col = [
			'font' => ['bold' => true], // Set font nya jadi bold
			'alignment' => [
				'horizontal' => \PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER, // Set text jadi ditengah secara horizontal (center)
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'top' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border top dengan garis tipis
				'right' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN],  // Set border right dengan garis tipis
				'bottom' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border bottom dengan garis tipis
				'left' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN] // Set border left dengan garis tipis
			]
		];
		// Buat sebuah variabel untuk menampung pengaturan style dari isi tabel
		$style_row = [
			'alignment' => [
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'top' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border top dengan garis tipis
				'right' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN],  // Set border right dengan garis tipis
				'bottom' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border bottom dengan garis tipis
				'left' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN] // Set border left dengan garis tipis
			]
		];


		if (isset($_POST['by_principal']))
		{
			$principal = $_POST['by_principal'];
		}
		else
		{
			$principal = "";
		}

		if (isset($_POST['by_channel']))
		{
			$channel = $_POST['by_channel'];
		}
		else
		{
			$channel = "";
		}

		if (isset($_POST['by_outlet_type']))
		{
			$outlet_type = $_POST['by_outlet_type'];
		}
		else
		{
			$outlet_type = "";
		}

		if (isset($_POST['by_year']))
		{
			$year = $_POST['by_year'];
		}
		else
		{
			$year = date('Y');
		}

		$sheet->setCellValue('A1', "Active Outlet - Detail (" . $year . ")"); // Set kolom A1 dengan tulisan "Report Selling In - By Outlet"
		$sheet->setCellValue('A2', "Principal : " . $principal); // Set kolom A2 dengan tulisan "Outlet Type : EC_EC"
		$sheet->setCellValue('A3', "Channel : " . $channel); // Set kolom A3 dengan tulisan "Outlet Type : EC_EC"
		$sheet->setCellValue('A4', "Outlet Type : " . $outlet_type);
		//$sheet->mergeCells('A1:F1'); // Set Merge Cell pada kolom A1 sampai F1
		$sheet->getStyle('A1')->getFont()->setBold(true); // Set bold kolom A1
		$sheet->getStyle('A2')->getFont()->setBold(true); // Set bold kolom A2
		$sheet->getStyle('A3')->getFont()->setBold(true); // Set bold kolom A3
		$sheet->getStyle('A4')->getFont()->setBold(true);
		$sheet->getStyle('A1')->getFont()->setSize(20); // Set font size 15 untuk kolom A1
		// Buat header tabel nya pada baris ke 6
		$sheet->setCellValue('A6', "#"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('A6:A7'); // Set Merge Row pada kolom A6 sampai A8
		$sheet->setCellValue('B6', "BIG Code"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('B6:B7'); // Set Merge Row pada kolom A6 sampai A8
		$sheet->setCellValue('C6', "Outlet Name"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('C6:C7'); // Set Merge Row pada kolom A6 sampai A8
		$sheet->setCellValue('D6', "Area"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('D6:D7');
		$sheet->setCellValue('E6', "Month");
		$sheet->mergeCells('E6:P6');
		$sheet->setCellValue('E7', "Jan");
		$sheet->setCellValue('F7', "Feb");
		$sheet->setCellValue('G7', "Mar");
		$sheet->setCellValue('H7', "Apr");
		$sheet->setCellValue('I7', "May");
		$sheet->setCellValue('J7', "Jun");
		$sheet->setCellValue('K7', "Jul");
		$sheet->setCellValue('L7', "Aug");
		$sheet->setCellValue('M7', "Sep");
		$sheet->setCellValue('N7', "Oct");
		$sheet->setCellValue('O7', "Nov");
		$sheet->setCellValue('P7', "Dec");

		// Apply style header yang telah kita buat tadi ke masing-masing kolom header
		$sheet->getStyle('A6')->applyFromArray($style_col);
		$sheet->getStyle('B6')->applyFromArray($style_col);
		$sheet->getStyle('C6')->applyFromArray($style_col);
		$sheet->getStyle('D6')->applyFromArray($style_col);
		$sheet->getStyle('E6')->applyFromArray($style_col);
		$sheet->getStyle('F6')->applyFromArray($style_col);
		$sheet->getStyle('G6')->applyFromArray($style_col);
		$sheet->getStyle('H6')->applyFromArray($style_col);
		$sheet->getStyle('I6')->applyFromArray($style_col);
		$sheet->getStyle('J6')->applyFromArray($style_col);
		$sheet->getStyle('K6')->applyFromArray($style_col);
		$sheet->getStyle('L6')->applyFromArray($style_col);
		$sheet->getStyle('M6')->applyFromArray($style_col);
		$sheet->getStyle('N6')->applyFromArray($style_col);
		$sheet->getStyle('O6')->applyFromArray($style_col);
		$sheet->getStyle('P6')->applyFromArray($style_col);
		$sheet->getStyle('A7')->applyFromArray($style_col);
		$sheet->getStyle('B7')->applyFromArray($style_col);
		$sheet->getStyle('C7')->applyFromArray($style_col);
		$sheet->getStyle('D7')->applyFromArray($style_col);
		$sheet->getStyle('E7')->applyFromArray($style_col);
		$sheet->getStyle('F7')->applyFromArray($style_col);
		$sheet->getStyle('G7')->applyFromArray($style_col);
		$sheet->getStyle('H7')->applyFromArray($style_col);
		$sheet->getStyle('I7')->applyFromArray($style_col);
		$sheet->getStyle('J7')->applyFromArray($style_col);
		$sheet->getStyle('K7')->applyFromArray($style_col);
		$sheet->getStyle('L7')->applyFromArray($style_col);
		$sheet->getStyle('M7')->applyFromArray($style_col);
		$sheet->getStyle('N7')->applyFromArray($style_col);
		$sheet->getStyle('O7')->applyFromArray($style_col);
		$sheet->getStyle('P7')->applyFromArray($style_col);

		$sheet->getStyle('A6:P7')->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');

		// Set height baris ke 1, 2 dan 3
		$sheet->getRowDimension('1')->setRowHeight(40);
		$sheet->getRowDimension('2')->setRowHeight(20);
		$sheet->getRowDimension('3')->setRowHeight(20);
		$sheet->getRowDimension('4')->setRowHeight(20);

		$no = 1; // Untuk penomoran tabel, di awal set dengan 1
		$row = 8;

		// $data1 = array(
		// 	'principal' => $principal,
		// 	'channel' => $channel,
		// 	'outlet_type' => $outlet_type,
		// 	'year' => $year
		// );

		$data['sellingin_OT'] = $this->model('ReportModel')->getActiveOutlet_OT();
		//$data['sellingin_OT'] = $this->model('ReportModel')->getSellingIn_OT2();

		foreach ($data['sellingin_OT'] as $rows) :
			$sheet->setCellValue('A' . $row, $no);
    		$sheet->setCellValue('B' . $row, $rows['big_code']);
			$sheet->setCellValue('C' . $row, $rows['cust_name']);
			$sheet->setCellValue('D' . $row, $rows['area']);
			$sheet->setCellValue('E' . $row, number_format($rows['qty_jan'], 0));
			$sheet->setCellValue('F' . $row, number_format($rows['qty_feb'], 0));
			$sheet->setCellValue('G' . $row, number_format($rows['qty_mar'], 0));
			$sheet->setCellValue('H' . $row, number_format($rows['qty_apr'], 0));
			$sheet->setCellValue('I' . $row, number_format($rows['qty_mei'], 0));
			$sheet->setCellValue('J' . $row, number_format($rows['qty_jun'], 0));
			$sheet->setCellValue('K' . $row, number_format($rows['qty_jul'], 0));
			$sheet->setCellValue('L' . $row, number_format($rows['qty_agu'], 0));
			$sheet->setCellValue('M' . $row, number_format($rows['qty_sep'], 0));
			$sheet->setCellValue('N' . $row, number_format($rows['qty_okt'], 0));
			$sheet->setCellValue('O' . $row, number_format($rows['qty_nop'], 0));;
			$sheet->setCellValue('P' . $row, number_format($rows['qty_des'], 0));

			// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
			$sheet->getStyle('A' . $row)->applyFromArray($style_row);
			$sheet->getStyle('B' . $row)->applyFromArray($style_row);
			$sheet->getStyle('C' . $row)->applyFromArray($style_row);
			$sheet->getStyle('D' . $row)->applyFromArray($style_row);
			$sheet->getStyle('E' . $row)->applyFromArray($style_row);
			$sheet->getStyle('F' . $row)->applyFromArray($style_row);
			$sheet->getStyle('G' . $row)->applyFromArray($style_row);
			$sheet->getStyle('H' . $row)->applyFromArray($style_row);
			$sheet->getStyle('I' . $row)->applyFromArray($style_row);
			$sheet->getStyle('J' . $row)->applyFromArray($style_row);
			$sheet->getStyle('K' . $row)->applyFromArray($style_row);
			$sheet->getStyle('L' . $row)->applyFromArray($style_row);
			$sheet->getStyle('M' . $row)->applyFromArray($style_row);
			$sheet->getStyle('N' . $row)->applyFromArray($style_row);
			$sheet->getStyle('O' . $row)->applyFromArray($style_row);
			$sheet->getStyle('P' . $row)->applyFromArray($style_row);

			$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('I' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('J' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('K' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('L' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('M' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('N' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('O' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('P' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);

			$no++; // Tambah 1 setiap kali looping
    		$row++; // Tambah 1 setiap kali looping

			$total_jan += $rows['qty_jan'];
			$total_feb += $rows['qty_feb'];
			$total_mar += $rows['qty_mar'];
			$total_apr += $rows['qty_apr'];
			$total_mei += $rows['qty_mei'];
			$total_jun += $rows['qty_jun'];
			$total_jul += $rows['qty_jul'];
			$total_agu += $rows['qty_agu'];
			$total_sep += $rows['qty_sep'];
			$total_okt += $rows['qty_okt'];
			$total_nop += $rows['qty_nop'];
			$total_des += $rows['qty_des'];

		endforeach;

		
		$sheet->setCellValue('A' . $row, "");
		$sheet->setCellValue('B' . $row, "");
		$sheet->setCellValue('C' . $row, "TOTAL");
		$sheet->setCellValue('D' . $row, "");
		$sheet->setCellValue('E' . $row, number_format($total_jan, 0));
		$sheet->setCellValue('F' . $row, number_format($total_feb, 0));
		$sheet->setCellValue('G' . $row, number_format($total_mar, 0));
		$sheet->setCellValue('H' . $row, number_format($total_apr, 0));
		$sheet->setCellValue('I' . $row, number_format($total_mei, 0));
		$sheet->setCellValue('J' . $row, number_format($total_jun, 0));
		$sheet->setCellValue('K' . $row, number_format($total_jul, 0));
		$sheet->setCellValue('L' . $row, number_format($total_agu, 0));
		$sheet->setCellValue('M' . $row, number_format($total_sep, 0));
		$sheet->setCellValue('N' . $row, number_format($total_okt, 0));
		$sheet->setCellValue('O' . $row, number_format($total_nop, 0));;
		$sheet->setCellValue('P' . $row, number_format($total_des, 0));

		// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
		$sheet->getStyle('A' . $row)->applyFromArray($style_row);
		$sheet->getStyle('B' . $row)->applyFromArray($style_row);
		$sheet->getStyle('C' . $row)->applyFromArray($style_row);
		$sheet->getStyle('D' . $row)->applyFromArray($style_row);
		$sheet->getStyle('E' . $row)->applyFromArray($style_row);
		$sheet->getStyle('F' . $row)->applyFromArray($style_row);
		$sheet->getStyle('G' . $row)->applyFromArray($style_row);
		$sheet->getStyle('H' . $row)->applyFromArray($style_row);
		$sheet->getStyle('I' . $row)->applyFromArray($style_row);
		$sheet->getStyle('J' . $row)->applyFromArray($style_row);
		$sheet->getStyle('K' . $row)->applyFromArray($style_row);
		$sheet->getStyle('L' . $row)->applyFromArray($style_row);
		$sheet->getStyle('M' . $row)->applyFromArray($style_row);
		$sheet->getStyle('N' . $row)->applyFromArray($style_row);
		$sheet->getStyle('O' . $row)->applyFromArray($style_row);
		$sheet->getStyle('P' . $row)->applyFromArray($style_row);

		$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('I' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('J' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('K' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('L' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('M' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('N' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('O' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('P' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);

		$sheet->getStyle('A' . $row . ':P' . $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFA07A');
		$sheet->getStyle('A' . $row . ':P' . $row)->getFont()->setBold(true);


		$sheet->getColumnDimension('A')->setWidth(5); // Set width kolom A
		$sheet->getColumnDimension('B')->setWidth(11); // Set width kolom B
		$sheet->getColumnDimension('C')->setWidth(40); // Set width kolom C
		$sheet->getColumnDimension('D')->setWidth(11);
		$sheet->getColumnDimension('E')->setWidth(6);
		$sheet->getColumnDimension('F')->setWidth(6);
		$sheet->getColumnDimension('G')->setWidth(6);
		$sheet->getColumnDimension('H')->setWidth(6);
		$sheet->getColumnDimension('I')->setWidth(6);
		$sheet->getColumnDimension('J')->setWidth(6);
		$sheet->getColumnDimension('K')->setWidth(6);
		$sheet->getColumnDimension('L')->setWidth(6);
		$sheet->getColumnDimension('M')->setWidth(6);
		$sheet->getColumnDimension('N')->setWidth(6);
		$sheet->getColumnDimension('O')->setWidth(6);
		$sheet->getColumnDimension('P')->setWidth(6);

		// Set orientasi kertas jadi LANDSCAPE
		$sheet->getPageSetup()->setOrientation(\PhpOffice\PhpSpreadsheet\Worksheet\PageSetup::ORIENTATION_LANDSCAPE);
		// Set judul file excel nya
		$sheet->setTitle("Active Outlet - Detail");
		// Proses file excel
		header('Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet');
		header('Content-Disposition: attachment; filename="Active Outlet - Detail ("' . $year . '").xlsx"'); // Set nama file excel nya
		header('Cache-Control: max-age=0');

		$writer = new Xlsx($spreadsheet);
		$writer->save('php://output');


	}

	public function export_direct_OT()
	{
		$spreadsheet = new Spreadsheet();
		$sheet = $spreadsheet->getActiveSheet();
		// Buat sebuah variabel untuk menampung pengaturan style dari header tabel
		$style_col = [
			'font' => ['bold' => true], // Set font nya jadi bold
			'alignment' => [
				'horizontal' => \PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER, // Set text jadi ditengah secara horizontal (center)
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'top' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border top dengan garis tipis
				'right' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN],  // Set border right dengan garis tipis
				'bottom' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border bottom dengan garis tipis
				'left' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN] // Set border left dengan garis tipis
			]
		];
		// Buat sebuah variabel untuk menampung pengaturan style dari isi tabel
		$style_row = [
			'alignment' => [
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'top' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border top dengan garis tipis
				'right' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN],  // Set border right dengan garis tipis
				'bottom' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border bottom dengan garis tipis
				'left' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN] // Set border left dengan garis tipis
			]
		];


		if (isset($_POST['by_principal']))
		{
			$principal = $_POST['by_principal'];
		}
		else
		{
			$principal = "";
		}

		if (isset($_POST['by_channel']))
		{
			$channel = $_POST['by_channel'];
		}
		else
		{
			$channel = "";
		}

		if (isset($_POST['by_outlet_type']))
		{
			$outlet_type = $_POST['by_outlet_type'];
		}
		else
		{
			$outlet_type = "";
		}

		if (isset($_POST['by_year']))
		{
			$year = $_POST['by_year'];
		}
		else
		{
			$year = date('Y');
		}

		$sheet->setCellValue('A1', "Direct Distribution Outlet (" . $year . ")"); // Set kolom A1 dengan tulisan "Report Selling In - By Outlet"
		$sheet->setCellValue('A2', "Principal : " . $principal); // Set kolom A2 dengan tulisan "Outlet Type : EC_EC"
		$sheet->setCellValue('A3', "Channel : " . $channel); // Set kolom A3 dengan tulisan "Outlet Type : EC_EC"
		$sheet->setCellValue('A4', "Outlet Type : " . $outlet_type);
		//$sheet->mergeCells('A1:F1'); // Set Merge Cell pada kolom A1 sampai F1
		$sheet->getStyle('A1')->getFont()->setBold(true); // Set bold kolom A1
		$sheet->getStyle('A2')->getFont()->setBold(true); // Set bold kolom A2
		$sheet->getStyle('A3')->getFont()->setBold(true); // Set bold kolom A3
		$sheet->getStyle('A4')->getFont()->setBold(true);
		$sheet->getStyle('A1')->getFont()->setSize(20); // Set font size 15 untuk kolom A1
		// Buat header tabel nya pada baris ke 6
		$sheet->setCellValue('A6', "#"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('A6:A7'); // Set Merge Row pada kolom A6 sampai A8
		$sheet->setCellValue('B6', "Cust Code"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('B6:B7'); // Set Merge Row pada kolom A6 sampai A8
		$sheet->setCellValue('C6', "Outlet Name"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('C6:C7'); // Set Merge Row pada kolom A6 sampai A8
		$sheet->setCellValue('D6', "Area"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('D6:D7');
		$sheet->setCellValue('E6', "Month");
		$sheet->mergeCells('E6:P6');
		$sheet->setCellValue('E7', "Jan");
		$sheet->setCellValue('F7', "Feb");
		$sheet->setCellValue('G7', "Mar");
		$sheet->setCellValue('H7', "Apr");
		$sheet->setCellValue('I7', "May");
		$sheet->setCellValue('J7', "Jun");
		$sheet->setCellValue('K7', "Jul");
		$sheet->setCellValue('L7', "Aug");
		$sheet->setCellValue('M7', "Sep");
		$sheet->setCellValue('N7', "Oct");
		$sheet->setCellValue('O7', "Nov");
		$sheet->setCellValue('P7', "Dec");

		// Apply style header yang telah kita buat tadi ke masing-masing kolom header
		$sheet->getStyle('A6')->applyFromArray($style_col);
		$sheet->getStyle('B6')->applyFromArray($style_col);
		$sheet->getStyle('C6')->applyFromArray($style_col);
		$sheet->getStyle('D6')->applyFromArray($style_col);
		$sheet->getStyle('E6')->applyFromArray($style_col);
		$sheet->getStyle('F6')->applyFromArray($style_col);
		$sheet->getStyle('G6')->applyFromArray($style_col);
		$sheet->getStyle('H6')->applyFromArray($style_col);
		$sheet->getStyle('I6')->applyFromArray($style_col);
		$sheet->getStyle('J6')->applyFromArray($style_col);
		$sheet->getStyle('K6')->applyFromArray($style_col);
		$sheet->getStyle('L6')->applyFromArray($style_col);
		$sheet->getStyle('M6')->applyFromArray($style_col);
		$sheet->getStyle('N6')->applyFromArray($style_col);
		$sheet->getStyle('O6')->applyFromArray($style_col);
		$sheet->getStyle('P6')->applyFromArray($style_col);
		$sheet->getStyle('A7')->applyFromArray($style_col);
		$sheet->getStyle('B7')->applyFromArray($style_col);
		$sheet->getStyle('C7')->applyFromArray($style_col);
		$sheet->getStyle('D7')->applyFromArray($style_col);
		$sheet->getStyle('E7')->applyFromArray($style_col);
		$sheet->getStyle('F7')->applyFromArray($style_col);
		$sheet->getStyle('G7')->applyFromArray($style_col);
		$sheet->getStyle('H7')->applyFromArray($style_col);
		$sheet->getStyle('I7')->applyFromArray($style_col);
		$sheet->getStyle('J7')->applyFromArray($style_col);
		$sheet->getStyle('K7')->applyFromArray($style_col);
		$sheet->getStyle('L7')->applyFromArray($style_col);
		$sheet->getStyle('M7')->applyFromArray($style_col);
		$sheet->getStyle('N7')->applyFromArray($style_col);
		$sheet->getStyle('O7')->applyFromArray($style_col);
		$sheet->getStyle('P7')->applyFromArray($style_col);

		$sheet->getStyle('A6:P7')->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');

		// Set height baris ke 1, 2 dan 3
		$sheet->getRowDimension('1')->setRowHeight(40);
		$sheet->getRowDimension('2')->setRowHeight(20);
		$sheet->getRowDimension('3')->setRowHeight(20);
		$sheet->getRowDimension('4')->setRowHeight(20);

		$no = 1; // Untuk penomoran tabel, di awal set dengan 1
		$row = 8;

		// $data1 = array(
		// 	'principal' => $principal,
		// 	'channel' => $channel,
		// 	'outlet_type' => $outlet_type,
		// 	'year' => $year
		// );

		$data['sellingin_OT'] = $this->model('ReportModel')->getDirect_OT();
		//$data['sellingin_OT'] = $this->model('ReportModel')->getSellingIn_OT2();

		foreach ($data['sellingin_OT'] as $rows) :
			$sheet->setCellValue('A' . $row, $no);
    		$sheet->setCellValue('B' . $row, $rows['outlet_code']);
			$sheet->setCellValue('C' . $row, $rows['outlet_name']);
			$sheet->setCellValue('D' . $row, $rows['area']);
			$sheet->setCellValue('E' . $row, number_format($rows['qty_jan'], 0));
			$sheet->setCellValue('F' . $row, number_format($rows['qty_feb'], 0));
			$sheet->setCellValue('G' . $row, number_format($rows['qty_mar'], 0));
			$sheet->setCellValue('H' . $row, number_format($rows['qty_apr'], 0));
			$sheet->setCellValue('I' . $row, number_format($rows['qty_mei'], 0));
			$sheet->setCellValue('J' . $row, number_format($rows['qty_jun'], 0));
			$sheet->setCellValue('K' . $row, number_format($rows['qty_jul'], 0));
			$sheet->setCellValue('L' . $row, number_format($rows['qty_agu'], 0));
			$sheet->setCellValue('M' . $row, number_format($rows['qty_sep'], 0));
			$sheet->setCellValue('N' . $row, number_format($rows['qty_okt'], 0));
			$sheet->setCellValue('O' . $row, number_format($rows['qty_nop'], 0));;
			$sheet->setCellValue('P' . $row, number_format($rows['qty_des'], 0));

			// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
			$sheet->getStyle('A' . $row)->applyFromArray($style_row);
			$sheet->getStyle('B' . $row)->applyFromArray($style_row);
			$sheet->getStyle('C' . $row)->applyFromArray($style_row);
			$sheet->getStyle('D' . $row)->applyFromArray($style_row);
			$sheet->getStyle('E' . $row)->applyFromArray($style_row);
			$sheet->getStyle('F' . $row)->applyFromArray($style_row);
			$sheet->getStyle('G' . $row)->applyFromArray($style_row);
			$sheet->getStyle('H' . $row)->applyFromArray($style_row);
			$sheet->getStyle('I' . $row)->applyFromArray($style_row);
			$sheet->getStyle('J' . $row)->applyFromArray($style_row);
			$sheet->getStyle('K' . $row)->applyFromArray($style_row);
			$sheet->getStyle('L' . $row)->applyFromArray($style_row);
			$sheet->getStyle('M' . $row)->applyFromArray($style_row);
			$sheet->getStyle('N' . $row)->applyFromArray($style_row);
			$sheet->getStyle('O' . $row)->applyFromArray($style_row);
			$sheet->getStyle('P' . $row)->applyFromArray($style_row);

			$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('I' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('J' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('K' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('L' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('M' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('N' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('O' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('P' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);

			$no++; // Tambah 1 setiap kali looping
    		$row++; // Tambah 1 setiap kali looping

			$total_jan += $rows['qty_jan'];
			$total_feb += $rows['qty_feb'];
			$total_mar += $rows['qty_mar'];
			$total_apr += $rows['qty_apr'];
			$total_mei += $rows['qty_mei'];
			$total_jun += $rows['qty_jun'];
			$total_jul += $rows['qty_jul'];
			$total_agu += $rows['qty_agu'];
			$total_sep += $rows['qty_sep'];
			$total_okt += $rows['qty_okt'];
			$total_nop += $rows['qty_nop'];
			$total_des += $rows['qty_des'];

		endforeach;

		
		$sheet->setCellValue('A' . $row, "");
		$sheet->setCellValue('B' . $row, "");
		$sheet->setCellValue('C' . $row, "TOTAL");
		$sheet->setCellValue('D' . $row, "");
		$sheet->setCellValue('E' . $row, number_format($total_jan, 0));
		$sheet->setCellValue('F' . $row, number_format($total_feb, 0));
		$sheet->setCellValue('G' . $row, number_format($total_mar, 0));
		$sheet->setCellValue('H' . $row, number_format($total_apr, 0));
		$sheet->setCellValue('I' . $row, number_format($total_mei, 0));
		$sheet->setCellValue('J' . $row, number_format($total_jun, 0));
		$sheet->setCellValue('K' . $row, number_format($total_jul, 0));
		$sheet->setCellValue('L' . $row, number_format($total_agu, 0));
		$sheet->setCellValue('M' . $row, number_format($total_sep, 0));
		$sheet->setCellValue('N' . $row, number_format($total_okt, 0));
		$sheet->setCellValue('O' . $row, number_format($total_nop, 0));;
		$sheet->setCellValue('P' . $row, number_format($total_des, 0));

		// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
		$sheet->getStyle('A' . $row)->applyFromArray($style_row);
		$sheet->getStyle('B' . $row)->applyFromArray($style_row);
		$sheet->getStyle('C' . $row)->applyFromArray($style_row);
		$sheet->getStyle('D' . $row)->applyFromArray($style_row);
		$sheet->getStyle('E' . $row)->applyFromArray($style_row);
		$sheet->getStyle('F' . $row)->applyFromArray($style_row);
		$sheet->getStyle('G' . $row)->applyFromArray($style_row);
		$sheet->getStyle('H' . $row)->applyFromArray($style_row);
		$sheet->getStyle('I' . $row)->applyFromArray($style_row);
		$sheet->getStyle('J' . $row)->applyFromArray($style_row);
		$sheet->getStyle('K' . $row)->applyFromArray($style_row);
		$sheet->getStyle('L' . $row)->applyFromArray($style_row);
		$sheet->getStyle('M' . $row)->applyFromArray($style_row);
		$sheet->getStyle('N' . $row)->applyFromArray($style_row);
		$sheet->getStyle('O' . $row)->applyFromArray($style_row);
		$sheet->getStyle('P' . $row)->applyFromArray($style_row);

		$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('I' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('J' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('K' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('L' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('M' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('N' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('O' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('P' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);

		$sheet->getStyle('A' . $row . ':P' . $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFA07A');
		$sheet->getStyle('A' . $row . ':P' . $row)->getFont()->setBold(true);


		$sheet->getColumnDimension('A')->setWidth(5); // Set width kolom A
		$sheet->getColumnDimension('B')->setWidth(11); // Set width kolom B
		$sheet->getColumnDimension('C')->setWidth(40); // Set width kolom C
		$sheet->getColumnDimension('D')->setWidth(11);
		$sheet->getColumnDimension('E')->setWidth(6);
		$sheet->getColumnDimension('F')->setWidth(6);
		$sheet->getColumnDimension('G')->setWidth(6);
		$sheet->getColumnDimension('H')->setWidth(6);
		$sheet->getColumnDimension('I')->setWidth(6);
		$sheet->getColumnDimension('J')->setWidth(6);
		$sheet->getColumnDimension('K')->setWidth(6);
		$sheet->getColumnDimension('L')->setWidth(6);
		$sheet->getColumnDimension('M')->setWidth(6);
		$sheet->getColumnDimension('N')->setWidth(6);
		$sheet->getColumnDimension('O')->setWidth(6);
		$sheet->getColumnDimension('P')->setWidth(6);

		// Set orientasi kertas jadi LANDSCAPE
		$sheet->getPageSetup()->setOrientation(\PhpOffice\PhpSpreadsheet\Worksheet\PageSetup::ORIENTATION_LANDSCAPE);
		// Set judul file excel nya
		$sheet->setTitle("Direct Distribution Outlet");
		// Proses file excel
		header('Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet');
		header('Content-Disposition: attachment; filename="Direct Distribution Outlet ("' . $year . '").xlsx"'); // Set nama file excel nya
		header('Cache-Control: max-age=0');

		$writer = new Xlsx($spreadsheet);
		$writer->save('php://output');


	}

	public function export_sellingin_OT()
	{
		$spreadsheet = new Spreadsheet();
		$sheet = $spreadsheet->getActiveSheet();
		// Buat sebuah variabel untuk menampung pengaturan style dari header tabel
		$style_col = [
			'font' => ['bold' => true], // Set font nya jadi bold
			'alignment' => [
				'horizontal' => \PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER, // Set text jadi ditengah secara horizontal (center)
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'top' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border top dengan garis tipis
				'right' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN],  // Set border right dengan garis tipis
				'bottom' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border bottom dengan garis tipis
				'left' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN] // Set border left dengan garis tipis
			]
		];
		// Buat sebuah variabel untuk menampung pengaturan style dari isi tabel
		$style_row = [
			'alignment' => [
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'top' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border top dengan garis tipis
				'right' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN],  // Set border right dengan garis tipis
				'bottom' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border bottom dengan garis tipis
				'left' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN] // Set border left dengan garis tipis
			]
		];


		if (isset($_POST['by_principal']))
		{
			$principal = $_POST['by_principal'];
		}
		else
		{
			$principal = "";
		}

		if (isset($_POST['by_channel']))
		{
			$channel = $_POST['by_channel'];
		}
		else
		{
			$channel = "";
		}

		if (isset($_POST['by_outlet_type']))
		{
			$outlet_type = $_POST['by_outlet_type'];
		}
		else
		{
			$outlet_type = "";
		}

		if (isset($_POST['by_year']))
		{
			$year = $_POST['by_year'];
		}
		else
		{
			$year = date('Y');
		}

		$sheet->setCellValue('A1', "Report Selling In - By Outlet (" . $year . ")"); // Set kolom A1 dengan tulisan "Report Selling In - By Outlet"
		$sheet->setCellValue('A2', "Principal : " . $principal); // Set kolom A2 dengan tulisan "Outlet Type : EC_EC"
		$sheet->setCellValue('A3', "Channel : " . $channel); // Set kolom A3 dengan tulisan "Outlet Type : EC_EC"
		$sheet->setCellValue('A4', "Outlet Type : " . $outlet_type);
		//$sheet->mergeCells('A1:F1'); // Set Merge Cell pada kolom A1 sampai F1
		$sheet->getStyle('A1')->getFont()->setBold(true); // Set bold kolom A1
		$sheet->getStyle('A2')->getFont()->setBold(true); // Set bold kolom A2
		$sheet->getStyle('A3')->getFont()->setBold(true); // Set bold kolom A3
		$sheet->getStyle('A4')->getFont()->setBold(true);
		$sheet->getStyle('A1')->getFont()->setSize(20); // Set font size 15 untuk kolom A1
		// Buat header tabel nya pada baris ke 6
		$sheet->setCellValue('A6', "#"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('A6:A8'); // Set Merge Row pada kolom A6 sampai A8
		$sheet->setCellValue('B6', "Cust Code"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('B6:B8'); // Set Merge Row pada kolom A6 sampai A8
		$sheet->setCellValue('C6', "Outlet Name"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('C6:C8'); // Set Merge Row pada kolom A6 sampai A8
		$sheet->setCellValue('D6', "Outlet Type"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('D6:D8'); // Set Merge Row pada kolom A6 sampai A8
		$sheet->setCellValue('E6', "Area"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('E6:E8'); // Set Merge Row pada kolom A6 sampai A8
		$sheet->setCellValue('F6', "Month");
		$sheet->mergeCells('F6:AC6');
		$sheet->setCellValue('AD6', "Total");
		$sheet->mergeCells('AD6:AE7');
		$sheet->setCellValue('AF6', "Average");
		$sheet->mergeCells('AF6:AG7');
		$sheet->setCellValue('F7', "January");
		$sheet->mergeCells('F7:G7');
		$sheet->setCellValue('H7', "February");
		$sheet->mergeCells('H7:I7');
		$sheet->setCellValue('J7', "March");
		$sheet->mergeCells('J7:K7');
		$sheet->setCellValue('L7', "April");
		$sheet->mergeCells('L7:M7');
		$sheet->setCellValue('N7', "May");
		$sheet->mergeCells('N7:O7');
		$sheet->setCellValue('P7', "June");
		$sheet->mergeCells('P7:Q7');
		$sheet->setCellValue('R7', "July");
		$sheet->mergeCells('R7:S7');
		$sheet->setCellValue('T7', "August");
		$sheet->mergeCells('T7:U7');
		$sheet->setCellValue('V7', "September");
		$sheet->mergeCells('V7:W7');
		$sheet->setCellValue('X7', "October");
		$sheet->mergeCells('X7:Y7');
		$sheet->setCellValue('Z7', "November");
		$sheet->mergeCells('Z7:AA7');
		$sheet->setCellValue('AB7', "December");
		$sheet->mergeCells('AB7:AC7');
		$sheet->setCellValue('F8', "Qty");
		$sheet->setCellValue('G8', "Value");
		$sheet->setCellValue('H8', "Qty");
		$sheet->setCellValue('I8', "Value");
		$sheet->setCellValue('J8', "Qty");
		$sheet->setCellValue('K8', "Value");
		$sheet->setCellValue('L8', "Qty");
		$sheet->setCellValue('M8', "Value");
		$sheet->setCellValue('N8', "Qty");
		$sheet->setCellValue('O8', "Value");
		$sheet->setCellValue('P8', "Qty");
		$sheet->setCellValue('Q8', "Value");
		$sheet->setCellValue('R8', "Qty");
		$sheet->setCellValue('S8', "Value");
		$sheet->setCellValue('T8', "Qty");
		$sheet->setCellValue('U8', "Value");
		$sheet->setCellValue('V8', "Qty");
		$sheet->setCellValue('W8', "Value");
		$sheet->setCellValue('X8', "Qty");
		$sheet->setCellValue('Y8', "Value");
		$sheet->setCellValue('Z8', "Qty");
		$sheet->setCellValue('AA8', "Value");
		$sheet->setCellValue('AB8', "Qty");
		$sheet->setCellValue('AC8', "Value");
		$sheet->setCellValue('AD8', "Qty");
		$sheet->setCellValue('AE8', "Value");
		$sheet->setCellValue('AF8', "Qty");
		$sheet->setCellValue('AG8', "Value");

		// Apply style header yang telah kita buat tadi ke masing-masing kolom header
		$sheet->getStyle('A6')->applyFromArray($style_col);
		$sheet->getStyle('B6')->applyFromArray($style_col);
		$sheet->getStyle('C6')->applyFromArray($style_col);
		$sheet->getStyle('D6')->applyFromArray($style_col);
		$sheet->getStyle('E6')->applyFromArray($style_col);
		$sheet->getStyle('F6')->applyFromArray($style_col);
		$sheet->getStyle('G6')->applyFromArray($style_col);
		$sheet->getStyle('H6')->applyFromArray($style_col);
		$sheet->getStyle('I6')->applyFromArray($style_col);
		$sheet->getStyle('J6')->applyFromArray($style_col);
		$sheet->getStyle('K6')->applyFromArray($style_col);
		$sheet->getStyle('L6')->applyFromArray($style_col);
		$sheet->getStyle('M6')->applyFromArray($style_col);
		$sheet->getStyle('N6')->applyFromArray($style_col);
		$sheet->getStyle('O6')->applyFromArray($style_col);
		$sheet->getStyle('P6')->applyFromArray($style_col);
		$sheet->getStyle('Q6')->applyFromArray($style_col);
		$sheet->getStyle('R6')->applyFromArray($style_col);
		$sheet->getStyle('S6')->applyFromArray($style_col);
		$sheet->getStyle('T6')->applyFromArray($style_col);
		$sheet->getStyle('U6')->applyFromArray($style_col);
		$sheet->getStyle('V6')->applyFromArray($style_col);
		$sheet->getStyle('W6')->applyFromArray($style_col);
		$sheet->getStyle('X6')->applyFromArray($style_col);
		$sheet->getStyle('Y6')->applyFromArray($style_col);
		$sheet->getStyle('Z6')->applyFromArray($style_col);
		$sheet->getStyle('AA6')->applyFromArray($style_col);
		$sheet->getStyle('AB6')->applyFromArray($style_col);
		$sheet->getStyle('AC6')->applyFromArray($style_col);
		$sheet->getStyle('AD6')->applyFromArray($style_col);
		$sheet->getStyle('AE6')->applyFromArray($style_col);
		$sheet->getStyle('AF6')->applyFromArray($style_col);
		$sheet->getStyle('AG6')->applyFromArray($style_col);
		$sheet->getStyle('A7')->applyFromArray($style_col);
		$sheet->getStyle('B7')->applyFromArray($style_col);
		$sheet->getStyle('C7')->applyFromArray($style_col);
		$sheet->getStyle('D7')->applyFromArray($style_col);
		$sheet->getStyle('E7')->applyFromArray($style_col);
		$sheet->getStyle('F7')->applyFromArray($style_col);
		$sheet->getStyle('G7')->applyFromArray($style_col);
		$sheet->getStyle('H7')->applyFromArray($style_col);
		$sheet->getStyle('I7')->applyFromArray($style_col);
		$sheet->getStyle('J7')->applyFromArray($style_col);
		$sheet->getStyle('K7')->applyFromArray($style_col);
		$sheet->getStyle('L7')->applyFromArray($style_col);
		$sheet->getStyle('M7')->applyFromArray($style_col);
		$sheet->getStyle('N7')->applyFromArray($style_col);
		$sheet->getStyle('O7')->applyFromArray($style_col);
		$sheet->getStyle('P7')->applyFromArray($style_col);
		$sheet->getStyle('Q7')->applyFromArray($style_col);
		$sheet->getStyle('R7')->applyFromArray($style_col);
		$sheet->getStyle('S7')->applyFromArray($style_col);
		$sheet->getStyle('T7')->applyFromArray($style_col);
		$sheet->getStyle('U7')->applyFromArray($style_col);
		$sheet->getStyle('V7')->applyFromArray($style_col);
		$sheet->getStyle('W7')->applyFromArray($style_col);
		$sheet->getStyle('X7')->applyFromArray($style_col);
		$sheet->getStyle('Y7')->applyFromArray($style_col);
		$sheet->getStyle('Z7')->applyFromArray($style_col);
		$sheet->getStyle('AA7')->applyFromArray($style_col);
		$sheet->getStyle('AB7')->applyFromArray($style_col);
		$sheet->getStyle('AC7')->applyFromArray($style_col);
		$sheet->getStyle('AD7')->applyFromArray($style_col);
		$sheet->getStyle('AE7')->applyFromArray($style_col);
		$sheet->getStyle('AF7')->applyFromArray($style_col);
		$sheet->getStyle('AG7')->applyFromArray($style_col);
		$sheet->getStyle('A8')->applyFromArray($style_col);
		$sheet->getStyle('B8')->applyFromArray($style_col);
		$sheet->getStyle('C8')->applyFromArray($style_col);
		$sheet->getStyle('D8')->applyFromArray($style_col);
		$sheet->getStyle('E8')->applyFromArray($style_col);
		$sheet->getStyle('F8')->applyFromArray($style_col);
		$sheet->getStyle('G8')->applyFromArray($style_col);
		$sheet->getStyle('H8')->applyFromArray($style_col);
		$sheet->getStyle('I8')->applyFromArray($style_col);
		$sheet->getStyle('J8')->applyFromArray($style_col);
		$sheet->getStyle('K8')->applyFromArray($style_col);
		$sheet->getStyle('L8')->applyFromArray($style_col);
		$sheet->getStyle('M8')->applyFromArray($style_col);
		$sheet->getStyle('N8')->applyFromArray($style_col);
		$sheet->getStyle('O8')->applyFromArray($style_col);
		$sheet->getStyle('P8')->applyFromArray($style_col);
		$sheet->getStyle('Q8')->applyFromArray($style_col);
		$sheet->getStyle('R8')->applyFromArray($style_col);
		$sheet->getStyle('S8')->applyFromArray($style_col);
		$sheet->getStyle('T8')->applyFromArray($style_col);
		$sheet->getStyle('U8')->applyFromArray($style_col);
		$sheet->getStyle('V8')->applyFromArray($style_col);
		$sheet->getStyle('W8')->applyFromArray($style_col);
		$sheet->getStyle('X8')->applyFromArray($style_col);
		$sheet->getStyle('Y8')->applyFromArray($style_col);
		$sheet->getStyle('Z8')->applyFromArray($style_col);
		$sheet->getStyle('AA8')->applyFromArray($style_col);
		$sheet->getStyle('AB8')->applyFromArray($style_col);
		$sheet->getStyle('AC8')->applyFromArray($style_col);
		$sheet->getStyle('AD8')->applyFromArray($style_col);
		$sheet->getStyle('AE8')->applyFromArray($style_col);
		$sheet->getStyle('AF8')->applyFromArray($style_col);
		$sheet->getStyle('AG8')->applyFromArray($style_col);

		$sheet->getStyle('A6:AC8')->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');
		$sheet->getStyle('AD6:AE8')->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');
		$sheet->getStyle('AF6:AG8')->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');

		// Set height baris ke 1, 2 dan 3
		$sheet->getRowDimension('1')->setRowHeight(40);
		$sheet->getRowDimension('2')->setRowHeight(20);
		$sheet->getRowDimension('3')->setRowHeight(20);
		$sheet->getRowDimension('4')->setRowHeight(20);

		$no = 1; // Untuk penomoran tabel, di awal set dengan 1
		$row = 9;

		$data1 = array(
			'principal' => $principal,
			'channel' => $channel,
			'outlet_type' => $outlet_type,
			'year' => $year
		);

		$data['sellingin_OT'] = $this->model('ReportModel')->getSellingIn_OT3($data1);
		//$data['sellingin_OT'] = $this->model('ReportModel')->getSellingIn_OT2();

		foreach ($data['sellingin_OT'] as $rows) :
			$sheet->setCellValue('A' . $row, $no);
    		$sheet->setCellValue('B' . $row, $rows['outlet_code']);
			$sheet->setCellValue('C' . $row, $rows['outlet_name']);
			$sheet->setCellValue('D' . $row, $rows['outlet_type']);
			$sheet->setCellValue('E' . $row, $rows['area']);
			$sheet->setCellValue('F' . $row, number_format($rows['qty_jan'], 0));
			$sheet->setCellValue('G' . $row, number_format($rows['val_jan'], 2));
			$sheet->setCellValue('H' . $row, number_format($rows['qty_feb'], 0));
			$sheet->setCellValue('I' . $row, number_format($rows['val_feb'], 2));
			$sheet->setCellValue('J' . $row, number_format($rows['qty_mar'], 0));
			$sheet->setCellValue('K' . $row, number_format($rows['val_mar'], 2));
			$sheet->setCellValue('L' . $row, number_format($rows['qty_apr'], 0));
			$sheet->setCellValue('M' . $row, number_format($rows['val_apr'], 2));
			$sheet->setCellValue('N' . $row, number_format($rows['qty_mei'], 0));
			$sheet->setCellValue('O' . $row, number_format($rows['val_mei'], 2));
			$sheet->setCellValue('P' . $row, number_format($rows['qty_jun'], 0));
			$sheet->setCellValue('Q' . $row, number_format($rows['val_jun'], 2));
			$sheet->setCellValue('R' . $row, number_format($rows['qty_jul'], 0));
			$sheet->setCellValue('S' . $row, number_format($rows['val_jul'], 2));
			$sheet->setCellValue('T' . $row, number_format($rows['qty_agu'], 0));
			$sheet->setCellValue('U' . $row, number_format($rows['val_agu'], 2));
			$sheet->setCellValue('V' . $row, number_format($rows['qty_sep'], 0));
			$sheet->setCellValue('W' . $row, number_format($rows['val_sep'], 2));
			$sheet->setCellValue('X' . $row, number_format($rows['qty_okt'], 0));
			$sheet->setCellValue('Y' . $row, number_format($rows['val_okt'], 2));
			$sheet->setCellValue('Z' . $row, number_format($rows['qty_nop'], 0));
			$sheet->setCellValue('AA' . $row, number_format($rows['val_nop'], 2));
			$sheet->setCellValue('AB' . $row, number_format($rows['qty_des'], 0));
			$sheet->setCellValue('AC' . $row, number_format($rows['val_des'], 2));
			$sheet->setCellValue('AD' . $row, number_format($rows['qty_year'], 0));
			$sheet->setCellValue('AE' . $row, number_format($rows['val_year'], 2));
			$sheet->setCellValue('AF' . $row, number_format($rows['qty_year']/12, 0));
			$sheet->setCellValue('AG' . $row, number_format($rows['val_year']/12, 2));

			// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
			$sheet->getStyle('A' . $row)->applyFromArray($style_row);
			$sheet->getStyle('B' . $row)->applyFromArray($style_row);
			$sheet->getStyle('C' . $row)->applyFromArray($style_row);
			$sheet->getStyle('D' . $row)->applyFromArray($style_row);
			$sheet->getStyle('E' . $row)->applyFromArray($style_row);
			$sheet->getStyle('F' . $row)->applyFromArray($style_row);
			$sheet->getStyle('G' . $row)->applyFromArray($style_row);
			$sheet->getStyle('H' . $row)->applyFromArray($style_row);
			$sheet->getStyle('I' . $row)->applyFromArray($style_row);
			$sheet->getStyle('J' . $row)->applyFromArray($style_row);
			$sheet->getStyle('K' . $row)->applyFromArray($style_row);
			$sheet->getStyle('L' . $row)->applyFromArray($style_row);
			$sheet->getStyle('M' . $row)->applyFromArray($style_row);
			$sheet->getStyle('N' . $row)->applyFromArray($style_row);
			$sheet->getStyle('O' . $row)->applyFromArray($style_row);
			$sheet->getStyle('P' . $row)->applyFromArray($style_row);
			$sheet->getStyle('Q' . $row)->applyFromArray($style_row);
			$sheet->getStyle('R' . $row)->applyFromArray($style_row);
			$sheet->getStyle('S' . $row)->applyFromArray($style_row);
			$sheet->getStyle('T' . $row)->applyFromArray($style_row);
			$sheet->getStyle('U' . $row)->applyFromArray($style_row);
			$sheet->getStyle('V' . $row)->applyFromArray($style_row);
			$sheet->getStyle('W' . $row)->applyFromArray($style_row);
			$sheet->getStyle('X' . $row)->applyFromArray($style_row);
			$sheet->getStyle('Y' . $row)->applyFromArray($style_row);
			$sheet->getStyle('Z' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AA' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AB' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AC' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AD' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AE' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AF' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AG' . $row)->applyFromArray($style_row);

			$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('I' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('J' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('K' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('L' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('M' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('N' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('O' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('P' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('Q' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('R' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('S' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('T' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('U' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('V' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('W' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('X' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('Y' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('Z' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AA' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AB' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AC' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AD' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AE' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AF' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AG' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

			$no++; // Tambah 1 setiap kali looping
    		$row++; // Tambah 1 setiap kali looping
		endforeach;

		$sheet->getColumnDimension('A')->setWidth(5); // Set width kolom A
		$sheet->getColumnDimension('B')->setWidth(11); // Set width kolom B
		$sheet->getColumnDimension('C')->setWidth(40); // Set width kolom C
		$sheet->getColumnDimension('D')->setWidth(15); // Set width kolom B
		$sheet->getColumnDimension('E')->setWidth(12); // Set width kolom B
		$sheet->getColumnDimension('F')->setWidth(10);
		$sheet->getColumnDimension('G')->setWidth(16);
		$sheet->getColumnDimension('H')->setWidth(10);
		$sheet->getColumnDimension('I')->setWidth(16);
		$sheet->getColumnDimension('J')->setWidth(10);
		$sheet->getColumnDimension('K')->setWidth(16);
		$sheet->getColumnDimension('L')->setWidth(10);
		$sheet->getColumnDimension('M')->setWidth(16);
		$sheet->getColumnDimension('N')->setWidth(10);
		$sheet->getColumnDimension('O')->setWidth(16);
		$sheet->getColumnDimension('P')->setWidth(10);
		$sheet->getColumnDimension('Q')->setWidth(16);
		$sheet->getColumnDimension('R')->setWidth(10);
		$sheet->getColumnDimension('S')->setWidth(16);
		$sheet->getColumnDimension('T')->setWidth(10);
		$sheet->getColumnDimension('U')->setWidth(16);
		$sheet->getColumnDimension('V')->setWidth(10);
		$sheet->getColumnDimension('W')->setWidth(16);
		$sheet->getColumnDimension('X')->setWidth(10);
		$sheet->getColumnDimension('Y')->setWidth(16);
		$sheet->getColumnDimension('Z')->setWidth(10);
		$sheet->getColumnDimension('AA')->setWidth(16);
		$sheet->getColumnDimension('AB')->setWidth(10);
		$sheet->getColumnDimension('AC')->setWidth(16);
		$sheet->getColumnDimension('AD')->setWidth(10);
		$sheet->getColumnDimension('AE')->setWidth(16);
		$sheet->getColumnDimension('AF')->setWidth(10);
		$sheet->getColumnDimension('AG')->setWidth(16);

		// Set orientasi kertas jadi LANDSCAPE
		$sheet->getPageSetup()->setOrientation(\PhpOffice\PhpSpreadsheet\Worksheet\PageSetup::ORIENTATION_LANDSCAPE);
		// Set judul file excel nya
		$sheet->setTitle("Report Selling In - By Outlet");
		// Proses file excel
		header('Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet');
		header('Content-Disposition: attachment; filename="Report Selling In - By Outlet ("' . $year . '").xlsx"'); // Set nama file excel nya
		header('Cache-Control: max-age=0');

		$writer = new Xlsx($spreadsheet);
		$writer->save('php://output');


	}

	public function export_sellingout_OT()
	{
		$spreadsheet = new Spreadsheet();
		$sheet = $spreadsheet->getActiveSheet();
		// Buat sebuah variabel untuk menampung pengaturan style dari header tabel
		$style_col = [
			'font' => ['bold' => true], // Set font nya jadi bold
			'alignment' => [
				'horizontal' => \PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER, // Set text jadi ditengah secara horizontal (center)
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'top' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border top dengan garis tipis
				'right' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN],  // Set border right dengan garis tipis
				'bottom' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border bottom dengan garis tipis
				'left' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN] // Set border left dengan garis tipis
			]
		];
		// Buat sebuah variabel untuk menampung pengaturan style dari isi tabel
		$style_row = [
			'alignment' => [
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'top' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border top dengan garis tipis
				'right' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN],  // Set border right dengan garis tipis
				'bottom' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border bottom dengan garis tipis
				'left' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN] // Set border left dengan garis tipis
			]
		];


		if (isset($_POST['by_principal']))
		{
			$principal = $_POST['by_principal'];
		}
		else
		{
			$principal = "";
		}

		if (isset($_POST['by_channel']))
		{
			$channel = $_POST['by_channel'];
		}
		else
		{
			$channel = "";
		}

		if (isset($_POST['by_outlet_type']))
		{
			$outlet_type = $_POST['by_outlet_type'];
		}
		else
		{
			$outlet_type = "";
		}

		if (isset($_POST['by_outlet_code']))
		{
			$outlet_code = $_POST['by_outlet_code'];
		}
		else
		{
			$outlet_code = "";
		}

		if (isset($_POST['by_area']))
		{
			$area = implode(',', $_POST['by_area']);
			$area = str_replace(",", "','", $area);;
		}
		else
		{
			$area = "";
		}
		

		if(isset($_POST['by_sku']))
		{
			$sku = $_POST['by_sku'];
		}else
		{
			$sku = "";
		}

		if (isset($_POST['by_year']))
		{
			$year = $_POST['by_year'];
		}
		else
		{
			$year = date('Y');
		}

		$data['sku'] = $this->model('SkuModel')->getSkuByCode($sku);
		$item_name = $data['sku']['item_name'];
		$data['outlet'] = $this->model('ReportModel')->getOutletById($outlet_code);
		$outlet_name = $data['outlet']['cust_name'];

		$sheet->setCellValue('A1', "Report Selling Out - By Outlet (" . $year . ")"); // Set kolom A1 dengan tulisan "Report Selling In - By Outlet"
		$sheet->setCellValue('A2', "Principal : " . $principal); // Set kolom A2 dengan tulisan "Outlet Type : EC_EC"
		$sheet->setCellValue('A3', "Channel : " . $channel); // Set kolom A3 dengan tulisan "Outlet Type : EC_EC"
		$sheet->setCellValue('A4', "Outlet Type : " . $outlet_type);
		$sheet->setCellValue('D2', "Outlet : " . $outlet_name);
		$sheet->setCellValue('D3', "Area : " . $area);
		$sheet->setCellValue('D4', "SKU : " . $item_name);
		//$sheet->mergeCells('A1:F1'); // Set Merge Cell pada kolom A1 sampai F1
		$sheet->getStyle('A1')->getFont()->setBold(true); // Set bold kolom A1
		$sheet->getStyle('A2')->getFont()->setBold(true); // Set bold kolom A2
		$sheet->getStyle('A3')->getFont()->setBold(true); // Set bold kolom A3
		$sheet->getStyle('A4')->getFont()->setBold(true);
		$sheet->getStyle('D2')->getFont()->setBold(true);
		$sheet->getStyle('D3')->getFont()->setBold(true);
		$sheet->getStyle('D4')->getFont()->setBold(true);
		$sheet->getStyle('A1')->getFont()->setSize(20); // Set font size 15 untuk kolom A1
		// Buat header tabel nya pada baris ke 6
		$sheet->setCellValue('A6', "#"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('A6:A8'); // Set Merge Row pada kolom A6 sampai A8
		$sheet->setCellValue('B6', "Cust Code"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('B6:B8'); // Set Merge Row pada kolom A6 sampai A8
		$sheet->setCellValue('C6', "BIG Code"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('C6:C8'); // Set Merge Row pada kolom A6 sampai A8
		$sheet->setCellValue('D6', "Outlet Name"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('D6:D8'); // Set Merge Row pada kolom A6 sampai A8
		$sheet->setCellValue('E6', "Outlet Type");
		$sheet->mergeCells('E6:E8');
		$sheet->setCellValue('F6', "Outlet Count");
		$sheet->mergeCells('F6:F8');
		$sheet->setCellValue('G6', "Area");
		$sheet->mergeCells('G6:G8');
		$sheet->setCellValue('H6', "Month");
		$sheet->mergeCells('H6:AE6');
		$sheet->setCellValue('AF6', "Total");
		$sheet->mergeCells('AF6:AG7');
		$sheet->setCellValue('AH6', "Average");
		$sheet->mergeCells('AH6:AI7');
		$sheet->setCellValue('H7', "January");
		$sheet->mergeCells('H7:I7');
		$sheet->setCellValue('J7', "February");
		$sheet->mergeCells('J7:K7');
		$sheet->setCellValue('L7', "March");
		$sheet->mergeCells('L7:M7');
		$sheet->setCellValue('N7', "April");
		$sheet->mergeCells('N7:O7');
		$sheet->setCellValue('P7', "May");
		$sheet->mergeCells('P7:Q7');
		$sheet->setCellValue('R7', "June");
		$sheet->mergeCells('R7:S7');
		$sheet->setCellValue('T7', "July");
		$sheet->mergeCells('T7:U7');
		$sheet->setCellValue('V7', "August");
		$sheet->mergeCells('V7:W7');
		$sheet->setCellValue('X7', "September");
		$sheet->mergeCells('X7:Y7');
		$sheet->setCellValue('Z7', "October");
		$sheet->mergeCells('Z7:AA7');
		$sheet->setCellValue('AB7', "November");
		$sheet->mergeCells('AB7:AC7');
		$sheet->setCellValue('AD7', "December");
		$sheet->mergeCells('AD7:AE7');
		$sheet->setCellValue('H8', "Qty");
		$sheet->setCellValue('I8', "Value");
		$sheet->setCellValue('J8', "Qty");
		$sheet->setCellValue('K8', "Value");
		$sheet->setCellValue('L8', "Qty");
		$sheet->setCellValue('M8', "Value");
		$sheet->setCellValue('N8', "Qty");
		$sheet->setCellValue('O8', "Value");
		$sheet->setCellValue('P8', "Qty");
		$sheet->setCellValue('Q8', "Value");
		$sheet->setCellValue('R8', "Qty");
		$sheet->setCellValue('S8', "Value");
		$sheet->setCellValue('T8', "Qty");
		$sheet->setCellValue('U8', "Value");
		$sheet->setCellValue('V8', "Qty");
		$sheet->setCellValue('W8', "Value");
		$sheet->setCellValue('X8', "Qty");
		$sheet->setCellValue('Y8', "Value");
		$sheet->setCellValue('Z8', "Qty");
		$sheet->setCellValue('AA8', "Value");
		$sheet->setCellValue('AB8', "Qty");
		$sheet->setCellValue('AC8', "Value");
		$sheet->setCellValue('AD8', "Qty");
		$sheet->setCellValue('AE8', "Value");
		$sheet->setCellValue('AF8', "Qty");
		$sheet->setCellValue('AG8', "Value");
		$sheet->setCellValue('AH8', "Qty");
		$sheet->setCellValue('AI8', "Value");

		// Apply style header yang telah kita buat tadi ke masing-masing kolom header
		$sheet->getStyle('A6')->applyFromArray($style_col);
		$sheet->getStyle('B6')->applyFromArray($style_col);
		$sheet->getStyle('C6')->applyFromArray($style_col);
		$sheet->getStyle('D6')->applyFromArray($style_col);
		$sheet->getStyle('E6')->applyFromArray($style_col);
		$sheet->getStyle('F6')->applyFromArray($style_col);
		$sheet->getStyle('G6')->applyFromArray($style_col);
		$sheet->getStyle('H6')->applyFromArray($style_col);
		$sheet->getStyle('I6')->applyFromArray($style_col);
		$sheet->getStyle('J6')->applyFromArray($style_col);
		$sheet->getStyle('K6')->applyFromArray($style_col);
		$sheet->getStyle('L6')->applyFromArray($style_col);
		$sheet->getStyle('M6')->applyFromArray($style_col);
		$sheet->getStyle('N6')->applyFromArray($style_col);
		$sheet->getStyle('O6')->applyFromArray($style_col);
		$sheet->getStyle('P6')->applyFromArray($style_col);
		$sheet->getStyle('Q6')->applyFromArray($style_col);
		$sheet->getStyle('R6')->applyFromArray($style_col);
		$sheet->getStyle('S6')->applyFromArray($style_col);
		$sheet->getStyle('T6')->applyFromArray($style_col);
		$sheet->getStyle('U6')->applyFromArray($style_col);
		$sheet->getStyle('V6')->applyFromArray($style_col);
		$sheet->getStyle('W6')->applyFromArray($style_col);
		$sheet->getStyle('X6')->applyFromArray($style_col);
		$sheet->getStyle('Y6')->applyFromArray($style_col);
		$sheet->getStyle('Z6')->applyFromArray($style_col);
		$sheet->getStyle('AA6')->applyFromArray($style_col);
		$sheet->getStyle('AB6')->applyFromArray($style_col);
		$sheet->getStyle('AC6')->applyFromArray($style_col);
		$sheet->getStyle('AD6')->applyFromArray($style_col);
		$sheet->getStyle('AE6')->applyFromArray($style_col);
		$sheet->getStyle('AF6')->applyFromArray($style_col);
		$sheet->getStyle('AG6')->applyFromArray($style_col);
		$sheet->getStyle('AH6')->applyFromArray($style_col);
		$sheet->getStyle('AI6')->applyFromArray($style_col);
		$sheet->getStyle('A7')->applyFromArray($style_col);
		$sheet->getStyle('B7')->applyFromArray($style_col);
		$sheet->getStyle('C7')->applyFromArray($style_col);
		$sheet->getStyle('D7')->applyFromArray($style_col);
		$sheet->getStyle('E7')->applyFromArray($style_col);
		$sheet->getStyle('F7')->applyFromArray($style_col);
		$sheet->getStyle('G7')->applyFromArray($style_col);
		$sheet->getStyle('H7')->applyFromArray($style_col);
		$sheet->getStyle('I7')->applyFromArray($style_col);
		$sheet->getStyle('J7')->applyFromArray($style_col);
		$sheet->getStyle('K7')->applyFromArray($style_col);
		$sheet->getStyle('L7')->applyFromArray($style_col);
		$sheet->getStyle('M7')->applyFromArray($style_col);
		$sheet->getStyle('N7')->applyFromArray($style_col);
		$sheet->getStyle('O7')->applyFromArray($style_col);
		$sheet->getStyle('P7')->applyFromArray($style_col);
		$sheet->getStyle('Q7')->applyFromArray($style_col);
		$sheet->getStyle('R7')->applyFromArray($style_col);
		$sheet->getStyle('S7')->applyFromArray($style_col);
		$sheet->getStyle('T7')->applyFromArray($style_col);
		$sheet->getStyle('U7')->applyFromArray($style_col);
		$sheet->getStyle('V7')->applyFromArray($style_col);
		$sheet->getStyle('W7')->applyFromArray($style_col);
		$sheet->getStyle('X7')->applyFromArray($style_col);
		$sheet->getStyle('Y7')->applyFromArray($style_col);
		$sheet->getStyle('Z7')->applyFromArray($style_col);
		$sheet->getStyle('AA7')->applyFromArray($style_col);
		$sheet->getStyle('AB7')->applyFromArray($style_col);
		$sheet->getStyle('AC7')->applyFromArray($style_col);
		$sheet->getStyle('AD7')->applyFromArray($style_col);
		$sheet->getStyle('AE7')->applyFromArray($style_col);
		$sheet->getStyle('AF7')->applyFromArray($style_col);
		$sheet->getStyle('AG7')->applyFromArray($style_col);
		$sheet->getStyle('AH7')->applyFromArray($style_col);
		$sheet->getStyle('AI7')->applyFromArray($style_col);
		$sheet->getStyle('A8')->applyFromArray($style_col);
		$sheet->getStyle('B8')->applyFromArray($style_col);
		$sheet->getStyle('C8')->applyFromArray($style_col);
		$sheet->getStyle('D8')->applyFromArray($style_col);
		$sheet->getStyle('E8')->applyFromArray($style_col);
		$sheet->getStyle('F8')->applyFromArray($style_col);
		$sheet->getStyle('G8')->applyFromArray($style_col);
		$sheet->getStyle('H8')->applyFromArray($style_col);
		$sheet->getStyle('I8')->applyFromArray($style_col);
		$sheet->getStyle('J8')->applyFromArray($style_col);
		$sheet->getStyle('K8')->applyFromArray($style_col);
		$sheet->getStyle('L8')->applyFromArray($style_col);
		$sheet->getStyle('M8')->applyFromArray($style_col);
		$sheet->getStyle('N8')->applyFromArray($style_col);
		$sheet->getStyle('O8')->applyFromArray($style_col);
		$sheet->getStyle('P8')->applyFromArray($style_col);
		$sheet->getStyle('Q8')->applyFromArray($style_col);
		$sheet->getStyle('R8')->applyFromArray($style_col);
		$sheet->getStyle('S8')->applyFromArray($style_col);
		$sheet->getStyle('T8')->applyFromArray($style_col);
		$sheet->getStyle('U8')->applyFromArray($style_col);
		$sheet->getStyle('V8')->applyFromArray($style_col);
		$sheet->getStyle('W8')->applyFromArray($style_col);
		$sheet->getStyle('X8')->applyFromArray($style_col);
		$sheet->getStyle('Y8')->applyFromArray($style_col);
		$sheet->getStyle('Z8')->applyFromArray($style_col);
		$sheet->getStyle('AA8')->applyFromArray($style_col);
		$sheet->getStyle('AB8')->applyFromArray($style_col);
		$sheet->getStyle('AC8')->applyFromArray($style_col);
		$sheet->getStyle('AD8')->applyFromArray($style_col);
		$sheet->getStyle('AE8')->applyFromArray($style_col);
		$sheet->getStyle('AF8')->applyFromArray($style_col);
		$sheet->getStyle('AG8')->applyFromArray($style_col);
		$sheet->getStyle('AH8')->applyFromArray($style_col);
		$sheet->getStyle('AI8')->applyFromArray($style_col);

		$sheet->getStyle('A6:AI8')->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');

		// Set height baris ke 1, 2 dan 3
		$sheet->getRowDimension('1')->setRowHeight(40);
		$sheet->getRowDimension('2')->setRowHeight(20);
		$sheet->getRowDimension('3')->setRowHeight(20);
		$sheet->getRowDimension('4')->setRowHeight(20);

		$no = 1; // Untuk penomoran tabel, di awal set dengan 1
		$row = 9;

		$data1 = array(
			'principal' => $principal,
			'channel' => $channel,
			'outlet_type' => $outlet_type,
			'outlet_code' => $outlet_code,
			'item_code' => $sku,
			'area' => $area, 
			'year' => $year
			
		);

		//$data['sellingout_OT'] = $this->model('ReportModel')->getSellingOut_OT3($data1);
		$data['sellingout_OT'] = $this->model('ReportModel')->getSellingOut_OT2();

		foreach ($data['sellingout_OT'] as $rows) :
			$sheet->setCellValue('A' . $row, $no);
    		$sheet->setCellValue('B' . $row, $rows['cust_code']);
			$sheet->setCellValue('C' . $row, $rows['big_code']);
			$sheet->setCellValue('D' . $row, $rows['cust_name']);
			$sheet->setCellValue('E' . $row, $rows['outlet_type']);
			$sheet->setCellValue('F' . $row, $rows['outlet_count']);
			$sheet->setCellValue('G' . $row, $rows['area']);
			$sheet->setCellValue('H' . $row, number_format($rows['qty_jan'], 0));
			$sheet->setCellValue('I' . $row, number_format($rows['val_jan'], 2));
			$sheet->setCellValue('J' . $row, number_format($rows['qty_feb'], 0));
			$sheet->setCellValue('K' . $row, number_format($rows['val_feb'], 2));
			$sheet->setCellValue('L' . $row, number_format($rows['qty_mar'], 0));
			$sheet->setCellValue('M' . $row, number_format($rows['val_mar'], 2));
			$sheet->setCellValue('N' . $row, number_format($rows['qty_apr'], 0));
			$sheet->setCellValue('O' . $row, number_format($rows['val_apr'], 2));
			$sheet->setCellValue('P' . $row, number_format($rows['qty_mei'], 0));
			$sheet->setCellValue('Q' . $row, number_format($rows['val_mei'], 2));
			$sheet->setCellValue('R' . $row, number_format($rows['qty_jun'], 0));
			$sheet->setCellValue('S' . $row, number_format($rows['val_jun'], 2));
			$sheet->setCellValue('T' . $row, number_format($rows['qty_jul'], 0));
			$sheet->setCellValue('U' . $row, number_format($rows['val_jul'], 2));
			$sheet->setCellValue('V' . $row, number_format($rows['qty_agu'], 0));
			$sheet->setCellValue('W' . $row, number_format($rows['val_agu'], 2));
			$sheet->setCellValue('X' . $row, number_format($rows['qty_sep'], 0));
			$sheet->setCellValue('Y' . $row, number_format($rows['val_sep'], 2));
			$sheet->setCellValue('Z' . $row, number_format($rows['qty_okt'], 0));
			$sheet->setCellValue('AA' . $row, number_format($rows['val_okt'], 2));
			$sheet->setCellValue('AB' . $row, number_format($rows['qty_nop'], 0));
			$sheet->setCellValue('AC' . $row, number_format($rows['val_nop'], 2));
			$sheet->setCellValue('AD' . $row, number_format($rows['qty_des'], 0));
			$sheet->setCellValue('AE' . $row, number_format($rows['val_des'], 2));
			$sheet->setCellValue('AF' . $row, number_format($rows['qty_year'], 0));
			$sheet->setCellValue('AG' . $row, number_format($rows['val_year'], 2));
			$sheet->setCellValue('AH' . $row, number_format($rows['qty_year']/12, 0));
			$sheet->setCellValue('AI' . $row, number_format($rows['val_year']/12, 2));

			// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
			$sheet->getStyle('A' . $row)->applyFromArray($style_row);
			$sheet->getStyle('B' . $row)->applyFromArray($style_row);
			$sheet->getStyle('C' . $row)->applyFromArray($style_row);
			$sheet->getStyle('D' . $row)->applyFromArray($style_row);
			$sheet->getStyle('E' . $row)->applyFromArray($style_row);
			$sheet->getStyle('F' . $row)->applyFromArray($style_row);
			$sheet->getStyle('G' . $row)->applyFromArray($style_row);
			$sheet->getStyle('H' . $row)->applyFromArray($style_row);
			$sheet->getStyle('I' . $row)->applyFromArray($style_row);
			$sheet->getStyle('J' . $row)->applyFromArray($style_row);
			$sheet->getStyle('K' . $row)->applyFromArray($style_row);
			$sheet->getStyle('L' . $row)->applyFromArray($style_row);
			$sheet->getStyle('M' . $row)->applyFromArray($style_row);
			$sheet->getStyle('N' . $row)->applyFromArray($style_row);
			$sheet->getStyle('O' . $row)->applyFromArray($style_row);
			$sheet->getStyle('P' . $row)->applyFromArray($style_row);
			$sheet->getStyle('Q' . $row)->applyFromArray($style_row);
			$sheet->getStyle('R' . $row)->applyFromArray($style_row);
			$sheet->getStyle('S' . $row)->applyFromArray($style_row);
			$sheet->getStyle('T' . $row)->applyFromArray($style_row);
			$sheet->getStyle('U' . $row)->applyFromArray($style_row);
			$sheet->getStyle('V' . $row)->applyFromArray($style_row);
			$sheet->getStyle('W' . $row)->applyFromArray($style_row);
			$sheet->getStyle('X' . $row)->applyFromArray($style_row);
			$sheet->getStyle('Y' . $row)->applyFromArray($style_row);
			$sheet->getStyle('Z' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AA' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AB' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AC' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AD' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AE' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AF' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AG' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AH' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AI' . $row)->applyFromArray($style_row);

			$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('I' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('J' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('K' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('L' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('M' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('N' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('O' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('P' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('Q' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('R' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('S' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('T' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('U' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('V' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('W' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('X' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('Y' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('Z' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AA' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AB' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AC' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AD' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AE' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AF' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AG' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AH' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AI' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

			$no++; // Tambah 1 setiap kali looping
    		$row++; // Tambah 1 setiap kali looping
		endforeach;

		$sheet->getColumnDimension('A')->setWidth(5); // Set width kolom A
		$sheet->getColumnDimension('B')->setWidth(11); // Set width kolom B
		$sheet->getColumnDimension('C')->setWidth(15); // Set width kolom C
		$sheet->getColumnDimension('D')->setWidth(40); // Set width kolom D
		$sheet->getColumnDimension('E')->setWidth(15);
		$sheet->getColumnDimension('F')->setWidth(15);
		$sheet->getColumnDimension('G')->setWidth(15);
		$sheet->getColumnDimension('H')->setWidth(10);
		$sheet->getColumnDimension('I')->setWidth(16);
		$sheet->getColumnDimension('J')->setWidth(10);
		$sheet->getColumnDimension('K')->setWidth(16);
		$sheet->getColumnDimension('L')->setWidth(10);
		$sheet->getColumnDimension('M')->setWidth(16);
		$sheet->getColumnDimension('N')->setWidth(10);
		$sheet->getColumnDimension('O')->setWidth(16);
		$sheet->getColumnDimension('P')->setWidth(10);
		$sheet->getColumnDimension('Q')->setWidth(16);
		$sheet->getColumnDimension('R')->setWidth(10);
		$sheet->getColumnDimension('S')->setWidth(16);
		$sheet->getColumnDimension('T')->setWidth(10);
		$sheet->getColumnDimension('U')->setWidth(16);
		$sheet->getColumnDimension('V')->setWidth(10);
		$sheet->getColumnDimension('W')->setWidth(16);
		$sheet->getColumnDimension('X')->setWidth(10);
		$sheet->getColumnDimension('Y')->setWidth(16);
		$sheet->getColumnDimension('Z')->setWidth(10);
		$sheet->getColumnDimension('AA')->setWidth(16);
		$sheet->getColumnDimension('AB')->setWidth(10);
		$sheet->getColumnDimension('AC')->setWidth(16);
		$sheet->getColumnDimension('AD')->setWidth(10);
		$sheet->getColumnDimension('AE')->setWidth(16);
		$sheet->getColumnDimension('AF')->setWidth(10);
		$sheet->getColumnDimension('AG')->setWidth(16);
		$sheet->getColumnDimension('AH')->setWidth(10);
		$sheet->getColumnDimension('AI')->setWidth(16);

		// Set orientasi kertas jadi LANDSCAPE
		$sheet->getPageSetup()->setOrientation(\PhpOffice\PhpSpreadsheet\Worksheet\PageSetup::ORIENTATION_LANDSCAPE);
		// Set judul file excel nya
		$sheet->setTitle("Selling Out - By Outlet");
		// Proses file excel
		header('Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet');
		header('Content-Disposition: attachment; filename="Report Selling Out - By Outlet ("' . $year . '").xlsx"'); // Set nama file excel nya
		header('Cache-Control: max-age=0');

		$writer = new Xlsx($spreadsheet);
		$writer->save('php://output');


	}

	public function export_sellingout_OT_SKU()
	{
		$spreadsheet = new Spreadsheet();
		$sheet = $spreadsheet->getActiveSheet();
		// Buat sebuah variabel untuk menampung pengaturan style dari header tabel
		$style_col = [
			'font' => ['bold' => true], // Set font nya jadi bold
			'alignment' => [
				'horizontal' => \PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER, // Set text jadi ditengah secara horizontal (center)
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'top' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border top dengan garis tipis
				'right' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN],  // Set border right dengan garis tipis
				'bottom' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border bottom dengan garis tipis
				'left' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN] // Set border left dengan garis tipis
			]
		];

		$style_range = [
			'font' => ['bold' => true], // Set font nya jadi bold
			'alignment' => [
				'horizontal' => \PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER, // Set text jadi ditengah secara horizontal (center)
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'allBorders' => [
					'borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN, // Set border top dengan garis tipis
				]
			]
		];

		$style_range_row = [
			'alignment' => [
				'horizontal' => \PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER, // Set text jadi ditengah secara horizontal (center)
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'allBorders' => [
					'borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN, // Set border top dengan garis tipis
				]
			]
		];

		// Buat sebuah variabel untuk menampung pengaturan style dari isi tabel
		$style_row = [
			'alignment' => [
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'top' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border top dengan garis tipis
				'right' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN],  // Set border right dengan garis tipis
				'bottom' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border bottom dengan garis tipis
				'left' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN] // Set border left dengan garis tipis
			]
		];


		if (isset($_POST['by_principal']))
		{
			$principal = $_POST['by_principal'];
		}
		else
		{
			$principal = "";
		}

		if (isset($_POST['by_channel']))
		{
			$channel = $_POST['by_channel'];
		}
		else
		{
			$channel = "";
		}

		if (isset($_POST['by_outlet_type']))
		{
			$outlet_type = $_POST['by_outlet_type'];
		}
		else
		{
			$outlet_type = "";
		}

		if (isset($_POST['by_area']))
		{
			$area = implode(',', $_POST['by_area']);
			$area = str_replace(",", "','", $area);;
		}
		else
		{
			$area = "";
		}

		if (isset($_POST['by_year']))
		{
			$year = $_POST['by_year'];
		}
		else
		{
			$year = date('Y');
		}

		$data['sku_code'] = $this->model('SkuModel')->getItemCodeSKU();

		$sheet->setCellValue('A1', "Report Selling Out - By Outlet & SKU (" . $year . ")"); // Set kolom A1 dengan tulisan "Report Selling In - By Outlet"
		$sheet->setCellValue('A2', "Principal : " . $principal); // Set kolom A2 dengan tulisan "Outlet Type : EC_EC"
		$sheet->setCellValue('A3', "Channel : " . $channel); // Set kolom A3 dengan tulisan "Outlet Type : EC_EC"
		$sheet->setCellValue('D2', "Outlet Type : " . $outlet_type);
		$sheet->setCellValue('D3', "Area : " . $area);
		//$sheet->mergeCells('A1:F1'); // Set Merge Cell pada kolom A1 sampai F1
		$sheet->getStyle('A1')->getFont()->setBold(true); // Set bold kolom A1
		$sheet->getStyle('A2')->getFont()->setBold(true); // Set bold kolom A2
		$sheet->getStyle('A3')->getFont()->setBold(true); // Set bold kolom A3
		$sheet->getStyle('D2')->getFont()->setBold(true);
		$sheet->getStyle('D3')->getFont()->setBold(true);
		$sheet->getStyle('A1')->getFont()->setSize(20); // Set font size 15 untuk kolom A1
		// Buat header tabel nya pada baris ke 6
		$sheet->setCellValue('A5', "#"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('A5:A7'); // Set Merge Row pada kolom A6 sampai A8
		$sheet->setCellValue('B5', "BIG Code"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('B5:B7'); // Set Merge Row pada kolom A6 sampai A8
		$sheet->setCellValue('C5', "Outlet Name"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('C5:C7'); // Set Merge Row pada kolom A6 sampai A8
		$sheet->setCellValue('D5', "Outlet Type"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('D5:D7'); // Set Merge Row pada kolom A6 sampai A8
		$sheet->setCellValue('E5', "Area");
		$sheet->mergeCells('E5:E7');

		$start_col = 6;
		foreach ($data['sku_code'] as $row_sku) :
			$sheet->setCellValueByColumnAndRow($start_col, 5, $row_sku['item_code']);
			$last_col = $start_col + 1;
			$sheet->mergeCellsByColumnAndRow($start_col, 5, $last_col, 5);
			$start_col = $last_col + 1;
		endforeach;

		$start_col = 6;
		foreach ($data['sku_code'] as $row_sku) :
			$sheet->setCellValueByColumnAndRow($start_col, 6, $row_sku['item_name']);
			$last_col = $start_col + 1;
			$sheet->mergeCellsByColumnAndRow($start_col, 6, $last_col, 6);
			$start_col = $last_col + 1;
		endforeach;

		$start_col = 6;
		foreach ($data['sku_code'] as $row_sku) :
			$sheet->setCellValueByColumnAndRow($start_col, 7, "Qty");
			$start_col = $start_col + 1;
			$sheet->setCellValueByColumnAndRow($start_col, 7, "Value");
			$start_col = $start_col + 1;
		endforeach;

		// Apply style header yang telah kita buat tadi ke masing-masing kolom header
		$sheet->getStyleByColumnAndRow(1, 6, $last_col, 6)->getAlignment()->setWrapText(true);
		$sheet->getStyleByColumnAndRow(1, 5, $last_col, 7)->applyFromArray($style_range);
		$sheet->getStyleByColumnAndRow(1, 5, $last_col, 7)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');

		// Set height baris ke 1, 2 dan 3
		$sheet->getRowDimension('1')->setRowHeight(40);
		$sheet->getRowDimension('2')->setRowHeight(20);
		$sheet->getRowDimension('3')->setRowHeight(20);
		$sheet->getRowDimension('4')->setRowHeight(20);
		$sheet->getRowDimension('6')->setRowHeight(75);

		$no = 1; // Untuk penomoran tabel, di awal set dengan 1
		$row = 8;

		$data1 = array(
			'principal' => $principal,
			'channel' => $channel,
			'outlet_type' => $outlet_type,
			'area' => $area, 
			'year' => $year
			
		);

		$data_col = 1;
		$data_row = 8;

		$data['sellingout_OT_SKU'] = $this->model('ReportModel')->getSellingOut_OT_SKU($data);

		foreach ($data['sellingout_OT_SKU'] as $rows) :
			$sheet->setCellValue('A' . $row, $no);
    		$sheet->setCellValue('B' . $row, $rows['big_code']);
			$sheet->setCellValue('C' . $row, $rows['cust_name']);
			$sheet->setCellValue('D' . $row, $rows['outlet_type']);
			$sheet->setCellValue('E' . $row, $rows['area']);

			$start_col = 6;
			foreach ($data['sku_code'] as $row_sku) :
				$sheet->setCellValueByColumnAndRow($start_col, $data_row, $rows['qty_'.$row_sku['item_code']]);
				$start_col = $start_col + 1;
				$sheet->setCellValueByColumnAndRow($start_col, $data_row, $rows['val_'.$row_sku['item_code']]);
				$start_col = $start_col + 1;
				$last_col = $start_col;
			endforeach;

			$data_row++;

			$sheet->getStyle('A' . $row)->applyFromArray($style_row);
			$sheet->getStyle('B' . $row)->applyFromArray($style_row);
			$sheet->getStyle('C' . $row)->applyFromArray($style_row);
			$sheet->getStyle('D' . $row)->applyFromArray($style_row);
			$sheet->getStyle('E' . $row)->applyFromArray($style_row);

			$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);

			$no++; // Tambah 1 setiap kali looping
    		$row++; // Tambah 1 setiap kali looping
		endforeach;

		$sheet->getStyleByColumnAndRow(6, 8, $last_col-1, $data_row-1)->applyFromArray($style_range_row);
		$sheet->getStyleByColumnAndRow(6, 8, $last_col-1, $data_row-1)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyleByColumnAndRow(6, 8, $last_col-1, $data_row-1)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

		$sheet->getColumnDimension('A')->setWidth(5); // Set width kolom A
		$sheet->getColumnDimension('B')->setWidth(15); // Set width kolom B
		$sheet->getColumnDimension('C')->setWidth(40); // Set width kolom C
		$sheet->getColumnDimension('D')->setWidth(15); // Set width kolom D
		$sheet->getColumnDimension('E')->setWidth(15);

		// Set orientasi kertas jadi LANDSCAPE
		$sheet->getPageSetup()->setOrientation(\PhpOffice\PhpSpreadsheet\Worksheet\PageSetup::ORIENTATION_LANDSCAPE);
		// Set judul file excel nya
		$sheet->setTitle("Selling Out - By Outlet & SKU");
		// Proses file excel
		header('Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet');
		header('Content-Disposition: attachment; filename="Report Selling Out - By Outlet & SKU ("' . $year . '").xlsx"'); // Set nama file excel nya
		header('Cache-Control: max-age=0');

		$writer = new Xlsx($spreadsheet);
		$writer->save('php://output');


	}

	public function export_sellingout_Account()
	{
		$spreadsheet = new Spreadsheet();
		$sheet = $spreadsheet->getActiveSheet();
		// Buat sebuah variabel untuk menampung pengaturan style dari header tabel
		$style_col = [
			'font' => ['bold' => true], // Set font nya jadi bold
			'alignment' => [
				'horizontal' => \PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER, // Set text jadi ditengah secara horizontal (center)
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'top' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border top dengan garis tipis
				'right' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN],  // Set border right dengan garis tipis
				'bottom' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border bottom dengan garis tipis
				'left' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN] // Set border left dengan garis tipis
			]
		];
		// Buat sebuah variabel untuk menampung pengaturan style dari isi tabel
		$style_row = [
			'alignment' => [
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'top' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border top dengan garis tipis
				'right' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN],  // Set border right dengan garis tipis
				'bottom' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border bottom dengan garis tipis
				'left' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN] // Set border left dengan garis tipis
			]
		];


		if (isset($_POST['by_principal']))
		{
			$principal = $_POST['by_principal'];
		}
		else
		{
			$principal = "";
		}

		if (isset($_POST['by_channel']))
		{
			$channel = $_POST['by_channel'];
		}
		else
		{
			$channel = "";
		}

		if (isset($_POST['by_outlet_type']))
		{
			$outlet_type = $_POST['by_outlet_type'];
		}
		else
		{
			$outlet_type = "";
		}

		if (isset($_POST['by_outlet_code']))
		{
			$outlet_code = $_POST['by_outlet_code'];
		}
		else
		{
			$outlet_code = "";
		}

		if (isset($_POST['by_area']))
		{
			$area = $_POST['by_area'];
		}
		else
		{
			$area = "";
		}
		

		if(isset($_POST['by_sku']))
		{
			$sku = $_POST['by_sku'];
		}else
		{
			$sku = "";
		}

		if (isset($_POST['by_year']))
		{
			$year = $_POST['by_year'];
		}
		else
		{
			$year = date('Y');
		}

		$old_year = $year - 1;

		$data['sku'] = $this->model('SkuModel')->getSkuByCode($sku);
		$item_name = $data['sku']['item_name'];
		$data['outlet'] = $this->model('ReportModel')->getOutletById($outlet_code);
		$outlet_name = $data['outlet']['cust_name'];

		$sheet->setCellValue('A1', "Report Selling Out - By Group Account (" . $year . ")"); // Set kolom A1 dengan tulisan "Report Selling In - By Outlet"
		$sheet->setCellValue('A2', "Principal : " . $principal); // Set kolom A2 dengan tulisan "Outlet Type : EC_EC"
		$sheet->setCellValue('A3', "Channel : " . $channel); // Set kolom A3 dengan tulisan "Outlet Type : EC_EC"
		$sheet->setCellValue('A4', "Outlet Type : " . $outlet_type);
		$sheet->setCellValue('D2', "Outlet : " . $outlet_name);
		$sheet->setCellValue('D3', "Area : " . $area);
		$sheet->setCellValue('D4', "SKU : " . $item_name);
		//$sheet->mergeCells('A1:F1'); // Set Merge Cell pada kolom A1 sampai F1
		$sheet->getStyle('A1')->getFont()->setBold(true); // Set bold kolom A1
		$sheet->getStyle('A2')->getFont()->setBold(true); // Set bold kolom A2
		$sheet->getStyle('A3')->getFont()->setBold(true); // Set bold kolom A3
		$sheet->getStyle('A4')->getFont()->setBold(true);
		$sheet->getStyle('D2')->getFont()->setBold(true);
		$sheet->getStyle('D3')->getFont()->setBold(true);
		$sheet->getStyle('D4')->getFont()->setBold(true);
		$sheet->getStyle('A1')->getFont()->setSize(20); // Set font size 15 untuk kolom A1
		// Buat header tabel nya pada baris ke 6
		$sheet->setCellValue('A6', "#"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('A6:A8'); // Set Merge Row pada kolom A6 sampai A8
		$sheet->setCellValue('B6', "Group Account"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('B6:B8');
		$sheet->setCellValue('C6', "Outlet Code"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('C6:C8'); // Set Merge Row pada kolom A6 sampai A8
		$sheet->setCellValue('D6', "BIG Code"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('D6:D8'); // Set Merge Row pada kolom A6 sampai A8
		$sheet->setCellValue('E6', "Outlet Name"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('E6:E8'); // Set Merge Row pada kolom A6 sampai A8
		$sheet->setCellValue('F6', "Outlet Type");
		$sheet->mergeCells('F6:F8');
		$sheet->setCellValue('G6', "Outlet Count");
		$sheet->mergeCells('G6:G8');
		$sheet->setCellValue('H6', "Area");
		$sheet->mergeCells('H6:H8');
		$sheet->setCellValue('I6', "Month");
		$sheet->mergeCells('I6:AF6');
		$sheet->setCellValue('AG6', "Total ".$year);
		$sheet->mergeCells('AG6:AH7');
		$sheet->setCellValue('AI6', "Total ".$old_year);
		$sheet->mergeCells('AI6:AJ7');
		$sheet->setCellValue('I7', "January");
		$sheet->mergeCells('I7:J7');
		$sheet->setCellValue('K7', "February");
		$sheet->mergeCells('K7:L7');
		$sheet->setCellValue('M7', "March");
		$sheet->mergeCells('M7:N7');
		$sheet->setCellValue('O7', "April");
		$sheet->mergeCells('O7:P7');
		$sheet->setCellValue('Q7', "May");
		$sheet->mergeCells('Q7:R7');
		$sheet->setCellValue('S7', "June");
		$sheet->mergeCells('S7:T7');
		$sheet->setCellValue('U7', "July");
		$sheet->mergeCells('U7:V7');
		$sheet->setCellValue('W7', "August");
		$sheet->mergeCells('W7:X7');
		$sheet->setCellValue('Y7', "September");
		$sheet->mergeCells('Y7:Z7');
		$sheet->setCellValue('AA7', "October");
		$sheet->mergeCells('AA7:AB7');
		$sheet->setCellValue('AC7', "November");
		$sheet->mergeCells('AC7:AD7');
		$sheet->setCellValue('AE7', "December");
		$sheet->mergeCells('AE7:AF7');
		$sheet->setCellValue('I8', "Qty");
		$sheet->setCellValue('J8', "Value");
		$sheet->setCellValue('K8', "Qty");
		$sheet->setCellValue('L8', "Value");
		$sheet->setCellValue('M8', "Qty");
		$sheet->setCellValue('N8', "Value");
		$sheet->setCellValue('O8', "Qty");
		$sheet->setCellValue('P8', "Value");
		$sheet->setCellValue('Q8', "Qty");
		$sheet->setCellValue('R8', "Value");
		$sheet->setCellValue('S8', "Qty");
		$sheet->setCellValue('T8', "Value");
		$sheet->setCellValue('U8', "Qty");
		$sheet->setCellValue('V8', "Value");
		$sheet->setCellValue('W8', "Qty");
		$sheet->setCellValue('X8', "Value");
		$sheet->setCellValue('Y8', "Qty");
		$sheet->setCellValue('Z8', "Value");
		$sheet->setCellValue('AA8', "Qty");
		$sheet->setCellValue('AB8', "Value");
		$sheet->setCellValue('AC8', "Qty");
		$sheet->setCellValue('AD8', "Value");
		$sheet->setCellValue('AE8', "Qty");
		$sheet->setCellValue('AF8', "Value");
		$sheet->setCellValue('AG8', "Qty");
		$sheet->setCellValue('AH8', "Value");
		$sheet->setCellValue('AI8', "Qty");
		$sheet->setCellValue('AJ8', "Value");

		// Apply style header yang telah kita buat tadi ke masing-masing kolom header
		$sheet->getStyle('A6')->applyFromArray($style_col);
		$sheet->getStyle('B6')->applyFromArray($style_col);
		$sheet->getStyle('C6')->applyFromArray($style_col);
		$sheet->getStyle('D6')->applyFromArray($style_col);
		$sheet->getStyle('E6')->applyFromArray($style_col);
		$sheet->getStyle('F6')->applyFromArray($style_col);
		$sheet->getStyle('G6')->applyFromArray($style_col);
		$sheet->getStyle('H6')->applyFromArray($style_col);
		$sheet->getStyle('I6')->applyFromArray($style_col);
		$sheet->getStyle('J6')->applyFromArray($style_col);
		$sheet->getStyle('K6')->applyFromArray($style_col);
		$sheet->getStyle('L6')->applyFromArray($style_col);
		$sheet->getStyle('M6')->applyFromArray($style_col);
		$sheet->getStyle('N6')->applyFromArray($style_col);
		$sheet->getStyle('O6')->applyFromArray($style_col);
		$sheet->getStyle('P6')->applyFromArray($style_col);
		$sheet->getStyle('Q6')->applyFromArray($style_col);
		$sheet->getStyle('R6')->applyFromArray($style_col);
		$sheet->getStyle('S6')->applyFromArray($style_col);
		$sheet->getStyle('T6')->applyFromArray($style_col);
		$sheet->getStyle('U6')->applyFromArray($style_col);
		$sheet->getStyle('V6')->applyFromArray($style_col);
		$sheet->getStyle('W6')->applyFromArray($style_col);
		$sheet->getStyle('X6')->applyFromArray($style_col);
		$sheet->getStyle('Y6')->applyFromArray($style_col);
		$sheet->getStyle('Z6')->applyFromArray($style_col);
		$sheet->getStyle('AA6')->applyFromArray($style_col);
		$sheet->getStyle('AB6')->applyFromArray($style_col);
		$sheet->getStyle('AC6')->applyFromArray($style_col);
		$sheet->getStyle('AD6')->applyFromArray($style_col);
		$sheet->getStyle('AE6')->applyFromArray($style_col);
		$sheet->getStyle('AF6')->applyFromArray($style_col);
		$sheet->getStyle('AG6')->applyFromArray($style_col);
		$sheet->getStyle('AH6')->applyFromArray($style_col);
		$sheet->getStyle('AI6')->applyFromArray($style_col);
		$sheet->getStyle('AJ6')->applyFromArray($style_col);
		$sheet->getStyle('A7')->applyFromArray($style_col);
		$sheet->getStyle('B7')->applyFromArray($style_col);
		$sheet->getStyle('C7')->applyFromArray($style_col);
		$sheet->getStyle('D7')->applyFromArray($style_col);
		$sheet->getStyle('E7')->applyFromArray($style_col);
		$sheet->getStyle('F7')->applyFromArray($style_col);
		$sheet->getStyle('G7')->applyFromArray($style_col);
		$sheet->getStyle('H7')->applyFromArray($style_col);
		$sheet->getStyle('I7')->applyFromArray($style_col);
		$sheet->getStyle('J7')->applyFromArray($style_col);
		$sheet->getStyle('K7')->applyFromArray($style_col);
		$sheet->getStyle('L7')->applyFromArray($style_col);
		$sheet->getStyle('M7')->applyFromArray($style_col);
		$sheet->getStyle('N7')->applyFromArray($style_col);
		$sheet->getStyle('O7')->applyFromArray($style_col);
		$sheet->getStyle('P7')->applyFromArray($style_col);
		$sheet->getStyle('Q7')->applyFromArray($style_col);
		$sheet->getStyle('R7')->applyFromArray($style_col);
		$sheet->getStyle('S7')->applyFromArray($style_col);
		$sheet->getStyle('T7')->applyFromArray($style_col);
		$sheet->getStyle('U7')->applyFromArray($style_col);
		$sheet->getStyle('V7')->applyFromArray($style_col);
		$sheet->getStyle('W7')->applyFromArray($style_col);
		$sheet->getStyle('X7')->applyFromArray($style_col);
		$sheet->getStyle('Y7')->applyFromArray($style_col);
		$sheet->getStyle('Z7')->applyFromArray($style_col);
		$sheet->getStyle('AA7')->applyFromArray($style_col);
		$sheet->getStyle('AB7')->applyFromArray($style_col);
		$sheet->getStyle('AC7')->applyFromArray($style_col);
		$sheet->getStyle('AD7')->applyFromArray($style_col);
		$sheet->getStyle('AE7')->applyFromArray($style_col);
		$sheet->getStyle('AF7')->applyFromArray($style_col);
		$sheet->getStyle('AG7')->applyFromArray($style_col);
		$sheet->getStyle('AH7')->applyFromArray($style_col);
		$sheet->getStyle('AI7')->applyFromArray($style_col);
		$sheet->getStyle('AJ7')->applyFromArray($style_col);
		$sheet->getStyle('A8')->applyFromArray($style_col);
		$sheet->getStyle('B8')->applyFromArray($style_col);
		$sheet->getStyle('C8')->applyFromArray($style_col);
		$sheet->getStyle('D8')->applyFromArray($style_col);
		$sheet->getStyle('E8')->applyFromArray($style_col);
		$sheet->getStyle('F8')->applyFromArray($style_col);
		$sheet->getStyle('G8')->applyFromArray($style_col);
		$sheet->getStyle('H8')->applyFromArray($style_col);
		$sheet->getStyle('I8')->applyFromArray($style_col);
		$sheet->getStyle('J8')->applyFromArray($style_col);
		$sheet->getStyle('K8')->applyFromArray($style_col);
		$sheet->getStyle('L8')->applyFromArray($style_col);
		$sheet->getStyle('M8')->applyFromArray($style_col);
		$sheet->getStyle('N8')->applyFromArray($style_col);
		$sheet->getStyle('O8')->applyFromArray($style_col);
		$sheet->getStyle('P8')->applyFromArray($style_col);
		$sheet->getStyle('Q8')->applyFromArray($style_col);
		$sheet->getStyle('R8')->applyFromArray($style_col);
		$sheet->getStyle('S8')->applyFromArray($style_col);
		$sheet->getStyle('T8')->applyFromArray($style_col);
		$sheet->getStyle('U8')->applyFromArray($style_col);
		$sheet->getStyle('V8')->applyFromArray($style_col);
		$sheet->getStyle('W8')->applyFromArray($style_col);
		$sheet->getStyle('X8')->applyFromArray($style_col);
		$sheet->getStyle('Y8')->applyFromArray($style_col);
		$sheet->getStyle('Z8')->applyFromArray($style_col);
		$sheet->getStyle('AA8')->applyFromArray($style_col);
		$sheet->getStyle('AB8')->applyFromArray($style_col);
		$sheet->getStyle('AC8')->applyFromArray($style_col);
		$sheet->getStyle('AD8')->applyFromArray($style_col);
		$sheet->getStyle('AE8')->applyFromArray($style_col);
		$sheet->getStyle('AF8')->applyFromArray($style_col);
		$sheet->getStyle('AG8')->applyFromArray($style_col);
		$sheet->getStyle('AH8')->applyFromArray($style_col);
		$sheet->getStyle('AI8')->applyFromArray($style_col);
		$sheet->getStyle('AJ8')->applyFromArray($style_col);

		$sheet->getStyle('A6:AF8')->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');
		$sheet->getStyle('AG6:AJ8')->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFA07A');

		// Set height baris ke 1, 2 dan 3
		$sheet->getRowDimension('1')->setRowHeight(40);
		$sheet->getRowDimension('2')->setRowHeight(20);
		$sheet->getRowDimension('3')->setRowHeight(20);
		$sheet->getRowDimension('4')->setRowHeight(20);

		$no = 1; // Untuk penomoran tabel, di awal set dengan 1
		$row = 9;

		$data1 = array(
			'principal' => $principal,
			'channel' => $channel,
			'outlet_type' => $outlet_type,
			'outlet_code' => $outlet_code,
			'item_code' => $sku,
			'area' => $area, 
			'year' => $year
			
		);

		//$data['sellingout_OT'] = $this->model('ReportModel')->getSellingOut_OT3($data1);
		$data['sellingout_Account'] = $this->model('ReportModel')->getSellingOut_Account();

		$group_account = '';
		$outlet_count = 0;
		$total_outlet_count = 0;

		$qty_jan = 0;
		$qty_feb = 0;
		$qty_mar = 0;
		$qty_apr = 0;
		$qty_mei = 0;
		$qty_jun = 0;
		$qty_jul = 0;
		$qty_agu = 0;
		$qty_sep = 0;
		$qty_okt = 0;
		$qty_nop = 0;
		$qty_des = 0;
		$qty_year_now = 0;
		$qty_year_old = 0;

		$val_jan = 0;
		$val_feb = 0;
		$val_mar = 0;
		$val_apr = 0;
		$val_mei = 0;
		$val_jun = 0;
		$val_jul = 0;
		$val_agu = 0;
		$val_sep = 0;
		$val_okt = 0;
		$val_nop = 0;
		$val_des = 0;
		$val_year_now = 0;
		$val_year_old = 0;

		$total_qty_jan = 0;
		$total_qty_feb = 0;
		$total_qty_mar = 0;
		$total_qty_apr = 0;
		$total_qty_mei = 0;
		$total_qty_jun = 0;
		$total_qty_jul = 0;
		$total_qty_agu = 0;
		$total_qty_sep = 0;
		$total_qty_okt = 0;
		$total_qty_nop = 0;
		$total_qty_des = 0;
		$total_qty_year_now = 0;
		$total_qty_year_old = 0;

		$total_val_jan = 0;
		$total_val_feb = 0;
		$total_val_mar = 0;
		$total_val_apr = 0;
		$total_val_mei = 0;
		$total_val_jun = 0;
		$total_val_jul = 0;
		$total_val_agu = 0;
		$total_val_sep = 0;
		$total_val_okt = 0;
		$total_val_nop = 0;
		$total_val_des = 0;
		$total_val_year_now = 0;
		$total_val_year_old = 0;

		foreach ($data['sellingout_Account'] as $rows) :

			if ($group_account != $rows['group_account'] and $group_account != '' )
			{
				$sheet->setCellValue('A' . $row, "");
				$sheet->setCellValue('B' . $row, "");
				$sheet->setCellValue('C' . $row, "");
				$sheet->setCellValue('D' . $row, "");
				$sheet->setCellValue('E' . $row, $group_account);
				$sheet->setCellValue('F' . $row, "");
				$sheet->setCellValue('G' . $row, $outlet_count);
				$sheet->setCellValue('H' . $row, "");
				$sheet->setCellValue('I' . $row, $qty_jan);
				$sheet->setCellValue('J' . $row, $val_jan);
				$sheet->setCellValue('K' . $row, $qty_feb);
				$sheet->setCellValue('L' . $row, $val_feb);
				$sheet->setCellValue('M' . $row, $qty_mar);
				$sheet->setCellValue('N' . $row, $val_mar);
				$sheet->setCellValue('O' . $row, $qty_apr);
				$sheet->setCellValue('P' . $row, $val_apr);
				$sheet->setCellValue('Q' . $row, $qty_mei);
				$sheet->setCellValue('R' . $row, $val_mei);
				$sheet->setCellValue('S' . $row, $qty_jun);
				$sheet->setCellValue('T' . $row, $val_jun);
				$sheet->setCellValue('U' . $row, $qty_jul);
				$sheet->setCellValue('V' . $row, $val_jul);
				$sheet->setCellValue('W' . $row, $qty_agu);
				$sheet->setCellValue('X' . $row, $val_agu);
				$sheet->setCellValue('Y' . $row, $qty_sep);
				$sheet->setCellValue('Z' . $row, $val_sep);
				$sheet->setCellValue('AA' . $row, $qty_okt);
				$sheet->setCellValue('AB' . $row, $val_okt);
				$sheet->setCellValue('AC' . $row, $qty_nop);
				$sheet->setCellValue('AD' . $row, $val_nop);
				$sheet->setCellValue('AE' . $row, $qty_des);
				$sheet->setCellValue('AF' . $row, $val_des);
				$sheet->setCellValue('AG' . $row, $qty_year_now);
				$sheet->setCellValue('AH' . $row, $val_year_now);
				$sheet->setCellValue('AI' . $row, $qty_year_old);
				$sheet->setCellValue('AJ' . $row, $val_year_old);

				// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
				$sheet->getStyle('A' . $row)->applyFromArray($style_row);
				$sheet->getStyle('B' . $row)->applyFromArray($style_row);
				$sheet->getStyle('C' . $row)->applyFromArray($style_row);
				$sheet->getStyle('D' . $row)->applyFromArray($style_row);
				$sheet->getStyle('E' . $row)->applyFromArray($style_row);
				$sheet->getStyle('F' . $row)->applyFromArray($style_row);
				$sheet->getStyle('G' . $row)->applyFromArray($style_row);
				$sheet->getStyle('H' . $row)->applyFromArray($style_row);
				$sheet->getStyle('I' . $row)->applyFromArray($style_row);
				$sheet->getStyle('J' . $row)->applyFromArray($style_row);
				$sheet->getStyle('K' . $row)->applyFromArray($style_row);
				$sheet->getStyle('L' . $row)->applyFromArray($style_row);
				$sheet->getStyle('M' . $row)->applyFromArray($style_row);
				$sheet->getStyle('N' . $row)->applyFromArray($style_row);
				$sheet->getStyle('O' . $row)->applyFromArray($style_row);
				$sheet->getStyle('P' . $row)->applyFromArray($style_row);
				$sheet->getStyle('Q' . $row)->applyFromArray($style_row);
				$sheet->getStyle('R' . $row)->applyFromArray($style_row);
				$sheet->getStyle('S' . $row)->applyFromArray($style_row);
				$sheet->getStyle('T' . $row)->applyFromArray($style_row);
				$sheet->getStyle('U' . $row)->applyFromArray($style_row);
				$sheet->getStyle('V' . $row)->applyFromArray($style_row);
				$sheet->getStyle('W' . $row)->applyFromArray($style_row);
				$sheet->getStyle('X' . $row)->applyFromArray($style_row);
				$sheet->getStyle('Y' . $row)->applyFromArray($style_row);
				$sheet->getStyle('Z' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AA' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AB' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AC' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AD' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AE' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AF' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AG' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AH' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AI' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AJ' . $row)->applyFromArray($style_row);

				$sheet->getStyle('G' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('I' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('J' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('K' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('L' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('M' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('N' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('O' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('P' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('Q' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('R' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('S' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('T' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('U' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('V' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('W' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('X' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('Y' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('Z' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('AA' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('AB' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('AC' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('AD' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('AE' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('AF' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('AG' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('AH' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('AI' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('AJ' . $row)->getNumberFormat()->setFormatCode('#,##0');

				$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
				$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
				$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
				$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
				$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
				$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
				$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
				$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
				$sheet->getStyle('I' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('J' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('K' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('L' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('M' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('N' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('O' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('P' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('Q' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('R' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('S' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('T' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('U' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('V' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('W' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('X' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('Y' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('Z' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AA' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AB' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AC' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AD' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AE' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AF' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AG' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AH' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AI' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AJ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

				$sheet->getStyle('A' . $row . ':AJ' . $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');
				$sheet->getStyle('A' . $row . ':AJ' . $row)->getFont()->setBold(true);

				$outlet_count = 0;

				$qty_jan = 0;
				$qty_feb = 0;
				$qty_mar = 0;
				$qty_apr = 0;
				$qty_mei = 0;
				$qty_jun = 0;
				$qty_jul = 0;
				$qty_agu = 0;
				$qty_sep = 0;
				$qty_okt = 0;
				$qty_nop = 0;
				$qty_des = 0;
				$qty_year_now = 0;
				$qty_year_old = 0;

				$val_jan = 0;
				$val_feb = 0;
				$val_mar = 0;
				$val_apr = 0;
				$val_mei = 0;
				$val_jun = 0;
				$val_jul = 0;
				$val_agu = 0;
				$val_sep = 0;
				$val_okt = 0;
				$val_nop = 0;
				$val_des = 0;
				$val_year_now = 0;
				$val_year_old = 0;

				$row++;

			}

			$sheet->setCellValue('A' . $row, $no);
			$sheet->setCellValue('B' . $row, $rows['group_account']);
    		$sheet->setCellValue('C' . $row, $rows['cust_code']);
			$sheet->setCellValue('D' . $row, $rows['big_code']);
			$sheet->setCellValue('E' . $row, $rows['cust_name']);
			$sheet->setCellValue('F' . $row, $rows['outlet_type']);
			$sheet->setCellValue('G' . $row, $rows['outlet_count']);
			$sheet->setCellValue('H' . $row, $rows['area']);
			$sheet->setCellValue('I' . $row, $rows['qty_jan']);
			$sheet->setCellValue('J' . $row, $rows['val_jan']);
			$sheet->setCellValue('K' . $row, $rows['qty_feb']);
			$sheet->setCellValue('L' . $row, $rows['val_feb']);
			$sheet->setCellValue('M' . $row, $rows['qty_mar']);
			$sheet->setCellValue('N' . $row, $rows['val_mar']);
			$sheet->setCellValue('O' . $row, $rows['qty_apr']);
			$sheet->setCellValue('P' . $row, $rows['val_apr']);
			$sheet->setCellValue('Q' . $row, $rows['qty_mei']);
			$sheet->setCellValue('R' . $row, $rows['val_mei']);
			$sheet->setCellValue('S' . $row, $rows['qty_jun']);
			$sheet->setCellValue('T' . $row, $rows['val_jun']);
			$sheet->setCellValue('U' . $row, $rows['qty_jul']);
			$sheet->setCellValue('V' . $row, $rows['val_jul']);
			$sheet->setCellValue('W' . $row, $rows['qty_agu']);
			$sheet->setCellValue('X' . $row, $rows['val_agu']);
			$sheet->setCellValue('Y' . $row, $rows['qty_sep']);
			$sheet->setCellValue('Z' . $row, $rows['val_sep']);
			$sheet->setCellValue('AA' . $row, $rows['qty_okt']);
			$sheet->setCellValue('AB' . $row, $rows['val_okt']);
			$sheet->setCellValue('AC' . $row, $rows['qty_nop']);
			$sheet->setCellValue('AD' . $row, $rows['val_nop']);
			$sheet->setCellValue('AE' . $row, $rows['qty_des']);
			$sheet->setCellValue('AF' . $row, $rows['val_des']);
			$sheet->setCellValue('AG' . $row, $rows['qty_year_now']);
			$sheet->setCellValue('AH' . $row, $rows['val_year_now']);
			$sheet->setCellValue('AI' . $row, $rows['qty_year_old']);
			$sheet->setCellValue('AJ' . $row, $rows['val_year_old']);

			$group_account = $rows['group_account'];
			$outlet_count += $rows['outlet_count'];
			$total_outlet_count += $rows['outlet_count'];

			$qty_jan += $rows['qty_jan'];
			$qty_feb += $rows['qty_feb'];
			$qty_mar += $rows['qty_mar'];
			$qty_apr += $rows['qty_apr'];
			$qty_mei += $rows['qty_mei'];
			$qty_jun += $rows['qty_jun'];
			$qty_jul += $rows['qty_jul'];
			$qty_agu += $rows['qty_agu'];
			$qty_sep += $rows['qty_sep'];
			$qty_okt += $rows['qty_okt'];
			$qty_nop += $rows['qty_nop'];
			$qty_des += $rows['qty_des'];
			$qty_year_now += $rows['qty_year_now'];
			$qty_year_old += $rows['qty_year_old'];

			$val_jan += $rows['val_jan'];
			$val_feb += $rows['val_feb'];
			$val_mar += $rows['val_mar'];
			$val_apr += $rows['val_apr'];
			$val_mei += $rows['val_mei'];
			$val_jun += $rows['val_jun'];
			$val_jul += $rows['val_jul'];
			$val_agu += $rows['val_agu'];
			$val_sep += $rows['val_sep'];
			$val_okt += $rows['val_okt'];
			$val_nop += $rows['val_nop'];
			$val_des += $rows['val_des'];
			$val_year_now += $rows['val_year_now'];
			$val_year_old += $rows['val_year_old'];

			$total_qty_jan += $rows['qty_jan'];
			$total_qty_feb += $rows['qty_feb'];
			$total_qty_mar += $rows['qty_mar'];
			$total_qty_apr += $rows['qty_apr'];
			$total_qty_mei += $rows['qty_mei'];
			$total_qty_jun += $rows['qty_jun'];
			$total_qty_jul += $rows['qty_jul'];
			$total_qty_agu += $rows['qty_agu'];
			$total_qty_sep += $rows['qty_sep'];
			$total_qty_okt += $rows['qty_okt'];
			$total_qty_nop += $rows['qty_nop'];
			$total_qty_des += $rows['qty_des'];
			$total_qty_year_now += $rows['qty_year_now'];
			$total_qty_year_old += $rows['qty_year_old'];

			$total_val_jan += $rows['val_jan'];
			$total_val_feb += $rows['val_feb'];
			$total_val_mar += $rows['val_mar'];
			$total_val_apr += $rows['val_apr'];
			$total_val_mei += $rows['val_mei'];
			$total_val_jun += $rows['val_jun'];
			$total_val_jul += $rows['val_jul'];
			$total_val_agu += $rows['val_agu'];
			$total_val_sep += $rows['val_sep'];
			$total_val_okt += $rows['val_okt'];
			$total_val_nop += $rows['val_nop'];
			$total_val_des += $rows['val_des'];
			$total_val_year_now += $rows['val_year_now'];
			$total_val_year_old += $rows['val_year_old'];

			// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
			$sheet->getStyle('A' . $row)->applyFromArray($style_row);
			$sheet->getStyle('B' . $row)->applyFromArray($style_row);
			$sheet->getStyle('C' . $row)->applyFromArray($style_row);
			$sheet->getStyle('D' . $row)->applyFromArray($style_row);
			$sheet->getStyle('E' . $row)->applyFromArray($style_row);
			$sheet->getStyle('F' . $row)->applyFromArray($style_row);
			$sheet->getStyle('G' . $row)->applyFromArray($style_row);
			$sheet->getStyle('H' . $row)->applyFromArray($style_row);
			$sheet->getStyle('I' . $row)->applyFromArray($style_row);
			$sheet->getStyle('J' . $row)->applyFromArray($style_row);
			$sheet->getStyle('K' . $row)->applyFromArray($style_row);
			$sheet->getStyle('L' . $row)->applyFromArray($style_row);
			$sheet->getStyle('M' . $row)->applyFromArray($style_row);
			$sheet->getStyle('N' . $row)->applyFromArray($style_row);
			$sheet->getStyle('O' . $row)->applyFromArray($style_row);
			$sheet->getStyle('P' . $row)->applyFromArray($style_row);
			$sheet->getStyle('Q' . $row)->applyFromArray($style_row);
			$sheet->getStyle('R' . $row)->applyFromArray($style_row);
			$sheet->getStyle('S' . $row)->applyFromArray($style_row);
			$sheet->getStyle('T' . $row)->applyFromArray($style_row);
			$sheet->getStyle('U' . $row)->applyFromArray($style_row);
			$sheet->getStyle('V' . $row)->applyFromArray($style_row);
			$sheet->getStyle('W' . $row)->applyFromArray($style_row);
			$sheet->getStyle('X' . $row)->applyFromArray($style_row);
			$sheet->getStyle('Y' . $row)->applyFromArray($style_row);
			$sheet->getStyle('Z' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AA' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AB' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AC' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AD' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AE' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AF' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AG' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AH' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AI' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AJ' . $row)->applyFromArray($style_row);

			$sheet->getStyle('G' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('I' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('J' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('K' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('L' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('M' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('N' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('O' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('P' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('Q' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('R' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('S' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('T' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('U' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('V' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('W' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('X' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('Y' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('Z' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('AA' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('AB' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('AC' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('AD' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('AE' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('AF' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('AG' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('AH' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('AI' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('AJ' . $row)->getNumberFormat()->setFormatCode('#,##0');

			$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('I' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('J' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('K' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('L' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('M' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('N' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('O' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('P' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('Q' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('R' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('S' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('T' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('U' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('V' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('W' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('X' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('Y' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('Z' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AA' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AB' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AC' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AD' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AE' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AF' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AG' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AH' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AI' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AJ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

			$no++; // Tambah 1 setiap kali looping
    		$row++; // Tambah 1 setiap kali looping
		endforeach;

		$sheet->setCellValue('A' . $row, "");
		$sheet->setCellValue('B' . $row, "");
		$sheet->setCellValue('C' . $row, "");
		$sheet->setCellValue('D' . $row, "");
		$sheet->setCellValue('E' . $row, $group_account);
		$sheet->setCellValue('F' . $row, "");
		$sheet->setCellValue('G' . $row, $outlet_count);
		$sheet->setCellValue('H' . $row, "");
		$sheet->setCellValue('I' . $row, $qty_jan);
		$sheet->setCellValue('J' . $row, $val_jan);
		$sheet->setCellValue('K' . $row, $qty_feb);
		$sheet->setCellValue('L' . $row, $val_feb);
		$sheet->setCellValue('M' . $row, $qty_mar);
		$sheet->setCellValue('N' . $row, $val_mar);
		$sheet->setCellValue('O' . $row, $qty_apr);
		$sheet->setCellValue('P' . $row, $val_apr);
		$sheet->setCellValue('Q' . $row, $qty_mei);
		$sheet->setCellValue('R' . $row, $val_mei);
		$sheet->setCellValue('S' . $row, $qty_jun);
		$sheet->setCellValue('T' . $row, $val_jun);
		$sheet->setCellValue('U' . $row, $qty_jul);
		$sheet->setCellValue('V' . $row, $val_jul);
		$sheet->setCellValue('W' . $row, $qty_agu);
		$sheet->setCellValue('X' . $row, $val_agu);
		$sheet->setCellValue('Y' . $row, $qty_sep);
		$sheet->setCellValue('Z' . $row, $val_sep);
		$sheet->setCellValue('AA' . $row, $qty_okt);
		$sheet->setCellValue('AB' . $row, $val_okt);
		$sheet->setCellValue('AC' . $row, $qty_nop);
		$sheet->setCellValue('AD' . $row, $val_nop);
		$sheet->setCellValue('AE' . $row, $qty_des);
		$sheet->setCellValue('AF' . $row, $val_des);
		$sheet->setCellValue('AG' . $row, $qty_year_now);
		$sheet->setCellValue('AH' . $row, $val_year_now);
		$sheet->setCellValue('AI' . $row, $qty_year_old);
		$sheet->setCellValue('AJ' . $row, $val_year_old);

		// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
		$sheet->getStyle('A' . $row)->applyFromArray($style_row);
		$sheet->getStyle('B' . $row)->applyFromArray($style_row);
		$sheet->getStyle('C' . $row)->applyFromArray($style_row);
		$sheet->getStyle('D' . $row)->applyFromArray($style_row);
		$sheet->getStyle('E' . $row)->applyFromArray($style_row);
		$sheet->getStyle('F' . $row)->applyFromArray($style_row);
		$sheet->getStyle('G' . $row)->applyFromArray($style_row);
		$sheet->getStyle('H' . $row)->applyFromArray($style_row);
		$sheet->getStyle('I' . $row)->applyFromArray($style_row);
		$sheet->getStyle('J' . $row)->applyFromArray($style_row);
		$sheet->getStyle('K' . $row)->applyFromArray($style_row);
		$sheet->getStyle('L' . $row)->applyFromArray($style_row);
		$sheet->getStyle('M' . $row)->applyFromArray($style_row);
		$sheet->getStyle('N' . $row)->applyFromArray($style_row);
		$sheet->getStyle('O' . $row)->applyFromArray($style_row);
		$sheet->getStyle('P' . $row)->applyFromArray($style_row);
		$sheet->getStyle('Q' . $row)->applyFromArray($style_row);
		$sheet->getStyle('R' . $row)->applyFromArray($style_row);
		$sheet->getStyle('S' . $row)->applyFromArray($style_row);
		$sheet->getStyle('T' . $row)->applyFromArray($style_row);
		$sheet->getStyle('U' . $row)->applyFromArray($style_row);
		$sheet->getStyle('V' . $row)->applyFromArray($style_row);
		$sheet->getStyle('W' . $row)->applyFromArray($style_row);
		$sheet->getStyle('X' . $row)->applyFromArray($style_row);
		$sheet->getStyle('Y' . $row)->applyFromArray($style_row);
		$sheet->getStyle('Z' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AA' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AB' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AC' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AD' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AE' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AF' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AG' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AH' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AI' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AJ' . $row)->applyFromArray($style_row);

		$sheet->getStyle('G' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('I' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('J' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('K' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('L' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('M' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('N' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('O' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('P' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('Q' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('R' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('S' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('T' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('U' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('V' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('W' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('X' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('Y' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('Z' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AA' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AB' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AC' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AD' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AE' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AF' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AG' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AH' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AI' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AJ' . $row)->getNumberFormat()->setFormatCode('#,##0');

		$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('I' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('J' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('K' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('L' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('M' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('N' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('O' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('P' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('Q' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('R' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('S' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('T' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('U' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('V' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('W' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('X' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('Y' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('Z' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AA' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AB' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AC' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AD' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AE' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AF' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AG' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AH' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AI' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AJ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

		$sheet->getStyle('A' . $row . ':AJ' . $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');
		$sheet->getStyle('A' . $row . ':AJ' . $row)->getFont()->setBold(true);

		$row++;

		$sheet->setCellValue('A' . $row, "");
		$sheet->setCellValue('B' . $row, "");
		$sheet->setCellValue('C' . $row, "");
		$sheet->setCellValue('D' . $row, "");
		$sheet->setCellValue('E' . $row, "TOTAL");
		$sheet->setCellValue('F' . $row, "");
		$sheet->setCellValue('G' . $row, $total_outlet_count);
		$sheet->setCellValue('H' . $row, "");
		$sheet->setCellValue('I' . $row, $total_qty_jan);
		$sheet->setCellValue('J' . $row, $total_val_jan);
		$sheet->setCellValue('K' . $row, $total_qty_feb);
		$sheet->setCellValue('L' . $row, $total_val_feb);
		$sheet->setCellValue('M' . $row, $total_qty_mar);
		$sheet->setCellValue('N' . $row, $total_val_mar);
		$sheet->setCellValue('O' . $row, $total_qty_apr);
		$sheet->setCellValue('P' . $row, $total_val_apr);
		$sheet->setCellValue('Q' . $row, $total_qty_mei);
		$sheet->setCellValue('R' . $row, $total_val_mei);
		$sheet->setCellValue('S' . $row, $total_qty_jun);
		$sheet->setCellValue('T' . $row, $total_val_jun);
		$sheet->setCellValue('U' . $row, $total_qty_jul);
		$sheet->setCellValue('V' . $row, $total_val_jul);
		$sheet->setCellValue('W' . $row, $total_qty_agu);
		$sheet->setCellValue('X' . $row, $total_val_agu);
		$sheet->setCellValue('Y' . $row, $total_qty_sep);
		$sheet->setCellValue('Z' . $row, $total_val_sep);
		$sheet->setCellValue('AA' . $row, $total_qty_okt);
		$sheet->setCellValue('AB' . $row, $total_val_okt);
		$sheet->setCellValue('AC' . $row, $total_qty_nop);
		$sheet->setCellValue('AD' . $row, $total_val_nop);
		$sheet->setCellValue('AE' . $row, $total_qty_des);
		$sheet->setCellValue('AF' . $row, $total_val_des);
		$sheet->setCellValue('AG' . $row, $total_qty_year_now);
		$sheet->setCellValue('AH' . $row, $total_val_year_now);
		$sheet->setCellValue('AI' . $row, $total_qty_year_old);
		$sheet->setCellValue('AJ' . $row, $total_val_year_old);

		// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
		$sheet->getStyle('A' . $row)->applyFromArray($style_row);
		$sheet->getStyle('B' . $row)->applyFromArray($style_row);
		$sheet->getStyle('C' . $row)->applyFromArray($style_row);
		$sheet->getStyle('D' . $row)->applyFromArray($style_row);
		$sheet->getStyle('E' . $row)->applyFromArray($style_row);
		$sheet->getStyle('F' . $row)->applyFromArray($style_row);
		$sheet->getStyle('G' . $row)->applyFromArray($style_row);
		$sheet->getStyle('H' . $row)->applyFromArray($style_row);
		$sheet->getStyle('I' . $row)->applyFromArray($style_row);
		$sheet->getStyle('J' . $row)->applyFromArray($style_row);
		$sheet->getStyle('K' . $row)->applyFromArray($style_row);
		$sheet->getStyle('L' . $row)->applyFromArray($style_row);
		$sheet->getStyle('M' . $row)->applyFromArray($style_row);
		$sheet->getStyle('N' . $row)->applyFromArray($style_row);
		$sheet->getStyle('O' . $row)->applyFromArray($style_row);
		$sheet->getStyle('P' . $row)->applyFromArray($style_row);
		$sheet->getStyle('Q' . $row)->applyFromArray($style_row);
		$sheet->getStyle('R' . $row)->applyFromArray($style_row);
		$sheet->getStyle('S' . $row)->applyFromArray($style_row);
		$sheet->getStyle('T' . $row)->applyFromArray($style_row);
		$sheet->getStyle('U' . $row)->applyFromArray($style_row);
		$sheet->getStyle('V' . $row)->applyFromArray($style_row);
		$sheet->getStyle('W' . $row)->applyFromArray($style_row);
		$sheet->getStyle('X' . $row)->applyFromArray($style_row);
		$sheet->getStyle('Y' . $row)->applyFromArray($style_row);
		$sheet->getStyle('Z' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AA' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AB' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AC' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AD' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AE' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AF' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AG' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AH' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AI' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AJ' . $row)->applyFromArray($style_row);

		$sheet->getStyle('G' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('I' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('J' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('K' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('L' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('M' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('N' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('O' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('P' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('Q' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('R' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('S' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('T' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('U' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('V' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('W' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('X' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('Y' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('Z' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AA' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AB' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AC' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AD' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AE' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AF' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AG' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AH' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AI' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AJ' . $row)->getNumberFormat()->setFormatCode('#,##0');

		$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('I' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('J' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('K' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('L' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('M' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('N' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('O' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('P' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('Q' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('R' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('S' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('T' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('U' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('V' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('W' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('X' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('Y' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('Z' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AA' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AB' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AC' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AD' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AE' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AF' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AG' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AH' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AI' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AJ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

		$sheet->getStyle('A' . $row . ':AJ' . $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFA07A');
		$sheet->getStyle('A' . $row . ':AJ' . $row)->getFont()->setBold(true);

		$sheet->getColumnDimension('A')->setWidth(7); // Set width kolom A
		$sheet->getColumnDimension('B')->setWidth(20);
		$sheet->getColumnDimension('C')->setWidth(15); // Set width kolom B
		$sheet->getColumnDimension('D')->setWidth(15); // Set width kolom C
		$sheet->getColumnDimension('E')->setWidth(60); // Set width kolom D
		$sheet->getColumnDimension('F')->setWidth(15);
		$sheet->getColumnDimension('G')->setWidth(15);
		$sheet->getColumnDimension('H')->setWidth(15);
		$sheet->getColumnDimension('I')->setWidth(10);
		$sheet->getColumnDimension('J')->setWidth(16);
		$sheet->getColumnDimension('K')->setWidth(10);
		$sheet->getColumnDimension('L')->setWidth(16);
		$sheet->getColumnDimension('M')->setWidth(10);
		$sheet->getColumnDimension('N')->setWidth(16);
		$sheet->getColumnDimension('O')->setWidth(10);
		$sheet->getColumnDimension('P')->setWidth(16);
		$sheet->getColumnDimension('Q')->setWidth(10);
		$sheet->getColumnDimension('R')->setWidth(16);
		$sheet->getColumnDimension('S')->setWidth(10);
		$sheet->getColumnDimension('T')->setWidth(16);
		$sheet->getColumnDimension('U')->setWidth(10);
		$sheet->getColumnDimension('V')->setWidth(16);
		$sheet->getColumnDimension('W')->setWidth(10);
		$sheet->getColumnDimension('X')->setWidth(16);
		$sheet->getColumnDimension('Y')->setWidth(10);
		$sheet->getColumnDimension('Z')->setWidth(16);
		$sheet->getColumnDimension('AA')->setWidth(10);
		$sheet->getColumnDimension('AB')->setWidth(16);
		$sheet->getColumnDimension('AC')->setWidth(10);
		$sheet->getColumnDimension('AD')->setWidth(16);
		$sheet->getColumnDimension('AE')->setWidth(10);
		$sheet->getColumnDimension('AF')->setWidth(16);
		$sheet->getColumnDimension('AG')->setWidth(10);
		$sheet->getColumnDimension('AH')->setWidth(16);
		$sheet->getColumnDimension('AI')->setWidth(10);
		$sheet->getColumnDimension('AJ')->setWidth(16);
		

		// Set orientasi kertas jadi LANDSCAPE
		$sheet->getPageSetup()->setOrientation(\PhpOffice\PhpSpreadsheet\Worksheet\PageSetup::ORIENTATION_LANDSCAPE);
		// Set judul file excel nya
		$sheet->setTitle("Selling Out - By Group Account");
		// Proses file excel
		header('Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet');
		header('Content-Disposition: attachment; filename="Report Selling Out - By Group Account ("' . $year . '").xlsx"'); // Set nama file excel nya
		header('Cache-Control: max-age=0');

		$writer = new Xlsx($spreadsheet);
		$writer->save('php://output');


	}

	public function export_sellingout_Account_Performance()
	{
		$spreadsheet = new Spreadsheet();
		$sheet = $spreadsheet->getActiveSheet();
		// Buat sebuah variabel untuk menampung pengaturan style dari header tabel
		$style_col = [
			'font' => ['bold' => true], // Set font nya jadi bold
			'alignment' => [
				'horizontal' => \PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER, // Set text jadi ditengah secara horizontal (center)
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'top' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border top dengan garis tipis
				'right' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN],  // Set border right dengan garis tipis
				'bottom' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border bottom dengan garis tipis
				'left' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN] // Set border left dengan garis tipis
			]
		];
		// Buat sebuah variabel untuk menampung pengaturan style dari isi tabel
		$style_row = [
			'alignment' => [
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'top' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border top dengan garis tipis
				'right' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN],  // Set border right dengan garis tipis
				'bottom' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border bottom dengan garis tipis
				'left' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN] // Set border left dengan garis tipis
			]
		];


		if (isset($_POST['by_principal']))
		{
			$principal = $_POST['by_principal'];
		}
		else
		{
			$principal = "";
		}

		if (isset($_POST['by_channel']))
		{
			$channel = $_POST['by_channel'];
		}
		else
		{
			$channel = "";
		}

		if (isset($_POST['by_outlet_type']))
		{
			$outlet_type = $_POST['by_outlet_type'];
		}
		else
		{
			$outlet_type = "";
		}

		if (isset($_POST['by_outlet_code']))
		{
			$outlet_code = $_POST['by_outlet_code'];
		}
		else
		{
			$outlet_code = "";
		}

		if (isset($_POST['by_area']))
		{
			$area = $_POST['by_area'];
		}
		else
		{
			$area = "";
		}
		
		if(isset($_POST['by_sku']))
		{
			$sku = $_POST['by_sku'];
		}else
		{
			$sku = "";
		}

		if (isset($_POST['by_year']))
		{
			$year = $_POST['by_year'];
		}
		else
		{
			$year = date('Y');
		}

		$old_year = $year - 1;

		$data['sku'] = $this->model('SkuModel')->getSkuByCode($sku);
		$item_name = $data['sku']['item_name'];
		$data['outlet'] = $this->model('ReportModel')->getOutletById($outlet_code);
		$outlet_name = $data['outlet']['cust_name'];

		$sheet->setCellValue('A1', "Report Selling Out - Group Account Performance (" . $year . ")"); // Set kolom A1 dengan tulisan "Report Selling In - By Outlet"
		$sheet->setCellValue('A2', "Principal : " . $principal); // Set kolom A2 dengan tulisan "Outlet Type : EC_EC"
		$sheet->setCellValue('A3', "Channel : " . $channel); // Set kolom A3 dengan tulisan "Outlet Type : EC_EC"
		$sheet->setCellValue('A4', "Outlet Type : " . $outlet_type);
		$sheet->setCellValue('D2', "Outlet : " . $outlet_name);
		$sheet->setCellValue('D3', "Area : " . $area);
		$sheet->setCellValue('D4', "SKU : " . $item_name);
		//$sheet->mergeCells('A1:F1'); // Set Merge Cell pada kolom A1 sampai F1
		$sheet->getStyle('A1')->getFont()->setBold(true); // Set bold kolom A1
		$sheet->getStyle('A2')->getFont()->setBold(true); // Set bold kolom A2
		$sheet->getStyle('A3')->getFont()->setBold(true); // Set bold kolom A3
		$sheet->getStyle('A4')->getFont()->setBold(true);
		$sheet->getStyle('D2')->getFont()->setBold(true);
		$sheet->getStyle('D3')->getFont()->setBold(true);
		$sheet->getStyle('D4')->getFont()->setBold(true);
		$sheet->getStyle('A1')->getFont()->setSize(20); // Set font size 15 untuk kolom A1
		// Buat header tabel nya pada baris ke 6
		$sheet->setCellValue('A6', "#"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('A6:A8'); // Set Merge Row pada kolom A6 sampai A8
		$sheet->setCellValue('B6', "Group Account"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('B6:B8');
		$sheet->setCellValue('C6', "Outlet Code"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('C6:C8'); // Set Merge Row pada kolom A6 sampai A8
		$sheet->setCellValue('D6', "BIG Code"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('D6:D8'); // Set Merge Row pada kolom A6 sampai A8
		$sheet->setCellValue('E6', "Outlet Name"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('E6:E8'); // Set Merge Row pada kolom A6 sampai A8
		$sheet->setCellValue('F6', "Outlet Type");
		$sheet->mergeCells('F6:F8');
		$sheet->setCellValue('G6', "Outlet Count");
		$sheet->mergeCells('G6:G8');
		$sheet->setCellValue('H6', "Area");
		$sheet->mergeCells('H6:H8');
		$sheet->setCellValue('I6', "Month");
		$sheet->mergeCells('I6:AR6');
		$sheet->setCellValue('AS6', "Total ".$year);
		$sheet->mergeCells('AS6:AU7');
		$sheet->setCellValue('AV6', "Total ".$old_year);
		$sheet->mergeCells('AV6:AX7');
		$sheet->setCellValue('I7', "January");
		$sheet->mergeCells('I7:K7');
		$sheet->setCellValue('L7', "February");
		$sheet->mergeCells('L7:N7');
		$sheet->setCellValue('O7', "March");
		$sheet->mergeCells('O7:Q7');
		$sheet->setCellValue('R7', "April");
		$sheet->mergeCells('R7:T7');
		$sheet->setCellValue('U7', "May");
		$sheet->mergeCells('U7:W7');
		$sheet->setCellValue('X7', "June");
		$sheet->mergeCells('X7:Z7');
		$sheet->setCellValue('AA7', "July");
		$sheet->mergeCells('AA7:AC7');
		$sheet->setCellValue('AD7', "August");
		$sheet->mergeCells('AD7:AF7');
		$sheet->setCellValue('AG7', "September");
		$sheet->mergeCells('AG7:AI7');
		$sheet->setCellValue('AJ7', "October");
		$sheet->mergeCells('AJ7:AL7');
		$sheet->setCellValue('AM7', "November");
		$sheet->mergeCells('AM7:AO7');
		$sheet->setCellValue('AP7', "December");
		$sheet->mergeCells('AP7:AR7');
		$sheet->setCellValue('I8', "Target");
		$sheet->setCellValue('J8', "Actual");
		$sheet->setCellValue('K8', "%");
		$sheet->setCellValue('L8', "Target");
		$sheet->setCellValue('M8', "Actual");
		$sheet->setCellValue('N8', "%");
		$sheet->setCellValue('O8', "Target");
		$sheet->setCellValue('P8', "Actual");
		$sheet->setCellValue('Q8', "%");
		$sheet->setCellValue('R8', "Target");
		$sheet->setCellValue('S8', "Actual");
		$sheet->setCellValue('T8', "%");
		$sheet->setCellValue('U8', "Target");
		$sheet->setCellValue('V8', "Actual");
		$sheet->setCellValue('W8', "%");
		$sheet->setCellValue('X8', "Target");
		$sheet->setCellValue('Y8', "Actual");
		$sheet->setCellValue('Z8', "%");
		$sheet->setCellValue('AA8', "Target");
		$sheet->setCellValue('AB8', "Actual");
		$sheet->setCellValue('AC8', "%");
		$sheet->setCellValue('AD8', "Target");
		$sheet->setCellValue('AE8', "Actual");
		$sheet->setCellValue('AF8', "%");
		$sheet->setCellValue('AG8', "Target");
		$sheet->setCellValue('AH8', "Actual");
		$sheet->setCellValue('AI8', "%");
		$sheet->setCellValue('AJ8', "Target");
		$sheet->setCellValue('AK8', "Actual");
		$sheet->setCellValue('AL8', "%");
		$sheet->setCellValue('AM8', "Target");
		$sheet->setCellValue('AN8', "Actual");
		$sheet->setCellValue('AO8', "%");
		$sheet->setCellValue('AP8', "Target");
		$sheet->setCellValue('AQ8', "Actual");
		$sheet->setCellValue('AR8', "%");
		$sheet->setCellValue('AS8', "Target");
		$sheet->setCellValue('AT8', "Actual");
		$sheet->setCellValue('AU8', "%");
		$sheet->setCellValue('AV8', "Target");
		$sheet->setCellValue('AW8', "Actual");
		$sheet->setCellValue('AX8', "%");

		// Apply style header yang telah kita buat tadi ke masing-masing kolom header
		$sheet->getStyle('A6')->applyFromArray($style_col);
		$sheet->getStyle('B6')->applyFromArray($style_col);
		$sheet->getStyle('C6')->applyFromArray($style_col);
		$sheet->getStyle('D6')->applyFromArray($style_col);
		$sheet->getStyle('E6')->applyFromArray($style_col);
		$sheet->getStyle('F6')->applyFromArray($style_col);
		$sheet->getStyle('G6')->applyFromArray($style_col);
		$sheet->getStyle('H6')->applyFromArray($style_col);
		$sheet->getStyle('I6')->applyFromArray($style_col);
		$sheet->getStyle('J6')->applyFromArray($style_col);
		$sheet->getStyle('K6')->applyFromArray($style_col);
		$sheet->getStyle('L6')->applyFromArray($style_col);
		$sheet->getStyle('M6')->applyFromArray($style_col);
		$sheet->getStyle('N6')->applyFromArray($style_col);
		$sheet->getStyle('O6')->applyFromArray($style_col);
		$sheet->getStyle('P6')->applyFromArray($style_col);
		$sheet->getStyle('Q6')->applyFromArray($style_col);
		$sheet->getStyle('R6')->applyFromArray($style_col);
		$sheet->getStyle('S6')->applyFromArray($style_col);
		$sheet->getStyle('T6')->applyFromArray($style_col);
		$sheet->getStyle('U6')->applyFromArray($style_col);
		$sheet->getStyle('V6')->applyFromArray($style_col);
		$sheet->getStyle('W6')->applyFromArray($style_col);
		$sheet->getStyle('X6')->applyFromArray($style_col);
		$sheet->getStyle('Y6')->applyFromArray($style_col);
		$sheet->getStyle('Z6')->applyFromArray($style_col);
		$sheet->getStyle('AA6')->applyFromArray($style_col);
		$sheet->getStyle('AB6')->applyFromArray($style_col);
		$sheet->getStyle('AC6')->applyFromArray($style_col);
		$sheet->getStyle('AD6')->applyFromArray($style_col);
		$sheet->getStyle('AE6')->applyFromArray($style_col);
		$sheet->getStyle('AF6')->applyFromArray($style_col);
		$sheet->getStyle('AG6')->applyFromArray($style_col);
		$sheet->getStyle('AH6')->applyFromArray($style_col);
		$sheet->getStyle('AI6')->applyFromArray($style_col);
		$sheet->getStyle('AJ6')->applyFromArray($style_col);
		$sheet->getStyle('AK6')->applyFromArray($style_col);
		$sheet->getStyle('AL6')->applyFromArray($style_col);
		$sheet->getStyle('AM6')->applyFromArray($style_col);
		$sheet->getStyle('AN6')->applyFromArray($style_col);
		$sheet->getStyle('AO6')->applyFromArray($style_col);
		$sheet->getStyle('AP6')->applyFromArray($style_col);
		$sheet->getStyle('AQ6')->applyFromArray($style_col);
		$sheet->getStyle('AR6')->applyFromArray($style_col);
		$sheet->getStyle('AS6')->applyFromArray($style_col);
		$sheet->getStyle('AT6')->applyFromArray($style_col);
		$sheet->getStyle('AU6')->applyFromArray($style_col);
		$sheet->getStyle('AV6')->applyFromArray($style_col);
		$sheet->getStyle('AW6')->applyFromArray($style_col);
		$sheet->getStyle('AX6')->applyFromArray($style_col);
		$sheet->getStyle('A7')->applyFromArray($style_col);
		$sheet->getStyle('B7')->applyFromArray($style_col);
		$sheet->getStyle('C7')->applyFromArray($style_col);
		$sheet->getStyle('D7')->applyFromArray($style_col);
		$sheet->getStyle('E7')->applyFromArray($style_col);
		$sheet->getStyle('F7')->applyFromArray($style_col);
		$sheet->getStyle('G7')->applyFromArray($style_col);
		$sheet->getStyle('H7')->applyFromArray($style_col);
		$sheet->getStyle('I7')->applyFromArray($style_col);
		$sheet->getStyle('J7')->applyFromArray($style_col);
		$sheet->getStyle('K7')->applyFromArray($style_col);
		$sheet->getStyle('L7')->applyFromArray($style_col);
		$sheet->getStyle('M7')->applyFromArray($style_col);
		$sheet->getStyle('N7')->applyFromArray($style_col);
		$sheet->getStyle('O7')->applyFromArray($style_col);
		$sheet->getStyle('P7')->applyFromArray($style_col);
		$sheet->getStyle('Q7')->applyFromArray($style_col);
		$sheet->getStyle('R7')->applyFromArray($style_col);
		$sheet->getStyle('S7')->applyFromArray($style_col);
		$sheet->getStyle('T7')->applyFromArray($style_col);
		$sheet->getStyle('U7')->applyFromArray($style_col);
		$sheet->getStyle('V7')->applyFromArray($style_col);
		$sheet->getStyle('W7')->applyFromArray($style_col);
		$sheet->getStyle('X7')->applyFromArray($style_col);
		$sheet->getStyle('Y7')->applyFromArray($style_col);
		$sheet->getStyle('Z7')->applyFromArray($style_col);
		$sheet->getStyle('AA7')->applyFromArray($style_col);
		$sheet->getStyle('AB7')->applyFromArray($style_col);
		$sheet->getStyle('AC7')->applyFromArray($style_col);
		$sheet->getStyle('AD7')->applyFromArray($style_col);
		$sheet->getStyle('AE7')->applyFromArray($style_col);
		$sheet->getStyle('AF7')->applyFromArray($style_col);
		$sheet->getStyle('AG7')->applyFromArray($style_col);
		$sheet->getStyle('AH7')->applyFromArray($style_col);
		$sheet->getStyle('AI7')->applyFromArray($style_col);
		$sheet->getStyle('AJ7')->applyFromArray($style_col);
		$sheet->getStyle('AK7')->applyFromArray($style_col);
		$sheet->getStyle('AL7')->applyFromArray($style_col);
		$sheet->getStyle('AM7')->applyFromArray($style_col);
		$sheet->getStyle('AN7')->applyFromArray($style_col);
		$sheet->getStyle('AO7')->applyFromArray($style_col);
		$sheet->getStyle('AP7')->applyFromArray($style_col);
		$sheet->getStyle('AQ7')->applyFromArray($style_col);
		$sheet->getStyle('AR7')->applyFromArray($style_col);
		$sheet->getStyle('AS7')->applyFromArray($style_col);
		$sheet->getStyle('AT7')->applyFromArray($style_col);
		$sheet->getStyle('AU7')->applyFromArray($style_col);
		$sheet->getStyle('AV7')->applyFromArray($style_col);
		$sheet->getStyle('AW7')->applyFromArray($style_col);
		$sheet->getStyle('AX7')->applyFromArray($style_col);
		$sheet->getStyle('A8')->applyFromArray($style_col);
		$sheet->getStyle('B8')->applyFromArray($style_col);
		$sheet->getStyle('C8')->applyFromArray($style_col);
		$sheet->getStyle('D8')->applyFromArray($style_col);
		$sheet->getStyle('E8')->applyFromArray($style_col);
		$sheet->getStyle('F8')->applyFromArray($style_col);
		$sheet->getStyle('G8')->applyFromArray($style_col);
		$sheet->getStyle('H8')->applyFromArray($style_col);
		$sheet->getStyle('I8')->applyFromArray($style_col);
		$sheet->getStyle('J8')->applyFromArray($style_col);
		$sheet->getStyle('K8')->applyFromArray($style_col);
		$sheet->getStyle('L8')->applyFromArray($style_col);
		$sheet->getStyle('M8')->applyFromArray($style_col);
		$sheet->getStyle('N8')->applyFromArray($style_col);
		$sheet->getStyle('O8')->applyFromArray($style_col);
		$sheet->getStyle('P8')->applyFromArray($style_col);
		$sheet->getStyle('Q8')->applyFromArray($style_col);
		$sheet->getStyle('R8')->applyFromArray($style_col);
		$sheet->getStyle('S8')->applyFromArray($style_col);
		$sheet->getStyle('T8')->applyFromArray($style_col);
		$sheet->getStyle('U8')->applyFromArray($style_col);
		$sheet->getStyle('V8')->applyFromArray($style_col);
		$sheet->getStyle('W8')->applyFromArray($style_col);
		$sheet->getStyle('X8')->applyFromArray($style_col);
		$sheet->getStyle('Y8')->applyFromArray($style_col);
		$sheet->getStyle('Z8')->applyFromArray($style_col);
		$sheet->getStyle('AA8')->applyFromArray($style_col);
		$sheet->getStyle('AB8')->applyFromArray($style_col);
		$sheet->getStyle('AC8')->applyFromArray($style_col);
		$sheet->getStyle('AD8')->applyFromArray($style_col);
		$sheet->getStyle('AE8')->applyFromArray($style_col);
		$sheet->getStyle('AF8')->applyFromArray($style_col);
		$sheet->getStyle('AG8')->applyFromArray($style_col);
		$sheet->getStyle('AH8')->applyFromArray($style_col);
		$sheet->getStyle('AI8')->applyFromArray($style_col);
		$sheet->getStyle('AJ8')->applyFromArray($style_col);
		$sheet->getStyle('AK8')->applyFromArray($style_col);
		$sheet->getStyle('AL8')->applyFromArray($style_col);
		$sheet->getStyle('AM8')->applyFromArray($style_col);
		$sheet->getStyle('AN8')->applyFromArray($style_col);
		$sheet->getStyle('AO8')->applyFromArray($style_col);
		$sheet->getStyle('AP8')->applyFromArray($style_col);
		$sheet->getStyle('AQ8')->applyFromArray($style_col);
		$sheet->getStyle('AR8')->applyFromArray($style_col);
		$sheet->getStyle('AS8')->applyFromArray($style_col);
		$sheet->getStyle('AT8')->applyFromArray($style_col);
		$sheet->getStyle('AU8')->applyFromArray($style_col);
		$sheet->getStyle('AV8')->applyFromArray($style_col);
		$sheet->getStyle('AW8')->applyFromArray($style_col);
		$sheet->getStyle('AX8')->applyFromArray($style_col);

		$sheet->getStyle('A6:AR8')->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');
		$sheet->getStyle('AS6:AX8')->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFA07A');

		// Set height baris ke 1, 2 dan 3
		$sheet->getRowDimension('1')->setRowHeight(40);
		$sheet->getRowDimension('2')->setRowHeight(20);
		$sheet->getRowDimension('3')->setRowHeight(20);
		$sheet->getRowDimension('4')->setRowHeight(20);

		$no = 1; // Untuk penomoran tabel, di awal set dengan 1
		$row = 9;

		$data['sellingout_account_performance'] = $this->model('ReportModel')->getSellingOut_Account_performance();

		$group_account = '';
		$outlet_count = 0;
		$total_outlet_count = 0;

		$target_jan = 0;
		$target_feb = 0;
		$target_mar = 0;
		$target_apr = 0;
		$target_mei = 0;
		$target_jun = 0;
		$target_jul = 0;
		$target_agu = 0;
		$target_sep = 0;
		$target_okt = 0;
		$target_nop = 0;
		$target_des = 0;
		$target_year_now = 0;
		$target_year_old = 0;

		$val_jan = 0;
		$val_feb = 0;
		$val_mar = 0;
		$val_apr = 0;
		$val_mei = 0;
		$val_jun = 0;
		$val_jul = 0;
		$val_agu = 0;
		$val_sep = 0;
		$val_okt = 0;
		$val_nop = 0;
		$val_des = 0;
		$val_year_now = 0;
		$val_year_old = 0;

		$p_jan = 0;
		$p_feb = 0;
		$p_mar = 0;
		$p_apr = 0;
		$p_mei = 0;
		$p_jun = 0;
		$p_jul = 0;
		$p_agu = 0;
		$p_sep = 0;
		$p_okt = 0;
		$p_nop = 0;
		$p_des = 0;
		$p_year_now = 0;
		$p_year_old = 0;

		$total_target_jan = 0;
		$total_target_feb = 0;
		$total_target_mar = 0;
		$total_target_apr = 0;
		$total_target_mei = 0;
		$total_target_jun = 0;
		$total_target_jul = 0;
		$total_target_agu = 0;
		$total_target_sep = 0;
		$total_target_okt = 0;
		$total_target_nop = 0;
		$total_target_des = 0;
		$total_target_year_now = 0;
		$total_target_year_old = 0;

		$total_val_jan = 0;
		$total_val_feb = 0;
		$total_val_mar = 0;
		$total_val_apr = 0;
		$total_val_mei = 0;
		$total_val_jun = 0;
		$total_val_jul = 0;
		$total_val_agu = 0;
		$total_val_sep = 0;
		$total_val_okt = 0;
		$total_val_nop = 0;
		$total_val_des = 0;
		$total_val_year_now = 0;
		$total_val_year_old = 0;

		$total_p_jan = 0;
		$total_p_feb = 0;
		$total_p_mar = 0;
		$total_p_apr = 0;
		$total_p_mei = 0;
		$total_p_jun = 0;
		$total_p_jul = 0;
		$total_p_agu = 0;
		$total_p_sep = 0;
		$total_p_okt = 0;
		$total_p_nop = 0;
		$total_p_des = 0;
		$total_p_year_now = 0;
		$total_p_year_old = 0;

		function persen($val, $target) {
			$val = (float)$val;
			$target = (float)$target;

			return ($target > 0) ? number_format(($val / $target) * 100, 0) : 0;
		}

		foreach ($data['sellingout_account_performance'] as $rows) :

			if ($group_account != $rows['group_account'] and $group_account != '' )
			{
				$sheet->setCellValue('A' . $row, "");
				$sheet->setCellValue('B' . $row, "");
				$sheet->setCellValue('C' . $row, "");
				$sheet->setCellValue('D' . $row, "");
				$sheet->setCellValue('E' . $row, $group_account);
				$sheet->setCellValue('F' . $row, "");
				$sheet->setCellValue('G' . $row, $outlet_count);
				$sheet->setCellValue('H' . $row, "");
				$sheet->setCellValue('I' . $row, $target_jan);
				$sheet->setCellValue('J' . $row, $val_jan);
				$sheet->setCellValue('K' . $row, $p_jan);
				$sheet->setCellValue('L' . $row, $target_feb);
				$sheet->setCellValue('M' . $row, $val_feb);
				$sheet->setCellValue('N' . $row, $p_feb);
				$sheet->setCellValue('O' . $row, $target_mar);
				$sheet->setCellValue('P' . $row, $val_mar);
				$sheet->setCellValue('Q' . $row, $p_mar);
				$sheet->setCellValue('R' . $row, $target_apr);
				$sheet->setCellValue('S' . $row, $val_apr);
				$sheet->setCellValue('T' . $row, $p_apr);
				$sheet->setCellValue('U' . $row, $target_mei);
				$sheet->setCellValue('V' . $row, $val_mei);
				$sheet->setCellValue('W' . $row, $p_mei);
				$sheet->setCellValue('X' . $row, $target_jun);
				$sheet->setCellValue('Y' . $row, $val_jun);
				$sheet->setCellValue('Z' . $row, $p_jun);
				$sheet->setCellValue('AA' . $row, $target_jul);
				$sheet->setCellValue('AB' . $row, $val_jul);
				$sheet->setCellValue('AC' . $row, $p_jul);
				$sheet->setCellValue('AD' . $row, $target_agu);
				$sheet->setCellValue('AE' . $row, $val_agu);
				$sheet->setCellValue('AF' . $row, $p_agu);
				$sheet->setCellValue('AG' . $row, $target_sep);
				$sheet->setCellValue('AH' . $row, $val_sep);
				$sheet->setCellValue('AI' . $row, $p_sep);
				$sheet->setCellValue('AJ' . $row, $target_okt);
				$sheet->setCellValue('AK' . $row, $val_okt);
				$sheet->setCellValue('AL' . $row, $p_okt);
				$sheet->setCellValue('AM' . $row, $target_nop);
				$sheet->setCellValue('AN' . $row, $val_nop);
				$sheet->setCellValue('AO' . $row, $p_nop);
				$sheet->setCellValue('AP' . $row, $target_des);
				$sheet->setCellValue('AQ' . $row, $val_des);
				$sheet->setCellValue('AR' . $row, $p_des);
				$sheet->setCellValue('AS' . $row, $target_year_now);
				$sheet->setCellValue('AT' . $row, $val_year_now);
				$sheet->setCellValue('AU' . $row, $p_year_now);
				$sheet->setCellValue('AV' . $row, $target_year_old);
				$sheet->setCellValue('AW' . $row, $val_year_old);
				$sheet->setCellValue('AX' . $row, $p_year_old);

				// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
				$sheet->getStyle('A' . $row)->applyFromArray($style_row);
				$sheet->getStyle('B' . $row)->applyFromArray($style_row);
				$sheet->getStyle('C' . $row)->applyFromArray($style_row);
				$sheet->getStyle('D' . $row)->applyFromArray($style_row);
				$sheet->getStyle('E' . $row)->applyFromArray($style_row);
				$sheet->getStyle('F' . $row)->applyFromArray($style_row);
				$sheet->getStyle('G' . $row)->applyFromArray($style_row);
				$sheet->getStyle('H' . $row)->applyFromArray($style_row);
				$sheet->getStyle('I' . $row)->applyFromArray($style_row);
				$sheet->getStyle('J' . $row)->applyFromArray($style_row);
				$sheet->getStyle('K' . $row)->applyFromArray($style_row);
				$sheet->getStyle('L' . $row)->applyFromArray($style_row);
				$sheet->getStyle('M' . $row)->applyFromArray($style_row);
				$sheet->getStyle('N' . $row)->applyFromArray($style_row);
				$sheet->getStyle('O' . $row)->applyFromArray($style_row);
				$sheet->getStyle('P' . $row)->applyFromArray($style_row);
				$sheet->getStyle('Q' . $row)->applyFromArray($style_row);
				$sheet->getStyle('R' . $row)->applyFromArray($style_row);
				$sheet->getStyle('S' . $row)->applyFromArray($style_row);
				$sheet->getStyle('T' . $row)->applyFromArray($style_row);
				$sheet->getStyle('U' . $row)->applyFromArray($style_row);
				$sheet->getStyle('V' . $row)->applyFromArray($style_row);
				$sheet->getStyle('W' . $row)->applyFromArray($style_row);
				$sheet->getStyle('X' . $row)->applyFromArray($style_row);
				$sheet->getStyle('Y' . $row)->applyFromArray($style_row);
				$sheet->getStyle('Z' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AA' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AB' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AC' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AD' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AE' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AF' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AG' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AH' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AI' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AJ' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AK' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AL' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AM' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AN' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AO' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AP' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AQ' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AR' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AS' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AT' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AU' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AV' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AW' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AX' . $row)->applyFromArray($style_row);

				$sheet->getStyle('G' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('I' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('J' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('K' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('L' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('M' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('N' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('O' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('P' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('Q' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('R' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('S' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('T' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('U' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('V' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('W' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('X' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('Y' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('Z' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('AA' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('AB' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('AC' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('AD' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('AE' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('AF' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('AG' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('AH' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('AI' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('AJ' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('AK' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('AL' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('AM' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('AN' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('AO' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('AP' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('AQ' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('AR' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('AS' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('AT' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('AU' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('AV' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('AW' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('AX' . $row)->getNumberFormat()->setFormatCode('#,##0');

				$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
				$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
				$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
				$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
				$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
				$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
				$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
				$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
				$sheet->getStyle('I' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('J' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('K' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('L' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('M' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('N' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('O' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('P' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('Q' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('R' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('S' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('T' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('U' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('V' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('W' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('X' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('Y' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('Z' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AA' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AB' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AC' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AD' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AE' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AF' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AG' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AH' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AI' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AJ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AK' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AL' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AM' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AN' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AO' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AP' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AQ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AR' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AS' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AT' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AU' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AV' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AW' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AX' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

				$sheet->getStyle('A' . $row . ':AX' . $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');
				$sheet->getStyle('A' . $row . ':AX' . $row)->getFont()->setBold(true);

				$outlet_count = 0;

				$target_jan = 0;
				$target_feb = 0;
				$target_mar = 0;
				$target_apr = 0;
				$target_mei = 0;
				$target_jun = 0;
				$target_jul = 0;
				$target_agu = 0;
				$target_sep = 0;
				$target_okt = 0;
				$target_nop = 0;
				$target_des = 0;
				$target_year_now = 0;
				$target_year_old = 0;

				$val_jan = 0;
				$val_feb = 0;
				$val_mar = 0;
				$val_apr = 0;
				$val_mei = 0;
				$val_jun = 0;
				$val_jul = 0;
				$val_agu = 0;
				$val_sep = 0;
				$val_okt = 0;
				$val_nop = 0;
				$val_des = 0;
				$val_year_now = 0;
				$val_year_old = 0;

				$p_jan = 0;
				$p_feb = 0;
				$p_mar = 0;
				$p_apr = 0;
				$p_mei = 0;
				$p_jun = 0;
				$p_jul = 0;
				$p_agu = 0;
				$p_sep = 0;
				$p_okt = 0;
				$p_nop = 0;
				$p_des = 0;
				$p_year_now = 0;
				$p_year_old = 0;

				$row++;

			}

			$sheet->setCellValue('A' . $row, $no);
			$sheet->setCellValue('B' . $row, $rows['group_account']);
    		$sheet->setCellValue('C' . $row, $rows['cust_code']);
			$sheet->setCellValue('D' . $row, $rows['big_code']);
			$sheet->setCellValue('E' . $row, $rows['cust_name']);
			$sheet->setCellValue('F' . $row, $rows['outlet_type']);
			$sheet->setCellValue('G' . $row, $rows['outlet_count']);
			$sheet->setCellValue('H' . $row, $rows['area']);
			$sheet->setCellValue('I' . $row, $rows['target_jan']);
			$sheet->setCellValue('J' . $row, $rows['val_jan']);
			$sheet->setCellValue('K' . $row, persen($rows['val_jan'], $rows['target_jan']));
			$sheet->setCellValue('L' . $row, $rows['target_feb']);
			$sheet->setCellValue('M' . $row, $rows['val_feb']);
			$sheet->setCellValue('N' . $row, persen($rows['val_feb'], $rows['target_feb']));
			$sheet->setCellValue('O' . $row, $rows['target_mar']);
			$sheet->setCellValue('P' . $row, $rows['val_mar']);
			$sheet->setCellValue('Q' . $row, persen($rows['val_mar'], $rows['target_mar']));
			$sheet->setCellValue('R' . $row, $rows['target_apr']);
			$sheet->setCellValue('S' . $row, $rows['val_apr']);
			$sheet->setCellValue('T' . $row, persen($rows['val_apr'], $rows['target_apr']));
			$sheet->setCellValue('U' . $row, $rows['target_mei']);
			$sheet->setCellValue('V' . $row, $rows['val_mei']);
			$sheet->setCellValue('W' . $row, persen($rows['val_mei'], $rows['target_mei']));
			$sheet->setCellValue('X' . $row, $rows['target_jun']);
			$sheet->setCellValue('Y' . $row, $rows['val_jun']);
			$sheet->setCellValue('Z' . $row, persen($rows['val_jun'], $rows['target_jun']));
			$sheet->setCellValue('AA' . $row, $rows['target_jul']);
			$sheet->setCellValue('AB' . $row, $rows['val_jul']);
			$sheet->setCellValue('AC' . $row, persen($rows['val_jul'], $rows['target_jul']));
			$sheet->setCellValue('AD' . $row, $rows['target_agu']);
			$sheet->setCellValue('AE' . $row, $rows['val_agu']);
			$sheet->setCellValue('AF' . $row, persen($rows['val_agu'], $rows['target_agu']));
			$sheet->setCellValue('AG' . $row, $rows['target_sep']);
			$sheet->setCellValue('AH' . $row, $rows['val_sep']);
			$sheet->setCellValue('AI' . $row, persen($rows['val_sep'], $rows['target_sep']));
			$sheet->setCellValue('AJ' . $row, $rows['target_okt']);
			$sheet->setCellValue('AK' . $row, $rows['val_okt']);
			$sheet->setCellValue('AL' . $row, persen($rows['val_okt'], $rows['target_okt']));
			$sheet->setCellValue('AM' . $row, $rows['target_nop']);
			$sheet->setCellValue('AN' . $row, $rows['val_nop']);
			$sheet->setCellValue('AO' . $row, persen($rows['val_nop'], $rows['target_nop']));
			$sheet->setCellValue('AP' . $row, $rows['target_des']);
			$sheet->setCellValue('AQ' . $row, $rows['val_des']);
			$sheet->setCellValue('AR' . $row, persen($rows['val_des'], $rows['target_des']));
			$sheet->setCellValue('AS' . $row, $rows['target_year_now']);
			$sheet->setCellValue('AT' . $row, $rows['val_year_now']);
			$sheet->setCellValue('AU' . $row, persen($rows['val_year_now'], $rows['target_year_now']));
			$sheet->setCellValue('AV' . $row, $rows['target_year_old']);
			$sheet->setCellValue('AW' . $row, $rows['val_year_old']);
			$sheet->setCellValue('AX' . $row, persen($rows['val_year_old'], $rows['target_year_old']));

			$group_account = $rows['group_account'];
			$outlet_count += $rows['outlet_count'];
			$total_outlet_count += $rows['outlet_count'];

			$target_jan += $rows['target_jan'];
			$target_feb += $rows['target_feb'];
			$target_mar += $rows['target_mar'];
			$target_apr += $rows['target_apr'];
			$target_mei += $rows['target_mei'];
			$target_jun += $rows['target_jun'];
			$target_jul += $rows['target_jul'];
			$target_agu += $rows['target_agu'];
			$target_sep += $rows['target_sep'];
			$target_okt += $rows['target_okt'];
			$target_nop += $rows['target_nop'];
			$target_des += $rows['target_des'];
			$target_year_now += $rows['target_year_now'];
			$target_year_old += $rows['target_year_old'];

			$val_jan += $rows['val_jan'];
			$val_feb += $rows['val_feb'];
			$val_mar += $rows['val_mar'];
			$val_apr += $rows['val_apr'];
			$val_mei += $rows['val_mei'];
			$val_jun += $rows['val_jun'];
			$val_jul += $rows['val_jul'];
			$val_agu += $rows['val_agu'];
			$val_sep += $rows['val_sep'];
			$val_okt += $rows['val_okt'];
			$val_nop += $rows['val_nop'];
			$val_des += $rows['val_des'];
			$val_year_now += $rows['val_year_now'];
			$val_year_old += $rows['val_year_old'];

			$p_jan += persen($rows['val_jan'], $rows['target_jan']);
			$p_feb += persen($rows['val_feb'], $rows['target_feb']);
			$p_mar += persen($rows['val_mar'], $rows['target_mar']);
			$p_apr += persen($rows['val_apr'], $rows['target_apr']);
			$p_mei += persen($rows['val_mei'], $rows['target_mei']);
			$p_jun += persen($rows['val_jun'], $rows['target_jun']);
			$p_jul += persen($rows['val_jul'], $rows['target_jul']);
			$p_agu += persen($rows['val_agu'], $rows['target_agu']);
			$p_sep += persen($rows['val_sep'], $rows['target_sep']);
			$p_okt += persen($rows['val_okt'], $rows['target_okt']);
			$p_nop += persen($rows['val_nop'], $rows['target_nop']);
			$p_des += persen($rows['val_des'], $rows['target_des']);
			$p_year_now += persen($rows['val_year_now'], $rows['target_year_now']);
			$p_year_old += persen($rows['val_year_old'], $rows['target_year_old']);

			$total_target_jan += $rows['target_jan'];
			$total_target_feb += $rows['target_feb'];
			$total_target_mar += $rows['target_mar'];
			$total_target_apr += $rows['target_apr'];
			$total_target_mei += $rows['target_mei'];
			$total_target_jun += $rows['target_jun'];
			$total_target_jul += $rows['target_jul'];
			$total_target_agu += $rows['target_agu'];
			$total_target_sep += $rows['target_sep'];
			$total_target_okt += $rows['target_okt'];
			$total_target_nop += $rows['target_nop'];
			$total_target_des += $rows['target_des'];
			$total_target_year_now += $rows['target_year_now'];
			$total_target_year_old += $rows['target_year_old'];

			$total_val_jan += $rows['val_jan'];
			$total_val_feb += $rows['val_feb'];
			$total_val_mar += $rows['val_mar'];
			$total_val_apr += $rows['val_apr'];
			$total_val_mei += $rows['val_mei'];
			$total_val_jun += $rows['val_jun'];
			$total_val_jul += $rows['val_jul'];
			$total_val_agu += $rows['val_agu'];
			$total_val_sep += $rows['val_sep'];
			$total_val_okt += $rows['val_okt'];
			$total_val_nop += $rows['val_nop'];
			$total_val_des += $rows['val_des'];
			$total_val_year_now += $rows['val_year_now'];
			$total_val_year_old += $rows['val_year_old'];

			$total_p_jan += persen($rows['val_jan'], $rows['target_jan']);
			$total_p_feb += persen($rows['val_feb'], $rows['target_feb']);
			$total_p_mar += persen($rows['val_mar'], $rows['target_mar']);
			$total_p_apr += persen($rows['val_apr'], $rows['target_apr']);
			$total_p_mei += persen($rows['val_mei'], $rows['target_mei']);
			$total_p_jun += persen($rows['val_jun'], $rows['target_jun']);
			$total_p_jul += persen($rows['val_jul'], $rows['target_jul']);
			$total_p_agu += persen($rows['val_agu'], $rows['target_agu']);
			$total_p_sep += persen($rows['val_sep'], $rows['target_sep']);
			$total_p_okt += persen($rows['val_okt'], $rows['target_okt']);
			$total_p_nop += persen($rows['val_nop'], $rows['target_nop']);
			$total_p_des += persen($rows['val_des'], $rows['target_des']);
			$total_p_year_now += persen($rows['val_year_now'], $rows['target_year_now']);
			$total_p_year_old += persen($rows['val_year_old'], $rows['target_year_old']);

			// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
			$sheet->getStyle('A' . $row)->applyFromArray($style_row);
			$sheet->getStyle('B' . $row)->applyFromArray($style_row);
			$sheet->getStyle('C' . $row)->applyFromArray($style_row);
			$sheet->getStyle('D' . $row)->applyFromArray($style_row);
			$sheet->getStyle('E' . $row)->applyFromArray($style_row);
			$sheet->getStyle('F' . $row)->applyFromArray($style_row);
			$sheet->getStyle('G' . $row)->applyFromArray($style_row);
			$sheet->getStyle('H' . $row)->applyFromArray($style_row);
			$sheet->getStyle('I' . $row)->applyFromArray($style_row);
			$sheet->getStyle('J' . $row)->applyFromArray($style_row);
			$sheet->getStyle('K' . $row)->applyFromArray($style_row);
			$sheet->getStyle('L' . $row)->applyFromArray($style_row);
			$sheet->getStyle('M' . $row)->applyFromArray($style_row);
			$sheet->getStyle('N' . $row)->applyFromArray($style_row);
			$sheet->getStyle('O' . $row)->applyFromArray($style_row);
			$sheet->getStyle('P' . $row)->applyFromArray($style_row);
			$sheet->getStyle('Q' . $row)->applyFromArray($style_row);
			$sheet->getStyle('R' . $row)->applyFromArray($style_row);
			$sheet->getStyle('S' . $row)->applyFromArray($style_row);
			$sheet->getStyle('T' . $row)->applyFromArray($style_row);
			$sheet->getStyle('U' . $row)->applyFromArray($style_row);
			$sheet->getStyle('V' . $row)->applyFromArray($style_row);
			$sheet->getStyle('W' . $row)->applyFromArray($style_row);
			$sheet->getStyle('X' . $row)->applyFromArray($style_row);
			$sheet->getStyle('Y' . $row)->applyFromArray($style_row);
			$sheet->getStyle('Z' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AA' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AB' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AC' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AD' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AE' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AF' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AG' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AH' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AI' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AJ' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AK' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AL' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AM' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AN' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AO' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AP' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AQ' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AR' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AS' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AT' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AU' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AV' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AW' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AX' . $row)->applyFromArray($style_row);

			$sheet->getStyle('G' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('I' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('J' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('K' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('L' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('M' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('N' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('O' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('P' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('Q' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('R' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('S' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('T' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('U' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('V' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('W' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('X' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('Y' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('Z' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('AA' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('AB' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('AC' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('AD' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('AE' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('AF' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('AG' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('AH' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('AI' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('AJ' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('AK' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('AL' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('AM' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('AN' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('AO' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('AP' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('AQ' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('AR' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('AS' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('AT' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('AU' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('AV' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('AW' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('AX' . $row)->getNumberFormat()->setFormatCode('#,##0');

			$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('I' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('J' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('K' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('L' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('M' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('N' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('O' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('P' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('Q' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('R' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('S' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('T' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('U' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('V' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('W' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('X' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('Y' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('Z' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AA' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AB' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AC' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AD' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AE' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AF' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AG' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AH' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AI' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AJ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AK' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AL' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AM' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AN' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AO' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AP' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AQ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AR' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AS' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AT' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AU' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AV' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AW' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AX' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

			$no++; // Tambah 1 setiap kali looping
    		$row++; // Tambah 1 setiap kali looping
		endforeach;

		$sheet->setCellValue('A' . $row, "");
		$sheet->setCellValue('B' . $row, "");
		$sheet->setCellValue('C' . $row, "");
		$sheet->setCellValue('D' . $row, "");
		$sheet->setCellValue('E' . $row, $group_account);
		$sheet->setCellValue('F' . $row, "");
		$sheet->setCellValue('G' . $row, $outlet_count);
		$sheet->setCellValue('H' . $row, "");
		$sheet->setCellValue('I' . $row, $target_jan);
		$sheet->setCellValue('J' . $row, $val_jan);
		$sheet->setCellValue('K' . $row, $p_jan);
		$sheet->setCellValue('L' . $row, $target_feb);
		$sheet->setCellValue('M' . $row, $val_feb);
		$sheet->setCellValue('N' . $row, $p_feb);
		$sheet->setCellValue('O' . $row, $target_mar);
		$sheet->setCellValue('P' . $row, $val_mar);
		$sheet->setCellValue('Q' . $row, $p_mar);
		$sheet->setCellValue('R' . $row, $target_apr);
		$sheet->setCellValue('S' . $row, $val_apr);
		$sheet->setCellValue('T' . $row, $p_apr);
		$sheet->setCellValue('U' . $row, $target_mei);
		$sheet->setCellValue('V' . $row, $val_mei);
		$sheet->setCellValue('W' . $row, $p_mei);
		$sheet->setCellValue('X' . $row, $target_jun);
		$sheet->setCellValue('Y' . $row, $val_jun);
		$sheet->setCellValue('Z' . $row, $p_jun);
		$sheet->setCellValue('AA' . $row, $target_jul);
		$sheet->setCellValue('AB' . $row, $val_jul);
		$sheet->setCellValue('AC' . $row, $p_jul);
		$sheet->setCellValue('AD' . $row, $target_agu);
		$sheet->setCellValue('AE' . $row, $val_agu);
		$sheet->setCellValue('AF' . $row, $p_agu);
		$sheet->setCellValue('AG' . $row, $target_sep);
		$sheet->setCellValue('AH' . $row, $val_sep);
		$sheet->setCellValue('AI' . $row, $p_sep);
		$sheet->setCellValue('AJ' . $row, $target_okt);
		$sheet->setCellValue('AK' . $row, $val_okt);
		$sheet->setCellValue('AL' . $row, $p_okt);
		$sheet->setCellValue('AM' . $row, $target_nop);
		$sheet->setCellValue('AN' . $row, $val_nop);
		$sheet->setCellValue('AO' . $row, $p_nop);
		$sheet->setCellValue('AP' . $row, $target_des);
		$sheet->setCellValue('AQ' . $row, $val_des);
		$sheet->setCellValue('AR' . $row, $p_des);
		$sheet->setCellValue('AS' . $row, $target_year_now);
		$sheet->setCellValue('AT' . $row, $val_year_now);
		$sheet->setCellValue('AU' . $row, $p_year_now);
		$sheet->setCellValue('AV' . $row, $target_year_old);
		$sheet->setCellValue('AW' . $row, $val_year_old);
		$sheet->setCellValue('AX' . $row, $p_year_old);

		// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
		$sheet->getStyle('A' . $row)->applyFromArray($style_row);
		$sheet->getStyle('B' . $row)->applyFromArray($style_row);
		$sheet->getStyle('C' . $row)->applyFromArray($style_row);
		$sheet->getStyle('D' . $row)->applyFromArray($style_row);
		$sheet->getStyle('E' . $row)->applyFromArray($style_row);
		$sheet->getStyle('F' . $row)->applyFromArray($style_row);
		$sheet->getStyle('G' . $row)->applyFromArray($style_row);
		$sheet->getStyle('H' . $row)->applyFromArray($style_row);
		$sheet->getStyle('I' . $row)->applyFromArray($style_row);
		$sheet->getStyle('J' . $row)->applyFromArray($style_row);
		$sheet->getStyle('K' . $row)->applyFromArray($style_row);
		$sheet->getStyle('L' . $row)->applyFromArray($style_row);
		$sheet->getStyle('M' . $row)->applyFromArray($style_row);
		$sheet->getStyle('N' . $row)->applyFromArray($style_row);
		$sheet->getStyle('O' . $row)->applyFromArray($style_row);
		$sheet->getStyle('P' . $row)->applyFromArray($style_row);
		$sheet->getStyle('Q' . $row)->applyFromArray($style_row);
		$sheet->getStyle('R' . $row)->applyFromArray($style_row);
		$sheet->getStyle('S' . $row)->applyFromArray($style_row);
		$sheet->getStyle('T' . $row)->applyFromArray($style_row);
		$sheet->getStyle('U' . $row)->applyFromArray($style_row);
		$sheet->getStyle('V' . $row)->applyFromArray($style_row);
		$sheet->getStyle('W' . $row)->applyFromArray($style_row);
		$sheet->getStyle('X' . $row)->applyFromArray($style_row);
		$sheet->getStyle('Y' . $row)->applyFromArray($style_row);
		$sheet->getStyle('Z' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AA' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AB' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AC' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AD' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AE' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AF' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AG' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AH' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AI' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AJ' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AK' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AL' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AM' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AN' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AO' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AP' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AQ' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AR' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AS' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AT' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AU' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AV' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AW' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AX' . $row)->applyFromArray($style_row);

		$sheet->getStyle('G' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('I' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('J' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('K' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('L' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('M' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('N' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('O' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('P' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('Q' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('R' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('S' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('T' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('U' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('V' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('W' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('X' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('Y' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('Z' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AA' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AB' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AC' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AD' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AE' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AF' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AG' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AH' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AI' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AJ' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AK' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AL' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AM' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AN' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AO' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AP' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AQ' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AR' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AS' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AT' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AU' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AV' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AW' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AX' . $row)->getNumberFormat()->setFormatCode('#,##0');

		$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('I' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('J' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('K' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('L' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('M' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('N' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('O' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('P' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('Q' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('R' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('S' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('T' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('U' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('V' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('W' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('X' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('Y' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('Z' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AA' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AB' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AC' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AD' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AE' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AF' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AG' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AH' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AI' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AJ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AK' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AL' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AM' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AN' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AO' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AP' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AQ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AR' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AS' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AT' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AU' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AV' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AW' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AX' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

		$sheet->getStyle('A' . $row . ':AX' . $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');
		$sheet->getStyle('A' . $row . ':AX' . $row)->getFont()->setBold(true);

		$row++;

		$sheet->setCellValue('A' . $row, "");
		$sheet->setCellValue('B' . $row, "");
		$sheet->setCellValue('C' . $row, "");
		$sheet->setCellValue('D' . $row, "");
		$sheet->setCellValue('E' . $row, "TOTAL");
		$sheet->setCellValue('F' . $row, "");
		$sheet->setCellValue('G' . $row, $total_outlet_count);
		$sheet->setCellValue('H' . $row, "");
		$sheet->setCellValue('I' . $row, $total_target_jan);
		$sheet->setCellValue('J' . $row, $total_val_jan);
		$sheet->setCellValue('K' . $row, $total_p_jan);
		$sheet->setCellValue('L' . $row, $total_target_feb);
		$sheet->setCellValue('M' . $row, $total_val_feb);
		$sheet->setCellValue('N' . $row, $total_p_feb);
		$sheet->setCellValue('O' . $row, $total_target_mar);
		$sheet->setCellValue('P' . $row, $total_val_mar);
		$sheet->setCellValue('Q' . $row, $total_p_mar);
		$sheet->setCellValue('R' . $row, $total_target_apr);
		$sheet->setCellValue('S' . $row, $total_val_apr);
		$sheet->setCellValue('T' . $row, $total_p_apr);
		$sheet->setCellValue('U' . $row, $total_target_mei);
		$sheet->setCellValue('V' . $row, $total_val_mei);
		$sheet->setCellValue('W' . $row, $total_p_mei);
		$sheet->setCellValue('X' . $row, $total_target_jun);
		$sheet->setCellValue('Y' . $row, $total_val_jun);
		$sheet->setCellValue('Z' . $row, $total_p_jun);
		$sheet->setCellValue('AA' . $row, $total_target_jul);
		$sheet->setCellValue('AB' . $row, $total_val_jul);
		$sheet->setCellValue('AC' . $row, $total_p_jul);
		$sheet->setCellValue('AD' . $row, $total_target_agu);
		$sheet->setCellValue('AE' . $row, $total_val_agu);
		$sheet->setCellValue('AF' . $row, $total_p_agu);
		$sheet->setCellValue('AG' . $row, $total_target_sep);
		$sheet->setCellValue('AH' . $row, $total_val_sep);
		$sheet->setCellValue('AI' . $row, $total_p_sep);
		$sheet->setCellValue('AJ' . $row, $total_target_okt);
		$sheet->setCellValue('AK' . $row, $total_val_okt);
		$sheet->setCellValue('AL' . $row, $total_p_okt);
		$sheet->setCellValue('AM' . $row, $total_target_nop);
		$sheet->setCellValue('AN' . $row, $total_val_nop);
		$sheet->setCellValue('AO' . $row, $total_p_nop);
		$sheet->setCellValue('AP' . $row, $total_target_des);
		$sheet->setCellValue('AQ' . $row, $total_val_des);
		$sheet->setCellValue('AR' . $row, $total_p_des);
		$sheet->setCellValue('AS' . $row, $total_target_year_now);
		$sheet->setCellValue('AT' . $row, $total_val_year_now);
		$sheet->setCellValue('AU' . $row, $total_p_year_now);
		$sheet->setCellValue('AV' . $row, $total_target_year_old);
		$sheet->setCellValue('AW' . $row, $total_val_year_old);
		$sheet->setCellValue('AX' . $row, $total_p_year_old);

		// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
		$sheet->getStyle('A' . $row)->applyFromArray($style_row);
		$sheet->getStyle('B' . $row)->applyFromArray($style_row);
		$sheet->getStyle('C' . $row)->applyFromArray($style_row);
		$sheet->getStyle('D' . $row)->applyFromArray($style_row);
		$sheet->getStyle('E' . $row)->applyFromArray($style_row);
		$sheet->getStyle('F' . $row)->applyFromArray($style_row);
		$sheet->getStyle('G' . $row)->applyFromArray($style_row);
		$sheet->getStyle('H' . $row)->applyFromArray($style_row);
		$sheet->getStyle('I' . $row)->applyFromArray($style_row);
		$sheet->getStyle('J' . $row)->applyFromArray($style_row);
		$sheet->getStyle('K' . $row)->applyFromArray($style_row);
		$sheet->getStyle('L' . $row)->applyFromArray($style_row);
		$sheet->getStyle('M' . $row)->applyFromArray($style_row);
		$sheet->getStyle('N' . $row)->applyFromArray($style_row);
		$sheet->getStyle('O' . $row)->applyFromArray($style_row);
		$sheet->getStyle('P' . $row)->applyFromArray($style_row);
		$sheet->getStyle('Q' . $row)->applyFromArray($style_row);
		$sheet->getStyle('R' . $row)->applyFromArray($style_row);
		$sheet->getStyle('S' . $row)->applyFromArray($style_row);
		$sheet->getStyle('T' . $row)->applyFromArray($style_row);
		$sheet->getStyle('U' . $row)->applyFromArray($style_row);
		$sheet->getStyle('V' . $row)->applyFromArray($style_row);
		$sheet->getStyle('W' . $row)->applyFromArray($style_row);
		$sheet->getStyle('X' . $row)->applyFromArray($style_row);
		$sheet->getStyle('Y' . $row)->applyFromArray($style_row);
		$sheet->getStyle('Z' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AA' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AB' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AC' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AD' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AE' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AF' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AG' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AH' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AI' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AJ' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AK' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AL' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AM' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AN' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AO' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AP' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AQ' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AR' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AS' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AT' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AU' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AV' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AW' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AX' . $row)->applyFromArray($style_row);

		$sheet->getStyle('G' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('H' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('I' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('J' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('K' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('L' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('M' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('N' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('O' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('P' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('Q' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('R' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('S' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('T' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('U' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('V' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('W' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('X' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('Y' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('Z' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AA' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AB' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AC' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AD' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AE' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AF' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AG' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AH' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AI' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AJ' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AK' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AL' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AM' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AN' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AO' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AP' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AQ' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AR' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AS' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AT' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AU' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AV' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AW' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AX' . $row)->getNumberFormat()->setFormatCode('#,##0');

		$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('I' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('J' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('K' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('L' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('M' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('N' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('O' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('P' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('Q' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('R' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('S' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('T' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('U' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('V' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('W' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('X' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('Y' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('Z' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AA' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AB' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AC' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AD' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AE' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AF' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AG' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AH' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AI' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AJ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AK' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AL' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AM' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AN' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AO' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AP' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AQ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AR' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AS' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AT' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AU' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AV' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AW' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AX' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

		$sheet->getStyle('A' . $row . ':AX' . $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFA07A');
		$sheet->getStyle('A' . $row . ':AX' . $row)->getFont()->setBold(true);

		$sheet->getColumnDimension('A')->setWidth(7); // Set width kolom A
		$sheet->getColumnDimension('B')->setWidth(20);
		$sheet->getColumnDimension('C')->setWidth(15); // Set width kolom B
		$sheet->getColumnDimension('D')->setWidth(15); // Set width kolom C
		$sheet->getColumnDimension('E')->setWidth(60); // Set width kolom D
		$sheet->getColumnDimension('F')->setWidth(15);
		$sheet->getColumnDimension('G')->setWidth(15);
		$sheet->getColumnDimension('H')->setWidth(15);
		$sheet->getColumnDimension('I')->setWidth(16);
		$sheet->getColumnDimension('J')->setWidth(16);
		$sheet->getColumnDimension('K')->setWidth(10);
		$sheet->getColumnDimension('L')->setWidth(16);
		$sheet->getColumnDimension('M')->setWidth(16);
		$sheet->getColumnDimension('N')->setWidth(10);
		$sheet->getColumnDimension('O')->setWidth(16);
		$sheet->getColumnDimension('P')->setWidth(16);
		$sheet->getColumnDimension('Q')->setWidth(10);
		$sheet->getColumnDimension('R')->setWidth(16);
		$sheet->getColumnDimension('S')->setWidth(16);
		$sheet->getColumnDimension('T')->setWidth(10);
		$sheet->getColumnDimension('U')->setWidth(16);
		$sheet->getColumnDimension('V')->setWidth(16);
		$sheet->getColumnDimension('W')->setWidth(10);
		$sheet->getColumnDimension('X')->setWidth(16);
		$sheet->getColumnDimension('Y')->setWidth(16);
		$sheet->getColumnDimension('Z')->setWidth(10);
		$sheet->getColumnDimension('AA')->setWidth(16);
		$sheet->getColumnDimension('AB')->setWidth(16);
		$sheet->getColumnDimension('AC')->setWidth(10);
		$sheet->getColumnDimension('AD')->setWidth(16);
		$sheet->getColumnDimension('AE')->setWidth(16);
		$sheet->getColumnDimension('AF')->setWidth(10);
		$sheet->getColumnDimension('AG')->setWidth(16);
		$sheet->getColumnDimension('AH')->setWidth(16);
		$sheet->getColumnDimension('AI')->setWidth(10);
		$sheet->getColumnDimension('AJ')->setWidth(16);
		$sheet->getColumnDimension('AK')->setWidth(16);
		$sheet->getColumnDimension('AL')->setWidth(10);
		$sheet->getColumnDimension('AM')->setWidth(16);
		$sheet->getColumnDimension('AN')->setWidth(16);
		$sheet->getColumnDimension('AO')->setWidth(10);
		$sheet->getColumnDimension('AP')->setWidth(16);
		$sheet->getColumnDimension('AQ')->setWidth(16);
		$sheet->getColumnDimension('AR')->setWidth(10);
		$sheet->getColumnDimension('AS')->setWidth(16);
		$sheet->getColumnDimension('AT')->setWidth(16);
		$sheet->getColumnDimension('AU')->setWidth(10);
		$sheet->getColumnDimension('AV')->setWidth(16);
		$sheet->getColumnDimension('AW')->setWidth(16);
		$sheet->getColumnDimension('AX')->setWidth(10);


		// Set orientasi kertas jadi LANDSCAPE
		$sheet->getPageSetup()->setOrientation(\PhpOffice\PhpSpreadsheet\Worksheet\PageSetup::ORIENTATION_LANDSCAPE);
		// Set judul file excel nya
		$sheet->setTitle("SO - Group Account Performance");
		// Proses file excel
		header('Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet');
		header('Content-Disposition: attachment; filename="Report Selling Out - Group Account Performance ("' . $year . '").xlsx"'); // Set nama file excel nya
		header('Cache-Control: max-age=0');

		$writer = new Xlsx($spreadsheet);
		$writer->save('php://output');


	}

	public function export_sellingout_growth_sku_exist()
	{
		$spreadsheet = new Spreadsheet();
		$sheet = $spreadsheet->getActiveSheet();
		// Buat sebuah variabel untuk menampung pengaturan style dari header tabel
		$style_col = [
			'font' => ['bold' => true], // Set font nya jadi bold
			'alignment' => [
				'horizontal' => \PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER, // Set text jadi ditengah secara horizontal (center)
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'top' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border top dengan garis tipis
				'right' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN],  // Set border right dengan garis tipis
				'bottom' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border bottom dengan garis tipis
				'left' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN] // Set border left dengan garis tipis
			]
		];
		// Buat sebuah variabel untuk menampung pengaturan style dari isi tabel
		$style_row = [
			'alignment' => [
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'top' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border top dengan garis tipis
				'right' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN],  // Set border right dengan garis tipis
				'bottom' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border bottom dengan garis tipis
				'left' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN] // Set border left dengan garis tipis
			]
		];


		if (isset($_POST['by_principal']))
		{
			$principal = $_POST['by_principal'];
		}
		else
		{
			$principal = "";
		}

		if (isset($_POST['by_channel']))
		{
			$channel = $_POST['by_channel'];
		}
		else
		{
			$channel = "";
		}

		if (isset($_POST['by_outlet_category']))
		{
			$outlet_category = $_POST['by_outlet_category'];
		}
		else
		{
			$outlet_category = "";
		}

		if (isset($_POST['by_outlet_type']))
		{
			$outlet_type = $_POST['by_outlet_type'];
		}
		else
		{
			$outlet_type = "";
		}

		if (isset($_POST['by_outlet_code']))
		{
			$outlet_code = $_POST['by_outlet_code'];
		}
		else
		{
			$outlet_code = "";
		}

		if (isset($_POST['by_area']))
		{
			$area = implode(',', $_POST['by_area']);
			$area = str_replace(",", "','", $area);;
		}
		else
		{
			$area = "";
		}

		if (isset($_POST['by_year']))
		{
			$year = $_POST['by_year'];
		}
		else
		{
			$year = date('Y');
		}

		$year_to = $year;
		$year_from = $year_to - 1;

		$sheet->setCellValue('A1', "Report Selling Out - Growth SKU Existing (" . $year . ")"); // Set kolom A1 dengan tulisan "Report Selling In - By Outlet"
		$sheet->setCellValue('A2', "Principal : " . $principal); // Set kolom A2 dengan tulisan "Outlet Type : EC_EC"
		$sheet->setCellValue('A3', "Channel : " . $channel); // Set kolom A3 dengan tulisan "Outlet Type : EC_EC"
		$sheet->setCellValue('A4', "Outlet Category : " . $outlet_category);
		$sheet->setCellValue('D2', "Outlet Type : " . $outlet_type);
		$sheet->setCellValue('D3', "Area : " . $area);
		//$sheet->mergeCells('A1:F1'); // Set Merge Cell pada kolom A1 sampai F1
		$sheet->getStyle('A1')->getFont()->setBold(true); // Set bold kolom A1
		$sheet->getStyle('A2')->getFont()->setBold(true); // Set bold kolom A2
		$sheet->getStyle('A3')->getFont()->setBold(true); // Set bold kolom A3
		$sheet->getStyle('A4')->getFont()->setBold(true);
		$sheet->getStyle('D2')->getFont()->setBold(true);
		$sheet->getStyle('D3')->getFont()->setBold(true);
		$sheet->getStyle('D4')->getFont()->setBold(true);
		$sheet->getStyle('A1')->getFont()->setSize(20); // Set font size 15 untuk kolom A1
		// Buat header tabel nya pada baris ke 6
		$sheet->setCellValue('A6', "#"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('A6:A7'); // Set Merge Row pada kolom A6 sampai A8
		$sheet->setCellValue('B6', "Outlet Type"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('B6:B7'); // Set Merge Row pada kolom A6 sampai A8
		$sheet->setCellValue('C6', "BIG Code"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('C6:C7'); // Set Merge Row pada kolom A6 sampai A8
		$sheet->setCellValue('D6', "Outlet Name"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('D6:D7'); // Set Merge Row pada kolom A6 sampai A8
		$sheet->setCellValue('E6', "Area");
		$sheet->mergeCells('E6:E7');
		$sheet->setCellValue('F6', "Item Code");
		$sheet->mergeCells('F6:F7');
		$sheet->setCellValue('G6', "SKU");
		$sheet->mergeCells('G6:G7');
		$sheet->setCellValue('H6', "Value");
		$sheet->mergeCells('H6:I6');

		$sheet->setCellValue('H7', $year_from);
		$sheet->setCellValue('I7', $year_to);

		// Apply style header yang telah kita buat tadi ke masing-masing kolom header
		$sheet->getStyle('A6')->applyFromArray($style_col);
		$sheet->getStyle('B6')->applyFromArray($style_col);
		$sheet->getStyle('C6')->applyFromArray($style_col);
		$sheet->getStyle('D6')->applyFromArray($style_col);
		$sheet->getStyle('E6')->applyFromArray($style_col);
		$sheet->getStyle('F6')->applyFromArray($style_col);
		$sheet->getStyle('G6')->applyFromArray($style_col);
		$sheet->getStyle('H6')->applyFromArray($style_col);
		$sheet->getStyle('I6')->applyFromArray($style_col);

		$sheet->getStyle('A7')->applyFromArray($style_col);
		$sheet->getStyle('B7')->applyFromArray($style_col);
		$sheet->getStyle('C7')->applyFromArray($style_col);
		$sheet->getStyle('D7')->applyFromArray($style_col);
		$sheet->getStyle('E7')->applyFromArray($style_col);
		$sheet->getStyle('F7')->applyFromArray($style_col);
		$sheet->getStyle('G7')->applyFromArray($style_col);
		$sheet->getStyle('H7')->applyFromArray($style_col);
		$sheet->getStyle('I7')->applyFromArray($style_col);
		

		$sheet->getStyle('A6:I7')->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');

		// Set height baris ke 1, 2 dan 3
		$sheet->getRowDimension('1')->setRowHeight(40);
		$sheet->getRowDimension('2')->setRowHeight(20);
		$sheet->getRowDimension('3')->setRowHeight(20);
		$sheet->getRowDimension('4')->setRowHeight(20);

		$big_code = '';
		$cust_name = '';

		$sub_value_from = 0;
		$sub_value_to = 0;

		$total_value_from = 0;
		$total_value_to = 0;

		$no = 1; // Untuk penomoran tabel, di awal set dengan 1
		$row = 8;

		$data1 = array(
			'principal' => $principal,
			'channel' => $channel,
			'outlet_category' => $outlet_type,
			'outlet_type' => $outlet_code,
			'area' => $area, 
			'year' => $year
		);

		//$data['sellingout_OT'] = $this->model('ReportModel')->getSellingOut_OT3($data1);
		$data['sellingout_OT_exist'] = $this->model('ReportModel')->getSellingOut_Growth_OT_Exist2($direct);

		foreach ($data['sellingout_OT_exist'] as $rows) :

			if ($big_code != $rows['big_code'] and $big_code != '' )
            {
				
				$sheet->setCellValue('A' . $row, '');
				$sheet->setCellValue('B' . $row, '');
				$sheet->setCellValue('C' . $row, $big_code);
				$sheet->setCellValue('D' . $row, $cust_name);
				$sheet->setCellValue('E' . $row, '');
				$sheet->setCellValue('F' . $row, '');
				$sheet->setCellValue('G' . $row, '');
				$sheet->setCellValue('H' . $row, $sub_value_from);
				$sheet->setCellValue('I' . $row, $sub_value_to);

				// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
				$sheet->getStyle('A' . $row)->applyFromArray($style_row);
				$sheet->getStyle('B' . $row)->applyFromArray($style_row);
				$sheet->getStyle('C' . $row)->applyFromArray($style_row);
				$sheet->getStyle('D' . $row)->applyFromArray($style_row);
				$sheet->getStyle('E' . $row)->applyFromArray($style_row);
				$sheet->getStyle('F' . $row)->applyFromArray($style_row);
				$sheet->getStyle('G' . $row)->applyFromArray($style_row);
				$sheet->getStyle('H' . $row)->applyFromArray($style_row);
				$sheet->getStyle('I' . $row)->applyFromArray($style_row);

				$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
				$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
				$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
				$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
				$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
				$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
				$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
				$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('I' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

				$sheet->getStyle('H' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('I' . $row)->getNumberFormat()->setFormatCode('#,##0');

				$sheet->getStyle('A' . $row . ':I' . $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');
				$sheet->getStyle('A' . $row . ':I' . $row)->getFont()->setBold(true);

				$sub_value_from = 0;
				$sub_value_to = 0;

				$row++;
            }

			$sheet->setCellValue('A' . $row, $no);
    		$sheet->setCellValue('B' . $row, $rows['outlet_type']);
			$sheet->setCellValue('C' . $row, $rows['big_code']);
			$sheet->setCellValue('D' . $row, $rows['cust_name']);
			$sheet->setCellValue('E' . $row, $rows['area']);
			$sheet->setCellValue('F' . $row, $rows['item_code']);
			$sheet->setCellValue('G' . $row, $rows['item_name']);
			$sheet->setCellValue('H' . $row, $rows['value_from']);
			$sheet->setCellValue('I' . $row, $rows['value_to']);

			// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
			$sheet->getStyle('A' . $row)->applyFromArray($style_row);
			$sheet->getStyle('B' . $row)->applyFromArray($style_row);
			$sheet->getStyle('C' . $row)->applyFromArray($style_row);
			$sheet->getStyle('D' . $row)->applyFromArray($style_row);
			$sheet->getStyle('E' . $row)->applyFromArray($style_row);
			$sheet->getStyle('F' . $row)->applyFromArray($style_row);
			$sheet->getStyle('G' . $row)->applyFromArray($style_row);
			$sheet->getStyle('H' . $row)->applyFromArray($style_row);
			$sheet->getStyle('I' . $row)->applyFromArray($style_row);

			$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('I' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

			$sheet->getStyle('H' . $row)->getNumberFormat()->setFormatCode('#,##0');
			if($rows['value_to'] !== '0')
			{
				$sheet->getStyle('I' . $row)->getNumberFormat()->setFormatCode('#,##0');
			}
			

			$big_code = $rows['big_code'];
			$cust_name = $rows['cust_name'];

			$sub_value_from += $rows['value_from'];
			$sub_value_to += $rows['value_to'];

			$total_value_from += $rows['value_from'];
			$total_value_to += $rows['value_to'];

			$no++; // Tambah 1 setiap kali looping
    		$row++; // Tambah 1 setiap kali looping
		endforeach;

		//subtotal end
		//$row = $row + 1;
		$sheet->setCellValue('A' . $row, '');
		$sheet->setCellValue('B' . $row, '');
		$sheet->setCellValue('C' . $row, $big_code);
		$sheet->setCellValue('D' . $row, $cust_name);
		$sheet->setCellValue('E' . $row, '');
		$sheet->setCellValue('F' . $row, '');
		$sheet->setCellValue('G' . $row, '');
		$sheet->setCellValue('H' . $row, $sub_value_from);
		$sheet->setCellValue('I' . $row, $sub_value_to);

		// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
		$sheet->getStyle('A' . $row)->applyFromArray($style_row);
		$sheet->getStyle('B' . $row)->applyFromArray($style_row);
		$sheet->getStyle('C' . $row)->applyFromArray($style_row);
		$sheet->getStyle('D' . $row)->applyFromArray($style_row);
		$sheet->getStyle('E' . $row)->applyFromArray($style_row);
		$sheet->getStyle('F' . $row)->applyFromArray($style_row);
		$sheet->getStyle('G' . $row)->applyFromArray($style_row);
		$sheet->getStyle('H' . $row)->applyFromArray($style_row);
		$sheet->getStyle('I' . $row)->applyFromArray($style_row);
		
		$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('I' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

		$sheet->getStyle('H' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('I' . $row)->getNumberFormat()->setFormatCode('#,##0');

		$sheet->getStyle('A' . $row . ':I' . $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');
		$sheet->getStyle('A' . $row . ':I' . $row)->getFont()->setBold(true);

		//total
		$row = $row + 1;
		$sheet->setCellValue('A' . $row, '');
		$sheet->setCellValue('B' . $row, '');
		$sheet->setCellValue('C' . $row, '');
		$sheet->setCellValue('D' . $row, 'TOTAL');
		$sheet->setCellValue('E' . $row, '');
		$sheet->setCellValue('F' . $row, '');
		$sheet->setCellValue('G' . $row, '');
		$sheet->setCellValue('H' . $row, $total_value_from);
		$sheet->setCellValue('I' . $row, $total_value_to);

		// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
		$sheet->getStyle('A' . $row)->applyFromArray($style_row);
		$sheet->getStyle('B' . $row)->applyFromArray($style_row);
		$sheet->getStyle('C' . $row)->applyFromArray($style_row);
		$sheet->getStyle('D' . $row)->applyFromArray($style_row);
		$sheet->getStyle('E' . $row)->applyFromArray($style_row);
		$sheet->getStyle('F' . $row)->applyFromArray($style_row);
		$sheet->getStyle('G' . $row)->applyFromArray($style_row);
		$sheet->getStyle('H' . $row)->applyFromArray($style_row);
		$sheet->getStyle('I' . $row)->applyFromArray($style_row);

		$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('I' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

		$sheet->getStyle('H' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('I' . $row)->getNumberFormat()->setFormatCode('#,##0');

		$sheet->getStyle('A' . $row . ':I' . $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFA07A');
		$sheet->getStyle('A' . $row . ':I' . $row)->getFont()->setBold(true);

		$sheet->getColumnDimension('A')->setWidth(8); // Set width kolom A
		$sheet->getColumnDimension('B')->setWidth(13); // Set width kolom B
		$sheet->getColumnDimension('C')->setWidth(15); // Set width kolom C
		$sheet->getColumnDimension('D')->setWidth(50); // Set width kolom D
		$sheet->getColumnDimension('E')->setWidth(15);
		$sheet->getColumnDimension('F')->setWidth(12);
		$sheet->getColumnDimension('G')->setWidth(45);
		$sheet->getColumnDimension('H')->setWidth(16);
		$sheet->getColumnDimension('I')->setWidth(16);

		// Set orientasi kertas jadi LANDSCAPE
		$sheet->getPageSetup()->setOrientation(\PhpOffice\PhpSpreadsheet\Worksheet\PageSetup::ORIENTATION_LANDSCAPE);
		// Set judul file excel nya
		$sheet->setTitle("Selling Out - SKU Existing");
		// Proses file excel
		header('Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet');
		header('Content-Disposition: attachment; filename="Report Selling Out - Growth SKU Existing ("' . $year . '").xlsx"'); // Set nama file excel nya
		header('Cache-Control: max-age=0');

		$writer = new Xlsx($spreadsheet);
		$writer->save('php://output');

	}

	public function export_sellingout_growth_add_sku()
	{
		$spreadsheet = new Spreadsheet();
		$sheet = $spreadsheet->getActiveSheet();
		// Buat sebuah variabel untuk menampung pengaturan style dari header tabel
		$style_col = [
			'font' => ['bold' => true], // Set font nya jadi bold
			'alignment' => [
				'horizontal' => \PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER, // Set text jadi ditengah secara horizontal (center)
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'top' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border top dengan garis tipis
				'right' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN],  // Set border right dengan garis tipis
				'bottom' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border bottom dengan garis tipis
				'left' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN] // Set border left dengan garis tipis
			]
		];
		// Buat sebuah variabel untuk menampung pengaturan style dari isi tabel
		$style_row = [
			'alignment' => [
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'top' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border top dengan garis tipis
				'right' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN],  // Set border right dengan garis tipis
				'bottom' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border bottom dengan garis tipis
				'left' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN] // Set border left dengan garis tipis
			]
		];


		if (isset($_POST['by_principal']))
		{
			$principal = $_POST['by_principal'];
		}
		else
		{
			$principal = "";
		}

		if (isset($_POST['by_channel']))
		{
			$channel = $_POST['by_channel'];
		}
		else
		{
			$channel = "";
		}

		if (isset($_POST['by_outlet_category']))
		{
			$outlet_category = $_POST['by_outlet_category'];
		}
		else
		{
			$outlet_category = "";
		}

		if (isset($_POST['by_outlet_type']))
		{
			$outlet_type = $_POST['by_outlet_type'];
		}
		else
		{
			$outlet_type = "";
		}

		if (isset($_POST['by_outlet_code']))
		{
			$outlet_code = $_POST['by_outlet_code'];
		}
		else
		{
			$outlet_code = "";
		}

		if (isset($_POST['by_area']))
		{
			$area = implode(',', $_POST['by_area']);
			$area = str_replace(",", "','", $area);;
		}
		else
		{
			$area = "";
		}

		if (isset($_POST['by_year']))
		{
			$year = $_POST['by_year'];
		}
		else
		{
			$year = date('Y');
		}

		$year_to = $year;
		$year_from = $year_to - 1;

		$sheet->setCellValue('A1', "Report Selling Out - Growth Add SKU (" . $year . ")"); // Set kolom A1 dengan tulisan "Report Selling In - By Outlet"
		$sheet->setCellValue('A2', "Principal : " . $principal); // Set kolom A2 dengan tulisan "Outlet Type : EC_EC"
		$sheet->setCellValue('A3', "Channel : " . $channel); // Set kolom A3 dengan tulisan "Outlet Type : EC_EC"
		$sheet->setCellValue('A4', "Outlet Category : " . $outlet_category);
		$sheet->setCellValue('D2', "Outlet Type : " . $outlet_type);
		$sheet->setCellValue('D3', "Area : " . $area);
		//$sheet->mergeCells('A1:F1'); // Set Merge Cell pada kolom A1 sampai F1
		$sheet->getStyle('A1')->getFont()->setBold(true); // Set bold kolom A1
		$sheet->getStyle('A2')->getFont()->setBold(true); // Set bold kolom A2
		$sheet->getStyle('A3')->getFont()->setBold(true); // Set bold kolom A3
		$sheet->getStyle('A4')->getFont()->setBold(true);
		$sheet->getStyle('D2')->getFont()->setBold(true);
		$sheet->getStyle('D3')->getFont()->setBold(true);
		$sheet->getStyle('D4')->getFont()->setBold(true);
		$sheet->getStyle('A1')->getFont()->setSize(20); // Set font size 15 untuk kolom A1
		// Buat header tabel nya pada baris ke 6
		$sheet->setCellValue('A6', "#"); // Set kolom A6 dengan tulisan "NO"
		$sheet->setCellValue('B6', "Outlet Type"); // Set kolom A6 dengan tulisan "NO"
		$sheet->setCellValue('C6', "BIG Code"); // Set kolom A6 dengan tulisan "NO"
		$sheet->setCellValue('D6', "Outlet Name"); // Set kolom A6 dengan tulisan "NO"
		$sheet->setCellValue('E6', "Area");
		$sheet->setCellValue('F6', "Item Code");
		$sheet->setCellValue('G6', "SKU");
		$sheet->setCellValue('H6', "Value");

		// Apply style header yang telah kita buat tadi ke masing-masing kolom header
		$sheet->getStyle('A6')->applyFromArray($style_col);
		$sheet->getStyle('B6')->applyFromArray($style_col);
		$sheet->getStyle('C6')->applyFromArray($style_col);
		$sheet->getStyle('D6')->applyFromArray($style_col);
		$sheet->getStyle('E6')->applyFromArray($style_col);
		$sheet->getStyle('F6')->applyFromArray($style_col);
		$sheet->getStyle('G6')->applyFromArray($style_col);
		$sheet->getStyle('H6')->applyFromArray($style_col);
		
		$sheet->getStyle('A6:H6')->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');

		// Set height baris ke 1, 2 dan 3
		$sheet->getRowDimension('1')->setRowHeight(40);
		$sheet->getRowDimension('2')->setRowHeight(20);
		$sheet->getRowDimension('3')->setRowHeight(20);
		$sheet->getRowDimension('4')->setRowHeight(20);

		$big_code = '';
		$cust_name = '';

		$sub_value = 0;
		$total_value = 0;

		$no = 1; // Untuk penomoran tabel, di awal set dengan 1
		$row = 7;

		$data1 = array(
			'principal' => $principal,
			'channel' => $channel,
			'outlet_category' => $outlet_type,
			'outlet_type' => $outlet_code,
			'area' => $area, 
			'year' => $year
		);

		//$data['sellingout_OT'] = $this->model('ReportModel')->getSellingOut_OT3($data1);
		$data['sellingout_add_sku'] = $this->model('ReportModel')->getSellingOut_Growth_Add_SKU2($direct);

		foreach ($data['sellingout_add_sku'] as $rows) :

			if ($big_code != $rows['big_code'] and $big_code != '' )
            {
				
				$sheet->setCellValue('A' . $row, '');
				$sheet->setCellValue('B' . $row, '');
				$sheet->setCellValue('C' . $row, $big_code);
				$sheet->setCellValue('D' . $row, $cust_name);
				$sheet->setCellValue('E' . $row, '');
				$sheet->setCellValue('F' . $row, '');
				$sheet->setCellValue('G' . $row, '');
				$sheet->setCellValue('H' . $row, $sub_value);

				// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
				$sheet->getStyle('A' . $row)->applyFromArray($style_row);
				$sheet->getStyle('B' . $row)->applyFromArray($style_row);
				$sheet->getStyle('C' . $row)->applyFromArray($style_row);
				$sheet->getStyle('D' . $row)->applyFromArray($style_row);
				$sheet->getStyle('E' . $row)->applyFromArray($style_row);
				$sheet->getStyle('F' . $row)->applyFromArray($style_row);
				$sheet->getStyle('G' . $row)->applyFromArray($style_row);
				$sheet->getStyle('H' . $row)->applyFromArray($style_row);

				$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
				$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
				$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
				$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
				$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
				$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
				$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
				$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

				$sheet->getStyle('H' . $row)->getNumberFormat()->setFormatCode('#,##0');

				$sheet->getStyle('A' . $row . ':H' . $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');
				$sheet->getStyle('A' . $row . ':H' . $row)->getFont()->setBold(true);

				$sub_value = 0;

				$row++;
            }

			$sheet->setCellValue('A' . $row, $no);
    		$sheet->setCellValue('B' . $row, $rows['outlet_type']);
			$sheet->setCellValue('C' . $row, $rows['big_code']);
			$sheet->setCellValue('D' . $row, $rows['cust_name']);
			$sheet->setCellValue('E' . $row, $rows['area']);
			$sheet->setCellValue('F' . $row, $rows['item_code']);
			$sheet->setCellValue('G' . $row, $rows['item_name']);
			$sheet->setCellValue('H' . $row, $rows['value_add_sku']);

			// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
			$sheet->getStyle('A' . $row)->applyFromArray($style_row);
			$sheet->getStyle('B' . $row)->applyFromArray($style_row);
			$sheet->getStyle('C' . $row)->applyFromArray($style_row);
			$sheet->getStyle('D' . $row)->applyFromArray($style_row);
			$sheet->getStyle('E' . $row)->applyFromArray($style_row);
			$sheet->getStyle('F' . $row)->applyFromArray($style_row);
			$sheet->getStyle('G' . $row)->applyFromArray($style_row);
			$sheet->getStyle('H' . $row)->applyFromArray($style_row);

			$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

			$sheet->getStyle('H' . $row)->getNumberFormat()->setFormatCode('#,##0');

			$big_code = $rows['big_code'];
			$cust_name = $rows['cust_name'];

			$sub_value += $rows['value_add_sku'];
			$total_value += $rows['value_add_sku'];

			$no++; // Tambah 1 setiap kali looping
    		$row++; // Tambah 1 setiap kali looping
		endforeach;

		//subtotal end
		//$row = $row + 1;
		$sheet->setCellValue('A' . $row, '');
		$sheet->setCellValue('B' . $row, '');
		$sheet->setCellValue('C' . $row, $big_code);
		$sheet->setCellValue('D' . $row, $cust_name);
		$sheet->setCellValue('E' . $row, '');
		$sheet->setCellValue('F' . $row, '');
		$sheet->setCellValue('G' . $row, '');
		$sheet->setCellValue('H' . $row, $sub_value);

		// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
		$sheet->getStyle('A' . $row)->applyFromArray($style_row);
		$sheet->getStyle('B' . $row)->applyFromArray($style_row);
		$sheet->getStyle('C' . $row)->applyFromArray($style_row);
		$sheet->getStyle('D' . $row)->applyFromArray($style_row);
		$sheet->getStyle('E' . $row)->applyFromArray($style_row);
		$sheet->getStyle('F' . $row)->applyFromArray($style_row);
		$sheet->getStyle('G' . $row)->applyFromArray($style_row);
		$sheet->getStyle('H' . $row)->applyFromArray($style_row);
		
		$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

		$sheet->getStyle('H' . $row)->getNumberFormat()->setFormatCode('#,##0');

		$sheet->getStyle('A' . $row . ':H' . $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');
		$sheet->getStyle('A' . $row . ':H' . $row)->getFont()->setBold(true);

		//total
		$row = $row + 1;
		$sheet->setCellValue('A' . $row, '');
		$sheet->setCellValue('B' . $row, '');
		$sheet->setCellValue('C' . $row, '');
		$sheet->setCellValue('D' . $row, 'TOTAL');
		$sheet->setCellValue('E' . $row, '');
		$sheet->setCellValue('F' . $row, '');
		$sheet->setCellValue('G' . $row, '');
		$sheet->setCellValue('H' . $row, $total_value);

		// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
		$sheet->getStyle('A' . $row)->applyFromArray($style_row);
		$sheet->getStyle('B' . $row)->applyFromArray($style_row);
		$sheet->getStyle('C' . $row)->applyFromArray($style_row);
		$sheet->getStyle('D' . $row)->applyFromArray($style_row);
		$sheet->getStyle('E' . $row)->applyFromArray($style_row);
		$sheet->getStyle('F' . $row)->applyFromArray($style_row);
		$sheet->getStyle('G' . $row)->applyFromArray($style_row);
		$sheet->getStyle('H' . $row)->applyFromArray($style_row);

		$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

		$sheet->getStyle('H' . $row)->getNumberFormat()->setFormatCode('#,##0');

		$sheet->getStyle('A' . $row . ':H' . $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFA07A');
		$sheet->getStyle('A' . $row . ':H' . $row)->getFont()->setBold(true);

		$sheet->getColumnDimension('A')->setWidth(8); // Set width kolom A
		$sheet->getColumnDimension('B')->setWidth(13); // Set width kolom B
		$sheet->getColumnDimension('C')->setWidth(15); // Set width kolom C
		$sheet->getColumnDimension('D')->setWidth(50); // Set width kolom D
		$sheet->getColumnDimension('E')->setWidth(15);
		$sheet->getColumnDimension('F')->setWidth(12);
		$sheet->getColumnDimension('G')->setWidth(45);
		$sheet->getColumnDimension('H')->setWidth(16);

		// Set orientasi kertas jadi LANDSCAPE
		$sheet->getPageSetup()->setOrientation(\PhpOffice\PhpSpreadsheet\Worksheet\PageSetup::ORIENTATION_LANDSCAPE);
		// Set judul file excel nya
		$sheet->setTitle("Selling Out - Add SKU");
		// Proses file excel
		header('Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet');
		header('Content-Disposition: attachment; filename="Report Selling Out - Growth Add SKU ("' . $year . '").xlsx"'); // Set nama file excel nya
		header('Cache-Control: max-age=0');

		$writer = new Xlsx($spreadsheet);
		$writer->save('php://output');

	}

	public function export_sellingout_growth_noo()
	{
		$spreadsheet = new Spreadsheet();
		$sheet = $spreadsheet->getActiveSheet();
		// Buat sebuah variabel untuk menampung pengaturan style dari header tabel
		$style_col = [
			'font' => ['bold' => true], // Set font nya jadi bold
			'alignment' => [
				'horizontal' => \PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER, // Set text jadi ditengah secara horizontal (center)
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'top' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border top dengan garis tipis
				'right' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN],  // Set border right dengan garis tipis
				'bottom' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border bottom dengan garis tipis
				'left' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN] // Set border left dengan garis tipis
			]
		];
		// Buat sebuah variabel untuk menampung pengaturan style dari isi tabel
		$style_row = [
			'alignment' => [
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'top' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border top dengan garis tipis
				'right' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN],  // Set border right dengan garis tipis
				'bottom' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border bottom dengan garis tipis
				'left' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN] // Set border left dengan garis tipis
			]
		];


		if (isset($_POST['by_principal']))
		{
			$principal = $_POST['by_principal'];
		}
		else
		{
			$principal = "";
		}

		if (isset($_POST['by_channel']))
		{
			$channel = $_POST['by_channel'];
		}
		else
		{
			$channel = "";
		}

		if (isset($_POST['by_outlet_category']))
		{
			$outlet_category = $_POST['by_outlet_category'];
		}
		else
		{
			$outlet_category = "";
		}

		if (isset($_POST['by_outlet_type']))
		{
			$outlet_type = $_POST['by_outlet_type'];
		}
		else
		{
			$outlet_type = "";
		}

		if (isset($_POST['by_outlet_code']))
		{
			$outlet_code = $_POST['by_outlet_code'];
		}
		else
		{
			$outlet_code = "";
		}

		if (isset($_POST['by_area']))
		{
			$area = implode(',', $_POST['by_area']);
			$area = str_replace(",", "','", $area);;
		}
		else
		{
			$area = "";
		}

		if (isset($_POST['by_year']))
		{
			$year = $_POST['by_year'];
		}
		else
		{
			$year = date('Y');
		}

		$year_to = $year;
		$year_from = $year_to - 1;

		$sheet->setCellValue('A1', "Report Selling Out - Growth NOO (" . $year . ")"); // Set kolom A1 dengan tulisan "Report Selling In - By Outlet"
		$sheet->setCellValue('A2', "Principal : " . $principal); // Set kolom A2 dengan tulisan "Outlet Type : EC_EC"
		$sheet->setCellValue('A3', "Channel : " . $channel); // Set kolom A3 dengan tulisan "Outlet Type : EC_EC"
		$sheet->setCellValue('A4', "Outlet Category : " . $outlet_category);
		$sheet->setCellValue('D2', "Outlet Type : " . $outlet_type);
		$sheet->setCellValue('D3', "Area : " . $area);
		//$sheet->mergeCells('A1:F1'); // Set Merge Cell pada kolom A1 sampai F1
		$sheet->getStyle('A1')->getFont()->setBold(true); // Set bold kolom A1
		$sheet->getStyle('A2')->getFont()->setBold(true); // Set bold kolom A2
		$sheet->getStyle('A3')->getFont()->setBold(true); // Set bold kolom A3
		$sheet->getStyle('A4')->getFont()->setBold(true);
		$sheet->getStyle('D2')->getFont()->setBold(true);
		$sheet->getStyle('D3')->getFont()->setBold(true);
		$sheet->getStyle('D4')->getFont()->setBold(true);
		$sheet->getStyle('A1')->getFont()->setSize(20); // Set font size 15 untuk kolom A1
		// Buat header tabel nya pada baris ke 6
		$sheet->setCellValue('A6', "#"); // Set kolom A6 dengan tulisan "NO"
		$sheet->setCellValue('B6', "Outlet Type"); // Set kolom A6 dengan tulisan "NO"
		$sheet->setCellValue('C6', "BIG Code"); // Set kolom A6 dengan tulisan "NO"
		$sheet->setCellValue('D6', "Outlet Name"); // Set kolom A6 dengan tulisan "NO"
		$sheet->setCellValue('E6', "Area");
		$sheet->setCellValue('F6', "Item Code");
		$sheet->setCellValue('G6', "SKU");
		$sheet->setCellValue('H6', "Value");

		// Apply style header yang telah kita buat tadi ke masing-masing kolom header
		$sheet->getStyle('A6')->applyFromArray($style_col);
		$sheet->getStyle('B6')->applyFromArray($style_col);
		$sheet->getStyle('C6')->applyFromArray($style_col);
		$sheet->getStyle('D6')->applyFromArray($style_col);
		$sheet->getStyle('E6')->applyFromArray($style_col);
		$sheet->getStyle('F6')->applyFromArray($style_col);
		$sheet->getStyle('G6')->applyFromArray($style_col);
		$sheet->getStyle('H6')->applyFromArray($style_col);
		
		$sheet->getStyle('A6:H6')->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');

		// Set height baris ke 1, 2 dan 3
		$sheet->getRowDimension('1')->setRowHeight(40);
		$sheet->getRowDimension('2')->setRowHeight(20);
		$sheet->getRowDimension('3')->setRowHeight(20);
		$sheet->getRowDimension('4')->setRowHeight(20);

		$big_code = '';
		$cust_name = '';

		$sub_value = 0;
		$total_value = 0;

		$no = 1; // Untuk penomoran tabel, di awal set dengan 1
		$row = 7;

		$data1 = array(
			'principal' => $principal,
			'channel' => $channel,
			'outlet_category' => $outlet_type,
			'outlet_type' => $outlet_code,
			'area' => $area, 
			'year' => $year
		);

		//$data['sellingout_OT'] = $this->model('ReportModel')->getSellingOut_OT3($data1);
		$data['sellingout_noo'] = $this->model('ReportModel')->getSellingOut_Growth_NOO2($direct);

		foreach ($data['sellingout_noo'] as $rows) :

			if ($big_code != $rows['big_code'] and $big_code != '' )
            {
				
				$sheet->setCellValue('A' . $row, '');
				$sheet->setCellValue('B' . $row, '');
				$sheet->setCellValue('C' . $row, $big_code);
				$sheet->setCellValue('D' . $row, $cust_name);
				$sheet->setCellValue('E' . $row, '');
				$sheet->setCellValue('F' . $row, '');
				$sheet->setCellValue('G' . $row, '');
				$sheet->setCellValue('H' . $row, $sub_value);

				// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
				$sheet->getStyle('A' . $row)->applyFromArray($style_row);
				$sheet->getStyle('B' . $row)->applyFromArray($style_row);
				$sheet->getStyle('C' . $row)->applyFromArray($style_row);
				$sheet->getStyle('D' . $row)->applyFromArray($style_row);
				$sheet->getStyle('E' . $row)->applyFromArray($style_row);
				$sheet->getStyle('F' . $row)->applyFromArray($style_row);
				$sheet->getStyle('G' . $row)->applyFromArray($style_row);
				$sheet->getStyle('H' . $row)->applyFromArray($style_row);

				$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
				$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
				$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
				$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
				$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
				$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
				$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
				$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

				$sheet->getStyle('H' . $row)->getNumberFormat()->setFormatCode('#,##0');

				$sheet->getStyle('A' . $row . ':H' . $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');
				$sheet->getStyle('A' . $row . ':H' . $row)->getFont()->setBold(true);

				$sub_value = 0;

				$row++;
            }

			$sheet->setCellValue('A' . $row, $no);
    		$sheet->setCellValue('B' . $row, $rows['outlet_type']);
			$sheet->setCellValue('C' . $row, $rows['big_code']);
			$sheet->setCellValue('D' . $row, $rows['cust_name']);
			$sheet->setCellValue('E' . $row, $rows['area']);
			$sheet->setCellValue('F' . $row, $rows['item_code']);
			$sheet->setCellValue('G' . $row, $rows['item_name']);
			$sheet->setCellValue('H' . $row, $rows['value_noo']);

			// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
			$sheet->getStyle('A' . $row)->applyFromArray($style_row);
			$sheet->getStyle('B' . $row)->applyFromArray($style_row);
			$sheet->getStyle('C' . $row)->applyFromArray($style_row);
			$sheet->getStyle('D' . $row)->applyFromArray($style_row);
			$sheet->getStyle('E' . $row)->applyFromArray($style_row);
			$sheet->getStyle('F' . $row)->applyFromArray($style_row);
			$sheet->getStyle('G' . $row)->applyFromArray($style_row);
			$sheet->getStyle('H' . $row)->applyFromArray($style_row);

			$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

			$sheet->getStyle('H' . $row)->getNumberFormat()->setFormatCode('#,##0');

			$big_code = $rows['big_code'];
			$cust_name = $rows['cust_name'];

			$sub_value += $rows['value_noo'];
			$total_value += $rows['value_noo'];

			$no++; // Tambah 1 setiap kali looping
    		$row++; // Tambah 1 setiap kali looping
		endforeach;

		//subtotal end
		//$row = $row + 1;
		$sheet->setCellValue('A' . $row, '');
		$sheet->setCellValue('B' . $row, '');
		$sheet->setCellValue('C' . $row, $big_code);
		$sheet->setCellValue('D' . $row, $cust_name);
		$sheet->setCellValue('E' . $row, '');
		$sheet->setCellValue('F' . $row, '');
		$sheet->setCellValue('G' . $row, '');
		$sheet->setCellValue('H' . $row, $sub_value);

		// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
		$sheet->getStyle('A' . $row)->applyFromArray($style_row);
		$sheet->getStyle('B' . $row)->applyFromArray($style_row);
		$sheet->getStyle('C' . $row)->applyFromArray($style_row);
		$sheet->getStyle('D' . $row)->applyFromArray($style_row);
		$sheet->getStyle('E' . $row)->applyFromArray($style_row);
		$sheet->getStyle('F' . $row)->applyFromArray($style_row);
		$sheet->getStyle('G' . $row)->applyFromArray($style_row);
		$sheet->getStyle('H' . $row)->applyFromArray($style_row);
		
		$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

		$sheet->getStyle('H' . $row)->getNumberFormat()->setFormatCode('#,##0');

		$sheet->getStyle('A' . $row . ':H' . $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');
		$sheet->getStyle('A' . $row . ':H' . $row)->getFont()->setBold(true);

		//total
		$row = $row + 1;
		$sheet->setCellValue('A' . $row, '');
		$sheet->setCellValue('B' . $row, '');
		$sheet->setCellValue('C' . $row, '');
		$sheet->setCellValue('D' . $row, 'TOTAL');
		$sheet->setCellValue('E' . $row, '');
		$sheet->setCellValue('F' . $row, '');
		$sheet->setCellValue('G' . $row, '');
		$sheet->setCellValue('H' . $row, $total_value);

		// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
		$sheet->getStyle('A' . $row)->applyFromArray($style_row);
		$sheet->getStyle('B' . $row)->applyFromArray($style_row);
		$sheet->getStyle('C' . $row)->applyFromArray($style_row);
		$sheet->getStyle('D' . $row)->applyFromArray($style_row);
		$sheet->getStyle('E' . $row)->applyFromArray($style_row);
		$sheet->getStyle('F' . $row)->applyFromArray($style_row);
		$sheet->getStyle('G' . $row)->applyFromArray($style_row);
		$sheet->getStyle('H' . $row)->applyFromArray($style_row);

		$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

		$sheet->getStyle('H' . $row)->getNumberFormat()->setFormatCode('#,##0');

		$sheet->getStyle('A' . $row . ':H' . $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFA07A');
		$sheet->getStyle('A' . $row . ':H' . $row)->getFont()->setBold(true);

		$sheet->getColumnDimension('A')->setWidth(8); // Set width kolom A
		$sheet->getColumnDimension('B')->setWidth(13); // Set width kolom B
		$sheet->getColumnDimension('C')->setWidth(15); // Set width kolom C
		$sheet->getColumnDimension('D')->setWidth(50); // Set width kolom D
		$sheet->getColumnDimension('E')->setWidth(15);
		$sheet->getColumnDimension('F')->setWidth(12);
		$sheet->getColumnDimension('G')->setWidth(45);
		$sheet->getColumnDimension('H')->setWidth(16);

		// Set orientasi kertas jadi LANDSCAPE
		$sheet->getPageSetup()->setOrientation(\PhpOffice\PhpSpreadsheet\Worksheet\PageSetup::ORIENTATION_LANDSCAPE);
		// Set judul file excel nya
		$sheet->setTitle("Selling Out - NOO");
		// Proses file excel
		header('Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet');
		header('Content-Disposition: attachment; filename="Report Selling Out - Growth NOO ("' . $year . '").xlsx"'); // Set nama file excel nya
		header('Cache-Control: max-age=0');

		$writer = new Xlsx($spreadsheet);
		$writer->save('php://output');

	}

	public function getStyleByColumnAndRow($columnIndex1, $row1, $columnIndex2 = null, $row2 = null)
    {
        if ($columnIndex2 !== null && $row2 !== null) {
            $cellRange = Coordinate::stringFromColumnIndex($columnIndex1) . $row1 . ':' . Coordinate::stringFromColumnIndex($columnIndex2) . $row2;
            return $this->getStyle($cellRange);
        }
        return $this->getStyle(Coordinate::stringFromColumnIndex($columnIndex1) . $row1);
    }

	public function mergeCellsByColumnAndRow($columnIndex1, $row1, $columnIndex2, $row2)
    {
        $cellRange = Coordinate::stringFromColumnIndex($columnIndex1) . $row1 . ':' . Coordinate::stringFromColumnIndex($columnIndex2) . $row2;
        return $this->mergeCells($cellRange);
    }

	public function export_sellingin_contribution()
	{
		$spreadsheet = new Spreadsheet();
		$sheet = $spreadsheet->getActiveSheet();
		// Buat sebuah variabel untuk menampung pengaturan style dari header tabel
		$style_col = [
			'font' => ['bold' => true], // Set font nya jadi bold
			'alignment' => [
				'horizontal' => \PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER, // Set text jadi ditengah secara horizontal (center)
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'top' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border top dengan garis tipis
				'right' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN],  // Set border right dengan garis tipis
				'bottom' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border bottom dengan garis tipis
				'left' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN] // Set border left dengan garis tipis
			]
		];
		// Buat sebuah variabel untuk menampung pengaturan style dari isi tabel
		$style_row = [
			'alignment' => [
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'top' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border top dengan garis tipis
				'right' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN],  // Set border right dengan garis tipis
				'bottom' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border bottom dengan garis tipis
				'left' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN] // Set border left dengan garis tipis
			]
		];


		if (isset($_POST['by_principal']))
		{
			$principal = $_POST['by_principal'];
		}
		else
		{
			$principal = "";
		}
		if (isset($_POST['by_year']))
		{
			$year = $_POST['by_year'];
		}
		else
		{
			$year = "";
		}


		$sheet->setCellValue('A1', "Report Selling In - Contribution (" . $year . ")"); // Set kolom A1 dengan tulisan "Report Selling In - By Outlet"
		$sheet->setCellValue('A2', "Principal : " . $principal); // Set kolom A2 dengan tulisan "Outlet Type : EC_EC"
		//$sheet->mergeCells('A1:F1'); // Set Merge Cell pada kolom A1 sampai F1
		$sheet->getStyle('A1')->getFont()->setBold(true); // Set bold kolom A1
		$sheet->getStyle('A2')->getFont()->setBold(true); // Set bold kolom A2
		$sheet->getStyle('A1')->getFont()->setSize(20); // Set font size 15 untuk kolom A1
		// Buat header tabel nya pada baris ke 4
		$sheet->setCellValue('A4', "#"); // Set kolom A4 dengan tulisan "#"
		$sheet->mergeCells('$A$4:$A$6'); // Set Merge Row pada kolom A4 sampai A6
		//$sheet->mergeCellsByColumnAndRow(1, 4, 1, 6);
		$sheet->setCellValue('B4', "Cust Code");
		$sheet->mergeCells('B4:B6'); 
		$sheet->setCellValue('C4', "Distributor"); 
		$sheet->mergeCells('C4:C6'); 
		$sheet->setCellValue('D4', "Area"); 
		$sheet->mergeCells('D4:D6'); 
		$sheet->setCellValue('E4', "Month");
		$sheet->mergeCells('E4:AB4');
		$sheet->setCellValue('AC4', "Total");
		$sheet->mergeCells('AC4:AD5');
		/* $sheet->setCellValue('AE4', "Average");
		$sheet->mergeCells('AE4:AF5'); */
		$sheet->setCellValue('E5', "January");
		$sheet->mergeCells('E5:F5');
		$sheet->setCellValue('G5', "February");
		$sheet->mergeCells('G5:H5');
		$sheet->setCellValue('I5', "March");
		$sheet->mergeCells('I5:J5');
		$sheet->setCellValue('K5', "April");
		$sheet->mergeCells('K5:L5');
		$sheet->setCellValue('M5', "May");
		$sheet->mergeCells('M5:N5');
		$sheet->setCellValue('O5', "June");
		$sheet->mergeCells('O5:P5');
		$sheet->setCellValue('Q5', "July");
		$sheet->mergeCells('Q5:R5');
		$sheet->setCellValue('S5', "August");
		$sheet->mergeCells('S5:T5');
		$sheet->setCellValue('U5', "September");
		$sheet->mergeCells('U5:V5');
		$sheet->setCellValue('W5', "October");
		$sheet->mergeCells('W5:X5');
		$sheet->setCellValue('Y5', "November");
		$sheet->mergeCells('Y5:Z5');
		$sheet->setCellValue('AA5', "December");
		$sheet->mergeCells('AA5:AB5');
		$sheet->setCellValue('E6', "Value");
		$sheet->setCellValue('F6', "Cont %");
		$sheet->setCellValue('G6', "Value");
		$sheet->setCellValue('H6', "Cont %");
		$sheet->setCellValue('I6', "Value");
		$sheet->setCellValue('J6', "Cont %");
		$sheet->setCellValue('K6', "Value");
		$sheet->setCellValue('L6', "Cont %");
		$sheet->setCellValue('M6', "Value");
		$sheet->setCellValue('N6', "Cont %");
		$sheet->setCellValue('O6', "Value");
		$sheet->setCellValue('P6', "Cont %");
		$sheet->setCellValue('Q6', "Value");
		$sheet->setCellValue('R6', "Cont %");
		$sheet->setCellValue('S6', "Value");
		$sheet->setCellValue('T6', "Cont %");
		$sheet->setCellValue('U6', "Value");
		$sheet->setCellValue('V6', "Cont %");
		$sheet->setCellValue('W6', "Value");
		$sheet->setCellValue('X6', "Cont %");
		$sheet->setCellValue('Y6', "Value");
		$sheet->setCellValue('Z6', "Cont %");
		$sheet->setCellValue('AA6', "Value");
		$sheet->setCellValue('AB6', "Cont %");
		$sheet->setCellValue('AC6', "Value");
		$sheet->setCellValue('AD6', "Cont %");
		/* $sheet->setCellValue('AE6', "Value");
		$sheet->setCellValue('AF6', "Cont %"); */

		// Apply style header yang telah kita buat tadi ke masing-masing kolom header
		$sheet->getStyle('A4')->applyFromArray($style_col);
		$sheet->getStyle('B4')->applyFromArray($style_col);
		$sheet->getStyle('C4')->applyFromArray($style_col);
		$sheet->getStyle('D4')->applyFromArray($style_col);
		$sheet->getStyle('E4')->applyFromArray($style_col);
		$sheet->getStyle('F4')->applyFromArray($style_col);
		$sheet->getStyle('G4')->applyFromArray($style_col);
		$sheet->getStyle('H4')->applyFromArray($style_col);
		$sheet->getStyle('I4')->applyFromArray($style_col);
		$sheet->getStyle('J4')->applyFromArray($style_col);
		$sheet->getStyle('K4')->applyFromArray($style_col);
		$sheet->getStyle('L4')->applyFromArray($style_col);
		$sheet->getStyle('M4')->applyFromArray($style_col);
		$sheet->getStyle('N4')->applyFromArray($style_col);
		$sheet->getStyle('O4')->applyFromArray($style_col);
		$sheet->getStyle('P4')->applyFromArray($style_col);
		$sheet->getStyle('Q4')->applyFromArray($style_col);
		$sheet->getStyle('R4')->applyFromArray($style_col);
		$sheet->getStyle('S4')->applyFromArray($style_col);
		$sheet->getStyle('T4')->applyFromArray($style_col);
		$sheet->getStyle('U4')->applyFromArray($style_col);
		$sheet->getStyle('V4')->applyFromArray($style_col);
		$sheet->getStyle('W4')->applyFromArray($style_col);
		$sheet->getStyle('X4')->applyFromArray($style_col);
		$sheet->getStyle('Y4')->applyFromArray($style_col);
		$sheet->getStyle('Z4')->applyFromArray($style_col);
		$sheet->getStyle('AA4')->applyFromArray($style_col);
		$sheet->getStyle('AB4')->applyFromArray($style_col);
		$sheet->getStyle('AC4')->applyFromArray($style_col);
		$sheet->getStyle('AD4')->applyFromArray($style_col);
		/* $sheet->getStyle('AE4')->applyFromArray($style_col);
		$sheet->getStyle('AF4')->applyFromArray($style_col); */
		$sheet->getStyle('A5')->applyFromArray($style_col);
		$sheet->getStyle('B5')->applyFromArray($style_col);
		$sheet->getStyle('C5')->applyFromArray($style_col);
		$sheet->getStyle('D5')->applyFromArray($style_col);
		$sheet->getStyle('E5')->applyFromArray($style_col);
		$sheet->getStyle('F5')->applyFromArray($style_col);
		$sheet->getStyle('G5')->applyFromArray($style_col);
		$sheet->getStyle('H5')->applyFromArray($style_col);
		$sheet->getStyle('I5')->applyFromArray($style_col);
		$sheet->getStyle('J5')->applyFromArray($style_col);
		$sheet->getStyle('K5')->applyFromArray($style_col);
		$sheet->getStyle('L5')->applyFromArray($style_col);
		$sheet->getStyle('M5')->applyFromArray($style_col);
		$sheet->getStyle('N5')->applyFromArray($style_col);
		$sheet->getStyle('O5')->applyFromArray($style_col);
		$sheet->getStyle('P5')->applyFromArray($style_col);
		$sheet->getStyle('Q5')->applyFromArray($style_col);
		$sheet->getStyle('R5')->applyFromArray($style_col);
		$sheet->getStyle('S5')->applyFromArray($style_col);
		$sheet->getStyle('T5')->applyFromArray($style_col);
		$sheet->getStyle('U5')->applyFromArray($style_col);
		$sheet->getStyle('V5')->applyFromArray($style_col);
		$sheet->getStyle('W5')->applyFromArray($style_col);
		$sheet->getStyle('X5')->applyFromArray($style_col);
		$sheet->getStyle('Y5')->applyFromArray($style_col);
		$sheet->getStyle('Z5')->applyFromArray($style_col);
		$sheet->getStyle('AA5')->applyFromArray($style_col);
		$sheet->getStyle('AB5')->applyFromArray($style_col);
		$sheet->getStyle('AC5')->applyFromArray($style_col);
		$sheet->getStyle('AD5')->applyFromArray($style_col);
		/* $sheet->getStyle('AE5')->applyFromArray($style_col);
		$sheet->getStyle('AF5')->applyFromArray($style_col); */
		$sheet->getStyle('A6')->applyFromArray($style_col);
		$sheet->getStyle('B6')->applyFromArray($style_col);
		$sheet->getStyle('C6')->applyFromArray($style_col);
		$sheet->getStyle('D6')->applyFromArray($style_col);
		$sheet->getStyle('E6')->applyFromArray($style_col);
		$sheet->getStyle('F6')->applyFromArray($style_col);
		$sheet->getStyle('G6')->applyFromArray($style_col);
		$sheet->getStyle('H6')->applyFromArray($style_col);
		$sheet->getStyle('I6')->applyFromArray($style_col);
		$sheet->getStyle('J6')->applyFromArray($style_col);
		$sheet->getStyle('K6')->applyFromArray($style_col);
		$sheet->getStyle('L6')->applyFromArray($style_col);
		$sheet->getStyle('M6')->applyFromArray($style_col);
		$sheet->getStyle('N6')->applyFromArray($style_col);
		$sheet->getStyle('O6')->applyFromArray($style_col);
		$sheet->getStyle('P6')->applyFromArray($style_col);
		$sheet->getStyle('Q6')->applyFromArray($style_col);
		$sheet->getStyle('R6')->applyFromArray($style_col);
		$sheet->getStyle('S6')->applyFromArray($style_col);
		$sheet->getStyle('T6')->applyFromArray($style_col);
		$sheet->getStyle('U6')->applyFromArray($style_col);
		$sheet->getStyle('V6')->applyFromArray($style_col);
		$sheet->getStyle('W6')->applyFromArray($style_col);
		$sheet->getStyle('X6')->applyFromArray($style_col);
		$sheet->getStyle('Y6')->applyFromArray($style_col);
		$sheet->getStyle('Z6')->applyFromArray($style_col);
		$sheet->getStyle('AA6')->applyFromArray($style_col);
		$sheet->getStyle('AB6')->applyFromArray($style_col);
		$sheet->getStyle('AC6')->applyFromArray($style_col);
		$sheet->getStyle('AD6')->applyFromArray($style_col);
		/* $sheet->getStyle('AE6')->applyFromArray($style_col);
		$sheet->getStyle('AF6')->applyFromArray($style_col); */

		$sheet->getStyle('A4:AB6')->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');
		$sheet->getStyle('AC4:AD6')->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FF6D6D');
		//$sheet->getStyle('AE4:AF6')->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('7BFF6D');

		// Set height baris ke 1 dan 2
		$sheet->getRowDimension('1')->setRowHeight(40);
		$sheet->getRowDimension('2')->setRowHeight(20);


		$region = '';
        $island = '';

        $cont_jan = 0;
		$cont_feb = 0;
		$cont_mar = 0;
		$cont_apr = 0;
		$cont_mei = 0;
		$cont_jun = 0;
		$cont_jul = 0;
		$cont_agu = 0;
		$cont_sep = 0;
		$cont_okt = 0;
		$cont_nop = 0;
		$cont_des = 0;
		$cont_year = 0;
		
		$total_jan = 0;
		$total_feb = 0;
		$total_mar = 0;
		$total_apr = 0;
		$total_mei = 0;
		$total_jun = 0;
		$total_jul = 0;
		$total_agu = 0;
		$total_sep = 0;
		$total_okt = 0;
		$total_nop = 0;
		$total_des = 0;
		$total_year = 0;

        $sub_cont_jan = 0;
		$sub_cont_feb = 0;
		$sub_cont_mar = 0;
		$sub_cont_apr = 0;
		$sub_cont_mei = 0;
		$sub_cont_jun = 0;
		$sub_cont_jul = 0;
		$sub_cont_agu = 0;
		$sub_cont_sep = 0;
		$sub_cont_okt = 0;
		$sub_cont_nop = 0;
		$sub_cont_des = 0;
		$sub_cont_year = 0;
		$sub_cont_avg = 0;

		$sub_val_jan = 0;
		$sub_val_feb = 0;
		$sub_val_mar = 0;
		$sub_val_apr = 0;
		$sub_val_mei = 0;
		$sub_val_jun = 0;
		$sub_val_jul = 0;
		$sub_val_agu = 0;
		$sub_val_sep = 0;
		$sub_val_okt = 0;
		$sub_val_nop = 0;
		$sub_val_des = 0;
		$sub_val_year = 0;
		$sub_val_avg = 0;

		$total_cont_jan = 0;
		$total_cont_feb = 0;
		$total_cont_mar = 0;
		$total_cont_apr = 0;
		$total_cont_mei = 0;
		$total_cont_jun = 0;
		$total_cont_jul = 0;
		$total_cont_agu = 0;
		$total_cont_sep = 0;
		$total_cont_okt = 0;
		$total_cont_nop = 0;
		$total_cont_des = 0;
		$total_cont_year = 0;
		$total_cont_avg = 0;

		$total_val_jan = 0;
		$total_val_feb = 0;
		$total_val_mar = 0;
		$total_val_apr = 0;
		$total_val_mei = 0;
		$total_val_jun = 0;
		$total_val_jul = 0;
		$total_val_agu = 0;
		$total_val_sep = 0;
		$total_val_okt = 0;
		$total_val_nop = 0;
		$total_val_des = 0;
		$total_val_year = 0;
		$total_val_avg = 0;

		$grandtotal_cont_jan = 0;
		$grandtotal_cont_feb = 0;
		$grandtotal_cont_mar = 0;
		$grandtotal_cont_apr = 0;
		$grandtotal_cont_mei = 0;
		$grandtotal_cont_jun = 0;
		$grandtotal_cont_jul = 0;
		$grandtotal_cont_agu = 0;
		$grandtotal_cont_sep = 0;
		$grandtotal_cont_okt = 0;
		$grandtotal_cont_nop = 0;
		$grandtotal_cont_des = 0;
		$grandtotal_cont_year = 0;
		$grandtotal_cont_avg = 0;

		$grandtotal_val_jan = 0;
		$grandtotal_val_feb = 0;
		$grandtotal_val_mar = 0;
		$grandtotal_val_apr = 0;
		$grandtotal_val_mei = 0;
		$grandtotal_val_jun = 0;
		$grandtotal_val_jul = 0;
		$grandtotal_val_agu = 0;
		$grandtotal_val_sep = 0;
		$grandtotal_val_okt = 0;
		$grandtotal_val_nop = 0;
		$grandtotal_val_des = 0;
		$grandtotal_val_year = 0;
		$grandtotal_val_avg = 0;


		$no = 1; // Untuk penomoran tabel, di awal set dengan 1
		$row = 7;

		$data1 = array(
			'principal' => $principal,
			'year' => $year
		);

		$data['sellingin_Dist'] = $this->model('ReportModel')->getSellingIn_Dist2($data1);
		$data['total_sellingin_Dist'] = $this->model('ReportModel')->getTotal_SellingIn_Dist2($data1);
		//$data['sellingin_OT'] = $this->model('ReportModel')->getSellingIn_OT2();

		foreach ($data['total_sellingin_Dist'] as $row1) :
			if ($row1['bulan'] === '1') {
				$total_jan = $row1['val'];
			}elseif ($row1['bulan'] === '2') {
				$total_feb = $row1['val'];
			}elseif ($row1['bulan'] === '3') {
				$total_mar = $row1['val'];
			}elseif ($row1['bulan'] === '4') {
				$total_apr = $row1['val'];
			}elseif ($row1['bulan'] === '5') {
				$total_mei = $row1['val'];
			}elseif ($row1['bulan'] === '6') {
				$total_jun = $row1['val'];
			}elseif ($row1['bulan'] === '7') {
				$total_jul = $row1['val'];
			}elseif ($row1['bulan'] === '8') {
				$total_agu = $row1['val'];
			}elseif ($row1['bulan'] === '9') {
				$total_sep = $row1['val'];
			}elseif ($row1['bulan'] === '10') {
				$total_okt = $row1['val'];
			}elseif ($row1['bulan'] === '11') {
				$total_nop = $row1['val'];
			}elseif ($row1['bulan'] === '12') {
				$total_des = $row1['val'];
			}
			
		endforeach;

		$total_year = $total_jan + $total_feb + $total_mar + $total_apr + $total_mei + $total_jun + $total_jul + $total_agu + $total_sep + $total_okt + $total_nop + $total_des = 0;

		foreach ($data['sellingin_Dist'] as $rows) :

			if ($region != $rows['region'] and $region != '' )
            {
				
				$sheet->setCellValue('A' . $row, '');
				$sheet->setCellValue('B' . $row, '');
				$sheet->setCellValue('C' . $row, '');
				$sheet->setCellValue('D' . $row, $region);
				$sheet->setCellValue('E' . $row, number_format($sub_val_jan, 2));
				$sheet->setCellValue('F' . $row, number_format($sub_cont_jan, 2));
				$sheet->setCellValue('G' . $row, number_format($sub_val_feb, 2));
				$sheet->setCellValue('H' . $row, number_format($sub_cont_feb, 2));
				$sheet->setCellValue('I' . $row, number_format($sub_val_mar, 2));
				$sheet->setCellValue('J' . $row, number_format($sub_cont_mar, 2));
				$sheet->setCellValue('K' . $row, number_format($sub_val_apr, 2));
				$sheet->setCellValue('L' . $row, number_format($sub_cont_apr, 2));
				$sheet->setCellValue('M' . $row, number_format($sub_val_mei, 2));
				$sheet->setCellValue('N' . $row, number_format($sub_cont_mei, 2));
				$sheet->setCellValue('O' . $row, number_format($sub_val_jun, 2));
				$sheet->setCellValue('P' . $row, number_format($sub_cont_jun, 2));
				$sheet->setCellValue('Q' . $row, number_format($sub_val_jul, 2));
				$sheet->setCellValue('R' . $row, number_format($sub_cont_jul, 2));
				$sheet->setCellValue('S' . $row, number_format($sub_val_agu, 2));
				$sheet->setCellValue('T' . $row, number_format($sub_cont_agu, 2));
				$sheet->setCellValue('U' . $row, number_format($sub_val_sep, 2));
				$sheet->setCellValue('V' . $row, number_format($sub_cont_sep, 2));
				$sheet->setCellValue('W' . $row, number_format($sub_val_okt, 2));
				$sheet->setCellValue('X' . $row, number_format($sub_cont_okt, 2));
				$sheet->setCellValue('Y' . $row, number_format($sub_val_nop, 2));
				$sheet->setCellValue('Z' . $row, number_format($sub_cont_nop, 2));
				$sheet->setCellValue('AA' . $row, number_format($sub_val_des, 2));
				$sheet->setCellValue('AB' . $row, number_format($sub_cont_des, 2));
				$sheet->setCellValue('AC' . $row, number_format($sub_val_year, 2));
				$sheet->setCellValue('AD' . $row, number_format($sub_cont_year, 2));
			

				// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
				$sheet->getStyle('A' . $row)->applyFromArray($style_row);
				$sheet->getStyle('B' . $row)->applyFromArray($style_row);
				$sheet->getStyle('C' . $row)->applyFromArray($style_row);
				$sheet->getStyle('D' . $row)->applyFromArray($style_row);
				$sheet->getStyle('E' . $row)->applyFromArray($style_row);
				$sheet->getStyle('F' . $row)->applyFromArray($style_row);
				$sheet->getStyle('G' . $row)->applyFromArray($style_row);
				$sheet->getStyle('H' . $row)->applyFromArray($style_row);
				$sheet->getStyle('I' . $row)->applyFromArray($style_row);
				$sheet->getStyle('J' . $row)->applyFromArray($style_row);
				$sheet->getStyle('K' . $row)->applyFromArray($style_row);
				$sheet->getStyle('L' . $row)->applyFromArray($style_row);
				$sheet->getStyle('M' . $row)->applyFromArray($style_row);
				$sheet->getStyle('N' . $row)->applyFromArray($style_row);
				$sheet->getStyle('O' . $row)->applyFromArray($style_row);
				$sheet->getStyle('P' . $row)->applyFromArray($style_row);
				$sheet->getStyle('Q' . $row)->applyFromArray($style_row);
				$sheet->getStyle('R' . $row)->applyFromArray($style_row);
				$sheet->getStyle('S' . $row)->applyFromArray($style_row);
				$sheet->getStyle('T' . $row)->applyFromArray($style_row);
				$sheet->getStyle('U' . $row)->applyFromArray($style_row);
				$sheet->getStyle('V' . $row)->applyFromArray($style_row);
				$sheet->getStyle('W' . $row)->applyFromArray($style_row);
				$sheet->getStyle('X' . $row)->applyFromArray($style_row);
				$sheet->getStyle('Y' . $row)->applyFromArray($style_row);
				$sheet->getStyle('Z' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AA' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AB' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AC' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AD' . $row)->applyFromArray($style_row);

				$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
				$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
				$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
				$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
				$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('I' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('J' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('K' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('L' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('M' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('N' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('O' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('P' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('Q' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('R' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('S' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('T' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('U' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('V' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('W' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('X' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('Y' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('Z' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AA' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AB' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AC' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AD' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				
				$sheet->getStyle('A' . $row . ':AD' . $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');
				$sheet->getStyle('A' . $row . ':AD' . $row)->getFont()->setBold(true);

				$sub_cont_jan = 0;
				$sub_cont_feb = 0;
				$sub_cont_mar = 0;
				$sub_cont_apr = 0;
				$sub_cont_mei = 0;
				$sub_cont_jun = 0;
				$sub_cont_jul = 0;
				$sub_cont_agu = 0;
				$sub_cont_sep = 0;
				$sub_cont_okt = 0;
				$sub_cont_nop = 0;
				$sub_cont_des = 0;
				$sub_cont_year = 0;
				$sub_cont_avg = 0;

				$sub_val_jan = 0;
				$sub_val_feb = 0;
				$sub_val_mar = 0;
				$sub_val_apr = 0;
				$sub_val_mei = 0;
				$sub_val_jun = 0;
				$sub_val_jul = 0;
				$sub_val_agu = 0;
				$sub_val_sep = 0;
				$sub_val_okt = 0;
				$sub_val_nop = 0;
				$sub_val_des = 0;
				$sub_val_year = 0;
				$sub_val_avg = 0;

				$row++;
            }

			if ($island != $rows['island'] and $island != '' )
            {
				
				$sheet->setCellValue('A' . $row, '');
				$sheet->setCellValue('B' . $row, '');
				$sheet->setCellValue('C' . $row, '');
				$sheet->setCellValue('D' . $row, $island);
				$sheet->setCellValue('E' . $row, number_format($total_val_jan, 2));
				$sheet->setCellValue('F' . $row, number_format($total_cont_jan, 2));
				$sheet->setCellValue('G' . $row, number_format($total_val_feb, 2));
				$sheet->setCellValue('H' . $row, number_format($total_cont_feb, 2));
				$sheet->setCellValue('I' . $row, number_format($total_val_mar, 2));
				$sheet->setCellValue('J' . $row, number_format($total_cont_mar, 2));
				$sheet->setCellValue('K' . $row, number_format($total_val_apr, 2));
				$sheet->setCellValue('L' . $row, number_format($total_cont_apr, 2));
				$sheet->setCellValue('M' . $row, number_format($total_val_mei, 2));
				$sheet->setCellValue('N' . $row, number_format($total_cont_mei, 2));
				$sheet->setCellValue('O' . $row, number_format($total_val_jun, 2));
				$sheet->setCellValue('P' . $row, number_format($total_cont_jun, 2));
				$sheet->setCellValue('Q' . $row, number_format($total_val_jul, 2));
				$sheet->setCellValue('R' . $row, number_format($total_cont_jul, 2));
				$sheet->setCellValue('S' . $row, number_format($total_val_agu, 2));
				$sheet->setCellValue('T' . $row, number_format($total_cont_agu, 2));
				$sheet->setCellValue('U' . $row, number_format($total_val_sep, 2));
				$sheet->setCellValue('V' . $row, number_format($total_cont_sep, 2));
				$sheet->setCellValue('W' . $row, number_format($total_val_okt, 2));
				$sheet->setCellValue('X' . $row, number_format($total_cont_okt, 2));
				$sheet->setCellValue('Y' . $row, number_format($total_val_nop, 2));
				$sheet->setCellValue('Z' . $row, number_format($total_cont_nop, 2));
				$sheet->setCellValue('AA' . $row, number_format($total_val_des, 2));
				$sheet->setCellValue('AB' . $row, number_format($total_cont_des, 2));
				$sheet->setCellValue('AC' . $row, number_format($total_val_year, 2));
				$sheet->setCellValue('AD' . $row, number_format($total_cont_year, 2));

				// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
				$sheet->getStyle('A' . $row)->applyFromArray($style_row);
				$sheet->getStyle('B' . $row)->applyFromArray($style_row);
				$sheet->getStyle('C' . $row)->applyFromArray($style_row);
				$sheet->getStyle('D' . $row)->applyFromArray($style_row);
				$sheet->getStyle('E' . $row)->applyFromArray($style_row);
				$sheet->getStyle('F' . $row)->applyFromArray($style_row);
				$sheet->getStyle('G' . $row)->applyFromArray($style_row);
				$sheet->getStyle('H' . $row)->applyFromArray($style_row);
				$sheet->getStyle('I' . $row)->applyFromArray($style_row);
				$sheet->getStyle('J' . $row)->applyFromArray($style_row);
				$sheet->getStyle('K' . $row)->applyFromArray($style_row);
				$sheet->getStyle('L' . $row)->applyFromArray($style_row);
				$sheet->getStyle('M' . $row)->applyFromArray($style_row);
				$sheet->getStyle('N' . $row)->applyFromArray($style_row);
				$sheet->getStyle('O' . $row)->applyFromArray($style_row);
				$sheet->getStyle('P' . $row)->applyFromArray($style_row);
				$sheet->getStyle('Q' . $row)->applyFromArray($style_row);
				$sheet->getStyle('R' . $row)->applyFromArray($style_row);
				$sheet->getStyle('S' . $row)->applyFromArray($style_row);
				$sheet->getStyle('T' . $row)->applyFromArray($style_row);
				$sheet->getStyle('U' . $row)->applyFromArray($style_row);
				$sheet->getStyle('V' . $row)->applyFromArray($style_row);
				$sheet->getStyle('W' . $row)->applyFromArray($style_row);
				$sheet->getStyle('X' . $row)->applyFromArray($style_row);
				$sheet->getStyle('Y' . $row)->applyFromArray($style_row);
				$sheet->getStyle('Z' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AA' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AB' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AC' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AD' . $row)->applyFromArray($style_row);

				$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
				$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
				$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
				$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
				$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('I' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('J' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('K' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('L' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('M' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('N' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('O' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('P' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('Q' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('R' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('S' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('T' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('U' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('V' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('W' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('X' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('Y' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('Z' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AA' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AB' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AC' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AD' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

				$sheet->getStyle('A' . $row . ':AD' . $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFA07A');
				$sheet->getStyle('A' . $row . ':AD' . $row)->getFont()->setBold(true);

				$total_cont_jan = 0;
				$total_cont_feb = 0;
				$total_cont_mar = 0;
				$total_cont_apr = 0;
				$total_cont_mei = 0;
				$total_cont_jun = 0;
				$total_cont_jul = 0;
				$total_cont_agu = 0;
				$total_cont_sep = 0;
				$total_cont_okt = 0;
				$total_cont_nop = 0;
				$total_cont_des = 0;
				$total_cont_year = 0;
				$total_cont_avg = 0;

				$total_val_jan = 0;
				$total_val_feb = 0;
				$total_val_mar = 0;
				$total_val_apr = 0;
				$total_val_mei = 0;
				$total_val_jun = 0;
				$total_val_jul = 0;
				$total_val_agu = 0;
				$total_val_sep = 0;
				$total_val_okt = 0;
				$total_val_nop = 0;
				$total_val_des = 0;
				$total_val_year = 0;
				$total_val_avg = 0;

				$row++;
            }

			$cont_jan = ($rows['val_jan']/($total_jan ? :1))*100;
			$cont_feb = ($rows['val_feb']/($total_feb ? :1))*100;
			$cont_mar = ($rows['val_mar']/($total_mar ? :1))*100;
			$cont_apr = ($rows['val_apr']/($total_apr ? :1))*100;
			$cont_mei = ($rows['val_mei']/($total_mei ? :1))*100;
			$cont_jun = ($rows['val_jun']/($total_jun ? :1))*100;
			$cont_jul = ($rows['val_jul']/($total_jul ? :1))*100;
			$cont_agu = ($rows['val_agu']/($total_agu ? :1))*100;
			$cont_sep = ($rows['val_sep']/($total_sep ? :1))*100;
			$cont_okt = ($rows['val_okt']/($total_okt ? :1))*100;
			$cont_nop = ($rows['val_nop']/($total_nop ? :1))*100;
			$cont_des = ($rows['val_des']/($total_des ? :1))*100;
			$cont_year = ($rows['val_year']/($total_year ? :1))*100;

			$sheet->setCellValue('A' . $row, $no);
    		$sheet->setCellValue('B' . $row, $rows['cust_code']);
			$sheet->setCellValue('C' . $row, $rows['distributor']);
			$sheet->setCellValue('D' . $row, $rows['area']);
			$sheet->setCellValue('E' . $row, number_format($rows['val_jan'], 2));
			$sheet->setCellValue('F' . $row, number_format($cont_jan, 2));
			$sheet->setCellValue('G' . $row, number_format($rows['val_feb'], 2));
			$sheet->setCellValue('H' . $row, number_format($cont_feb, 2));
			$sheet->setCellValue('I' . $row, number_format($rows['val_mar'], 2));
			$sheet->setCellValue('J' . $row, number_format($cont_mar, 2));
			$sheet->setCellValue('K' . $row, number_format($rows['val_apr'], 2));
			$sheet->setCellValue('L' . $row, number_format($cont_apr, 2));
			$sheet->setCellValue('M' . $row, number_format($rows['val_mei'], 2));
			$sheet->setCellValue('N' . $row, number_format($cont_mei, 2));
			$sheet->setCellValue('O' . $row, number_format($rows['val_jun'], 2));
			$sheet->setCellValue('P' . $row, number_format($cont_jun, 2));
			$sheet->setCellValue('Q' . $row, number_format($rows['val_jul'], 2));
			$sheet->setCellValue('R' . $row, number_format($cont_jul, 2));
			$sheet->setCellValue('S' . $row, number_format($rows['val_agu'], 2));
			$sheet->setCellValue('T' . $row, number_format($cont_agu, 2));
			$sheet->setCellValue('U' . $row, number_format($rows['val_sep'], 2));
			$sheet->setCellValue('V' . $row, number_format($cont_sep, 2));
			$sheet->setCellValue('W' . $row, number_format($rows['val_okt'], 2));
			$sheet->setCellValue('X' . $row, number_format($cont_okt, 2));
			$sheet->setCellValue('Y' . $row, number_format($rows['val_nop'], 2));
			$sheet->setCellValue('Z' . $row, number_format($cont_nop, 2));
			$sheet->setCellValue('AA' . $row, number_format($rows['val_des'], 2));
			$sheet->setCellValue('AB' . $row, number_format($cont_des, 2));
			$sheet->setCellValue('AC' . $row, number_format($rows['val_year'], 2));
			$sheet->setCellValue('AD' . $row, number_format($cont_year, 2));

			// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
			$sheet->getStyle('A' . $row)->applyFromArray($style_row);
			$sheet->getStyle('B' . $row)->applyFromArray($style_row);
			$sheet->getStyle('C' . $row)->applyFromArray($style_row);
			$sheet->getStyle('D' . $row)->applyFromArray($style_row);
			$sheet->getStyle('E' . $row)->applyFromArray($style_row);
			$sheet->getStyle('F' . $row)->applyFromArray($style_row);
			$sheet->getStyle('G' . $row)->applyFromArray($style_row);
			$sheet->getStyle('H' . $row)->applyFromArray($style_row);
			$sheet->getStyle('I' . $row)->applyFromArray($style_row);
			$sheet->getStyle('J' . $row)->applyFromArray($style_row);
			$sheet->getStyle('K' . $row)->applyFromArray($style_row);
			$sheet->getStyle('L' . $row)->applyFromArray($style_row);
			$sheet->getStyle('M' . $row)->applyFromArray($style_row);
			$sheet->getStyle('N' . $row)->applyFromArray($style_row);
			$sheet->getStyle('O' . $row)->applyFromArray($style_row);
			$sheet->getStyle('P' . $row)->applyFromArray($style_row);
			$sheet->getStyle('Q' . $row)->applyFromArray($style_row);
			$sheet->getStyle('R' . $row)->applyFromArray($style_row);
			$sheet->getStyle('S' . $row)->applyFromArray($style_row);
			$sheet->getStyle('T' . $row)->applyFromArray($style_row);
			$sheet->getStyle('U' . $row)->applyFromArray($style_row);
			$sheet->getStyle('V' . $row)->applyFromArray($style_row);
			$sheet->getStyle('W' . $row)->applyFromArray($style_row);
			$sheet->getStyle('X' . $row)->applyFromArray($style_row);
			$sheet->getStyle('Y' . $row)->applyFromArray($style_row);
			$sheet->getStyle('Z' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AA' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AB' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AC' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AD' . $row)->applyFromArray($style_row);

			$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('I' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('J' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('K' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('L' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('M' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('N' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('O' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('P' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('Q' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('R' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('S' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('T' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('U' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('V' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('W' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('X' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('Y' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('Z' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AA' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AB' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AC' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AD' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

			$region = $rows['region'];
			$island = $rows['island'];

			$sub_cont_jan += $cont_jan;
			$sub_cont_feb += $cont_feb;
			$sub_cont_mar += $cont_mar;
			$sub_cont_apr += $cont_apr;
			$sub_cont_mei += $cont_mei;
			$sub_cont_jun += $cont_jun;
			$sub_cont_jul += $cont_jul;
			$sub_cont_agu += $cont_agu;
			$sub_cont_sep += $cont_sep;
			$sub_cont_okt += $cont_okt;
			$sub_cont_nop += $cont_nop;
			$sub_cont_des += $cont_des;
			$sub_cont_year += $cont_year;

			$sub_val_jan += $rows['val_jan'];
			$sub_val_feb += $rows['val_feb'];
			$sub_val_mar += $rows['val_mar'];
			$sub_val_apr += $rows['val_apr'];
			$sub_val_mei += $rows['val_mei'];
			$sub_val_jun += $rows['val_jun'];
			$sub_val_jul += $rows['val_jul'];
			$sub_val_agu += $rows['val_agu'];
			$sub_val_sep += $rows['val_sep'];
			$sub_val_okt += $rows['val_okt'];
			$sub_val_nop += $rows['val_nop'];
			$sub_val_des += $rows['val_des'];
			$sub_val_year += $rows['val_year'];

			$total_cont_jan += $cont_jan;
			$total_cont_feb += $cont_feb;
			$total_cont_mar += $cont_mar;
			$total_cont_apr += $cont_apr;
			$total_cont_mei += $cont_mei;
			$total_cont_jun += $cont_jun;
			$total_cont_jul += $cont_jul;
			$total_cont_agu += $cont_agu;
			$total_cont_sep += $cont_sep;
			$total_cont_okt += $cont_okt;
			$total_cont_nop += $cont_nop;
			$total_cont_des += $cont_des;
			$total_cont_year += $cont_year;

			$total_val_jan += $rows['val_jan'];
			$total_val_feb += $rows['val_feb'];
			$total_val_mar += $rows['val_mar'];
			$total_val_apr += $rows['val_apr'];
			$total_val_mei += $rows['val_mei'];
			$total_val_jun += $rows['val_jun'];
			$total_val_jul += $rows['val_jul'];
			$total_val_agu += $rows['val_agu'];
			$total_val_sep += $rows['val_sep'];
			$total_val_okt += $rows['val_okt'];
			$total_val_nop += $rows['val_nop'];
			$total_val_des += $rows['val_des'];
			$total_val_year += $rows['val_year'];

			$grandtotal_cont_jan += $cont_jan;
			$grandtotal_cont_feb += $cont_feb;
			$grandtotal_cont_mar += $cont_mar;
			$grandtotal_cont_apr += $cont_apr;
			$grandtotal_cont_mei += $cont_mei;
			$grandtotal_cont_jun += $cont_jun;
			$grandtotal_cont_jul += $cont_jul;
			$grandtotal_cont_agu += $cont_agu;
			$grandtotal_cont_sep += $cont_sep;
			$grandtotal_cont_okt += $cont_okt;
			$grandtotal_cont_nop += $cont_nop;
			$grandtotal_cont_des += $cont_des;
			$grandtotal_cont_year += $cont_year;

			$grandtotal_val_jan += $rows['val_jan'];
			$grandtotal_val_feb += $rows['val_feb'];
			$grandtotal_val_mar += $rows['val_mar'];
			$grandtotal_val_apr += $rows['val_apr'];
			$grandtotal_val_mei += $rows['val_mei'];
			$grandtotal_val_jun += $rows['val_jun'];
			$grandtotal_val_jul += $rows['val_jul'];
			$grandtotal_val_agu += $rows['val_agu'];
			$grandtotal_val_sep += $rows['val_sep'];
			$grandtotal_val_okt += $rows['val_okt'];
			$grandtotal_val_nop += $rows['val_nop'];
			$grandtotal_val_des += $rows['val_des'];
			$grandtotal_val_year += $rows['val_year'];

			$no++; // Tambah 1 setiap kali looping
    		$row++; // Tambah 1 setiap kali looping
		endforeach;

		//region end
		//$row = $row + 1;
		$sheet->setCellValue('A' . $row, '');
		$sheet->setCellValue('B' . $row, '');
		$sheet->setCellValue('C' . $row, '');
		$sheet->setCellValue('D' . $row, $region);
		$sheet->setCellValue('E' . $row, number_format($sub_val_jan, 0));
		$sheet->setCellValue('F' . $row, number_format($sub_cont_jan, 2));
		$sheet->setCellValue('G' . $row, number_format($sub_val_feb, 0));
		$sheet->setCellValue('H' . $row, number_format($sub_cont_feb, 2));
		$sheet->setCellValue('I' . $row, number_format($sub_val_mar, 0));
		$sheet->setCellValue('J' . $row, number_format($sub_cont_mar, 2));
		$sheet->setCellValue('K' . $row, number_format($sub_val_apr, 0));
		$sheet->setCellValue('L' . $row, number_format($sub_cont_apr, 2));
		$sheet->setCellValue('M' . $row, number_format($sub_val_mei, 0));
		$sheet->setCellValue('N' . $row, number_format($sub_cont_mei, 2));
		$sheet->setCellValue('O' . $row, number_format($sub_val_jun, 0));
		$sheet->setCellValue('P' . $row, number_format($sub_cont_jun, 2));
		$sheet->setCellValue('Q' . $row, number_format($sub_val_jul, 0));
		$sheet->setCellValue('R' . $row, number_format($sub_cont_jul, 2));
		$sheet->setCellValue('S' . $row, number_format($sub_val_agu, 0));
		$sheet->setCellValue('T' . $row, number_format($sub_cont_agu, 2));
		$sheet->setCellValue('U' . $row, number_format($sub_val_sep, 0));
		$sheet->setCellValue('V' . $row, number_format($sub_cont_sep, 2));
		$sheet->setCellValue('W' . $row, number_format($sub_val_okt, 0));
		$sheet->setCellValue('X' . $row, number_format($sub_cont_okt, 2));
		$sheet->setCellValue('Y' . $row, number_format($sub_val_nop, 0));
		$sheet->setCellValue('Z' . $row, number_format($sub_cont_nop, 2));
		$sheet->setCellValue('AA' . $row, number_format($sub_val_des, 0));
		$sheet->setCellValue('AB' . $row, number_format($sub_cont_des, 2));
		$sheet->setCellValue('AC' . $row, number_format($sub_val_year, 0));
		$sheet->setCellValue('AD' . $row, number_format($sub_cont_year, 2));

		// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
		$sheet->getStyle('A' . $row)->applyFromArray($style_row);
		$sheet->getStyle('B' . $row)->applyFromArray($style_row);
		$sheet->getStyle('C' . $row)->applyFromArray($style_row);
		$sheet->getStyle('D' . $row)->applyFromArray($style_row);
		$sheet->getStyle('E' . $row)->applyFromArray($style_row);
		$sheet->getStyle('F' . $row)->applyFromArray($style_row);
		$sheet->getStyle('G' . $row)->applyFromArray($style_row);
		$sheet->getStyle('H' . $row)->applyFromArray($style_row);
		$sheet->getStyle('I' . $row)->applyFromArray($style_row);
		$sheet->getStyle('J' . $row)->applyFromArray($style_row);
		$sheet->getStyle('K' . $row)->applyFromArray($style_row);
		$sheet->getStyle('L' . $row)->applyFromArray($style_row);
		$sheet->getStyle('M' . $row)->applyFromArray($style_row);
		$sheet->getStyle('N' . $row)->applyFromArray($style_row);
		$sheet->getStyle('O' . $row)->applyFromArray($style_row);
		$sheet->getStyle('P' . $row)->applyFromArray($style_row);
		$sheet->getStyle('Q' . $row)->applyFromArray($style_row);
		$sheet->getStyle('R' . $row)->applyFromArray($style_row);
		$sheet->getStyle('S' . $row)->applyFromArray($style_row);
		$sheet->getStyle('T' . $row)->applyFromArray($style_row);
		$sheet->getStyle('U' . $row)->applyFromArray($style_row);
		$sheet->getStyle('V' . $row)->applyFromArray($style_row);
		$sheet->getStyle('W' . $row)->applyFromArray($style_row);
		$sheet->getStyle('X' . $row)->applyFromArray($style_row);
		$sheet->getStyle('Y' . $row)->applyFromArray($style_row);
		$sheet->getStyle('Z' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AA' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AB' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AC' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AD' . $row)->applyFromArray($style_row);

		$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('I' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('J' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('K' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('L' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('M' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('N' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('O' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('P' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('Q' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('R' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('S' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('T' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('U' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('V' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('W' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('X' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('Y' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('Z' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AA' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AB' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AC' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AD' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		
		$sheet->getStyle('A' . $row . ':AD' . $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');
		$sheet->getStyle('A' . $row . ':AD' . $row)->getFont()->setBold(true);

		//island end
		$row = $row + 1;
		$sheet->setCellValue('A' . $row, '');
		$sheet->setCellValue('B' . $row, '');
		$sheet->setCellValue('C' . $row, '');
		$sheet->setCellValue('D' . $row, $island);
		$sheet->setCellValue('E' . $row, number_format($total_val_jan, 2));
		$sheet->setCellValue('F' . $row, number_format($total_cont_jan, 2));
		$sheet->setCellValue('G' . $row, number_format($total_val_feb, 2));
		$sheet->setCellValue('H' . $row, number_format($total_cont_feb, 2));
		$sheet->setCellValue('I' . $row, number_format($total_val_mar, 2));
		$sheet->setCellValue('J' . $row, number_format($total_cont_mar, 2));
		$sheet->setCellValue('K' . $row, number_format($total_val_apr, 2));
		$sheet->setCellValue('L' . $row, number_format($total_cont_apr, 2));
		$sheet->setCellValue('M' . $row, number_format($total_val_mei, 2));
		$sheet->setCellValue('N' . $row, number_format($total_cont_mei, 2));
		$sheet->setCellValue('O' . $row, number_format($total_val_jun, 2));
		$sheet->setCellValue('P' . $row, number_format($total_cont_jun, 2));
		$sheet->setCellValue('Q' . $row, number_format($total_val_jul, 2));
		$sheet->setCellValue('R' . $row, number_format($total_cont_jul, 2));
		$sheet->setCellValue('S' . $row, number_format($total_val_agu, 2));
		$sheet->setCellValue('T' . $row, number_format($total_cont_agu, 2));
		$sheet->setCellValue('U' . $row, number_format($total_val_sep, 2));
		$sheet->setCellValue('V' . $row, number_format($total_cont_sep, 2));
		$sheet->setCellValue('W' . $row, number_format($total_val_okt, 2));
		$sheet->setCellValue('X' . $row, number_format($total_cont_okt, 2));
		$sheet->setCellValue('Y' . $row, number_format($total_val_nop, 2));
		$sheet->setCellValue('Z' . $row, number_format($total_cont_nop, 2));
		$sheet->setCellValue('AA' . $row, number_format($total_val_des, 2));
		$sheet->setCellValue('AB' . $row, number_format($total_cont_des, 2));
		$sheet->setCellValue('AC' . $row, number_format($total_val_year, 2));
		$sheet->setCellValue('AD' . $row, number_format($total_cont_year, 2));

		// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
		$sheet->getStyle('A' . $row)->applyFromArray($style_row);
		$sheet->getStyle('B' . $row)->applyFromArray($style_row);
		$sheet->getStyle('C' . $row)->applyFromArray($style_row);
		$sheet->getStyle('D' . $row)->applyFromArray($style_row);
		$sheet->getStyle('E' . $row)->applyFromArray($style_row);
		$sheet->getStyle('F' . $row)->applyFromArray($style_row);
		$sheet->getStyle('G' . $row)->applyFromArray($style_row);
		$sheet->getStyle('H' . $row)->applyFromArray($style_row);
		$sheet->getStyle('I' . $row)->applyFromArray($style_row);
		$sheet->getStyle('J' . $row)->applyFromArray($style_row);
		$sheet->getStyle('K' . $row)->applyFromArray($style_row);
		$sheet->getStyle('L' . $row)->applyFromArray($style_row);
		$sheet->getStyle('M' . $row)->applyFromArray($style_row);
		$sheet->getStyle('N' . $row)->applyFromArray($style_row);
		$sheet->getStyle('O' . $row)->applyFromArray($style_row);
		$sheet->getStyle('P' . $row)->applyFromArray($style_row);
		$sheet->getStyle('Q' . $row)->applyFromArray($style_row);
		$sheet->getStyle('R' . $row)->applyFromArray($style_row);
		$sheet->getStyle('S' . $row)->applyFromArray($style_row);
		$sheet->getStyle('T' . $row)->applyFromArray($style_row);
		$sheet->getStyle('U' . $row)->applyFromArray($style_row);
		$sheet->getStyle('V' . $row)->applyFromArray($style_row);
		$sheet->getStyle('W' . $row)->applyFromArray($style_row);
		$sheet->getStyle('X' . $row)->applyFromArray($style_row);
		$sheet->getStyle('Y' . $row)->applyFromArray($style_row);
		$sheet->getStyle('Z' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AA' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AB' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AC' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AD' . $row)->applyFromArray($style_row);

		$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('I' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('J' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('K' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('L' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('M' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('N' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('O' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('P' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('Q' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('R' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('S' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('T' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('U' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('V' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('W' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('X' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('Y' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('Z' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AA' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AB' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AC' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AD' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

		$sheet->getStyle('A' . $row . ':AD' . $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFA07A');
		$sheet->getStyle('A' . $row . ':AD' . $row)->getFont()->setBold(true);

		//national
		$row = $row + 1;
		$sheet->setCellValue('A' . $row, '');
		$sheet->setCellValue('B' . $row, '');
		$sheet->setCellValue('C' . $row, '');
		$sheet->setCellValue('D' . $row, 'NATIONAL');
		$sheet->setCellValue('E' . $row, number_format($grandtotal_val_jan, 2));
		$sheet->setCellValue('F' . $row, number_format($grandtotal_cont_jan, 2));
		$sheet->setCellValue('G' . $row, number_format($grandtotal_val_feb, 2));
		$sheet->setCellValue('H' . $row, number_format($grandtotal_cont_feb, 2));
		$sheet->setCellValue('I' . $row, number_format($grandtotal_val_mar, 2));
		$sheet->setCellValue('J' . $row, number_format($grandtotal_cont_mar, 2));
		$sheet->setCellValue('K' . $row, number_format($grandtotal_val_apr, 2));
		$sheet->setCellValue('L' . $row, number_format($grandtotal_cont_apr, 2));
		$sheet->setCellValue('M' . $row, number_format($grandtotal_val_mei, 2));
		$sheet->setCellValue('N' . $row, number_format($grandtotal_cont_mei, 2));
		$sheet->setCellValue('O' . $row, number_format($grandtotal_val_jun, 2));
		$sheet->setCellValue('P' . $row, number_format($grandtotal_cont_jun, 2));
		$sheet->setCellValue('Q' . $row, number_format($grandtotal_val_jul, 2));
		$sheet->setCellValue('R' . $row, number_format($grandtotal_cont_jul, 2));
		$sheet->setCellValue('S' . $row, number_format($grandtotal_val_agu, 2));
		$sheet->setCellValue('T' . $row, number_format($grandtotal_cont_agu, 2));
		$sheet->setCellValue('U' . $row, number_format($grandtotal_val_sep, 2));
		$sheet->setCellValue('V' . $row, number_format($grandtotal_cont_sep, 2));
		$sheet->setCellValue('W' . $row, number_format($grandtotal_val_okt, 2));
		$sheet->setCellValue('X' . $row, number_format($grandtotal_cont_okt, 2));
		$sheet->setCellValue('Y' . $row, number_format($grandtotal_val_nop, 2));
		$sheet->setCellValue('Z' . $row, number_format($grandtotal_cont_nop, 2));
		$sheet->setCellValue('AA' . $row, number_format($grandtotal_val_des, 2));
		$sheet->setCellValue('AB' . $row, number_format($grandtotal_cont_des, 2));
		$sheet->setCellValue('AC' . $row, number_format($grandtotal_val_year, 2));
		$sheet->setCellValue('AD' . $row, number_format($grandtotal_cont_year, 2));

		// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
		$sheet->getStyle('A' . $row)->applyFromArray($style_row);
		$sheet->getStyle('B' . $row)->applyFromArray($style_row);
		$sheet->getStyle('C' . $row)->applyFromArray($style_row);
		$sheet->getStyle('D' . $row)->applyFromArray($style_row);
		$sheet->getStyle('E' . $row)->applyFromArray($style_row);
		$sheet->getStyle('F' . $row)->applyFromArray($style_row);
		$sheet->getStyle('G' . $row)->applyFromArray($style_row);
		$sheet->getStyle('H' . $row)->applyFromArray($style_row);
		$sheet->getStyle('I' . $row)->applyFromArray($style_row);
		$sheet->getStyle('J' . $row)->applyFromArray($style_row);
		$sheet->getStyle('K' . $row)->applyFromArray($style_row);
		$sheet->getStyle('L' . $row)->applyFromArray($style_row);
		$sheet->getStyle('M' . $row)->applyFromArray($style_row);
		$sheet->getStyle('N' . $row)->applyFromArray($style_row);
		$sheet->getStyle('O' . $row)->applyFromArray($style_row);
		$sheet->getStyle('P' . $row)->applyFromArray($style_row);
		$sheet->getStyle('Q' . $row)->applyFromArray($style_row);
		$sheet->getStyle('R' . $row)->applyFromArray($style_row);
		$sheet->getStyle('S' . $row)->applyFromArray($style_row);
		$sheet->getStyle('T' . $row)->applyFromArray($style_row);
		$sheet->getStyle('U' . $row)->applyFromArray($style_row);
		$sheet->getStyle('V' . $row)->applyFromArray($style_row);
		$sheet->getStyle('W' . $row)->applyFromArray($style_row);
		$sheet->getStyle('X' . $row)->applyFromArray($style_row);
		$sheet->getStyle('Y' . $row)->applyFromArray($style_row);
		$sheet->getStyle('Z' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AA' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AB' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AC' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AD' . $row)->applyFromArray($style_row);

		$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('I' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('J' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('K' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('L' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('M' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('N' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('O' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('P' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('Q' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('R' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('S' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('T' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('U' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('V' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('W' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('X' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('Y' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('Z' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AA' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AB' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AC' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AD' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

		$sheet->getStyle('A' . $row . ':AD' . $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFA07A');
		$sheet->getStyle('A' . $row . ':AD' . $row)->getFont()->setBold(true);


		//set columns width
		$sheet->getColumnDimension('A')->setWidth(5); 
		$sheet->getColumnDimension('B')->setWidth(11); 
		$sheet->getColumnDimension('C')->setWidth(40);
		$sheet->getColumnDimension('D')->setWidth(15);
		$sheet->getColumnDimension('E')->setWidth(16);
		$sheet->getColumnDimension('F')->setWidth(10);
		$sheet->getColumnDimension('G')->setWidth(16);
		$sheet->getColumnDimension('H')->setWidth(10);
		$sheet->getColumnDimension('I')->setWidth(16);
		$sheet->getColumnDimension('J')->setWidth(10);
		$sheet->getColumnDimension('K')->setWidth(16);
		$sheet->getColumnDimension('L')->setWidth(10);
		$sheet->getColumnDimension('M')->setWidth(16);
		$sheet->getColumnDimension('N')->setWidth(10);
		$sheet->getColumnDimension('O')->setWidth(16);
		$sheet->getColumnDimension('P')->setWidth(10);
		$sheet->getColumnDimension('Q')->setWidth(16);
		$sheet->getColumnDimension('R')->setWidth(10);
		$sheet->getColumnDimension('S')->setWidth(16);
		$sheet->getColumnDimension('T')->setWidth(10);
		$sheet->getColumnDimension('U')->setWidth(16);
		$sheet->getColumnDimension('V')->setWidth(10);
		$sheet->getColumnDimension('W')->setWidth(16);
		$sheet->getColumnDimension('X')->setWidth(10);
		$sheet->getColumnDimension('Y')->setWidth(16);
		$sheet->getColumnDimension('Z')->setWidth(10);
		$sheet->getColumnDimension('AA')->setWidth(16);
		$sheet->getColumnDimension('AB')->setWidth(10);
		$sheet->getColumnDimension('AC')->setWidth(16);
		$sheet->getColumnDimension('AD')->setWidth(10);

		// Set orientasi kertas jadi LANDSCAPE
		$sheet->getPageSetup()->setOrientation(\PhpOffice\PhpSpreadsheet\Worksheet\PageSetup::ORIENTATION_LANDSCAPE);
		// Set judul file excel nya
		$sheet->setTitle("Selling In - Contribution");
		// Proses file excel
		header('Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet');
		header('Content-Disposition: attachment; filename="Report Selling In - Contribution ("' . $year . '").xlsx"'); // Set nama file excel nya
		header('Cache-Control: max-age=0');

		$writer = new Xlsx($spreadsheet);
		$writer->save('php://output');


	}

	public function export_sellingin_asm()
	{
		$spreadsheet = new Spreadsheet();
		$sheet = $spreadsheet->getActiveSheet();
		// Buat sebuah variabel untuk menampung pengaturan style dari header tabel
		$style_col = [
			'font' => ['bold' => true], // Set font nya jadi bold
			'alignment' => [
				'horizontal' => \PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER, // Set text jadi ditengah secara horizontal (center)
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'top' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border top dengan garis tipis
				'right' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN],  // Set border right dengan garis tipis
				'bottom' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border bottom dengan garis tipis
				'left' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN] // Set border left dengan garis tipis
			]
		];
		// Buat sebuah variabel untuk menampung pengaturan style dari isi tabel
		$style_row = [
			'alignment' => [
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'top' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border top dengan garis tipis
				'right' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN],  // Set border right dengan garis tipis
				'bottom' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border bottom dengan garis tipis
				'left' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN] // Set border left dengan garis tipis
			]
		];


		if (isset($_POST['by_principal']))
		{
			$principal = $_POST['by_principal'];
		}
		else
		{
			$principal = "";
		}
		if (isset($_POST['by_year']))
		{
			$year = $_POST['by_year'];
		}
		else
		{
			$year = "";
		}

		if (isset($_POST['by_month']))
		{
			$month = $_POST['by_month'];
		}
		else
		{
			$month = "";
		}


		$sheet->setCellValue('A1', "Report Selling In - ASM (" . $year . ")"); // Set kolom A1 dengan tulisan "Report Selling In - By Outlet"
		$sheet->setCellValue('A2', "Principal : " . $principal); // Set kolom A2 dengan tulisan "Outlet Type : EC_EC"
		//$sheet->mergeCells('A1:F1'); // Set Merge Cell pada kolom A1 sampai F1
		$sheet->getStyle('A1')->getFont()->setBold(true); // Set bold kolom A1
		$sheet->getStyle('A2')->getFont()->setBold(true); // Set bold kolom A2
		$sheet->getStyle('A1')->getFont()->setSize(20); // Set font size 15 untuk kolom A1
		// Buat header tabel nya pada baris ke 4
		$sheet->setCellValue('A4', "#"); // Set kolom A4 dengan tulisan "#"
		$sheet->mergeCells('A4:A5'); // Set Merge Row pada kolom A4 sampai A6
		$sheet->setCellValue('B4', "ASM");
		$sheet->mergeCells('B4:B5'); 
		$sheet->setCellValue('C4', "Distributor"); 
		$sheet->mergeCells('C4:C5'); 
		$sheet->setCellValue('D4', "Area"); 
		$sheet->mergeCells('D4:D5'); 
		$sheet->setCellValue('E4', date('F', mktime(0, 0, 0, $month, 10)));
		$sheet->mergeCells('E4:G4');
		$sheet->setCellValue('E5', "Actual");
		$sheet->setCellValue('F5', "Target");
		$sheet->setCellValue('G5', "%");
		

		// Apply style header yang telah kita buat tadi ke masing-masing kolom header
		$sheet->getStyle('A4')->applyFromArray($style_col);
		$sheet->getStyle('B4')->applyFromArray($style_col);
		$sheet->getStyle('C4')->applyFromArray($style_col);
		$sheet->getStyle('D4')->applyFromArray($style_col);
		$sheet->getStyle('E4')->applyFromArray($style_col);
		$sheet->getStyle('F4')->applyFromArray($style_col);
		$sheet->getStyle('G4')->applyFromArray($style_col);
		$sheet->getStyle('A5')->applyFromArray($style_col);
		$sheet->getStyle('B5')->applyFromArray($style_col);
		$sheet->getStyle('C5')->applyFromArray($style_col);
		$sheet->getStyle('D5')->applyFromArray($style_col);
		$sheet->getStyle('E5')->applyFromArray($style_col);
		$sheet->getStyle('F5')->applyFromArray($style_col);
		$sheet->getStyle('G5')->applyFromArray($style_col);
		

		$sheet->getStyle('A4:G5')->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');

		// Set height baris ke 1 dan 2
		$sheet->getRowDimension('1')->setRowHeight(40);
		$sheet->getRowDimension('2')->setRowHeight(20);


		$asm = '';
		$area = '';

		$actual = 0;
		$target = 0;
		$p = 0;

		$sub_actual = 0;
		$sub_target = 0;
		$sub_p = 0;

		$total_actual = 0;
		$total_target = 0;
		$total_p = 0;


		$no = 1; // Untuk penomoran tabel, di awal set dengan 1
		$row = 6;

		$data1 = array(
			'principal' => $principal,
			'year' => $year,
			'month' => $month
		);

		$data['sellingin_asm'] = $this->model('ReportModel')->getSellingIn_ASM2($data1);
		//$data['sellingin_OT'] = $this->model('ReportModel')->getSellingIn_OT2();

		foreach ($data['sellingin_asm'] as $rows) :

			if ($asm != $rows['asm'] and $asm != '' )
            {
				
				$sheet->setCellValue('A' . $row, '');
				$sheet->setCellValue('B' . $row, $asm);
				$sheet->setCellValue('C' . $row, '');
				$sheet->setCellValue('D' . $row, '');
				$sheet->setCellValue('E' . $row, number_format($sub_actual, 2));
				$sheet->setCellValue('F' . $row, number_format($sub_target, 2));
				$sheet->setCellValue('G' . $row, number_format($sub_p, 2) . '%');

				// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
				$sheet->getStyle('A' . $row)->applyFromArray($style_row);
				$sheet->getStyle('B' . $row)->applyFromArray($style_row);
				$sheet->getStyle('C' . $row)->applyFromArray($style_row);
				$sheet->getStyle('D' . $row)->applyFromArray($style_row);
				$sheet->getStyle('E' . $row)->applyFromArray($style_row);
				$sheet->getStyle('F' . $row)->applyFromArray($style_row);
				$sheet->getStyle('G' . $row)->applyFromArray($style_row);

				$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
				$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
				$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
				$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
				$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

				$sheet->getStyle('A' . $row . ':G' . $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');
				$sheet->getStyle('A' . $row . ':G' . $row)->getFont()->setBold(true);

				$sub_actual = 0;
				$sub_target = 0;
				$sub_p = 0;

				$row++;
            }

			$sheet->setCellValue('A' . $row, $no);
    		$sheet->setCellValue('B' . $row, $rows['asm']);
			$sheet->setCellValue('C' . $row, $rows['distributor']);
			$sheet->setCellValue('D' . $row, $rows['area']);
			$sheet->setCellValue('E' . $row, number_format($rows['value'], 2));
			$sheet->setCellValue('F' . $row, number_format($rows['value_target'], 2));
			$sheet->setCellValue('G' . $row, number_format($rows['p'], 2) . '%');

			// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
			$sheet->getStyle('A' . $row)->applyFromArray($style_row);
			$sheet->getStyle('B' . $row)->applyFromArray($style_row);
			$sheet->getStyle('C' . $row)->applyFromArray($style_row);
			$sheet->getStyle('D' . $row)->applyFromArray($style_row);
			$sheet->getStyle('E' . $row)->applyFromArray($style_row);
			$sheet->getStyle('F' . $row)->applyFromArray($style_row);
			$sheet->getStyle('G' . $row)->applyFromArray($style_row);

			$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

			$asm = $rows['asm'];

			$sub_actual += $rows['value'];

			if($area != $rows['area'])
			{
				$sub_target += $rows['value_target'];
				$total_target += $rows['value_target'];
			}

			$sub_p = ($sub_actual/($sub_target ?: 1))*100;
			$total_actual += $rows['value'];
			$total_p = ($total_actual/($total_target ?: 1))*100;

			$area = $rows['area'];

			$no++; // Tambah 1 setiap kali looping
    		$row++; // Tambah 1 setiap kali looping
		endforeach;

		//asm end
		//$row = $row + 1;
		$sheet->setCellValue('A' . $row, '');
		$sheet->setCellValue('B' . $row, $asm);
		$sheet->setCellValue('C' . $row, '');
		$sheet->setCellValue('D' . $row, '');
		$sheet->setCellValue('E' . $row, number_format($sub_actual, 2));
		$sheet->setCellValue('F' . $row, number_format($sub_target, 2));
		$sheet->setCellValue('G' . $row, number_format($sub_p, 2) . '%');

		// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
		$sheet->getStyle('A' . $row)->applyFromArray($style_row);
		$sheet->getStyle('B' . $row)->applyFromArray($style_row);
		$sheet->getStyle('C' . $row)->applyFromArray($style_row);
		$sheet->getStyle('D' . $row)->applyFromArray($style_row);
		$sheet->getStyle('E' . $row)->applyFromArray($style_row);
		$sheet->getStyle('F' . $row)->applyFromArray($style_row);
		$sheet->getStyle('G' . $row)->applyFromArray($style_row);

		$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

		$sheet->getStyle('A' . $row . ':G' . $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');
		$sheet->getStyle('A' . $row . ':G' . $row)->getFont()->setBold(true);

		//TOTAL
		$row = $row + 1;
		$sheet->setCellValue('A' . $row, '');
		$sheet->setCellValue('B' . $row, '');
		$sheet->setCellValue('C' . $row, 'GRAND TOTAL');
		$sheet->setCellValue('D' . $row, '');
		$sheet->setCellValue('E' . $row, number_format($total_actual, 2));
		$sheet->setCellValue('F' . $row, number_format($total_target, 2));
		$sheet->setCellValue('G' . $row, number_format($total_p, 2) . '%');

		// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
		$sheet->getStyle('A' . $row)->applyFromArray($style_row);
		$sheet->getStyle('B' . $row)->applyFromArray($style_row);
		$sheet->getStyle('C' . $row)->applyFromArray($style_row);
		$sheet->getStyle('D' . $row)->applyFromArray($style_row);
		$sheet->getStyle('E' . $row)->applyFromArray($style_row);
		$sheet->getStyle('F' . $row)->applyFromArray($style_row);
		$sheet->getStyle('G' . $row)->applyFromArray($style_row);

		$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

		$sheet->getStyle('A' . $row . ':G' . $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFA07A');
		$sheet->getStyle('A' . $row . ':G' . $row)->getFont()->setBold(true);


		//set columns width
		$sheet->getColumnDimension('A')->setWidth(5); 
		$sheet->getColumnDimension('B')->setWidth(18); 
		$sheet->getColumnDimension('C')->setWidth(60);
		$sheet->getColumnDimension('D')->setWidth(15);
		$sheet->getColumnDimension('E')->setWidth(16);
		$sheet->getColumnDimension('F')->setWidth(16);
		$sheet->getColumnDimension('G')->setWidth(10);

		// Set orientasi kertas jadi LANDSCAPE
		$sheet->getPageSetup()->setOrientation(\PhpOffice\PhpSpreadsheet\Worksheet\PageSetup::ORIENTATION_LANDSCAPE);
		// Set judul file excel nya
		$sheet->setTitle("Report Selling In - ASM");
		// Proses file excel
		header('Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet');
		header('Content-Disposition: attachment; filename="Report Selling In - ASM ("' . $year . '").xlsx"'); // Set nama file excel nya
		header('Cache-Control: max-age=0');

		$writer = new Xlsx($spreadsheet);
		$writer->save('php://output');


	}

	public function export_sellingout_asm()
	{
		$spreadsheet = new Spreadsheet();
		$sheet = $spreadsheet->getActiveSheet();
		// Buat sebuah variabel untuk menampung pengaturan style dari header tabel
		$style_col = [
			'font' => ['bold' => true], // Set font nya jadi bold
			'alignment' => [
				'horizontal' => \PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER, // Set text jadi ditengah secara horizontal (center)
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'top' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border top dengan garis tipis
				'right' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN],  // Set border right dengan garis tipis
				'bottom' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border bottom dengan garis tipis
				'left' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN] // Set border left dengan garis tipis
			]
		];
		// Buat sebuah variabel untuk menampung pengaturan style dari isi tabel
		$style_row = [
			'alignment' => [
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'top' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border top dengan garis tipis
				'right' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN],  // Set border right dengan garis tipis
				'bottom' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border bottom dengan garis tipis
				'left' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN] // Set border left dengan garis tipis
			]
		];


		if (isset($_POST['by_principal']))
		{
			$principal = $_POST['by_principal'];
		}
		else
		{
			$principal = "";
		}
		if (isset($_POST['by_year']))
		{
			$year = $_POST['by_year'];
		}
		else
		{
			$year = "";
		}

		if (isset($_POST['by_month']))
		{
			$month = $_POST['by_month'];
		}
		else
		{
			$month = "";
		}


		$sheet->setCellValue('A1', "Report Selling Out - ASM (" . $year . ")"); // Set kolom A1 dengan tulisan "Report Selling In - By Outlet"
		$sheet->setCellValue('A2', "Principal : " . $principal); // Set kolom A2 dengan tulisan "Outlet Type : EC_EC"
		//$sheet->mergeCells('A1:F1'); // Set Merge Cell pada kolom A1 sampai F1
		$sheet->getStyle('A1')->getFont()->setBold(true); // Set bold kolom A1
		$sheet->getStyle('A2')->getFont()->setBold(true); // Set bold kolom A2
		$sheet->getStyle('A1')->getFont()->setSize(20); // Set font size 15 untuk kolom A1
		// Buat header tabel nya pada baris ke 4
		$sheet->setCellValue('A4', "#"); // Set kolom A4 dengan tulisan "#"
		$sheet->mergeCells('A4:A5'); // Set Merge Row pada kolom A4 sampai A6
		$sheet->setCellValue('B4', "ASM");
		$sheet->mergeCells('B4:B5'); 
		$sheet->setCellValue('C4', "Distributor"); 
		$sheet->mergeCells('C4:C5'); 
		$sheet->setCellValue('D4', "Area"); 
		$sheet->mergeCells('D4:D5'); 
		$sheet->setCellValue('E4', date('F', mktime(0, 0, 0, $month, 10)));
		$sheet->mergeCells('E4:G4');
		$sheet->setCellValue('E5', "Actual");
		$sheet->setCellValue('F5', "Target");
		$sheet->setCellValue('G5', "%");
		

		// Apply style header yang telah kita buat tadi ke masing-masing kolom header
		$sheet->getStyle('A4')->applyFromArray($style_col);
		$sheet->getStyle('B4')->applyFromArray($style_col);
		$sheet->getStyle('C4')->applyFromArray($style_col);
		$sheet->getStyle('D4')->applyFromArray($style_col);
		$sheet->getStyle('E4')->applyFromArray($style_col);
		$sheet->getStyle('F4')->applyFromArray($style_col);
		$sheet->getStyle('G4')->applyFromArray($style_col);
		$sheet->getStyle('A5')->applyFromArray($style_col);
		$sheet->getStyle('B5')->applyFromArray($style_col);
		$sheet->getStyle('C5')->applyFromArray($style_col);
		$sheet->getStyle('D5')->applyFromArray($style_col);
		$sheet->getStyle('E5')->applyFromArray($style_col);
		$sheet->getStyle('F5')->applyFromArray($style_col);
		$sheet->getStyle('G5')->applyFromArray($style_col);
		

		$sheet->getStyle('A4:G5')->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');

		// Set height baris ke 1 dan 2
		$sheet->getRowDimension('1')->setRowHeight(40);
		$sheet->getRowDimension('2')->setRowHeight(20);


		$asm = '';
		$area = '';

		$actual = 0;
		$target = 0;
		$p = 0;

		$sub_actual = 0;
		$sub_target = 0;
		$sub_p = 0;

		$total_actual = 0;
		$total_target = 0;
		$total_p = 0;


		$no = 1; // Untuk penomoran tabel, di awal set dengan 1
		$row = 6;

		$data1 = array(
			'principal' => $principal,
			'year' => $year,
			'month' => $month
		);

		$data['sellingout_asm'] = $this->model('ReportModel')->getSellingOut_ASM2($data1);
		//$data['sellingin_OT'] = $this->model('ReportModel')->getSellingIn_OT2();

		foreach ($data['sellingout_asm'] as $rows) :

			if ($asm != $rows['asm'] and $asm != '' )
            {
				
				$sheet->setCellValue('A' . $row, '');
				$sheet->setCellValue('B' . $row, $asm);
				$sheet->setCellValue('C' . $row, '');
				$sheet->setCellValue('D' . $row, '');
				$sheet->setCellValue('E' . $row, number_format($sub_actual, 2));
				$sheet->setCellValue('F' . $row, number_format($sub_target, 2));
				$sheet->setCellValue('G' . $row, number_format($sub_p, 2) . '%');

				// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
				$sheet->getStyle('A' . $row)->applyFromArray($style_row);
				$sheet->getStyle('B' . $row)->applyFromArray($style_row);
				$sheet->getStyle('C' . $row)->applyFromArray($style_row);
				$sheet->getStyle('D' . $row)->applyFromArray($style_row);
				$sheet->getStyle('E' . $row)->applyFromArray($style_row);
				$sheet->getStyle('F' . $row)->applyFromArray($style_row);
				$sheet->getStyle('G' . $row)->applyFromArray($style_row);

				$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
				$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
				$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
				$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
				$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

				$sheet->getStyle('A' . $row . ':G' . $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');
				$sheet->getStyle('A' . $row . ':G' . $row)->getFont()->setBold(true);

				$sub_actual = 0;
				$sub_target = 0;
				$sub_p = 0;

				$row++;
            }

			$sheet->setCellValue('A' . $row, $no);
    		$sheet->setCellValue('B' . $row, $rows['asm']);
			$sheet->setCellValue('C' . $row, $rows['distributor']);
			$sheet->setCellValue('D' . $row, $rows['area']);
			$sheet->setCellValue('E' . $row, number_format($rows['value'], 2));
			$sheet->setCellValue('F' . $row, number_format($rows['value_target'], 2));
			$sheet->setCellValue('G' . $row, number_format($rows['p'], 2) . '%');

			// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
			$sheet->getStyle('A' . $row)->applyFromArray($style_row);
			$sheet->getStyle('B' . $row)->applyFromArray($style_row);
			$sheet->getStyle('C' . $row)->applyFromArray($style_row);
			$sheet->getStyle('D' . $row)->applyFromArray($style_row);
			$sheet->getStyle('E' . $row)->applyFromArray($style_row);
			$sheet->getStyle('F' . $row)->applyFromArray($style_row);
			$sheet->getStyle('G' . $row)->applyFromArray($style_row);

			$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

			$asm = $rows['asm'];

			$sub_actual += $rows['value'];

			if($area != $rows['area'])
			{
				$sub_target += $rows['value_target'];
				$total_target += $rows['value_target'];
			}

			$sub_p = ($sub_actual/($sub_target ?: 1))*100;
			$total_actual += $rows['value'];
			$total_p = ($total_actual/($total_target ?: 1))*100;

			$area = $rows['area'];

			$no++; // Tambah 1 setiap kali looping
    		$row++; // Tambah 1 setiap kali looping
		endforeach;

		//asm end
		//$row = $row + 1;
		$sheet->setCellValue('A' . $row, '');
		$sheet->setCellValue('B' . $row, $asm);
		$sheet->setCellValue('C' . $row, '');
		$sheet->setCellValue('D' . $row, '');
		$sheet->setCellValue('E' . $row, number_format($sub_actual, 2));
		$sheet->setCellValue('F' . $row, number_format($sub_target, 2));
		$sheet->setCellValue('G' . $row, number_format($sub_p, 2) . '%');

		// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
		$sheet->getStyle('A' . $row)->applyFromArray($style_row);
		$sheet->getStyle('B' . $row)->applyFromArray($style_row);
		$sheet->getStyle('C' . $row)->applyFromArray($style_row);
		$sheet->getStyle('D' . $row)->applyFromArray($style_row);
		$sheet->getStyle('E' . $row)->applyFromArray($style_row);
		$sheet->getStyle('F' . $row)->applyFromArray($style_row);
		$sheet->getStyle('G' . $row)->applyFromArray($style_row);

		$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

		$sheet->getStyle('A' . $row . ':G' . $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');
		$sheet->getStyle('A' . $row . ':G' . $row)->getFont()->setBold(true);

		//TOTAL
		$row = $row + 1;
		$sheet->setCellValue('A' . $row, '');
		$sheet->setCellValue('B' . $row, '');
		$sheet->setCellValue('C' . $row, 'GRAND TOTAL');
		$sheet->setCellValue('D' . $row, '');
		$sheet->setCellValue('E' . $row, number_format($total_actual, 2));
		$sheet->setCellValue('F' . $row, number_format($total_target, 2));
		$sheet->setCellValue('G' . $row, number_format($total_p, 2) . '%');

		// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
		$sheet->getStyle('A' . $row)->applyFromArray($style_row);
		$sheet->getStyle('B' . $row)->applyFromArray($style_row);
		$sheet->getStyle('C' . $row)->applyFromArray($style_row);
		$sheet->getStyle('D' . $row)->applyFromArray($style_row);
		$sheet->getStyle('E' . $row)->applyFromArray($style_row);
		$sheet->getStyle('F' . $row)->applyFromArray($style_row);
		$sheet->getStyle('G' . $row)->applyFromArray($style_row);

		$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

		$sheet->getStyle('A' . $row . ':G' . $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFA07A');
		$sheet->getStyle('A' . $row . ':G' . $row)->getFont()->setBold(true);


		//set columns width
		$sheet->getColumnDimension('A')->setWidth(5); 
		$sheet->getColumnDimension('B')->setWidth(18); 
		$sheet->getColumnDimension('C')->setWidth(60);
		$sheet->getColumnDimension('D')->setWidth(15);
		$sheet->getColumnDimension('E')->setWidth(16);
		$sheet->getColumnDimension('F')->setWidth(16);
		$sheet->getColumnDimension('G')->setWidth(10);

		// Set orientasi kertas jadi LANDSCAPE
		$sheet->getPageSetup()->setOrientation(\PhpOffice\PhpSpreadsheet\Worksheet\PageSetup::ORIENTATION_LANDSCAPE);
		// Set judul file excel nya
		$sheet->setTitle("Report Selling Out - ASM");
		// Proses file excel
		header('Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet');
		header('Content-Disposition: attachment; filename="Report Selling Out - ASM ("' . $year . '").xlsx"'); // Set nama file excel nya
		header('Cache-Control: max-age=0');

		$writer = new Xlsx($spreadsheet);
		$writer->save('php://output');

	}


	public function export_sellingin_dist()
	{
		$spreadsheet = new Spreadsheet();
		$sheet = $spreadsheet->getActiveSheet();
		// Buat sebuah variabel untuk menampung pengaturan style dari header tabel
		$style_col = [
			'font' => ['bold' => true], // Set font nya jadi bold
			'alignment' => [
				'horizontal' => \PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER, // Set text jadi ditengah secara horizontal (center)
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'top' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border top dengan garis tipis
				'right' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN],  // Set border right dengan garis tipis
				'bottom' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border bottom dengan garis tipis
				'left' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN] // Set border left dengan garis tipis
			]
		];
		// Buat sebuah variabel untuk menampung pengaturan style dari isi tabel
		$style_row = [
			'alignment' => [
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'top' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border top dengan garis tipis
				'right' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN],  // Set border right dengan garis tipis
				'bottom' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border bottom dengan garis tipis
				'left' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN] // Set border left dengan garis tipis
			]
		];


		if (isset($_POST['by_principal']))
		{
			$principal = $_POST['by_principal'];
		}
		else
		{
			$principal = "";
		}
		if (isset($_POST['by_year']))
		{
			$year = $_POST['by_year'];
		}
		else
		{
			$year = "";
		}


		$sheet->setCellValue('A1', "Report Selling In - Distributor (" . $year . ")"); // Set kolom A1 dengan tulisan "Report Selling In - By Outlet"
		$sheet->setCellValue('A2', "Principal : " . $principal); // Set kolom A2 dengan tulisan "Outlet Type : EC_EC"
		//$sheet->mergeCells('A1:F1'); // Set Merge Cell pada kolom A1 sampai F1
		$sheet->getStyle('A1')->getFont()->setBold(true); // Set bold kolom A1
		$sheet->getStyle('A2')->getFont()->setBold(true); // Set bold kolom A2
		$sheet->getStyle('A1')->getFont()->setSize(20); // Set font size 15 untuk kolom A1
		// Buat header tabel nya pada baris ke 4
		$sheet->setCellValue('A4', "#"); // Set kolom A4 dengan tulisan "#"
		$sheet->mergeCells('A4:A6'); // Set Merge Row pada kolom A4 sampai A6
		$sheet->setCellValue('B4', "Cust Code");
		$sheet->mergeCells('B4:B6'); 
		$sheet->setCellValue('C4', "Distributor"); 
		$sheet->mergeCells('C4:C6'); 
		$sheet->setCellValue('D4', "Area"); 
		$sheet->mergeCells('D4:D6'); 
		$sheet->setCellValue('E4', "Month");
		$sheet->mergeCells('E4:AB4');
		$sheet->setCellValue('AC4', "Total");
		$sheet->mergeCells('AC4:AD5');
		$sheet->setCellValue('AE4', "Average");
		$sheet->mergeCells('AE4:AF5');
		$sheet->setCellValue('E5', "January");
		$sheet->mergeCells('E5:F5');
		$sheet->setCellValue('G5', "February");
		$sheet->mergeCells('G5:H5');
		$sheet->setCellValue('I5', "March");
		$sheet->mergeCells('I5:J5');
		$sheet->setCellValue('K5', "April");
		$sheet->mergeCells('K5:L5');
		$sheet->setCellValue('M5', "May");
		$sheet->mergeCells('M5:N5');
		$sheet->setCellValue('O5', "June");
		$sheet->mergeCells('O5:P5');
		$sheet->setCellValue('Q5', "July");
		$sheet->mergeCells('Q5:R5');
		$sheet->setCellValue('S5', "August");
		$sheet->mergeCells('S5:T5');
		$sheet->setCellValue('U5', "September");
		$sheet->mergeCells('U5:V5');
		$sheet->setCellValue('W5', "October");
		$sheet->mergeCells('W5:X5');
		$sheet->setCellValue('Y5', "November");
		$sheet->mergeCells('Y5:Z5');
		$sheet->setCellValue('AA5', "December");
		$sheet->mergeCells('AA5:AB5');
		$sheet->setCellValue('E6', "Qty");
		$sheet->setCellValue('F6', "Value");
		$sheet->setCellValue('G6', "Qty");
		$sheet->setCellValue('H6', "Value");
		$sheet->setCellValue('I6', "Qty");
		$sheet->setCellValue('J6', "Value");
		$sheet->setCellValue('K6', "Qty");
		$sheet->setCellValue('L6', "Value");
		$sheet->setCellValue('M6', "Qty");
		$sheet->setCellValue('N6', "Value");
		$sheet->setCellValue('O6', "Qty");
		$sheet->setCellValue('P6', "Value");
		$sheet->setCellValue('Q6', "Qty");
		$sheet->setCellValue('R6', "Value");
		$sheet->setCellValue('S6', "Qty");
		$sheet->setCellValue('T6', "Value");
		$sheet->setCellValue('U6', "Qty");
		$sheet->setCellValue('V6', "Value");
		$sheet->setCellValue('W6', "Qty");
		$sheet->setCellValue('X6', "Value");
		$sheet->setCellValue('Y6', "Qty");
		$sheet->setCellValue('Z6', "Value");
		$sheet->setCellValue('AA6', "Qty");
		$sheet->setCellValue('AB6', "Value");
		$sheet->setCellValue('AC6', "Qty");
		$sheet->setCellValue('AD6', "Value");
		$sheet->setCellValue('AE6', "Qty");
		$sheet->setCellValue('AF6', "Value");

		// Apply style header yang telah kita buat tadi ke masing-masing kolom header
		$sheet->getStyle('A4')->applyFromArray($style_col);
		$sheet->getStyle('B4')->applyFromArray($style_col);
		$sheet->getStyle('C4')->applyFromArray($style_col);
		$sheet->getStyle('D4')->applyFromArray($style_col);
		$sheet->getStyle('E4')->applyFromArray($style_col);
		$sheet->getStyle('F4')->applyFromArray($style_col);
		$sheet->getStyle('G4')->applyFromArray($style_col);
		$sheet->getStyle('H4')->applyFromArray($style_col);
		$sheet->getStyle('I4')->applyFromArray($style_col);
		$sheet->getStyle('J4')->applyFromArray($style_col);
		$sheet->getStyle('K4')->applyFromArray($style_col);
		$sheet->getStyle('L4')->applyFromArray($style_col);
		$sheet->getStyle('M4')->applyFromArray($style_col);
		$sheet->getStyle('N4')->applyFromArray($style_col);
		$sheet->getStyle('O4')->applyFromArray($style_col);
		$sheet->getStyle('P4')->applyFromArray($style_col);
		$sheet->getStyle('Q4')->applyFromArray($style_col);
		$sheet->getStyle('R4')->applyFromArray($style_col);
		$sheet->getStyle('S4')->applyFromArray($style_col);
		$sheet->getStyle('T4')->applyFromArray($style_col);
		$sheet->getStyle('U4')->applyFromArray($style_col);
		$sheet->getStyle('V4')->applyFromArray($style_col);
		$sheet->getStyle('W4')->applyFromArray($style_col);
		$sheet->getStyle('X4')->applyFromArray($style_col);
		$sheet->getStyle('Y4')->applyFromArray($style_col);
		$sheet->getStyle('Z4')->applyFromArray($style_col);
		$sheet->getStyle('AA4')->applyFromArray($style_col);
		$sheet->getStyle('AB4')->applyFromArray($style_col);
		$sheet->getStyle('AC4')->applyFromArray($style_col);
		$sheet->getStyle('AD4')->applyFromArray($style_col);
		$sheet->getStyle('AE4')->applyFromArray($style_col);
		$sheet->getStyle('AF4')->applyFromArray($style_col);
		$sheet->getStyle('A5')->applyFromArray($style_col);
		$sheet->getStyle('B5')->applyFromArray($style_col);
		$sheet->getStyle('C5')->applyFromArray($style_col);
		$sheet->getStyle('D5')->applyFromArray($style_col);
		$sheet->getStyle('E5')->applyFromArray($style_col);
		$sheet->getStyle('F5')->applyFromArray($style_col);
		$sheet->getStyle('G5')->applyFromArray($style_col);
		$sheet->getStyle('H5')->applyFromArray($style_col);
		$sheet->getStyle('I5')->applyFromArray($style_col);
		$sheet->getStyle('J5')->applyFromArray($style_col);
		$sheet->getStyle('K5')->applyFromArray($style_col);
		$sheet->getStyle('L5')->applyFromArray($style_col);
		$sheet->getStyle('M5')->applyFromArray($style_col);
		$sheet->getStyle('N5')->applyFromArray($style_col);
		$sheet->getStyle('O5')->applyFromArray($style_col);
		$sheet->getStyle('P5')->applyFromArray($style_col);
		$sheet->getStyle('Q5')->applyFromArray($style_col);
		$sheet->getStyle('R5')->applyFromArray($style_col);
		$sheet->getStyle('S5')->applyFromArray($style_col);
		$sheet->getStyle('T5')->applyFromArray($style_col);
		$sheet->getStyle('U5')->applyFromArray($style_col);
		$sheet->getStyle('V5')->applyFromArray($style_col);
		$sheet->getStyle('W5')->applyFromArray($style_col);
		$sheet->getStyle('X5')->applyFromArray($style_col);
		$sheet->getStyle('Y5')->applyFromArray($style_col);
		$sheet->getStyle('Z5')->applyFromArray($style_col);
		$sheet->getStyle('AA5')->applyFromArray($style_col);
		$sheet->getStyle('AB5')->applyFromArray($style_col);
		$sheet->getStyle('AC5')->applyFromArray($style_col);
		$sheet->getStyle('AD5')->applyFromArray($style_col);
		$sheet->getStyle('AE5')->applyFromArray($style_col);
		$sheet->getStyle('AF5')->applyFromArray($style_col);
		$sheet->getStyle('A6')->applyFromArray($style_col);
		$sheet->getStyle('B6')->applyFromArray($style_col);
		$sheet->getStyle('C6')->applyFromArray($style_col);
		$sheet->getStyle('D6')->applyFromArray($style_col);
		$sheet->getStyle('E6')->applyFromArray($style_col);
		$sheet->getStyle('F6')->applyFromArray($style_col);
		$sheet->getStyle('G6')->applyFromArray($style_col);
		$sheet->getStyle('H6')->applyFromArray($style_col);
		$sheet->getStyle('I6')->applyFromArray($style_col);
		$sheet->getStyle('J6')->applyFromArray($style_col);
		$sheet->getStyle('K6')->applyFromArray($style_col);
		$sheet->getStyle('L6')->applyFromArray($style_col);
		$sheet->getStyle('M6')->applyFromArray($style_col);
		$sheet->getStyle('N6')->applyFromArray($style_col);
		$sheet->getStyle('O6')->applyFromArray($style_col);
		$sheet->getStyle('P6')->applyFromArray($style_col);
		$sheet->getStyle('Q6')->applyFromArray($style_col);
		$sheet->getStyle('R6')->applyFromArray($style_col);
		$sheet->getStyle('S6')->applyFromArray($style_col);
		$sheet->getStyle('T6')->applyFromArray($style_col);
		$sheet->getStyle('U6')->applyFromArray($style_col);
		$sheet->getStyle('V6')->applyFromArray($style_col);
		$sheet->getStyle('W6')->applyFromArray($style_col);
		$sheet->getStyle('X6')->applyFromArray($style_col);
		$sheet->getStyle('Y6')->applyFromArray($style_col);
		$sheet->getStyle('Z6')->applyFromArray($style_col);
		$sheet->getStyle('AA6')->applyFromArray($style_col);
		$sheet->getStyle('AB6')->applyFromArray($style_col);
		$sheet->getStyle('AC6')->applyFromArray($style_col);
		$sheet->getStyle('AD6')->applyFromArray($style_col);
		$sheet->getStyle('AE6')->applyFromArray($style_col);
		$sheet->getStyle('AF6')->applyFromArray($style_col);

		$sheet->getStyle('A4:AB6')->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');
		$sheet->getStyle('AC4:AD6')->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FF6D6D');
		$sheet->getStyle('AE4:AF6')->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('7BFF6D');

		// Set height baris ke 1 dan 2
		$sheet->getRowDimension('1')->setRowHeight(40);
		$sheet->getRowDimension('2')->setRowHeight(20);


		$region = '';
        $island = '';
        $qty_jan = 0;
        $qty_feb = 0;
        $qty_mar = 0;
        $qty_apr = 0;
        $qty_mei = 0;
        $qty_jun = 0;
        $qty_jul = 0;
        $qty_agu = 0;
        $qty_sep = 0;
        $qty_okt = 0;
        $qty_nop = 0;
        $qty_des = 0;
        $qty_year = 0;
        $qty_avg = 0;

        $val_jan = 0;
        $val_feb = 0;
        $val_mar = 0;
        $val_apr = 0;
        $val_mei = 0;
        $val_jun = 0;
        $val_jul = 0;
        $val_agu = 0;
        $val_sep = 0;
        $val_okt = 0;
        $val_nop = 0;
        $val_des = 0;
        $val_year = 0;
        $val_avg = 0;

        $sub_qty_jan = 0;
        $sub_qty_feb = 0;
        $sub_qty_mar = 0;
        $sub_qty_apr = 0;
        $sub_qty_mei = 0;
        $sub_qty_jun = 0;
        $sub_qty_jul = 0;
        $sub_qty_agu = 0;
        $sub_qty_sep = 0;
        $sub_qty_okt = 0;
        $sub_qty_nop = 0;
        $sub_qty_des = 0;
        $sub_qty_year = 0;
        $sub_qty_avg = 0;

        $sub_val_jan = 0;
        $sub_val_feb = 0;
        $sub_val_mar = 0;
        $sub_val_apr = 0;
        $sub_val_mei = 0;
        $sub_val_jun = 0;
        $sub_val_jul = 0;
        $sub_val_agu = 0;
        $sub_val_sep = 0;
        $sub_val_okt = 0;
        $sub_val_nop = 0;
        $sub_val_des = 0;
        $sub_val_year = 0;
        $sub_val_avg = 0;

        $total_qty_jan = 0;
        $total_qty_feb = 0;
        $total_qty_mar = 0;
        $total_qty_apr = 0;
        $total_qty_mei = 0;
        $total_qty_jun = 0;
        $total_qty_jul = 0;
        $total_qty_agu = 0;
        $total_qty_sep = 0;
        $total_qty_okt = 0;
        $total_qty_nop = 0;
        $total_qty_des = 0;
        $total_qty_year = 0;
        $total_qty_avg = 0;

        $total_val_jan = 0;
        $total_val_feb = 0;
        $total_val_mar = 0;
        $total_val_apr = 0;
        $total_val_mei = 0;
        $total_val_jun = 0;
        $total_val_jul = 0;
        $total_val_agu = 0;
        $total_val_sep = 0;
        $total_val_okt = 0;
        $total_val_nop = 0;
        $total_val_des = 0;
        $total_val_year = 0;
        $total_val_avg = 0;


		$no = 1; // Untuk penomoran tabel, di awal set dengan 1
		$row = 7;

		$data1 = array(
			'principal' => $principal,
			'year' => $year
		);

		$data['sellingin_Dist'] = $this->model('ReportModel')->getSellingIn_Dist2($data1);
		//$data['sellingin_OT'] = $this->model('ReportModel')->getSellingIn_OT2();

		foreach ($data['sellingin_Dist'] as $rows) :

			if ($region != $rows['region'] and $region != '' )
            {
				
				$sheet->setCellValue('A' . $row, '');
				$sheet->setCellValue('B' . $row, '');
				$sheet->setCellValue('C' . $row, '');
				$sheet->setCellValue('D' . $row, $region);
				$sheet->setCellValue('E' . $row, number_format($qty_jan, 0));
				$sheet->setCellValue('F' . $row, number_format($val_jan, 2));
				$sheet->setCellValue('G' . $row, number_format($qty_feb, 0));
				$sheet->setCellValue('H' . $row, number_format($val_feb, 2));
				$sheet->setCellValue('I' . $row, number_format($qty_mar, 0));
				$sheet->setCellValue('J' . $row, number_format($val_mar, 2));
				$sheet->setCellValue('K' . $row, number_format($qty_apr, 0));
				$sheet->setCellValue('L' . $row, number_format($val_apr, 2));
				$sheet->setCellValue('M' . $row, number_format($qty_mei, 0));
				$sheet->setCellValue('N' . $row, number_format($val_mei, 2));
				$sheet->setCellValue('O' . $row, number_format($qty_jun, 0));
				$sheet->setCellValue('P' . $row, number_format($val_jun, 2));
				$sheet->setCellValue('Q' . $row, number_format($qty_jul, 0));
				$sheet->setCellValue('R' . $row, number_format($val_jul, 2));
				$sheet->setCellValue('S' . $row, number_format($qty_agu, 0));
				$sheet->setCellValue('T' . $row, number_format($val_agu, 2));
				$sheet->setCellValue('U' . $row, number_format($qty_sep, 0));
				$sheet->setCellValue('V' . $row, number_format($val_sep, 2));
				$sheet->setCellValue('W' . $row, number_format($qty_okt, 0));
				$sheet->setCellValue('X' . $row, number_format($val_okt, 2));
				$sheet->setCellValue('Y' . $row, number_format($qty_nop, 0));
				$sheet->setCellValue('Z' . $row, number_format($val_nop, 2));
				$sheet->setCellValue('AA' . $row, number_format($qty_des, 0));
				$sheet->setCellValue('AB' . $row, number_format($val_des, 2));
				$sheet->setCellValue('AC' . $row, number_format($qty_year, 0));
				$sheet->setCellValue('AD' . $row, number_format($val_year, 2));
				$sheet->setCellValue('AE' . $row, number_format($qty_year/12, 0));
				$sheet->setCellValue('AF' . $row, number_format($val_year/12, 2));

				// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
				$sheet->getStyle('A' . $row)->applyFromArray($style_row);
				$sheet->getStyle('B' . $row)->applyFromArray($style_row);
				$sheet->getStyle('C' . $row)->applyFromArray($style_row);
				$sheet->getStyle('D' . $row)->applyFromArray($style_row);
				$sheet->getStyle('E' . $row)->applyFromArray($style_row);
				$sheet->getStyle('F' . $row)->applyFromArray($style_row);
				$sheet->getStyle('G' . $row)->applyFromArray($style_row);
				$sheet->getStyle('H' . $row)->applyFromArray($style_row);
				$sheet->getStyle('I' . $row)->applyFromArray($style_row);
				$sheet->getStyle('J' . $row)->applyFromArray($style_row);
				$sheet->getStyle('K' . $row)->applyFromArray($style_row);
				$sheet->getStyle('L' . $row)->applyFromArray($style_row);
				$sheet->getStyle('M' . $row)->applyFromArray($style_row);
				$sheet->getStyle('N' . $row)->applyFromArray($style_row);
				$sheet->getStyle('O' . $row)->applyFromArray($style_row);
				$sheet->getStyle('P' . $row)->applyFromArray($style_row);
				$sheet->getStyle('Q' . $row)->applyFromArray($style_row);
				$sheet->getStyle('R' . $row)->applyFromArray($style_row);
				$sheet->getStyle('S' . $row)->applyFromArray($style_row);
				$sheet->getStyle('T' . $row)->applyFromArray($style_row);
				$sheet->getStyle('U' . $row)->applyFromArray($style_row);
				$sheet->getStyle('V' . $row)->applyFromArray($style_row);
				$sheet->getStyle('W' . $row)->applyFromArray($style_row);
				$sheet->getStyle('X' . $row)->applyFromArray($style_row);
				$sheet->getStyle('Y' . $row)->applyFromArray($style_row);
				$sheet->getStyle('Z' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AA' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AB' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AC' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AD' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AE' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AF' . $row)->applyFromArray($style_row);

				$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
				$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
				$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
				$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
				$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('I' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('J' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('K' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('L' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('M' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('N' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('O' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('P' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('Q' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('R' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('S' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('T' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('U' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('V' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('W' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('X' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('Y' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('Z' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AA' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AB' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AC' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AD' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AE' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AF' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

				$sheet->getStyle('A' . $row . ':AF' . $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');
				$sheet->getStyle('A' . $row . ':AF' . $row)->getFont()->setBold(true);

				$qty_jan = 0;
                $qty_feb = 0;
                $qty_mar = 0;
                $qty_apr = 0;
                $qty_mei = 0;
                $qty_jun = 0;
                $qty_jul = 0;
                $qty_agu = 0;
                $qty_sep = 0;
                $qty_okt = 0;
                $qty_nop = 0;
                $qty_des = 0;
                $qty_year = 0;
                $qty_avg = 0;

                $val_jan = 0;
               	$val_feb = 0;
                $val_mar = 0;
                $val_apr = 0;
                $val_mei = 0;
                $val_jun = 0;
                $val_jul = 0;
                $val_agu = 0;
                $val_sep = 0;
                $val_okt = 0;
                $val_nop = 0;
                $val_des = 0;
                $val_year = 0;
                $val_avg = 0;

				$row++;
            }

			if ($island != $rows['island'] and $island != '' )
            {
				
				$sheet->setCellValue('A' . $row, '');
				$sheet->setCellValue('B' . $row, '');
				$sheet->setCellValue('C' . $row, '');
				$sheet->setCellValue('D' . $row, $island);
				$sheet->setCellValue('E' . $row, number_format($sub_qty_jan, 0));
				$sheet->setCellValue('F' . $row, number_format($sub_val_jan, 2));
				$sheet->setCellValue('G' . $row, number_format($sub_qty_feb, 0));
				$sheet->setCellValue('H' . $row, number_format($sub_val_feb, 2));
				$sheet->setCellValue('I' . $row, number_format($sub_qty_mar, 0));
				$sheet->setCellValue('J' . $row, number_format($sub_val_mar, 2));
				$sheet->setCellValue('K' . $row, number_format($sub_qty_apr, 0));
				$sheet->setCellValue('L' . $row, number_format($sub_val_apr, 2));
				$sheet->setCellValue('M' . $row, number_format($sub_qty_mei, 0));
				$sheet->setCellValue('N' . $row, number_format($sub_val_mei, 2));
				$sheet->setCellValue('O' . $row, number_format($sub_qty_jun, 0));
				$sheet->setCellValue('P' . $row, number_format($sub_val_jun, 2));
				$sheet->setCellValue('Q' . $row, number_format($sub_qty_jul, 0));
				$sheet->setCellValue('R' . $row, number_format($sub_val_jul, 2));
				$sheet->setCellValue('S' . $row, number_format($sub_qty_agu, 0));
				$sheet->setCellValue('T' . $row, number_format($sub_val_agu, 2));
				$sheet->setCellValue('U' . $row, number_format($sub_qty_sep, 0));
				$sheet->setCellValue('V' . $row, number_format($sub_val_sep, 2));
				$sheet->setCellValue('W' . $row, number_format($sub_qty_okt, 0));
				$sheet->setCellValue('X' . $row, number_format($sub_val_okt, 2));
				$sheet->setCellValue('Y' . $row, number_format($sub_qty_nop, 0));
				$sheet->setCellValue('Z' . $row, number_format($sub_val_nop, 2));
				$sheet->setCellValue('AA' . $row, number_format($sub_qty_des, 0));
				$sheet->setCellValue('AB' . $row, number_format($sub_val_des, 2));
				$sheet->setCellValue('AC' . $row, number_format($sub_qty_year, 0));
				$sheet->setCellValue('AD' . $row, number_format($sub_val_year, 2));
				$sheet->setCellValue('AE' . $row, number_format($sub_qty_year/12, 0));
				$sheet->setCellValue('AF' . $row, number_format($sub_val_year/12, 2));

				// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
				$sheet->getStyle('A' . $row)->applyFromArray($style_row);
				$sheet->getStyle('B' . $row)->applyFromArray($style_row);
				$sheet->getStyle('C' . $row)->applyFromArray($style_row);
				$sheet->getStyle('D' . $row)->applyFromArray($style_row);
				$sheet->getStyle('E' . $row)->applyFromArray($style_row);
				$sheet->getStyle('F' . $row)->applyFromArray($style_row);
				$sheet->getStyle('G' . $row)->applyFromArray($style_row);
				$sheet->getStyle('H' . $row)->applyFromArray($style_row);
				$sheet->getStyle('I' . $row)->applyFromArray($style_row);
				$sheet->getStyle('J' . $row)->applyFromArray($style_row);
				$sheet->getStyle('K' . $row)->applyFromArray($style_row);
				$sheet->getStyle('L' . $row)->applyFromArray($style_row);
				$sheet->getStyle('M' . $row)->applyFromArray($style_row);
				$sheet->getStyle('N' . $row)->applyFromArray($style_row);
				$sheet->getStyle('O' . $row)->applyFromArray($style_row);
				$sheet->getStyle('P' . $row)->applyFromArray($style_row);
				$sheet->getStyle('Q' . $row)->applyFromArray($style_row);
				$sheet->getStyle('R' . $row)->applyFromArray($style_row);
				$sheet->getStyle('S' . $row)->applyFromArray($style_row);
				$sheet->getStyle('T' . $row)->applyFromArray($style_row);
				$sheet->getStyle('U' . $row)->applyFromArray($style_row);
				$sheet->getStyle('V' . $row)->applyFromArray($style_row);
				$sheet->getStyle('W' . $row)->applyFromArray($style_row);
				$sheet->getStyle('X' . $row)->applyFromArray($style_row);
				$sheet->getStyle('Y' . $row)->applyFromArray($style_row);
				$sheet->getStyle('Z' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AA' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AB' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AC' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AD' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AE' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AF' . $row)->applyFromArray($style_row);

				$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
				$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
				$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
				$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
				$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('I' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('J' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('K' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('L' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('M' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('N' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('O' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('P' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('Q' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('R' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('S' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('T' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('U' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('V' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('W' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('X' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('Y' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('Z' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AA' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AB' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AC' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AD' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AE' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AF' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

				$sheet->getStyle('A' . $row . ':AF' . $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFA07A');
				$sheet->getStyle('A' . $row . ':AF' . $row)->getFont()->setBold(true);

				$sub_qty_jan = 0;
				$sub_qty_feb = 0;
				$sub_qty_mar = 0;
				$sub_qty_apr = 0;
				$sub_qty_mei = 0;
				$sub_qty_jun = 0;
				$sub_qty_jul = 0;
				$sub_qty_agu = 0;
				$sub_qty_sep = 0;
				$sub_qty_okt = 0;
				$sub_qty_nop = 0;
				$sub_qty_des = 0;
				$sub_qty_year = 0;
				$sub_qty_avg = 0;

				$sub_val_jan = 0;
				$sub_val_feb = 0;
				$sub_val_mar = 0;
				$sub_val_apr = 0;
				$sub_val_mei = 0;
				$sub_val_jun = 0;
				$sub_val_jul = 0;
				$sub_val_agu = 0;
				$sub_val_sep = 0;
				$sub_val_okt = 0;
				$sub_val_nop = 0;
				$sub_val_des = 0;
				$sub_val_year = 0;
				$sub_val_avg = 0;

				$row++;
            }

			$sheet->setCellValue('A' . $row, $no);
    		$sheet->setCellValue('B' . $row, $rows['cust_code']);
			$sheet->setCellValue('C' . $row, $rows['distributor']);
			$sheet->setCellValue('D' . $row, $rows['area']);
			$sheet->setCellValue('E' . $row, number_format($rows['qty_jan'], 0));
			$sheet->setCellValue('F' . $row, number_format($rows['val_jan'], 2));
			$sheet->setCellValue('G' . $row, number_format($rows['qty_feb'], 0));
			$sheet->setCellValue('H' . $row, number_format($rows['val_feb'], 2));
			$sheet->setCellValue('I' . $row, number_format($rows['qty_mar'], 0));
			$sheet->setCellValue('J' . $row, number_format($rows['val_mar'], 2));
			$sheet->setCellValue('K' . $row, number_format($rows['qty_apr'], 0));
			$sheet->setCellValue('L' . $row, number_format($rows['val_apr'], 2));
			$sheet->setCellValue('M' . $row, number_format($rows['qty_mei'], 0));
			$sheet->setCellValue('N' . $row, number_format($rows['val_mei'], 2));
			$sheet->setCellValue('O' . $row, number_format($rows['qty_jun'], 0));
			$sheet->setCellValue('P' . $row, number_format($rows['val_jun'], 2));
			$sheet->setCellValue('Q' . $row, number_format($rows['qty_jul'], 0));
			$sheet->setCellValue('R' . $row, number_format($rows['val_jul'], 2));
			$sheet->setCellValue('S' . $row, number_format($rows['qty_agu'], 0));
			$sheet->setCellValue('T' . $row, number_format($rows['val_agu'], 2));
			$sheet->setCellValue('U' . $row, number_format($rows['qty_sep'], 0));
			$sheet->setCellValue('V' . $row, number_format($rows['val_sep'], 2));
			$sheet->setCellValue('W' . $row, number_format($rows['qty_okt'], 0));
			$sheet->setCellValue('X' . $row, number_format($rows['val_okt'], 2));
			$sheet->setCellValue('Y' . $row, number_format($rows['qty_nop'], 0));
			$sheet->setCellValue('Z' . $row, number_format($rows['val_nop'], 2));
			$sheet->setCellValue('AA' . $row, number_format($rows['qty_des'], 0));
			$sheet->setCellValue('AB' . $row, number_format($rows['val_des'], 2));
			$sheet->setCellValue('AC' . $row, number_format($rows['qty_year'], 0));
			$sheet->setCellValue('AD' . $row, number_format($rows['val_year'], 2));
			$sheet->setCellValue('AE' . $row, number_format($rows['qty_year']/12, 0));
			$sheet->setCellValue('AF' . $row, number_format($rows['val_year']/12, 2));

			// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
			$sheet->getStyle('A' . $row)->applyFromArray($style_row);
			$sheet->getStyle('B' . $row)->applyFromArray($style_row);
			$sheet->getStyle('C' . $row)->applyFromArray($style_row);
			$sheet->getStyle('D' . $row)->applyFromArray($style_row);
			$sheet->getStyle('E' . $row)->applyFromArray($style_row);
			$sheet->getStyle('F' . $row)->applyFromArray($style_row);
			$sheet->getStyle('G' . $row)->applyFromArray($style_row);
			$sheet->getStyle('H' . $row)->applyFromArray($style_row);
			$sheet->getStyle('I' . $row)->applyFromArray($style_row);
			$sheet->getStyle('J' . $row)->applyFromArray($style_row);
			$sheet->getStyle('K' . $row)->applyFromArray($style_row);
			$sheet->getStyle('L' . $row)->applyFromArray($style_row);
			$sheet->getStyle('M' . $row)->applyFromArray($style_row);
			$sheet->getStyle('N' . $row)->applyFromArray($style_row);
			$sheet->getStyle('O' . $row)->applyFromArray($style_row);
			$sheet->getStyle('P' . $row)->applyFromArray($style_row);
			$sheet->getStyle('Q' . $row)->applyFromArray($style_row);
			$sheet->getStyle('R' . $row)->applyFromArray($style_row);
			$sheet->getStyle('S' . $row)->applyFromArray($style_row);
			$sheet->getStyle('T' . $row)->applyFromArray($style_row);
			$sheet->getStyle('U' . $row)->applyFromArray($style_row);
			$sheet->getStyle('V' . $row)->applyFromArray($style_row);
			$sheet->getStyle('W' . $row)->applyFromArray($style_row);
			$sheet->getStyle('X' . $row)->applyFromArray($style_row);
			$sheet->getStyle('Y' . $row)->applyFromArray($style_row);
			$sheet->getStyle('Z' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AA' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AB' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AC' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AD' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AE' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AF' . $row)->applyFromArray($style_row);

			$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('I' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('J' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('K' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('L' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('M' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('N' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('O' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('P' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('Q' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('R' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('S' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('T' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('U' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('V' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('W' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('X' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('Y' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('Z' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AA' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AB' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AC' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AD' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AE' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AF' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

			$region = $rows['region'];
			$island = $rows['island'];

			$qty_jan += $rows['qty_jan'];
            $qty_feb += $rows['qty_feb'];
            $qty_mar += $rows['qty_mar'];
            $qty_apr += $rows['qty_apr'];
            $qty_mei += $rows['qty_mei'];
            $qty_jun += $rows['qty_jun'];
            $qty_jul += $rows['qty_jul'];
            $qty_agu += $rows['qty_agu'];
            $qty_sep += $rows['qty_sep'];
            $qty_okt += $rows['qty_okt'];
            $qty_nop += $rows['qty_nop'];
            $qty_des += $rows['qty_des'];
            $qty_year += $rows['qty_year'];

            $val_jan += $rows['val_jan'];
            $val_feb += $rows['val_feb'];
            $val_mar += $rows['val_mar'];
            $val_apr += $rows['val_apr'];
            $val_mei += $rows['val_mei'];
            $val_jun += $rows['val_jun'];
            $val_jul += $rows['val_jul'];
            $val_agu += $rows['val_agu'];
            $val_sep += $rows['val_sep'];
            $val_okt += $rows['val_okt'];
            $val_nop += $rows['val_nop'];
            $val_des += $rows['val_des'];
            $val_year += $rows['val_year'];

            $sub_qty_jan += $rows['qty_jan'];
            $sub_qty_feb += $rows['qty_feb'];
            $sub_qty_mar += $rows['qty_mar'];
            $sub_qty_apr += $rows['qty_apr'];
            $sub_qty_mei += $rows['qty_mei'];
            $sub_qty_jun += $rows['qty_jun'];
            $sub_qty_jul += $rows['qty_jul'];
            $sub_qty_agu += $rows['qty_agu'];
            $sub_qty_sep += $rows['qty_sep'];
            $sub_qty_okt += $rows['qty_okt'];
            $sub_qty_nop += $rows['qty_nop'];
            $sub_qty_des += $rows['qty_des'];
            $sub_qty_year += $rows['qty_year'];

            $sub_val_jan += $rows['val_jan'];
            $sub_val_feb += $rows['val_feb'];
            $sub_val_mar += $rows['val_mar'];
            $sub_val_apr += $rows['val_apr'];
            $sub_val_mei += $rows['val_mei'];
        	$sub_val_jun += $rows['val_jun'];
            $sub_val_jul += $rows['val_jul'];
            $sub_val_agu += $rows['val_agu'];
            $sub_val_sep += $rows['val_sep'];
            $sub_val_okt += $rows['val_okt'];
            $sub_val_nop += $rows['val_nop'];
            $sub_val_des += $rows['val_des'];
            $sub_val_year += $rows['val_year'];

            $total_qty_jan += $rows['qty_jan'];
            $total_qty_feb += $rows['qty_feb'];
            $total_qty_mar += $rows['qty_mar'];
            $total_qty_apr += $rows['qty_apr'];
            $total_qty_mei += $rows['qty_mei'];
            $total_qty_jun += $rows['qty_jun'];
            $total_qty_jul += $rows['qty_jul'];
            $total_qty_agu += $rows['qty_agu'];
            $total_qty_sep += $rows['qty_sep'];
            $total_qty_okt += $rows['qty_okt'];
            $total_qty_nop += $rows['qty_nop'];
            $total_qty_des += $rows['qty_des'];
            $total_qty_year += $rows['qty_year'];

            $total_val_jan += $rows['val_jan'];
            $total_val_feb += $rows['val_feb'];
            $total_val_mar += $rows['val_mar'];
            $total_val_apr += $rows['val_apr'];
            $total_val_mei += $rows['val_mei'];
            $total_val_jun += $rows['val_jun'];
            $total_val_jul += $rows['val_jul'];
            $total_val_agu += $rows['val_agu'];
            $total_val_sep += $rows['val_sep'];
            $total_val_okt += $rows['val_okt'];
            $total_val_nop += $rows['val_nop'];
            $total_val_des += $rows['val_des'];
            $total_val_year += $rows['val_year'];

			$no++; // Tambah 1 setiap kali looping
    		$row++; // Tambah 1 setiap kali looping
		endforeach;

		//region end
		//$row = $row + 1;
		$sheet->setCellValue('A' . $row, '');
		$sheet->setCellValue('B' . $row, '');
		$sheet->setCellValue('C' . $row, '');
		$sheet->setCellValue('D' . $row, $region);
		$sheet->setCellValue('E' . $row, number_format($qty_jan, 0));
		$sheet->setCellValue('F' . $row, number_format($val_jan, 2));
		$sheet->setCellValue('G' . $row, number_format($qty_feb, 0));
		$sheet->setCellValue('H' . $row, number_format($val_feb, 2));
		$sheet->setCellValue('I' . $row, number_format($qty_mar, 0));
		$sheet->setCellValue('J' . $row, number_format($val_mar, 2));
		$sheet->setCellValue('K' . $row, number_format($qty_apr, 0));
		$sheet->setCellValue('L' . $row, number_format($val_apr, 2));
		$sheet->setCellValue('M' . $row, number_format($qty_mei, 0));
		$sheet->setCellValue('N' . $row, number_format($val_mei, 2));
		$sheet->setCellValue('O' . $row, number_format($qty_jun, 0));
		$sheet->setCellValue('P' . $row, number_format($val_jun, 2));
		$sheet->setCellValue('Q' . $row, number_format($qty_jul, 0));
		$sheet->setCellValue('R' . $row, number_format($val_jul, 2));
		$sheet->setCellValue('S' . $row, number_format($qty_agu, 0));
		$sheet->setCellValue('T' . $row, number_format($val_agu, 2));
		$sheet->setCellValue('U' . $row, number_format($qty_sep, 0));
		$sheet->setCellValue('V' . $row, number_format($val_sep, 2));
		$sheet->setCellValue('W' . $row, number_format($qty_okt, 0));
		$sheet->setCellValue('X' . $row, number_format($val_okt, 2));
		$sheet->setCellValue('Y' . $row, number_format($qty_nop, 0));
		$sheet->setCellValue('Z' . $row, number_format($val_nop, 2));
		$sheet->setCellValue('AA' . $row, number_format($qty_des, 0));
		$sheet->setCellValue('AB' . $row, number_format($val_des, 2));
		$sheet->setCellValue('AC' . $row, number_format($qty_year, 0));
		$sheet->setCellValue('AD' . $row, number_format($val_year, 2));
		$sheet->setCellValue('AE' . $row, number_format($qty_year/12, 0));
		$sheet->setCellValue('AF' . $row, number_format($val_year/12, 2));

		// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
		$sheet->getStyle('A' . $row)->applyFromArray($style_row);
		$sheet->getStyle('B' . $row)->applyFromArray($style_row);
		$sheet->getStyle('C' . $row)->applyFromArray($style_row);
		$sheet->getStyle('D' . $row)->applyFromArray($style_row);
		$sheet->getStyle('E' . $row)->applyFromArray($style_row);
		$sheet->getStyle('F' . $row)->applyFromArray($style_row);
		$sheet->getStyle('G' . $row)->applyFromArray($style_row);
		$sheet->getStyle('H' . $row)->applyFromArray($style_row);
		$sheet->getStyle('I' . $row)->applyFromArray($style_row);
		$sheet->getStyle('J' . $row)->applyFromArray($style_row);
		$sheet->getStyle('K' . $row)->applyFromArray($style_row);
		$sheet->getStyle('L' . $row)->applyFromArray($style_row);
		$sheet->getStyle('M' . $row)->applyFromArray($style_row);
		$sheet->getStyle('N' . $row)->applyFromArray($style_row);
		$sheet->getStyle('O' . $row)->applyFromArray($style_row);
		$sheet->getStyle('P' . $row)->applyFromArray($style_row);
		$sheet->getStyle('Q' . $row)->applyFromArray($style_row);
		$sheet->getStyle('R' . $row)->applyFromArray($style_row);
		$sheet->getStyle('S' . $row)->applyFromArray($style_row);
		$sheet->getStyle('T' . $row)->applyFromArray($style_row);
		$sheet->getStyle('U' . $row)->applyFromArray($style_row);
		$sheet->getStyle('V' . $row)->applyFromArray($style_row);
		$sheet->getStyle('W' . $row)->applyFromArray($style_row);
		$sheet->getStyle('X' . $row)->applyFromArray($style_row);
		$sheet->getStyle('Y' . $row)->applyFromArray($style_row);
		$sheet->getStyle('Z' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AA' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AB' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AC' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AD' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AE' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AF' . $row)->applyFromArray($style_row);

		$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('I' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('J' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('K' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('L' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('M' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('N' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('O' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('P' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('Q' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('R' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('S' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('T' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('U' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('V' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('W' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('X' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('Y' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('Z' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AA' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AB' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AC' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AD' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AE' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AF' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

		$sheet->getStyle('A' . $row . ':AF' . $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');
		$sheet->getStyle('A' . $row . ':AF' . $row)->getFont()->setBold(true);

		//island and
		$row = $row + 1;
		$sheet->setCellValue('A' . $row, '');
		$sheet->setCellValue('B' . $row, '');
		$sheet->setCellValue('C' . $row, '');
		$sheet->setCellValue('D' . $row, $island);
		$sheet->setCellValue('E' . $row, number_format($sub_qty_jan, 0));
		$sheet->setCellValue('F' . $row, number_format($sub_val_jan, 2));
		$sheet->setCellValue('G' . $row, number_format($sub_qty_feb, 0));
		$sheet->setCellValue('H' . $row, number_format($sub_val_feb, 2));
		$sheet->setCellValue('I' . $row, number_format($sub_qty_mar, 0));
		$sheet->setCellValue('J' . $row, number_format($sub_val_mar, 2));
		$sheet->setCellValue('K' . $row, number_format($sub_qty_apr, 0));
		$sheet->setCellValue('L' . $row, number_format($sub_val_apr, 2));
		$sheet->setCellValue('M' . $row, number_format($sub_qty_mei, 0));
		$sheet->setCellValue('N' . $row, number_format($sub_val_mei, 2));
		$sheet->setCellValue('O' . $row, number_format($sub_qty_jun, 0));
		$sheet->setCellValue('P' . $row, number_format($sub_val_jun, 2));
		$sheet->setCellValue('Q' . $row, number_format($sub_qty_jul, 0));
		$sheet->setCellValue('R' . $row, number_format($sub_val_jul, 2));
		$sheet->setCellValue('S' . $row, number_format($sub_qty_agu, 0));
		$sheet->setCellValue('T' . $row, number_format($sub_val_agu, 2));
		$sheet->setCellValue('U' . $row, number_format($sub_qty_sep, 0));
		$sheet->setCellValue('V' . $row, number_format($sub_val_sep, 2));
		$sheet->setCellValue('W' . $row, number_format($sub_qty_okt, 0));
		$sheet->setCellValue('X' . $row, number_format($sub_val_okt, 2));
		$sheet->setCellValue('Y' . $row, number_format($sub_qty_nop, 0));
		$sheet->setCellValue('Z' . $row, number_format($sub_val_nop, 2));
		$sheet->setCellValue('AA' . $row, number_format($sub_qty_des, 0));
		$sheet->setCellValue('AB' . $row, number_format($sub_val_des, 2));
		$sheet->setCellValue('AC' . $row, number_format($sub_qty_year, 0));
		$sheet->setCellValue('AD' . $row, number_format($sub_val_year, 2));
		$sheet->setCellValue('AE' . $row, number_format($sub_qty_year/12, 0));
		$sheet->setCellValue('AF' . $row, number_format($sub_val_year/12, 2));

		// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
		$sheet->getStyle('A' . $row)->applyFromArray($style_row);
		$sheet->getStyle('B' . $row)->applyFromArray($style_row);
		$sheet->getStyle('C' . $row)->applyFromArray($style_row);
		$sheet->getStyle('D' . $row)->applyFromArray($style_row);
		$sheet->getStyle('E' . $row)->applyFromArray($style_row);
		$sheet->getStyle('F' . $row)->applyFromArray($style_row);
		$sheet->getStyle('G' . $row)->applyFromArray($style_row);
		$sheet->getStyle('H' . $row)->applyFromArray($style_row);
		$sheet->getStyle('I' . $row)->applyFromArray($style_row);
		$sheet->getStyle('J' . $row)->applyFromArray($style_row);
		$sheet->getStyle('K' . $row)->applyFromArray($style_row);
		$sheet->getStyle('L' . $row)->applyFromArray($style_row);
		$sheet->getStyle('M' . $row)->applyFromArray($style_row);
		$sheet->getStyle('N' . $row)->applyFromArray($style_row);
		$sheet->getStyle('O' . $row)->applyFromArray($style_row);
		$sheet->getStyle('P' . $row)->applyFromArray($style_row);
		$sheet->getStyle('Q' . $row)->applyFromArray($style_row);
		$sheet->getStyle('R' . $row)->applyFromArray($style_row);
		$sheet->getStyle('S' . $row)->applyFromArray($style_row);
		$sheet->getStyle('T' . $row)->applyFromArray($style_row);
		$sheet->getStyle('U' . $row)->applyFromArray($style_row);
		$sheet->getStyle('V' . $row)->applyFromArray($style_row);
		$sheet->getStyle('W' . $row)->applyFromArray($style_row);
		$sheet->getStyle('X' . $row)->applyFromArray($style_row);
		$sheet->getStyle('Y' . $row)->applyFromArray($style_row);
		$sheet->getStyle('Z' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AA' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AB' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AC' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AD' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AE' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AF' . $row)->applyFromArray($style_row);

		$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('I' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('J' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('K' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('L' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('M' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('N' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('O' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('P' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('Q' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('R' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('S' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('T' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('U' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('V' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('W' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('X' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('Y' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('Z' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AA' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AB' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AC' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AD' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AE' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AF' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

		$sheet->getStyle('A' . $row . ':AF' . $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFA07A');
		$sheet->getStyle('A' . $row . ':AF' . $row)->getFont()->setBold(true);

		//national
		$row = $row + 1;
		$sheet->setCellValue('A' . $row, '');
		$sheet->setCellValue('B' . $row, '');
		$sheet->setCellValue('C' . $row, '');
		$sheet->setCellValue('D' . $row, 'NATIONAL');
		$sheet->setCellValue('E' . $row, number_format($total_qty_jan, 0));
		$sheet->setCellValue('F' . $row, number_format($total_val_jan, 2));
		$sheet->setCellValue('G' . $row, number_format($total_qty_feb, 0));
		$sheet->setCellValue('H' . $row, number_format($total_val_feb, 2));
		$sheet->setCellValue('I' . $row, number_format($total_qty_mar, 0));
		$sheet->setCellValue('J' . $row, number_format($total_val_mar, 2));
		$sheet->setCellValue('K' . $row, number_format($total_qty_apr, 0));
		$sheet->setCellValue('L' . $row, number_format($total_val_apr, 2));
		$sheet->setCellValue('M' . $row, number_format($total_qty_mei, 0));
		$sheet->setCellValue('N' . $row, number_format($total_val_mei, 2));
		$sheet->setCellValue('O' . $row, number_format($total_qty_jun, 0));
		$sheet->setCellValue('P' . $row, number_format($total_val_jun, 2));
		$sheet->setCellValue('Q' . $row, number_format($total_qty_jul, 0));
		$sheet->setCellValue('R' . $row, number_format($total_val_jul, 2));
		$sheet->setCellValue('S' . $row, number_format($total_qty_agu, 0));
		$sheet->setCellValue('T' . $row, number_format($total_val_agu, 2));
		$sheet->setCellValue('U' . $row, number_format($total_qty_sep, 0));
		$sheet->setCellValue('V' . $row, number_format($total_val_sep, 2));
		$sheet->setCellValue('W' . $row, number_format($total_qty_okt, 0));
		$sheet->setCellValue('X' . $row, number_format($total_val_okt, 2));
		$sheet->setCellValue('Y' . $row, number_format($total_qty_nop, 0));
		$sheet->setCellValue('Z' . $row, number_format($total_val_nop, 2));
		$sheet->setCellValue('AA' . $row, number_format($total_qty_des, 0));
		$sheet->setCellValue('AB' . $row, number_format($total_val_des, 2));
		$sheet->setCellValue('AC' . $row, number_format($total_qty_year, 0));
		$sheet->setCellValue('AD' . $row, number_format($total_val_year, 2));
		$sheet->setCellValue('AE' . $row, number_format($total_qty_year/12, 0));
		$sheet->setCellValue('AF' . $row, number_format($total_val_year/12, 2));

		// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
		$sheet->getStyle('A' . $row)->applyFromArray($style_row);
		$sheet->getStyle('B' . $row)->applyFromArray($style_row);
		$sheet->getStyle('C' . $row)->applyFromArray($style_row);
		$sheet->getStyle('D' . $row)->applyFromArray($style_row);
		$sheet->getStyle('E' . $row)->applyFromArray($style_row);
		$sheet->getStyle('F' . $row)->applyFromArray($style_row);
		$sheet->getStyle('G' . $row)->applyFromArray($style_row);
		$sheet->getStyle('H' . $row)->applyFromArray($style_row);
		$sheet->getStyle('I' . $row)->applyFromArray($style_row);
		$sheet->getStyle('J' . $row)->applyFromArray($style_row);
		$sheet->getStyle('K' . $row)->applyFromArray($style_row);
		$sheet->getStyle('L' . $row)->applyFromArray($style_row);
		$sheet->getStyle('M' . $row)->applyFromArray($style_row);
		$sheet->getStyle('N' . $row)->applyFromArray($style_row);
		$sheet->getStyle('O' . $row)->applyFromArray($style_row);
		$sheet->getStyle('P' . $row)->applyFromArray($style_row);
		$sheet->getStyle('Q' . $row)->applyFromArray($style_row);
		$sheet->getStyle('R' . $row)->applyFromArray($style_row);
		$sheet->getStyle('S' . $row)->applyFromArray($style_row);
		$sheet->getStyle('T' . $row)->applyFromArray($style_row);
		$sheet->getStyle('U' . $row)->applyFromArray($style_row);
		$sheet->getStyle('V' . $row)->applyFromArray($style_row);
		$sheet->getStyle('W' . $row)->applyFromArray($style_row);
		$sheet->getStyle('X' . $row)->applyFromArray($style_row);
		$sheet->getStyle('Y' . $row)->applyFromArray($style_row);
		$sheet->getStyle('Z' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AA' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AB' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AC' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AD' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AE' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AF' . $row)->applyFromArray($style_row);

		$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('I' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('J' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('K' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('L' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('M' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('N' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('O' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('P' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('Q' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('R' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('S' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('T' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('U' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('V' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('W' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('X' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('Y' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('Z' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AA' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AB' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AC' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AD' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AE' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AF' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

		$sheet->getStyle('A' . $row . ':AF' . $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFA07A');
		$sheet->getStyle('A' . $row . ':AF' . $row)->getFont()->setBold(true);


		//set columns width
		$sheet->getColumnDimension('A')->setWidth(5); 
		$sheet->getColumnDimension('B')->setWidth(11); 
		$sheet->getColumnDimension('C')->setWidth(40);
		$sheet->getColumnDimension('D')->setWidth(15);
		$sheet->getColumnDimension('E')->setWidth(10);
		$sheet->getColumnDimension('F')->setWidth(16);
		$sheet->getColumnDimension('G')->setWidth(10);
		$sheet->getColumnDimension('H')->setWidth(16);
		$sheet->getColumnDimension('I')->setWidth(10);
		$sheet->getColumnDimension('J')->setWidth(16);
		$sheet->getColumnDimension('K')->setWidth(10);
		$sheet->getColumnDimension('L')->setWidth(16);
		$sheet->getColumnDimension('M')->setWidth(10);
		$sheet->getColumnDimension('N')->setWidth(16);
		$sheet->getColumnDimension('O')->setWidth(10);
		$sheet->getColumnDimension('P')->setWidth(16);
		$sheet->getColumnDimension('Q')->setWidth(10);
		$sheet->getColumnDimension('R')->setWidth(16);
		$sheet->getColumnDimension('S')->setWidth(10);
		$sheet->getColumnDimension('T')->setWidth(16);
		$sheet->getColumnDimension('U')->setWidth(10);
		$sheet->getColumnDimension('V')->setWidth(16);
		$sheet->getColumnDimension('W')->setWidth(10);
		$sheet->getColumnDimension('X')->setWidth(16);
		$sheet->getColumnDimension('Y')->setWidth(10);
		$sheet->getColumnDimension('Z')->setWidth(16);
		$sheet->getColumnDimension('AA')->setWidth(10);
		$sheet->getColumnDimension('AB')->setWidth(16);
		$sheet->getColumnDimension('AC')->setWidth(10);
		$sheet->getColumnDimension('AD')->setWidth(16);
		$sheet->getColumnDimension('AE')->setWidth(10);
		$sheet->getColumnDimension('AF')->setWidth(16);

		// Set orientasi kertas jadi LANDSCAPE
		$sheet->getPageSetup()->setOrientation(\PhpOffice\PhpSpreadsheet\Worksheet\PageSetup::ORIENTATION_LANDSCAPE);
		// Set judul file excel nya
		$sheet->setTitle("Report Selling In - Distributor");
		// Proses file excel
		header('Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet');
		header('Content-Disposition: attachment; filename="Report Selling In - Distributor ("' . $year . '").xlsx"'); // Set nama file excel nya
		header('Cache-Control: max-age=0');

		$writer = new Xlsx($spreadsheet);
		$writer->save('php://output');


	}

	public function export_sellingout_dist()
	{
		$spreadsheet = new Spreadsheet();
		$sheet = $spreadsheet->getActiveSheet();
		// Buat sebuah variabel untuk menampung pengaturan style dari header tabel
		$style_col = [
			'font' => ['bold' => true], // Set font nya jadi bold
			'alignment' => [
				'horizontal' => \PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER, // Set text jadi ditengah secara horizontal (center)
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'top' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border top dengan garis tipis
				'right' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN],  // Set border right dengan garis tipis
				'bottom' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border bottom dengan garis tipis
				'left' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN] // Set border left dengan garis tipis
			]
		];
		// Buat sebuah variabel untuk menampung pengaturan style dari isi tabel
		$style_row = [
			'alignment' => [
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'top' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border top dengan garis tipis
				'right' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN],  // Set border right dengan garis tipis
				'bottom' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border bottom dengan garis tipis
				'left' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN] // Set border left dengan garis tipis
			]
		];


		if (isset($_POST['by_principal']))
		{
			$principal = $_POST['by_principal'];
		}
		else
		{
			$principal = "";
		}

		if (isset($_POST['by_year']))
		{
			$year = $_POST['by_year'];
		}
		else
		{
			$year = date('Y');
		}


		$sheet->setCellValue('A1', "Report Selling Out - Distributor (" . $year . ")"); // Set kolom A1 dengan tulisan "Report Selling In - By Outlet"
		$sheet->setCellValue('A2', "Principal : " . $principal); // Set kolom A2 dengan tulisan "Outlet Type : EC_EC"
		//$sheet->mergeCells('A1:F1'); // Set Merge Cell pada kolom A1 sampai F1
		$sheet->getStyle('A1')->getFont()->setBold(true); // Set bold kolom A1
		$sheet->getStyle('A2')->getFont()->setBold(true); // Set bold kolom A2
		$sheet->getStyle('A1')->getFont()->setSize(20); // Set font size 15 untuk kolom A1
		// Buat header tabel nya pada baris ke 4
		$sheet->setCellValue('A4', "#"); // Set kolom A4 dengan tulisan "#"
		$sheet->mergeCells('A4:A6'); // Set Merge Row pada kolom A4 sampai A6
		$sheet->setCellValue('B4', "Cust Code");
		$sheet->mergeCells('B4:B6'); 
		$sheet->setCellValue('C4', "Distributor"); 
		$sheet->mergeCells('C4:C6'); 
		$sheet->setCellValue('D4', "Area"); 
		$sheet->mergeCells('D4:D6'); 
		$sheet->setCellValue('E4', "Month");
		$sheet->mergeCells('E4:AB4');
		$sheet->setCellValue('AC4', "Total");
		$sheet->mergeCells('AC4:AD5');
		$sheet->setCellValue('AE4', "Average");
		$sheet->mergeCells('AE4:AF5');
		$sheet->setCellValue('E5', "January");
		$sheet->mergeCells('E5:F5');
		$sheet->setCellValue('G5', "February");
		$sheet->mergeCells('G5:H5');
		$sheet->setCellValue('I5', "March");
		$sheet->mergeCells('I5:J5');
		$sheet->setCellValue('K5', "April");
		$sheet->mergeCells('K5:L5');
		$sheet->setCellValue('M5', "May");
		$sheet->mergeCells('M5:N5');
		$sheet->setCellValue('O5', "June");
		$sheet->mergeCells('O5:P5');
		$sheet->setCellValue('Q5', "July");
		$sheet->mergeCells('Q5:R5');
		$sheet->setCellValue('S5', "August");
		$sheet->mergeCells('S5:T5');
		$sheet->setCellValue('U5', "September");
		$sheet->mergeCells('U5:V5');
		$sheet->setCellValue('W5', "October");
		$sheet->mergeCells('W5:X5');
		$sheet->setCellValue('Y5', "November");
		$sheet->mergeCells('Y5:Z5');
		$sheet->setCellValue('AA5', "December");
		$sheet->mergeCells('AA5:AB5');
		$sheet->setCellValue('E6', "Qty");
		$sheet->setCellValue('F6', "Value");
		$sheet->setCellValue('G6', "Qty");
		$sheet->setCellValue('H6', "Value");
		$sheet->setCellValue('I6', "Qty");
		$sheet->setCellValue('J6', "Value");
		$sheet->setCellValue('K6', "Qty");
		$sheet->setCellValue('L6', "Value");
		$sheet->setCellValue('M6', "Qty");
		$sheet->setCellValue('N6', "Value");
		$sheet->setCellValue('O6', "Qty");
		$sheet->setCellValue('P6', "Value");
		$sheet->setCellValue('Q6', "Qty");
		$sheet->setCellValue('R6', "Value");
		$sheet->setCellValue('S6', "Qty");
		$sheet->setCellValue('T6', "Value");
		$sheet->setCellValue('U6', "Qty");
		$sheet->setCellValue('V6', "Value");
		$sheet->setCellValue('W6', "Qty");
		$sheet->setCellValue('X6', "Value");
		$sheet->setCellValue('Y6', "Qty");
		$sheet->setCellValue('Z6', "Value");
		$sheet->setCellValue('AA6', "Qty");
		$sheet->setCellValue('AB6', "Value");
		$sheet->setCellValue('AC6', "Qty");
		$sheet->setCellValue('AD6', "Value");
		$sheet->setCellValue('AE6', "Qty");
		$sheet->setCellValue('AF6', "Value");

		// Apply style header yang telah kita buat tadi ke masing-masing kolom header
		$sheet->getStyle('A4')->applyFromArray($style_col);
		$sheet->getStyle('B4')->applyFromArray($style_col);
		$sheet->getStyle('C4')->applyFromArray($style_col);
		$sheet->getStyle('D4')->applyFromArray($style_col);
		$sheet->getStyle('E4')->applyFromArray($style_col);
		$sheet->getStyle('F4')->applyFromArray($style_col);
		$sheet->getStyle('G4')->applyFromArray($style_col);
		$sheet->getStyle('H4')->applyFromArray($style_col);
		$sheet->getStyle('I4')->applyFromArray($style_col);
		$sheet->getStyle('J4')->applyFromArray($style_col);
		$sheet->getStyle('K4')->applyFromArray($style_col);
		$sheet->getStyle('L4')->applyFromArray($style_col);
		$sheet->getStyle('M4')->applyFromArray($style_col);
		$sheet->getStyle('N4')->applyFromArray($style_col);
		$sheet->getStyle('O4')->applyFromArray($style_col);
		$sheet->getStyle('P4')->applyFromArray($style_col);
		$sheet->getStyle('Q4')->applyFromArray($style_col);
		$sheet->getStyle('R4')->applyFromArray($style_col);
		$sheet->getStyle('S4')->applyFromArray($style_col);
		$sheet->getStyle('T4')->applyFromArray($style_col);
		$sheet->getStyle('U4')->applyFromArray($style_col);
		$sheet->getStyle('V4')->applyFromArray($style_col);
		$sheet->getStyle('W4')->applyFromArray($style_col);
		$sheet->getStyle('X4')->applyFromArray($style_col);
		$sheet->getStyle('Y4')->applyFromArray($style_col);
		$sheet->getStyle('Z4')->applyFromArray($style_col);
		$sheet->getStyle('AA4')->applyFromArray($style_col);
		$sheet->getStyle('AB4')->applyFromArray($style_col);
		$sheet->getStyle('AC4')->applyFromArray($style_col);
		$sheet->getStyle('AD4')->applyFromArray($style_col);
		$sheet->getStyle('AE4')->applyFromArray($style_col);
		$sheet->getStyle('AF4')->applyFromArray($style_col);
		$sheet->getStyle('A5')->applyFromArray($style_col);
		$sheet->getStyle('B5')->applyFromArray($style_col);
		$sheet->getStyle('C5')->applyFromArray($style_col);
		$sheet->getStyle('D5')->applyFromArray($style_col);
		$sheet->getStyle('E5')->applyFromArray($style_col);
		$sheet->getStyle('F5')->applyFromArray($style_col);
		$sheet->getStyle('G5')->applyFromArray($style_col);
		$sheet->getStyle('H5')->applyFromArray($style_col);
		$sheet->getStyle('I5')->applyFromArray($style_col);
		$sheet->getStyle('J5')->applyFromArray($style_col);
		$sheet->getStyle('K5')->applyFromArray($style_col);
		$sheet->getStyle('L5')->applyFromArray($style_col);
		$sheet->getStyle('M5')->applyFromArray($style_col);
		$sheet->getStyle('N5')->applyFromArray($style_col);
		$sheet->getStyle('O5')->applyFromArray($style_col);
		$sheet->getStyle('P5')->applyFromArray($style_col);
		$sheet->getStyle('Q5')->applyFromArray($style_col);
		$sheet->getStyle('R5')->applyFromArray($style_col);
		$sheet->getStyle('S5')->applyFromArray($style_col);
		$sheet->getStyle('T5')->applyFromArray($style_col);
		$sheet->getStyle('U5')->applyFromArray($style_col);
		$sheet->getStyle('V5')->applyFromArray($style_col);
		$sheet->getStyle('W5')->applyFromArray($style_col);
		$sheet->getStyle('X5')->applyFromArray($style_col);
		$sheet->getStyle('Y5')->applyFromArray($style_col);
		$sheet->getStyle('Z5')->applyFromArray($style_col);
		$sheet->getStyle('AA5')->applyFromArray($style_col);
		$sheet->getStyle('AB5')->applyFromArray($style_col);
		$sheet->getStyle('AC5')->applyFromArray($style_col);
		$sheet->getStyle('AD5')->applyFromArray($style_col);
		$sheet->getStyle('AE5')->applyFromArray($style_col);
		$sheet->getStyle('AF5')->applyFromArray($style_col);
		$sheet->getStyle('A6')->applyFromArray($style_col);
		$sheet->getStyle('B6')->applyFromArray($style_col);
		$sheet->getStyle('C6')->applyFromArray($style_col);
		$sheet->getStyle('D6')->applyFromArray($style_col);
		$sheet->getStyle('E6')->applyFromArray($style_col);
		$sheet->getStyle('F6')->applyFromArray($style_col);
		$sheet->getStyle('G6')->applyFromArray($style_col);
		$sheet->getStyle('H6')->applyFromArray($style_col);
		$sheet->getStyle('I6')->applyFromArray($style_col);
		$sheet->getStyle('J6')->applyFromArray($style_col);
		$sheet->getStyle('K6')->applyFromArray($style_col);
		$sheet->getStyle('L6')->applyFromArray($style_col);
		$sheet->getStyle('M6')->applyFromArray($style_col);
		$sheet->getStyle('N6')->applyFromArray($style_col);
		$sheet->getStyle('O6')->applyFromArray($style_col);
		$sheet->getStyle('P6')->applyFromArray($style_col);
		$sheet->getStyle('Q6')->applyFromArray($style_col);
		$sheet->getStyle('R6')->applyFromArray($style_col);
		$sheet->getStyle('S6')->applyFromArray($style_col);
		$sheet->getStyle('T6')->applyFromArray($style_col);
		$sheet->getStyle('U6')->applyFromArray($style_col);
		$sheet->getStyle('V6')->applyFromArray($style_col);
		$sheet->getStyle('W6')->applyFromArray($style_col);
		$sheet->getStyle('X6')->applyFromArray($style_col);
		$sheet->getStyle('Y6')->applyFromArray($style_col);
		$sheet->getStyle('Z6')->applyFromArray($style_col);
		$sheet->getStyle('AA6')->applyFromArray($style_col);
		$sheet->getStyle('AB6')->applyFromArray($style_col);
		$sheet->getStyle('AC6')->applyFromArray($style_col);
		$sheet->getStyle('AD6')->applyFromArray($style_col);
		$sheet->getStyle('AE6')->applyFromArray($style_col);
		$sheet->getStyle('AF6')->applyFromArray($style_col);

		$sheet->getStyle('A4:AF6')->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');

		// Set height baris ke 1 dan 2
		$sheet->getRowDimension('1')->setRowHeight(40);
		$sheet->getRowDimension('2')->setRowHeight(20);


		$region = '';
        $island = '';
        $qty_jan = 0;
        $qty_feb = 0;
        $qty_mar = 0;
        $qty_apr = 0;
        $qty_mei = 0;
        $qty_jun = 0;
        $qty_jul = 0;
        $qty_agu = 0;
        $qty_sep = 0;
        $qty_okt = 0;
        $qty_nop = 0;
        $qty_des = 0;
        $qty_year = 0;
        $qty_avg = 0;

        $val_jan = 0;
        $val_feb = 0;
        $val_mar = 0;
        $val_apr = 0;
        $val_mei = 0;
        $val_jun = 0;
        $val_jul = 0;
        $val_agu = 0;
        $val_sep = 0;
        $val_okt = 0;
        $val_nop = 0;
        $val_des = 0;
        $val_year = 0;
        $val_avg = 0;

        $sub_qty_jan = 0;
        $sub_qty_feb = 0;
        $sub_qty_mar = 0;
        $sub_qty_apr = 0;
        $sub_qty_mei = 0;
        $sub_qty_jun = 0;
        $sub_qty_jul = 0;
        $sub_qty_agu = 0;
        $sub_qty_sep = 0;
        $sub_qty_okt = 0;
        $sub_qty_nop = 0;
        $sub_qty_des = 0;
        $sub_qty_year = 0;
        $sub_qty_avg = 0;

        $sub_val_jan = 0;
        $sub_val_feb = 0;
        $sub_val_mar = 0;
        $sub_val_apr = 0;
        $sub_val_mei = 0;
        $sub_val_jun = 0;
        $sub_val_jul = 0;
        $sub_val_agu = 0;
        $sub_val_sep = 0;
        $sub_val_okt = 0;
        $sub_val_nop = 0;
        $sub_val_des = 0;
        $sub_val_year = 0;
        $sub_val_avg = 0;

        $total_qty_jan = 0;
        $total_qty_feb = 0;
        $total_qty_mar = 0;
        $total_qty_apr = 0;
        $total_qty_mei = 0;
        $total_qty_jun = 0;
        $total_qty_jul = 0;
        $total_qty_agu = 0;
        $total_qty_sep = 0;
        $total_qty_okt = 0;
        $total_qty_nop = 0;
        $total_qty_des = 0;
        $total_qty_year = 0;
        $total_qty_avg = 0;

        $total_val_jan = 0;
        $total_val_feb = 0;
        $total_val_mar = 0;
        $total_val_apr = 0;
        $total_val_mei = 0;
        $total_val_jun = 0;
        $total_val_jul = 0;
        $total_val_agu = 0;
        $total_val_sep = 0;
        $total_val_okt = 0;
        $total_val_nop = 0;
        $total_val_des = 0;
        $total_val_year = 0;
        $total_val_avg = 0;


		$no = 1; // Untuk penomoran tabel, di awal set dengan 1
		$row = 7;

		$data1 = array(
			'principal' => $principal,
			'year' => $year
		);

		$data['sellingout_Dist'] = $this->model('ReportModel')->getSellingOut_Distributor2($data1);
		//$data['sellingin_OT'] = $this->model('ReportModel')->getSellingIn_OT2();

		foreach ($data['sellingout_Dist'] as $rows) :

			if ($region != $rows['region'] and $region != '' )
            {
				
				$sheet->setCellValue('A' . $row, '');
				$sheet->setCellValue('B' . $row, '');
				$sheet->setCellValue('C' . $row, '');
				$sheet->setCellValue('D' . $row, $region);
				$sheet->setCellValue('E' . $row, number_format($qty_jan, 0));
				$sheet->setCellValue('F' . $row, number_format($val_jan, 2));
				$sheet->setCellValue('G' . $row, number_format($qty_feb, 0));
				$sheet->setCellValue('H' . $row, number_format($val_feb, 2));
				$sheet->setCellValue('I' . $row, number_format($qty_mar, 0));
				$sheet->setCellValue('J' . $row, number_format($val_mar, 2));
				$sheet->setCellValue('K' . $row, number_format($qty_apr, 0));
				$sheet->setCellValue('L' . $row, number_format($val_apr, 2));
				$sheet->setCellValue('M' . $row, number_format($qty_mei, 0));
				$sheet->setCellValue('N' . $row, number_format($val_mei, 2));
				$sheet->setCellValue('O' . $row, number_format($qty_jun, 0));
				$sheet->setCellValue('P' . $row, number_format($val_jun, 2));
				$sheet->setCellValue('Q' . $row, number_format($qty_jul, 0));
				$sheet->setCellValue('R' . $row, number_format($val_jul, 2));
				$sheet->setCellValue('S' . $row, number_format($qty_agu, 0));
				$sheet->setCellValue('T' . $row, number_format($val_agu, 2));
				$sheet->setCellValue('U' . $row, number_format($qty_sep, 0));
				$sheet->setCellValue('V' . $row, number_format($val_sep, 2));
				$sheet->setCellValue('W' . $row, number_format($qty_okt, 0));
				$sheet->setCellValue('X' . $row, number_format($val_okt, 2));
				$sheet->setCellValue('Y' . $row, number_format($qty_nop, 0));
				$sheet->setCellValue('Z' . $row, number_format($val_nop, 2));
				$sheet->setCellValue('AA' . $row, number_format($qty_des, 0));
				$sheet->setCellValue('AB' . $row, number_format($val_des, 2));
				$sheet->setCellValue('AC' . $row, number_format($qty_year, 0));
				$sheet->setCellValue('AD' . $row, number_format($val_year, 2));
				$sheet->setCellValue('AE' . $row, number_format($qty_year/12, 0));
				$sheet->setCellValue('AF' . $row, number_format($val_year/12, 2));

				// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
				$sheet->getStyle('A' . $row)->applyFromArray($style_row);
				$sheet->getStyle('B' . $row)->applyFromArray($style_row);
				$sheet->getStyle('C' . $row)->applyFromArray($style_row);
				$sheet->getStyle('D' . $row)->applyFromArray($style_row);
				$sheet->getStyle('E' . $row)->applyFromArray($style_row);
				$sheet->getStyle('F' . $row)->applyFromArray($style_row);
				$sheet->getStyle('G' . $row)->applyFromArray($style_row);
				$sheet->getStyle('H' . $row)->applyFromArray($style_row);
				$sheet->getStyle('I' . $row)->applyFromArray($style_row);
				$sheet->getStyle('J' . $row)->applyFromArray($style_row);
				$sheet->getStyle('K' . $row)->applyFromArray($style_row);
				$sheet->getStyle('L' . $row)->applyFromArray($style_row);
				$sheet->getStyle('M' . $row)->applyFromArray($style_row);
				$sheet->getStyle('N' . $row)->applyFromArray($style_row);
				$sheet->getStyle('O' . $row)->applyFromArray($style_row);
				$sheet->getStyle('P' . $row)->applyFromArray($style_row);
				$sheet->getStyle('Q' . $row)->applyFromArray($style_row);
				$sheet->getStyle('R' . $row)->applyFromArray($style_row);
				$sheet->getStyle('S' . $row)->applyFromArray($style_row);
				$sheet->getStyle('T' . $row)->applyFromArray($style_row);
				$sheet->getStyle('U' . $row)->applyFromArray($style_row);
				$sheet->getStyle('V' . $row)->applyFromArray($style_row);
				$sheet->getStyle('W' . $row)->applyFromArray($style_row);
				$sheet->getStyle('X' . $row)->applyFromArray($style_row);
				$sheet->getStyle('Y' . $row)->applyFromArray($style_row);
				$sheet->getStyle('Z' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AA' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AB' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AC' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AD' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AE' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AF' . $row)->applyFromArray($style_row);

				$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
				$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
				$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
				$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
				$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('I' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('J' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('K' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('L' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('M' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('N' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('O' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('P' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('Q' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('R' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('S' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('T' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('U' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('V' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('W' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('X' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('Y' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('Z' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AA' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AB' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AC' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AD' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AE' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AF' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

				$sheet->getStyle('A' . $row . ':AF' . $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');
				$sheet->getStyle('A' . $row . ':AF' . $row)->getFont()->setBold(true);

				$qty_jan = 0;
                $qty_feb = 0;
                $qty_mar = 0;
                $qty_apr = 0;
                $qty_mei = 0;
                $qty_jun = 0;
                $qty_jul = 0;
                $qty_agu = 0;
                $qty_sep = 0;
                $qty_okt = 0;
                $qty_nop = 0;
                $qty_des = 0;
                $qty_year = 0;
                $qty_avg = 0;

                $val_jan = 0;
               	$val_feb = 0;
                $val_mar = 0;
                $val_apr = 0;
                $val_mei = 0;
                $val_jun = 0;
                $val_jul = 0;
                $val_agu = 0;
                $val_sep = 0;
                $val_okt = 0;
                $val_nop = 0;
                $val_des = 0;
                $val_year = 0;
                $val_avg = 0;

				$row++;
            }

			if ($island != $rows['island'] and $island != '' )
            {
				
				$sheet->setCellValue('A' . $row, '');
				$sheet->setCellValue('B' . $row, '');
				$sheet->setCellValue('C' . $row, '');
				$sheet->setCellValue('D' . $row, $island);
				$sheet->setCellValue('E' . $row, number_format($sub_qty_jan, 0));
				$sheet->setCellValue('F' . $row, number_format($sub_val_jan, 2));
				$sheet->setCellValue('G' . $row, number_format($sub_qty_feb, 0));
				$sheet->setCellValue('H' . $row, number_format($sub_val_feb, 2));
				$sheet->setCellValue('I' . $row, number_format($sub_qty_mar, 0));
				$sheet->setCellValue('J' . $row, number_format($sub_val_mar, 2));
				$sheet->setCellValue('K' . $row, number_format($sub_qty_apr, 0));
				$sheet->setCellValue('L' . $row, number_format($sub_val_apr, 2));
				$sheet->setCellValue('M' . $row, number_format($sub_qty_mei, 0));
				$sheet->setCellValue('N' . $row, number_format($sub_val_mei, 2));
				$sheet->setCellValue('O' . $row, number_format($sub_qty_jun, 0));
				$sheet->setCellValue('P' . $row, number_format($sub_val_jun, 2));
				$sheet->setCellValue('Q' . $row, number_format($sub_qty_jul, 0));
				$sheet->setCellValue('R' . $row, number_format($sub_val_jul, 2));
				$sheet->setCellValue('S' . $row, number_format($sub_qty_agu, 0));
				$sheet->setCellValue('T' . $row, number_format($sub_val_agu, 2));
				$sheet->setCellValue('U' . $row, number_format($sub_qty_sep, 0));
				$sheet->setCellValue('V' . $row, number_format($sub_val_sep, 2));
				$sheet->setCellValue('W' . $row, number_format($sub_qty_okt, 0));
				$sheet->setCellValue('X' . $row, number_format($sub_val_okt, 2));
				$sheet->setCellValue('Y' . $row, number_format($sub_qty_nop, 0));
				$sheet->setCellValue('Z' . $row, number_format($sub_val_nop, 2));
				$sheet->setCellValue('AA' . $row, number_format($sub_qty_des, 0));
				$sheet->setCellValue('AB' . $row, number_format($sub_val_des, 2));
				$sheet->setCellValue('AC' . $row, number_format($sub_qty_year, 0));
				$sheet->setCellValue('AD' . $row, number_format($sub_val_year, 2));
				$sheet->setCellValue('AE' . $row, number_format($sub_qty_year/12, 0));
				$sheet->setCellValue('AF' . $row, number_format($sub_val_year/12, 2));

				// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
				$sheet->getStyle('A' . $row)->applyFromArray($style_row);
				$sheet->getStyle('B' . $row)->applyFromArray($style_row);
				$sheet->getStyle('C' . $row)->applyFromArray($style_row);
				$sheet->getStyle('D' . $row)->applyFromArray($style_row);
				$sheet->getStyle('E' . $row)->applyFromArray($style_row);
				$sheet->getStyle('F' . $row)->applyFromArray($style_row);
				$sheet->getStyle('G' . $row)->applyFromArray($style_row);
				$sheet->getStyle('H' . $row)->applyFromArray($style_row);
				$sheet->getStyle('I' . $row)->applyFromArray($style_row);
				$sheet->getStyle('J' . $row)->applyFromArray($style_row);
				$sheet->getStyle('K' . $row)->applyFromArray($style_row);
				$sheet->getStyle('L' . $row)->applyFromArray($style_row);
				$sheet->getStyle('M' . $row)->applyFromArray($style_row);
				$sheet->getStyle('N' . $row)->applyFromArray($style_row);
				$sheet->getStyle('O' . $row)->applyFromArray($style_row);
				$sheet->getStyle('P' . $row)->applyFromArray($style_row);
				$sheet->getStyle('Q' . $row)->applyFromArray($style_row);
				$sheet->getStyle('R' . $row)->applyFromArray($style_row);
				$sheet->getStyle('S' . $row)->applyFromArray($style_row);
				$sheet->getStyle('T' . $row)->applyFromArray($style_row);
				$sheet->getStyle('U' . $row)->applyFromArray($style_row);
				$sheet->getStyle('V' . $row)->applyFromArray($style_row);
				$sheet->getStyle('W' . $row)->applyFromArray($style_row);
				$sheet->getStyle('X' . $row)->applyFromArray($style_row);
				$sheet->getStyle('Y' . $row)->applyFromArray($style_row);
				$sheet->getStyle('Z' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AA' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AB' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AC' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AD' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AE' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AF' . $row)->applyFromArray($style_row);

				$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
				$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
				$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
				$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
				$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('I' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('J' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('K' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('L' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('M' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('N' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('O' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('P' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('Q' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('R' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('S' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('T' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('U' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('V' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('W' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('X' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('Y' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('Z' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AA' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AB' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AC' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AD' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AE' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AF' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

				$sheet->getStyle('A' . $row . ':AF' . $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFA07A');
				$sheet->getStyle('A' . $row . ':AF' . $row)->getFont()->setBold(true);

				$sub_qty_jan = 0;
				$sub_qty_feb = 0;
				$sub_qty_mar = 0;
				$sub_qty_apr = 0;
				$sub_qty_mei = 0;
				$sub_qty_jun = 0;
				$sub_qty_jul = 0;
				$sub_qty_agu = 0;
				$sub_qty_sep = 0;
				$sub_qty_okt = 0;
				$sub_qty_nop = 0;
				$sub_qty_des = 0;
				$sub_qty_year = 0;
				$sub_qty_avg = 0;

				$sub_val_jan = 0;
				$sub_val_feb = 0;
				$sub_val_mar = 0;
				$sub_val_apr = 0;
				$sub_val_mei = 0;
				$sub_val_jun = 0;
				$sub_val_jul = 0;
				$sub_val_agu = 0;
				$sub_val_sep = 0;
				$sub_val_okt = 0;
				$sub_val_nop = 0;
				$sub_val_des = 0;
				$sub_val_year = 0;
				$sub_val_avg = 0;

				$row++;
            }

			$sheet->setCellValue('A' . $row, $no);
    		$sheet->setCellValue('B' . $row, $rows['cust_code']);
			$sheet->setCellValue('C' . $row, $rows['distributor']);
			$sheet->setCellValue('D' . $row, $rows['area']);
			$sheet->setCellValue('E' . $row, number_format($rows['qty_jan'], 0));
			$sheet->setCellValue('F' . $row, number_format($rows['val_jan'], 2));
			$sheet->setCellValue('G' . $row, number_format($rows['qty_feb'], 0));
			$sheet->setCellValue('H' . $row, number_format($rows['val_feb'], 2));
			$sheet->setCellValue('I' . $row, number_format($rows['qty_mar'], 0));
			$sheet->setCellValue('J' . $row, number_format($rows['val_mar'], 2));
			$sheet->setCellValue('K' . $row, number_format($rows['qty_apr'], 0));
			$sheet->setCellValue('L' . $row, number_format($rows['val_apr'], 2));
			$sheet->setCellValue('M' . $row, number_format($rows['qty_mei'], 0));
			$sheet->setCellValue('N' . $row, number_format($rows['val_mei'], 2));
			$sheet->setCellValue('O' . $row, number_format($rows['qty_jun'], 0));
			$sheet->setCellValue('P' . $row, number_format($rows['val_jun'], 2));
			$sheet->setCellValue('Q' . $row, number_format($rows['qty_jul'], 0));
			$sheet->setCellValue('R' . $row, number_format($rows['val_jul'], 2));
			$sheet->setCellValue('S' . $row, number_format($rows['qty_agu'], 0));
			$sheet->setCellValue('T' . $row, number_format($rows['val_agu'], 2));
			$sheet->setCellValue('U' . $row, number_format($rows['qty_sep'], 0));
			$sheet->setCellValue('V' . $row, number_format($rows['val_sep'], 2));
			$sheet->setCellValue('W' . $row, number_format($rows['qty_okt'], 0));
			$sheet->setCellValue('X' . $row, number_format($rows['val_okt'], 2));
			$sheet->setCellValue('Y' . $row, number_format($rows['qty_nop'], 0));
			$sheet->setCellValue('Z' . $row, number_format($rows['val_nop'], 2));
			$sheet->setCellValue('AA' . $row, number_format($rows['qty_des'], 0));
			$sheet->setCellValue('AB' . $row, number_format($rows['val_des'], 2));
			$sheet->setCellValue('AC' . $row, number_format($rows['qty_year'], 0));
			$sheet->setCellValue('AD' . $row, number_format($rows['val_year'], 2));
			$sheet->setCellValue('AE' . $row, number_format($rows['qty_year']/12, 0));
			$sheet->setCellValue('AF' . $row, number_format($rows['val_year']/12, 2));

			// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
			$sheet->getStyle('A' . $row)->applyFromArray($style_row);
			$sheet->getStyle('B' . $row)->applyFromArray($style_row);
			$sheet->getStyle('C' . $row)->applyFromArray($style_row);
			$sheet->getStyle('D' . $row)->applyFromArray($style_row);
			$sheet->getStyle('E' . $row)->applyFromArray($style_row);
			$sheet->getStyle('F' . $row)->applyFromArray($style_row);
			$sheet->getStyle('G' . $row)->applyFromArray($style_row);
			$sheet->getStyle('H' . $row)->applyFromArray($style_row);
			$sheet->getStyle('I' . $row)->applyFromArray($style_row);
			$sheet->getStyle('J' . $row)->applyFromArray($style_row);
			$sheet->getStyle('K' . $row)->applyFromArray($style_row);
			$sheet->getStyle('L' . $row)->applyFromArray($style_row);
			$sheet->getStyle('M' . $row)->applyFromArray($style_row);
			$sheet->getStyle('N' . $row)->applyFromArray($style_row);
			$sheet->getStyle('O' . $row)->applyFromArray($style_row);
			$sheet->getStyle('P' . $row)->applyFromArray($style_row);
			$sheet->getStyle('Q' . $row)->applyFromArray($style_row);
			$sheet->getStyle('R' . $row)->applyFromArray($style_row);
			$sheet->getStyle('S' . $row)->applyFromArray($style_row);
			$sheet->getStyle('T' . $row)->applyFromArray($style_row);
			$sheet->getStyle('U' . $row)->applyFromArray($style_row);
			$sheet->getStyle('V' . $row)->applyFromArray($style_row);
			$sheet->getStyle('W' . $row)->applyFromArray($style_row);
			$sheet->getStyle('X' . $row)->applyFromArray($style_row);
			$sheet->getStyle('Y' . $row)->applyFromArray($style_row);
			$sheet->getStyle('Z' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AA' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AB' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AC' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AD' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AE' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AF' . $row)->applyFromArray($style_row);

			$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('I' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('J' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('K' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('L' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('M' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('N' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('O' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('P' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('Q' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('R' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('S' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('T' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('U' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('V' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('W' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('X' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('Y' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('Z' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AA' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AB' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AC' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AD' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AE' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AF' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

			$region = $rows['region'];
			$island = $rows['island'];

			$qty_jan += $rows['qty_jan'];
            $qty_feb += $rows['qty_feb'];
            $qty_mar += $rows['qty_mar'];
            $qty_apr += $rows['qty_apr'];
            $qty_mei += $rows['qty_mei'];
            $qty_jun += $rows['qty_jun'];
            $qty_jul += $rows['qty_jul'];
            $qty_agu += $rows['qty_agu'];
            $qty_sep += $rows['qty_sep'];
            $qty_okt += $rows['qty_okt'];
            $qty_nop += $rows['qty_nop'];
            $qty_des += $rows['qty_des'];
            $qty_year += $rows['qty_year'];

            $val_jan += $rows['val_jan'];
            $val_feb += $rows['val_feb'];
            $val_mar += $rows['val_mar'];
            $val_apr += $rows['val_apr'];
            $val_mei += $rows['val_mei'];
            $val_jun += $rows['val_jun'];
            $val_jul += $rows['val_jul'];
            $val_agu += $rows['val_agu'];
            $val_sep += $rows['val_sep'];
            $val_okt += $rows['val_okt'];
            $val_nop += $rows['val_nop'];
            $val_des += $rows['val_des'];
            $val_year += $rows['val_year'];

            $sub_qty_jan += $rows['qty_jan'];
            $sub_qty_feb += $rows['qty_feb'];
            $sub_qty_mar += $rows['qty_mar'];
            $sub_qty_apr += $rows['qty_apr'];
            $sub_qty_mei += $rows['qty_mei'];
            $sub_qty_jun += $rows['qty_jun'];
            $sub_qty_jul += $rows['qty_jul'];
            $sub_qty_agu += $rows['qty_agu'];
            $sub_qty_sep += $rows['qty_sep'];
            $sub_qty_okt += $rows['qty_okt'];
            $sub_qty_nop += $rows['qty_nop'];
            $sub_qty_des += $rows['qty_des'];
            $sub_qty_year += $rows['qty_year'];

            $sub_val_jan += $rows['val_jan'];
            $sub_val_feb += $rows['val_feb'];
            $sub_val_mar += $rows['val_mar'];
            $sub_val_apr += $rows['val_apr'];
            $sub_val_mei += $rows['val_mei'];
        	$sub_val_jun += $rows['val_jun'];
            $sub_val_jul += $rows['val_jul'];
            $sub_val_agu += $rows['val_agu'];
            $sub_val_sep += $rows['val_sep'];
            $sub_val_okt += $rows['val_okt'];
            $sub_val_nop += $rows['val_nop'];
            $sub_val_des += $rows['val_des'];
            $sub_val_year += $rows['val_year'];

            $total_qty_jan += $rows['qty_jan'];
            $total_qty_feb += $rows['qty_feb'];
            $total_qty_mar += $rows['qty_mar'];
            $total_qty_apr += $rows['qty_apr'];
            $total_qty_mei += $rows['qty_mei'];
            $total_qty_jun += $rows['qty_jun'];
            $total_qty_jul += $rows['qty_jul'];
            $total_qty_agu += $rows['qty_agu'];
            $total_qty_sep += $rows['qty_sep'];
            $total_qty_okt += $rows['qty_okt'];
            $total_qty_nop += $rows['qty_nop'];
            $total_qty_des += $rows['qty_des'];
            $total_qty_year += $rows['qty_year'];

            $total_val_jan += $rows['val_jan'];
            $total_val_feb += $rows['val_feb'];
            $total_val_mar += $rows['val_mar'];
            $total_val_apr += $rows['val_apr'];
            $total_val_mei += $rows['val_mei'];
            $total_val_jun += $rows['val_jun'];
            $total_val_jul += $rows['val_jul'];
            $total_val_agu += $rows['val_agu'];
            $total_val_sep += $rows['val_sep'];
            $total_val_okt += $rows['val_okt'];
            $total_val_nop += $rows['val_nop'];
            $total_val_des += $rows['val_des'];
            $total_val_year += $rows['val_year'];

			$no++; // Tambah 1 setiap kali looping
    		$row++; // Tambah 1 setiap kali looping
		endforeach;

		//region end
		//$row = $row + 1;
		$sheet->setCellValue('A' . $row, '');
		$sheet->setCellValue('B' . $row, '');
		$sheet->setCellValue('C' . $row, '');
		$sheet->setCellValue('D' . $row, $region);
		$sheet->setCellValue('E' . $row, number_format($qty_jan, 0));
		$sheet->setCellValue('F' . $row, number_format($val_jan, 2));
		$sheet->setCellValue('G' . $row, number_format($qty_feb, 0));
		$sheet->setCellValue('H' . $row, number_format($val_feb, 2));
		$sheet->setCellValue('I' . $row, number_format($qty_mar, 0));
		$sheet->setCellValue('J' . $row, number_format($val_mar, 2));
		$sheet->setCellValue('K' . $row, number_format($qty_apr, 0));
		$sheet->setCellValue('L' . $row, number_format($val_apr, 2));
		$sheet->setCellValue('M' . $row, number_format($qty_mei, 0));
		$sheet->setCellValue('N' . $row, number_format($val_mei, 2));
		$sheet->setCellValue('O' . $row, number_format($qty_jun, 0));
		$sheet->setCellValue('P' . $row, number_format($val_jun, 2));
		$sheet->setCellValue('Q' . $row, number_format($qty_jul, 0));
		$sheet->setCellValue('R' . $row, number_format($val_jul, 2));
		$sheet->setCellValue('S' . $row, number_format($qty_agu, 0));
		$sheet->setCellValue('T' . $row, number_format($val_agu, 2));
		$sheet->setCellValue('U' . $row, number_format($qty_sep, 0));
		$sheet->setCellValue('V' . $row, number_format($val_sep, 2));
		$sheet->setCellValue('W' . $row, number_format($qty_okt, 0));
		$sheet->setCellValue('X' . $row, number_format($val_okt, 2));
		$sheet->setCellValue('Y' . $row, number_format($qty_nop, 0));
		$sheet->setCellValue('Z' . $row, number_format($val_nop, 2));
		$sheet->setCellValue('AA' . $row, number_format($qty_des, 0));
		$sheet->setCellValue('AB' . $row, number_format($val_des, 2));
		$sheet->setCellValue('AC' . $row, number_format($qty_year, 0));
		$sheet->setCellValue('AD' . $row, number_format($val_year, 2));
		$sheet->setCellValue('AE' . $row, number_format($qty_year/12, 0));
		$sheet->setCellValue('AF' . $row, number_format($val_year/12, 2));

		// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
		$sheet->getStyle('A' . $row)->applyFromArray($style_row);
		$sheet->getStyle('B' . $row)->applyFromArray($style_row);
		$sheet->getStyle('C' . $row)->applyFromArray($style_row);
		$sheet->getStyle('D' . $row)->applyFromArray($style_row);
		$sheet->getStyle('E' . $row)->applyFromArray($style_row);
		$sheet->getStyle('F' . $row)->applyFromArray($style_row);
		$sheet->getStyle('G' . $row)->applyFromArray($style_row);
		$sheet->getStyle('H' . $row)->applyFromArray($style_row);
		$sheet->getStyle('I' . $row)->applyFromArray($style_row);
		$sheet->getStyle('J' . $row)->applyFromArray($style_row);
		$sheet->getStyle('K' . $row)->applyFromArray($style_row);
		$sheet->getStyle('L' . $row)->applyFromArray($style_row);
		$sheet->getStyle('M' . $row)->applyFromArray($style_row);
		$sheet->getStyle('N' . $row)->applyFromArray($style_row);
		$sheet->getStyle('O' . $row)->applyFromArray($style_row);
		$sheet->getStyle('P' . $row)->applyFromArray($style_row);
		$sheet->getStyle('Q' . $row)->applyFromArray($style_row);
		$sheet->getStyle('R' . $row)->applyFromArray($style_row);
		$sheet->getStyle('S' . $row)->applyFromArray($style_row);
		$sheet->getStyle('T' . $row)->applyFromArray($style_row);
		$sheet->getStyle('U' . $row)->applyFromArray($style_row);
		$sheet->getStyle('V' . $row)->applyFromArray($style_row);
		$sheet->getStyle('W' . $row)->applyFromArray($style_row);
		$sheet->getStyle('X' . $row)->applyFromArray($style_row);
		$sheet->getStyle('Y' . $row)->applyFromArray($style_row);
		$sheet->getStyle('Z' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AA' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AB' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AC' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AD' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AE' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AF' . $row)->applyFromArray($style_row);

		$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('I' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('J' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('K' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('L' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('M' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('N' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('O' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('P' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('Q' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('R' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('S' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('T' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('U' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('V' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('W' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('X' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('Y' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('Z' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AA' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AB' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AC' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AD' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AE' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AF' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

		$sheet->getStyle('A' . $row . ':AF' . $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');
		$sheet->getStyle('A' . $row . ':AF' . $row)->getFont()->setBold(true);

		//island and
		$row = $row + 1;
		$sheet->setCellValue('A' . $row, '');
		$sheet->setCellValue('B' . $row, '');
		$sheet->setCellValue('C' . $row, '');
		$sheet->setCellValue('D' . $row, $island);
		$sheet->setCellValue('E' . $row, number_format($sub_qty_jan, 0));
		$sheet->setCellValue('F' . $row, number_format($sub_val_jan, 2));
		$sheet->setCellValue('G' . $row, number_format($sub_qty_feb, 0));
		$sheet->setCellValue('H' . $row, number_format($sub_val_feb, 2));
		$sheet->setCellValue('I' . $row, number_format($sub_qty_mar, 0));
		$sheet->setCellValue('J' . $row, number_format($sub_val_mar, 2));
		$sheet->setCellValue('K' . $row, number_format($sub_qty_apr, 0));
		$sheet->setCellValue('L' . $row, number_format($sub_val_apr, 2));
		$sheet->setCellValue('M' . $row, number_format($sub_qty_mei, 0));
		$sheet->setCellValue('N' . $row, number_format($sub_val_mei, 2));
		$sheet->setCellValue('O' . $row, number_format($sub_qty_jun, 0));
		$sheet->setCellValue('P' . $row, number_format($sub_val_jun, 2));
		$sheet->setCellValue('Q' . $row, number_format($sub_qty_jul, 0));
		$sheet->setCellValue('R' . $row, number_format($sub_val_jul, 2));
		$sheet->setCellValue('S' . $row, number_format($sub_qty_agu, 0));
		$sheet->setCellValue('T' . $row, number_format($sub_val_agu, 2));
		$sheet->setCellValue('U' . $row, number_format($sub_qty_sep, 0));
		$sheet->setCellValue('V' . $row, number_format($sub_val_sep, 2));
		$sheet->setCellValue('W' . $row, number_format($sub_qty_okt, 0));
		$sheet->setCellValue('X' . $row, number_format($sub_val_okt, 2));
		$sheet->setCellValue('Y' . $row, number_format($sub_qty_nop, 0));
		$sheet->setCellValue('Z' . $row, number_format($sub_val_nop, 2));
		$sheet->setCellValue('AA' . $row, number_format($sub_qty_des, 0));
		$sheet->setCellValue('AB' . $row, number_format($sub_val_des, 2));
		$sheet->setCellValue('AC' . $row, number_format($sub_qty_year, 0));
		$sheet->setCellValue('AD' . $row, number_format($sub_val_year, 2));
		$sheet->setCellValue('AE' . $row, number_format($sub_qty_year/12, 0));
		$sheet->setCellValue('AF' . $row, number_format($sub_val_year/12, 2));

		// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
		$sheet->getStyle('A' . $row)->applyFromArray($style_row);
		$sheet->getStyle('B' . $row)->applyFromArray($style_row);
		$sheet->getStyle('C' . $row)->applyFromArray($style_row);
		$sheet->getStyle('D' . $row)->applyFromArray($style_row);
		$sheet->getStyle('E' . $row)->applyFromArray($style_row);
		$sheet->getStyle('F' . $row)->applyFromArray($style_row);
		$sheet->getStyle('G' . $row)->applyFromArray($style_row);
		$sheet->getStyle('H' . $row)->applyFromArray($style_row);
		$sheet->getStyle('I' . $row)->applyFromArray($style_row);
		$sheet->getStyle('J' . $row)->applyFromArray($style_row);
		$sheet->getStyle('K' . $row)->applyFromArray($style_row);
		$sheet->getStyle('L' . $row)->applyFromArray($style_row);
		$sheet->getStyle('M' . $row)->applyFromArray($style_row);
		$sheet->getStyle('N' . $row)->applyFromArray($style_row);
		$sheet->getStyle('O' . $row)->applyFromArray($style_row);
		$sheet->getStyle('P' . $row)->applyFromArray($style_row);
		$sheet->getStyle('Q' . $row)->applyFromArray($style_row);
		$sheet->getStyle('R' . $row)->applyFromArray($style_row);
		$sheet->getStyle('S' . $row)->applyFromArray($style_row);
		$sheet->getStyle('T' . $row)->applyFromArray($style_row);
		$sheet->getStyle('U' . $row)->applyFromArray($style_row);
		$sheet->getStyle('V' . $row)->applyFromArray($style_row);
		$sheet->getStyle('W' . $row)->applyFromArray($style_row);
		$sheet->getStyle('X' . $row)->applyFromArray($style_row);
		$sheet->getStyle('Y' . $row)->applyFromArray($style_row);
		$sheet->getStyle('Z' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AA' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AB' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AC' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AD' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AE' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AF' . $row)->applyFromArray($style_row);

		$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('I' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('J' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('K' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('L' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('M' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('N' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('O' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('P' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('Q' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('R' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('S' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('T' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('U' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('V' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('W' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('X' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('Y' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('Z' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AA' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AB' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AC' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AD' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AE' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AF' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

		$sheet->getStyle('A' . $row . ':AF' . $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFA07A');
		$sheet->getStyle('A' . $row . ':AF' . $row)->getFont()->setBold(true);

		//national
		$row = $row + 1;
		$sheet->setCellValue('A' . $row, '');
		$sheet->setCellValue('B' . $row, '');
		$sheet->setCellValue('C' . $row, '');
		$sheet->setCellValue('D' . $row, 'NATIONAL');
		$sheet->setCellValue('E' . $row, number_format($total_qty_jan, 0));
		$sheet->setCellValue('F' . $row, number_format($total_val_jan, 2));
		$sheet->setCellValue('G' . $row, number_format($total_qty_feb, 0));
		$sheet->setCellValue('H' . $row, number_format($total_val_feb, 2));
		$sheet->setCellValue('I' . $row, number_format($total_qty_mar, 0));
		$sheet->setCellValue('J' . $row, number_format($total_val_mar, 2));
		$sheet->setCellValue('K' . $row, number_format($total_qty_apr, 0));
		$sheet->setCellValue('L' . $row, number_format($total_val_apr, 2));
		$sheet->setCellValue('M' . $row, number_format($total_qty_mei, 0));
		$sheet->setCellValue('N' . $row, number_format($total_val_mei, 2));
		$sheet->setCellValue('O' . $row, number_format($total_qty_jun, 0));
		$sheet->setCellValue('P' . $row, number_format($total_val_jun, 2));
		$sheet->setCellValue('Q' . $row, number_format($total_qty_jul, 0));
		$sheet->setCellValue('R' . $row, number_format($total_val_jul, 2));
		$sheet->setCellValue('S' . $row, number_format($total_qty_agu, 0));
		$sheet->setCellValue('T' . $row, number_format($total_val_agu, 2));
		$sheet->setCellValue('U' . $row, number_format($total_qty_sep, 0));
		$sheet->setCellValue('V' . $row, number_format($total_val_sep, 2));
		$sheet->setCellValue('W' . $row, number_format($total_qty_okt, 0));
		$sheet->setCellValue('X' . $row, number_format($total_val_okt, 2));
		$sheet->setCellValue('Y' . $row, number_format($total_qty_nop, 0));
		$sheet->setCellValue('Z' . $row, number_format($total_val_nop, 2));
		$sheet->setCellValue('AA' . $row, number_format($total_qty_des, 0));
		$sheet->setCellValue('AB' . $row, number_format($total_val_des, 2));
		$sheet->setCellValue('AC' . $row, number_format($total_qty_year, 0));
		$sheet->setCellValue('AD' . $row, number_format($total_val_year, 2));
		$sheet->setCellValue('AE' . $row, number_format($total_qty_year/12, 0));
		$sheet->setCellValue('AF' . $row, number_format($total_val_year/12, 2));

		// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
		$sheet->getStyle('A' . $row)->applyFromArray($style_row);
		$sheet->getStyle('B' . $row)->applyFromArray($style_row);
		$sheet->getStyle('C' . $row)->applyFromArray($style_row);
		$sheet->getStyle('D' . $row)->applyFromArray($style_row);
		$sheet->getStyle('E' . $row)->applyFromArray($style_row);
		$sheet->getStyle('F' . $row)->applyFromArray($style_row);
		$sheet->getStyle('G' . $row)->applyFromArray($style_row);
		$sheet->getStyle('H' . $row)->applyFromArray($style_row);
		$sheet->getStyle('I' . $row)->applyFromArray($style_row);
		$sheet->getStyle('J' . $row)->applyFromArray($style_row);
		$sheet->getStyle('K' . $row)->applyFromArray($style_row);
		$sheet->getStyle('L' . $row)->applyFromArray($style_row);
		$sheet->getStyle('M' . $row)->applyFromArray($style_row);
		$sheet->getStyle('N' . $row)->applyFromArray($style_row);
		$sheet->getStyle('O' . $row)->applyFromArray($style_row);
		$sheet->getStyle('P' . $row)->applyFromArray($style_row);
		$sheet->getStyle('Q' . $row)->applyFromArray($style_row);
		$sheet->getStyle('R' . $row)->applyFromArray($style_row);
		$sheet->getStyle('S' . $row)->applyFromArray($style_row);
		$sheet->getStyle('T' . $row)->applyFromArray($style_row);
		$sheet->getStyle('U' . $row)->applyFromArray($style_row);
		$sheet->getStyle('V' . $row)->applyFromArray($style_row);
		$sheet->getStyle('W' . $row)->applyFromArray($style_row);
		$sheet->getStyle('X' . $row)->applyFromArray($style_row);
		$sheet->getStyle('Y' . $row)->applyFromArray($style_row);
		$sheet->getStyle('Z' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AA' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AB' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AC' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AD' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AE' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AF' . $row)->applyFromArray($style_row);

		$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('I' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('J' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('K' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('L' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('M' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('N' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('O' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('P' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('Q' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('R' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('S' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('T' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('U' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('V' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('W' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('X' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('Y' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('Z' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AA' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AB' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AC' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AD' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AE' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AF' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

		$sheet->getStyle('A' . $row . ':AF' . $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFA07A');
		$sheet->getStyle('A' . $row . ':AF' . $row)->getFont()->setBold(true);


		//set columns width
		$sheet->getColumnDimension('A')->setWidth(5); 
		$sheet->getColumnDimension('B')->setWidth(11); 
		$sheet->getColumnDimension('C')->setWidth(40);
		$sheet->getColumnDimension('D')->setWidth(15);
		$sheet->getColumnDimension('E')->setWidth(10);
		$sheet->getColumnDimension('F')->setWidth(16);
		$sheet->getColumnDimension('G')->setWidth(10);
		$sheet->getColumnDimension('H')->setWidth(16);
		$sheet->getColumnDimension('I')->setWidth(10);
		$sheet->getColumnDimension('J')->setWidth(16);
		$sheet->getColumnDimension('K')->setWidth(10);
		$sheet->getColumnDimension('L')->setWidth(16);
		$sheet->getColumnDimension('M')->setWidth(10);
		$sheet->getColumnDimension('N')->setWidth(16);
		$sheet->getColumnDimension('O')->setWidth(10);
		$sheet->getColumnDimension('P')->setWidth(16);
		$sheet->getColumnDimension('Q')->setWidth(10);
		$sheet->getColumnDimension('R')->setWidth(16);
		$sheet->getColumnDimension('S')->setWidth(10);
		$sheet->getColumnDimension('T')->setWidth(16);
		$sheet->getColumnDimension('U')->setWidth(10);
		$sheet->getColumnDimension('V')->setWidth(16);
		$sheet->getColumnDimension('W')->setWidth(10);
		$sheet->getColumnDimension('X')->setWidth(16);
		$sheet->getColumnDimension('Y')->setWidth(10);
		$sheet->getColumnDimension('Z')->setWidth(16);
		$sheet->getColumnDimension('AA')->setWidth(10);
		$sheet->getColumnDimension('AB')->setWidth(16);
		$sheet->getColumnDimension('AC')->setWidth(10);
		$sheet->getColumnDimension('AD')->setWidth(16);
		$sheet->getColumnDimension('AE')->setWidth(10);
		$sheet->getColumnDimension('AF')->setWidth(16);

		// Set orientasi kertas jadi LANDSCAPE
		$sheet->getPageSetup()->setOrientation(\PhpOffice\PhpSpreadsheet\Worksheet\PageSetup::ORIENTATION_LANDSCAPE);
		// Set judul file excel nya
		$sheet->setTitle("Selling Out - Distributor");
		// Proses file excel
		header('Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet');
		header('Content-Disposition: attachment; filename="Report Selling Out - Distributor ("' . $year . '").xlsx"'); // Set nama file excel nya
		header('Cache-Control: max-age=0');

		$writer = new Xlsx($spreadsheet);
		$writer->save('php://output');


	}

	public function export_sellingin_qty()
	{
		$spreadsheet = new Spreadsheet();
		$sheet = $spreadsheet->getActiveSheet();
		// Buat sebuah variabel untuk menampung pengaturan style dari header tabel
		$style_col = [
			'font' => ['bold' => true], // Set font nya jadi bold
			'alignment' => [
				'horizontal' => \PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER, // Set text jadi ditengah secara horizontal (center)
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'top' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border top dengan garis tipis
				'right' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN],  // Set border right dengan garis tipis
				'bottom' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border bottom dengan garis tipis
				'left' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN] // Set border left dengan garis tipis
			]
		];
		// Buat sebuah variabel untuk menampung pengaturan style dari isi tabel
		$style_row = [
			'alignment' => [
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'top' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border top dengan garis tipis
				'right' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN],  // Set border right dengan garis tipis
				'bottom' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border bottom dengan garis tipis
				'left' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN] // Set border left dengan garis tipis
			]
		];


		if (isset($_POST['by_island']))
		{
			$island = $_POST['by_island'];
		}
		else
		{
			$island = "";
		}

		if (isset($_POST['by_region']))
		{
			$region = $_POST['by_region'];
		}
		else
		{
			$region = "";
		}

		if (isset($_POST['by_area']))
		{
			$area = implode(',', $_POST['by_area']);
		}
		else
		{
			$area = "";
		}

		if (isset($_POST['by_year']))
		{
			$year = $_POST['by_year'];
		}
		else
		{
			$year = "";
		}


		$sheet->setCellValue('A1', "Report Selling In - Quantity (" . $year . ")"); // Set kolom A1 dengan tulisan 
		$sheet->setCellValue('A2', "Island : " . $island);
		$sheet->setCellValue('A3', "Region : " . $region); 
		$sheet->setCellValue('A4', "Area : " . $area); 
		//$sheet->mergeCells('A1:F1'); // Set Merge Cell pada kolom A1 sampai F1
		$sheet->getStyle('A1')->getFont()->setBold(true); // Set bold kolom A1
		$sheet->getStyle('A2')->getFont()->setBold(true);
		$sheet->getStyle('A3')->getFont()->setBold(true);
		$sheet->getStyle('A4')->getFont()->setBold(true);
		$sheet->getStyle('A1')->getFont()->setSize(20); // Set font size 15 untuk kolom A1
		// Buat header tabel nya pada baris ke 6
		$sheet->setCellValue('A6', "#"); // Set kolom A6 dengan tulisan "#"
		$sheet->setCellValue('B6', "Principal");
		$sheet->setCellValue('C6', "Group SKU"); 
		$sheet->setCellValue('D6', "Kode Item"); 
		$sheet->setCellValue('E6', "SKU");
		$sheet->setCellValue('F6', "Unit");
		$sheet->setCellValue('G6', "January");
		$sheet->setCellValue('H6', "February");
		$sheet->setCellValue('I6', "March");
		$sheet->setCellValue('J6', "April");
		$sheet->setCellValue('K6', "May");
		$sheet->setCellValue('L6', "June");
		$sheet->setCellValue('M6', "July");
		$sheet->setCellValue('N6', "August");
		$sheet->setCellValue('O6', "September");
		$sheet->setCellValue('P6', "October");
		$sheet->setCellValue('Q6', "November");
		$sheet->setCellValue('R6', "December");
		$sheet->setCellValue('S6', "Total");
		
		

		// Apply style header yang telah kita buat tadi ke masing-masing kolom header
		$sheet->getStyle('A6')->applyFromArray($style_col);
		$sheet->getStyle('B6')->applyFromArray($style_col);
		$sheet->getStyle('C6')->applyFromArray($style_col);
		$sheet->getStyle('D6')->applyFromArray($style_col);
		$sheet->getStyle('E6')->applyFromArray($style_col);
		$sheet->getStyle('F6')->applyFromArray($style_col);
		$sheet->getStyle('G6')->applyFromArray($style_col);
		$sheet->getStyle('H6')->applyFromArray($style_col);
		$sheet->getStyle('I6')->applyFromArray($style_col);
		$sheet->getStyle('J6')->applyFromArray($style_col);
		$sheet->getStyle('K6')->applyFromArray($style_col);
		$sheet->getStyle('L6')->applyFromArray($style_col);
		$sheet->getStyle('M6')->applyFromArray($style_col);
		$sheet->getStyle('N6')->applyFromArray($style_col);
		$sheet->getStyle('O6')->applyFromArray($style_col);
		$sheet->getStyle('P6')->applyFromArray($style_col);
		$sheet->getStyle('Q6')->applyFromArray($style_col);
		$sheet->getStyle('R6')->applyFromArray($style_col);
		$sheet->getStyle('S6')->applyFromArray($style_col);

		$sheet->getStyle('A6:R6')->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');
		$sheet->getStyle('S6')->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFA07A');

		// Set height baris ke 1 dan 2
		$sheet->getRowDimension('1')->setRowHeight(40);
		$sheet->getRowDimension('2')->setRowHeight(20);
		$sheet->getRowDimension('3')->setRowHeight(20);
		$sheet->getRowDimension('4')->setRowHeight(20);


		$item_group = '';
        $principal = '';
        $qty_jan = 0;
        $qty_feb = 0;
        $qty_mar = 0;
        $qty_apr = 0;
        $qty_mei = 0;
        $qty_jun = 0;
        $qty_jul = 0;
        $qty_agu = 0;
        $qty_sep = 0;
        $qty_okt = 0;
        $qty_nop = 0;
        $qty_des = 0;
        $qty_year = 0;
        $qty_avg = 0;

        $sub_qty_jan = 0;
        $sub_qty_feb = 0;
        $sub_qty_mar = 0;
        $sub_qty_apr = 0;
        $sub_qty_mei = 0;
        $sub_qty_jun = 0;
        $sub_qty_jul = 0;
        $sub_qty_agu = 0;
        $sub_qty_sep = 0;
        $sub_qty_okt = 0;
        $sub_qty_nop = 0;
        $sub_qty_des = 0;
        $sub_qty_year = 0;
        $sub_qty_avg = 0;

        $total_qty_jan = 0;
        $total_qty_feb = 0;
        $total_qty_mar = 0;
        $total_qty_apr = 0;
        $total_qty_mei = 0;
        $total_qty_jun = 0;
        $total_qty_jul = 0;
        $total_qty_agu = 0;
        $total_qty_sep = 0;
        $total_qty_okt = 0;
        $total_qty_nop = 0;
        $total_qty_des = 0;
        $total_qty_year = 0;
        $total_qty_avg = 0;


		$no = 1; // Untuk penomoran tabel, di awal set dengan 1
		$row = 7;

		$data1 = array(
			'island' => $island,
			'region' => $region,
			'area' => $area,
			'year' => $year
		);

		//$data['sellingin_Dist'] = $this->model('ReportModel')->getSellingIn_Dist2($data1);
		$data['sellingin_qty'] = $this->model('ReportModel')->getSellingIn_Year_pivot();
		//$data['sellingin_OT'] = $this->model('ReportModel')->getSellingIn_OT2();

		foreach ($data['sellingin_qty'] as $rows) :

			if ($item_group != $rows['item_group'] and $item_group != '' )
            {
				
				$sheet->setCellValue('A' . $row, '');
				$sheet->setCellValue('B' . $row, $principal);
				$sheet->setCellValue('C' . $row, $item_group);
				$sheet->setCellValue('D' . $row, '');
				$sheet->setCellValue('E' . $row, 'Sub Total ' . $item_group);
				$sheet->setCellValue('F' . $row, '');
				$sheet->setCellValue('G' . $row, number_format($qty_jan, 0));
				$sheet->setCellValue('H' . $row, number_format($qty_feb, 0));
				$sheet->setCellValue('I' . $row, number_format($qty_mar, 0));
				$sheet->setCellValue('J' . $row, number_format($qty_apr, 0));
				$sheet->setCellValue('K' . $row, number_format($qty_mei, 0));
				$sheet->setCellValue('L' . $row, number_format($qty_jun, 0));
				$sheet->setCellValue('M' . $row, number_format($qty_jul, 0));
				$sheet->setCellValue('N' . $row, number_format($qty_agu, 0));
				$sheet->setCellValue('O' . $row, number_format($qty_sep, 0));
				$sheet->setCellValue('P' . $row, number_format($qty_okt, 0));
				$sheet->setCellValue('Q' . $row, number_format($qty_nop, 0));
				$sheet->setCellValue('R' . $row, number_format($qty_des, 0));
				$sheet->setCellValue('S' . $row, number_format($qty_year, 0));

				// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
				$sheet->getStyle('A' . $row)->applyFromArray($style_row);
				$sheet->getStyle('B' . $row)->applyFromArray($style_row);
				$sheet->getStyle('C' . $row)->applyFromArray($style_row);
				$sheet->getStyle('D' . $row)->applyFromArray($style_row);
				$sheet->getStyle('E' . $row)->applyFromArray($style_row);
				$sheet->getStyle('F' . $row)->applyFromArray($style_row);
				$sheet->getStyle('G' . $row)->applyFromArray($style_row);
				$sheet->getStyle('H' . $row)->applyFromArray($style_row);
				$sheet->getStyle('I' . $row)->applyFromArray($style_row);
				$sheet->getStyle('J' . $row)->applyFromArray($style_row);
				$sheet->getStyle('K' . $row)->applyFromArray($style_row);
				$sheet->getStyle('L' . $row)->applyFromArray($style_row);
				$sheet->getStyle('M' . $row)->applyFromArray($style_row);
				$sheet->getStyle('N' . $row)->applyFromArray($style_row);
				$sheet->getStyle('O' . $row)->applyFromArray($style_row);
				$sheet->getStyle('P' . $row)->applyFromArray($style_row);
				$sheet->getStyle('Q' . $row)->applyFromArray($style_row);
				$sheet->getStyle('R' . $row)->applyFromArray($style_row);
				$sheet->getStyle('S' . $row)->applyFromArray($style_row);

				$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
				$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
				$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
				$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
				$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
				$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
				$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('I' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('J' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('K' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('L' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('M' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('N' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('O' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('P' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('Q' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('R' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('S' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

				$sheet->getStyle('A' . $row . ':S' . $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');
				$sheet->getStyle('A' . $row . ':S' . $row)->getFont()->setBold(true);

				$qty_jan = 0;
                $qty_feb = 0;
                $qty_mar = 0;
                $qty_apr = 0;
                $qty_mei = 0;
                $qty_jun = 0;
                $qty_jul = 0;
                $qty_agu = 0;
                $qty_sep = 0;
                $qty_okt = 0;
                $qty_nop = 0;
                $qty_des = 0;
                $qty_year = 0;
                $qty_avg = 0;

				$row++;
            }

			if ($principal != $rows['principal'] and $principal != '' )
            {
				
				$sheet->setCellValue('A' . $row, '');
				$sheet->setCellValue('B' . $row, $principal);
				$sheet->setCellValue('C' . $row, '');
				$sheet->setCellValue('D' . $row, '');
				$sheet->setCellValue('E' . $row, 'TOTAL ' . $principal);
				$sheet->setCellValue('F' . $row, '');
				$sheet->setCellValue('G' . $row, number_format($sub_qty_jan, 0));
				$sheet->setCellValue('H' . $row, number_format($sub_qty_feb, 0));
				$sheet->setCellValue('I' . $row, number_format($sub_qty_mar, 0));
				$sheet->setCellValue('J' . $row, number_format($sub_qty_apr, 0));
				$sheet->setCellValue('K' . $row, number_format($sub_qty_mei, 0));
				$sheet->setCellValue('L' . $row, number_format($sub_qty_jun, 0));
				$sheet->setCellValue('M' . $row, number_format($sub_qty_jul, 0));
				$sheet->setCellValue('N' . $row, number_format($sub_qty_agu, 0));
				$sheet->setCellValue('O' . $row, number_format($sub_qty_sep, 0));
				$sheet->setCellValue('P' . $row, number_format($sub_qty_okt, 0));
				$sheet->setCellValue('Q' . $row, number_format($sub_qty_nop, 0));
				$sheet->setCellValue('R' . $row, number_format($sub_qty_des, 0));
				$sheet->setCellValue('S' . $row, number_format($sub_qty_year, 0));

				// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
				$sheet->getStyle('A' . $row)->applyFromArray($style_row);
				$sheet->getStyle('B' . $row)->applyFromArray($style_row);
				$sheet->getStyle('C' . $row)->applyFromArray($style_row);
				$sheet->getStyle('D' . $row)->applyFromArray($style_row);
				$sheet->getStyle('E' . $row)->applyFromArray($style_row);
				$sheet->getStyle('F' . $row)->applyFromArray($style_row);
				$sheet->getStyle('G' . $row)->applyFromArray($style_row);
				$sheet->getStyle('H' . $row)->applyFromArray($style_row);
				$sheet->getStyle('I' . $row)->applyFromArray($style_row);
				$sheet->getStyle('J' . $row)->applyFromArray($style_row);
				$sheet->getStyle('K' . $row)->applyFromArray($style_row);
				$sheet->getStyle('L' . $row)->applyFromArray($style_row);
				$sheet->getStyle('M' . $row)->applyFromArray($style_row);
				$sheet->getStyle('N' . $row)->applyFromArray($style_row);
				$sheet->getStyle('O' . $row)->applyFromArray($style_row);
				$sheet->getStyle('P' . $row)->applyFromArray($style_row);
				$sheet->getStyle('Q' . $row)->applyFromArray($style_row);
				$sheet->getStyle('R' . $row)->applyFromArray($style_row);
				$sheet->getStyle('S' . $row)->applyFromArray($style_row);

				$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
				$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
				$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
				$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
				$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
				$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
				$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('I' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('J' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('K' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('L' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('M' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('N' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('O' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('P' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('Q' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('R' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('S' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

				$sheet->getStyle('A' . $row . ':S' . $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFA07A');
				$sheet->getStyle('A' . $row . ':S' . $row)->getFont()->setBold(true);

				$sub_qty_jan = 0;
				$sub_qty_feb = 0;
				$sub_qty_mar = 0;
				$sub_qty_apr = 0;
				$sub_qty_mei = 0;
				$sub_qty_jun = 0;
				$sub_qty_jul = 0;
				$sub_qty_agu = 0;
				$sub_qty_sep = 0;
				$sub_qty_okt = 0;
				$sub_qty_nop = 0;
				$sub_qty_des = 0;
				$sub_qty_year = 0;
				$sub_qty_avg = 0;

				$row++;
            }

			$sheet->setCellValue('A' . $row, $no);
    		$sheet->setCellValue('B' . $row, $rows['principal']);
			$sheet->setCellValue('C' . $row, $rows['item_group']);
			$sheet->setCellValue('D' . $row, $rows['item_code']);
			$sheet->setCellValue('E' . $row, $rows['item_name']);
			$sheet->setCellValue('F' . $row, $rows['unit']);
			$sheet->setCellValue('G' . $row, number_format($rows['qty_jan'], 0));			
			$sheet->setCellValue('H' . $row, number_format($rows['qty_feb'], 0));			
			$sheet->setCellValue('I' . $row, number_format($rows['qty_mar'], 0));			
			$sheet->setCellValue('J' . $row, number_format($rows['qty_apr'], 0));			
			$sheet->setCellValue('K' . $row, number_format($rows['qty_mei'], 0));			
			$sheet->setCellValue('L' . $row, number_format($rows['qty_jun'], 0));			
			$sheet->setCellValue('M' . $row, number_format($rows['qty_jul'], 0));			
			$sheet->setCellValue('N' . $row, number_format($rows['qty_agu'], 0));			
			$sheet->setCellValue('O' . $row, number_format($rows['qty_sep'], 0));			
			$sheet->setCellValue('P' . $row, number_format($rows['qty_okt'], 0));			
			$sheet->setCellValue('Q' . $row, number_format($rows['qty_nop'], 0));			
			$sheet->setCellValue('R' . $row, number_format($rows['qty_des'], 0));			
			$sheet->setCellValue('S' . $row, number_format($rows['qty_total'], 0));

			// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
			$sheet->getStyle('A' . $row)->applyFromArray($style_row);
			$sheet->getStyle('B' . $row)->applyFromArray($style_row);
			$sheet->getStyle('C' . $row)->applyFromArray($style_row);
			$sheet->getStyle('D' . $row)->applyFromArray($style_row);
			$sheet->getStyle('E' . $row)->applyFromArray($style_row);
			$sheet->getStyle('F' . $row)->applyFromArray($style_row);
			$sheet->getStyle('G' . $row)->applyFromArray($style_row);
			$sheet->getStyle('H' . $row)->applyFromArray($style_row);
			$sheet->getStyle('I' . $row)->applyFromArray($style_row);
			$sheet->getStyle('J' . $row)->applyFromArray($style_row);
			$sheet->getStyle('K' . $row)->applyFromArray($style_row);
			$sheet->getStyle('L' . $row)->applyFromArray($style_row);
			$sheet->getStyle('M' . $row)->applyFromArray($style_row);
			$sheet->getStyle('N' . $row)->applyFromArray($style_row);
			$sheet->getStyle('O' . $row)->applyFromArray($style_row);
			$sheet->getStyle('P' . $row)->applyFromArray($style_row);
			$sheet->getStyle('Q' . $row)->applyFromArray($style_row);
			$sheet->getStyle('R' . $row)->applyFromArray($style_row);
			$sheet->getStyle('S' . $row)->applyFromArray($style_row);

			$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('I' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('J' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('K' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('L' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('M' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('N' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('O' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('P' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('Q' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('R' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('S' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

			$item_group = $rows['item_group'];
			$principal = $rows['principal'];

			$qty_jan += $rows['qty_jan'];
            $qty_feb += $rows['qty_feb'];
            $qty_mar += $rows['qty_mar'];
            $qty_apr += $rows['qty_apr'];
            $qty_mei += $rows['qty_mei'];
            $qty_jun += $rows['qty_jun'];
            $qty_jul += $rows['qty_jul'];
            $qty_agu += $rows['qty_agu'];
            $qty_sep += $rows['qty_sep'];
            $qty_okt += $rows['qty_okt'];
            $qty_nop += $rows['qty_nop'];
            $qty_des += $rows['qty_des'];
            $qty_year += $rows['qty_total'];

            $sub_qty_jan += $rows['qty_jan'];
            $sub_qty_feb += $rows['qty_feb'];
            $sub_qty_mar += $rows['qty_mar'];
            $sub_qty_apr += $rows['qty_apr'];
            $sub_qty_mei += $rows['qty_mei'];
            $sub_qty_jun += $rows['qty_jun'];
            $sub_qty_jul += $rows['qty_jul'];
            $sub_qty_agu += $rows['qty_agu'];
            $sub_qty_sep += $rows['qty_sep'];
            $sub_qty_okt += $rows['qty_okt'];
            $sub_qty_nop += $rows['qty_nop'];
            $sub_qty_des += $rows['qty_des'];
            $sub_qty_year += $rows['qty_total'];

            $total_qty_jan += $rows['qty_jan'];
            $total_qty_feb += $rows['qty_feb'];
            $total_qty_mar += $rows['qty_mar'];
            $total_qty_apr += $rows['qty_apr'];
            $total_qty_mei += $rows['qty_mei'];
            $total_qty_jun += $rows['qty_jun'];
            $total_qty_jul += $rows['qty_jul'];
            $total_qty_agu += $rows['qty_agu'];
            $total_qty_sep += $rows['qty_sep'];
            $total_qty_okt += $rows['qty_okt'];
            $total_qty_nop += $rows['qty_nop'];
            $total_qty_des += $rows['qty_des'];
            $total_qty_year += $rows['qty_total'];

			$no++; // Tambah 1 setiap kali looping
    		$row++; // Tambah 1 setiap kali looping
		endforeach;

		//item_group end
		//$row = $row + 1;
		$sheet->setCellValue('A' . $row, '');
		$sheet->setCellValue('B' . $row, $principal);
		$sheet->setCellValue('C' . $row, $item_group);
		$sheet->setCellValue('D' . $row, '');
		$sheet->setCellValue('E' . $row, 'Sub Total ' . $item_group);
		$sheet->setCellValue('F' . $row, '');
		$sheet->setCellValue('G' . $row, number_format($qty_jan, 0));
		$sheet->setCellValue('H' . $row, number_format($qty_feb, 0));
		$sheet->setCellValue('I' . $row, number_format($qty_mar, 0));
		$sheet->setCellValue('J' . $row, number_format($qty_apr, 0));
		$sheet->setCellValue('K' . $row, number_format($qty_mei, 0));
		$sheet->setCellValue('L' . $row, number_format($qty_jun, 0));
		$sheet->setCellValue('M' . $row, number_format($qty_jul, 0));
		$sheet->setCellValue('N' . $row, number_format($qty_agu, 0));
		$sheet->setCellValue('O' . $row, number_format($qty_sep, 0));
		$sheet->setCellValue('P' . $row, number_format($qty_okt, 0));
		$sheet->setCellValue('Q' . $row, number_format($qty_nop, 0));
		$sheet->setCellValue('R' . $row, number_format($qty_des, 0));
		$sheet->setCellValue('S' . $row, number_format($qty_year, 0));

		// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
		$sheet->getStyle('A' . $row)->applyFromArray($style_row);
		$sheet->getStyle('B' . $row)->applyFromArray($style_row);
		$sheet->getStyle('C' . $row)->applyFromArray($style_row);
		$sheet->getStyle('D' . $row)->applyFromArray($style_row);
		$sheet->getStyle('E' . $row)->applyFromArray($style_row);
		$sheet->getStyle('F' . $row)->applyFromArray($style_row);
		$sheet->getStyle('G' . $row)->applyFromArray($style_row);
		$sheet->getStyle('H' . $row)->applyFromArray($style_row);
		$sheet->getStyle('I' . $row)->applyFromArray($style_row);
		$sheet->getStyle('J' . $row)->applyFromArray($style_row);
		$sheet->getStyle('K' . $row)->applyFromArray($style_row);
		$sheet->getStyle('L' . $row)->applyFromArray($style_row);
		$sheet->getStyle('M' . $row)->applyFromArray($style_row);
		$sheet->getStyle('N' . $row)->applyFromArray($style_row);
		$sheet->getStyle('O' . $row)->applyFromArray($style_row);
		$sheet->getStyle('P' . $row)->applyFromArray($style_row);
		$sheet->getStyle('Q' . $row)->applyFromArray($style_row);
		$sheet->getStyle('R' . $row)->applyFromArray($style_row);
		$sheet->getStyle('S' . $row)->applyFromArray($style_row);

		$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('I' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('J' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('K' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('L' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('M' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('N' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('O' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('P' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('Q' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('R' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('S' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

		$sheet->getStyle('A' . $row . ':S' . $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');
		$sheet->getStyle('A' . $row . ':S' . $row)->getFont()->setBold(true);

		//principal end
		$row = $row + 1;
		$sheet->setCellValue('A' . $row, '');
		$sheet->setCellValue('B' . $row, $principal);
		$sheet->setCellValue('C' . $row, '');
		$sheet->setCellValue('D' . $row, '');
		$sheet->setCellValue('E' . $row, 'TOTAL ' . $principal);
		$sheet->setCellValue('F' . $row, '');
		$sheet->setCellValue('G' . $row, number_format($sub_qty_jan, 0));
		$sheet->setCellValue('H' . $row, number_format($sub_qty_feb, 0));
		$sheet->setCellValue('I' . $row, number_format($sub_qty_mar, 0));
		$sheet->setCellValue('J' . $row, number_format($sub_qty_apr, 0));
		$sheet->setCellValue('K' . $row, number_format($sub_qty_mei, 0));
		$sheet->setCellValue('L' . $row, number_format($sub_qty_jun, 0));
		$sheet->setCellValue('M' . $row, number_format($sub_qty_jul, 0));
		$sheet->setCellValue('N' . $row, number_format($sub_qty_agu, 0));
		$sheet->setCellValue('O' . $row, number_format($sub_qty_sep, 0));
		$sheet->setCellValue('P' . $row, number_format($sub_qty_okt, 0));
		$sheet->setCellValue('Q' . $row, number_format($sub_qty_nop, 0));
		$sheet->setCellValue('R' . $row, number_format($sub_qty_des, 0));
		$sheet->setCellValue('S' . $row, number_format($sub_qty_year, 0));

		// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
		$sheet->getStyle('A' . $row)->applyFromArray($style_row);
		$sheet->getStyle('B' . $row)->applyFromArray($style_row);
		$sheet->getStyle('C' . $row)->applyFromArray($style_row);
		$sheet->getStyle('D' . $row)->applyFromArray($style_row);
		$sheet->getStyle('E' . $row)->applyFromArray($style_row);
		$sheet->getStyle('F' . $row)->applyFromArray($style_row);
		$sheet->getStyle('G' . $row)->applyFromArray($style_row);
		$sheet->getStyle('H' . $row)->applyFromArray($style_row);
		$sheet->getStyle('I' . $row)->applyFromArray($style_row);
		$sheet->getStyle('J' . $row)->applyFromArray($style_row);
		$sheet->getStyle('K' . $row)->applyFromArray($style_row);
		$sheet->getStyle('L' . $row)->applyFromArray($style_row);
		$sheet->getStyle('M' . $row)->applyFromArray($style_row);
		$sheet->getStyle('N' . $row)->applyFromArray($style_row);
		$sheet->getStyle('O' . $row)->applyFromArray($style_row);
		$sheet->getStyle('P' . $row)->applyFromArray($style_row);
		$sheet->getStyle('Q' . $row)->applyFromArray($style_row);
		$sheet->getStyle('R' . $row)->applyFromArray($style_row);
		$sheet->getStyle('S' . $row)->applyFromArray($style_row);

		$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('I' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('J' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('K' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('L' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('M' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('N' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('O' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('P' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('Q' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('R' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('S' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

		$sheet->getStyle('A' . $row . ':S' . $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFA07A');
		$sheet->getStyle('A' . $row . ':S' . $row)->getFont()->setBold(true);

		//grand total
		$row = $row + 1;
		$sheet->setCellValue('A' . $row, '');
		$sheet->setCellValue('B' . $row, '');
		$sheet->setCellValue('C' . $row, '');
		$sheet->setCellValue('D' . $row, '');
		$sheet->setCellValue('E' . $row, 'GRAND TOTAL');
		$sheet->setCellValue('F' . $row, '');
		$sheet->setCellValue('G' . $row, number_format($total_qty_jan, 0));
		$sheet->setCellValue('H' . $row, number_format($total_qty_feb, 0));
		$sheet->setCellValue('I' . $row, number_format($total_qty_mar, 0));
		$sheet->setCellValue('J' . $row, number_format($total_qty_apr, 0));
		$sheet->setCellValue('K' . $row, number_format($total_qty_mei, 0));
		$sheet->setCellValue('L' . $row, number_format($total_qty_jun, 0));
		$sheet->setCellValue('M' . $row, number_format($total_qty_jul, 0));
		$sheet->setCellValue('N' . $row, number_format($total_qty_agu, 0));
		$sheet->setCellValue('O' . $row, number_format($total_qty_sep, 0));
		$sheet->setCellValue('P' . $row, number_format($total_qty_okt, 0));
		$sheet->setCellValue('Q' . $row, number_format($total_qty_nop, 0));
		$sheet->setCellValue('R' . $row, number_format($total_qty_des, 0));
		$sheet->setCellValue('S' . $row, number_format($total_qty_year, 0));

		// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
		$sheet->getStyle('A' . $row)->applyFromArray($style_row);
		$sheet->getStyle('B' . $row)->applyFromArray($style_row);
		$sheet->getStyle('C' . $row)->applyFromArray($style_row);
		$sheet->getStyle('D' . $row)->applyFromArray($style_row);
		$sheet->getStyle('E' . $row)->applyFromArray($style_row);
		$sheet->getStyle('F' . $row)->applyFromArray($style_row);
		$sheet->getStyle('G' . $row)->applyFromArray($style_row);
		$sheet->getStyle('H' . $row)->applyFromArray($style_row);
		$sheet->getStyle('I' . $row)->applyFromArray($style_row);
		$sheet->getStyle('J' . $row)->applyFromArray($style_row);
		$sheet->getStyle('K' . $row)->applyFromArray($style_row);
		$sheet->getStyle('L' . $row)->applyFromArray($style_row);
		$sheet->getStyle('M' . $row)->applyFromArray($style_row);
		$sheet->getStyle('N' . $row)->applyFromArray($style_row);
		$sheet->getStyle('O' . $row)->applyFromArray($style_row);
		$sheet->getStyle('P' . $row)->applyFromArray($style_row);
		$sheet->getStyle('Q' . $row)->applyFromArray($style_row);
		$sheet->getStyle('R' . $row)->applyFromArray($style_row);
		$sheet->getStyle('S' . $row)->applyFromArray($style_row);

		$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('I' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('J' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('K' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('L' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('M' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('N' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('O' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('P' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('Q' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('R' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('S' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

		$sheet->getStyle('A' . $row . ':S' . $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFA07A');
		$sheet->getStyle('A' . $row . ':S' . $row)->getFont()->setBold(true);


		//set columns width
		$sheet->getColumnDimension('A')->setWidth(5); 
		$sheet->getColumnDimension('B')->setWidth(11); 
		$sheet->getColumnDimension('C')->setWidth(22);
		$sheet->getColumnDimension('D')->setWidth(12);
		$sheet->getColumnDimension('E')->setWidth(53);
		$sheet->getColumnDimension('F')->setWidth(6);
		$sheet->getColumnDimension('G')->setWidth(10);
		$sheet->getColumnDimension('H')->setWidth(10);
		$sheet->getColumnDimension('I')->setWidth(10);
		$sheet->getColumnDimension('J')->setWidth(10);
		$sheet->getColumnDimension('K')->setWidth(10);
		$sheet->getColumnDimension('L')->setWidth(10);
		$sheet->getColumnDimension('M')->setWidth(10);
		$sheet->getColumnDimension('N')->setWidth(10);
		$sheet->getColumnDimension('O')->setWidth(10);
		$sheet->getColumnDimension('P')->setWidth(10);
		$sheet->getColumnDimension('Q')->setWidth(10);
		$sheet->getColumnDimension('R')->setWidth(10);
		$sheet->getColumnDimension('S')->setWidth(10);
		

		// Set orientasi kertas jadi LANDSCAPE
		$sheet->getPageSetup()->setOrientation(\PhpOffice\PhpSpreadsheet\Worksheet\PageSetup::ORIENTATION_LANDSCAPE);
		// Set judul file excel nya
		$sheet->setTitle("Report Selling In - Quantity");
		// Proses file excel
		header('Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet');
		header('Content-Disposition: attachment; filename="Report Selling In - Quantity ("'. $year . '").xlsx"'); // Set nama file excel nya
		header('Cache-Control: max-age=0');

		$writer = new Xlsx($spreadsheet);
		$writer->save('php://output');

	}

	public function export_sellingin_val()
	{
		$spreadsheet = new Spreadsheet();
		$sheet = $spreadsheet->getActiveSheet();
		// Buat sebuah variabel untuk menampung pengaturan style dari header tabel
		$style_col = [
			'font' => ['bold' => true], // Set font nya jadi bold
			'alignment' => [
				'horizontal' => \PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER, // Set text jadi ditengah secara horizontal (center)
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'top' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border top dengan garis tipis
				'right' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN],  // Set border right dengan garis tipis
				'bottom' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border bottom dengan garis tipis
				'left' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN] // Set border left dengan garis tipis
			]
		];
		// Buat sebuah variabel untuk menampung pengaturan style dari isi tabel
		$style_row = [
			'alignment' => [
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'top' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border top dengan garis tipis
				'right' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN],  // Set border right dengan garis tipis
				'bottom' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border bottom dengan garis tipis
				'left' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN] // Set border left dengan garis tipis
			]
		];


		if (isset($_POST['by_island']))
		{
			$island = $_POST['by_island'];
		}
		else
		{
			$island = "";
		}

		if (isset($_POST['by_region']))
		{
			$region = $_POST['by_region'];
		}
		else
		{
			$region = "";
		}

		if (isset($_POST['by_area']))
		{
			$area = implode(',', $_POST['by_area']);
		}
		else
		{
			$area = "";
		}

		if (isset($_POST['by_year']))
		{
			$year = $_POST['by_year'];
		}
		else
		{
			$year = date('Y');
		}


		$sheet->setCellValue('A1', "Report Selling In - Value (" . $year . ")"); // Set kolom A1 dengan tulisan 
		$sheet->setCellValue('A2', "Island : " . $island);
		$sheet->setCellValue('A3', "Region : " . $region); 
		$sheet->setCellValue('A4', "Area : " . $area); 
		//$sheet->mergeCells('A1:F1'); // Set Merge Cell pada kolom A1 sampai F1
		$sheet->getStyle('A1')->getFont()->setBold(true); // Set bold kolom A1
		$sheet->getStyle('A2')->getFont()->setBold(true);
		$sheet->getStyle('A3')->getFont()->setBold(true);
		$sheet->getStyle('A4')->getFont()->setBold(true);
		$sheet->getStyle('A1')->getFont()->setSize(20); // Set font size 15 untuk kolom A1
		// Buat header tabel nya pada baris ke 6
		$sheet->setCellValue('A6', "#"); // Set kolom A6 dengan tulisan "#"
		$sheet->setCellValue('B6', "Principal");
		$sheet->setCellValue('C6', "Group SKU"); 
		$sheet->setCellValue('D6', "Kode Item"); 
		$sheet->setCellValue('E6', "SKU");
		$sheet->setCellValue('F6', "Unit");
		$sheet->setCellValue('G6', "January");
		$sheet->setCellValue('H6', "February");
		$sheet->setCellValue('I6', "March");
		$sheet->setCellValue('J6', "April");
		$sheet->setCellValue('K6', "May");
		$sheet->setCellValue('L6', "June");
		$sheet->setCellValue('M6', "July");
		$sheet->setCellValue('N6', "August");
		$sheet->setCellValue('O6', "September");
		$sheet->setCellValue('P6', "October");
		$sheet->setCellValue('Q6', "November");
		$sheet->setCellValue('R6', "December");
		$sheet->setCellValue('S6', "Total");
		
		

		// Apply style header yang telah kita buat tadi ke masing-masing kolom header
		$sheet->getStyle('A6')->applyFromArray($style_col);
		$sheet->getStyle('B6')->applyFromArray($style_col);
		$sheet->getStyle('C6')->applyFromArray($style_col);
		$sheet->getStyle('D6')->applyFromArray($style_col);
		$sheet->getStyle('E6')->applyFromArray($style_col);
		$sheet->getStyle('F6')->applyFromArray($style_col);
		$sheet->getStyle('G6')->applyFromArray($style_col);
		$sheet->getStyle('H6')->applyFromArray($style_col);
		$sheet->getStyle('I6')->applyFromArray($style_col);
		$sheet->getStyle('J6')->applyFromArray($style_col);
		$sheet->getStyle('K6')->applyFromArray($style_col);
		$sheet->getStyle('L6')->applyFromArray($style_col);
		$sheet->getStyle('M6')->applyFromArray($style_col);
		$sheet->getStyle('N6')->applyFromArray($style_col);
		$sheet->getStyle('O6')->applyFromArray($style_col);
		$sheet->getStyle('P6')->applyFromArray($style_col);
		$sheet->getStyle('Q6')->applyFromArray($style_col);
		$sheet->getStyle('R6')->applyFromArray($style_col);
		$sheet->getStyle('S6')->applyFromArray($style_col);

		$sheet->getStyle('A6:R6')->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');
		$sheet->getStyle('S6')->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFA07A');

		// Set height baris ke 1 dan 2
		$sheet->getRowDimension('1')->setRowHeight(40);
		$sheet->getRowDimension('2')->setRowHeight(20);
		$sheet->getRowDimension('3')->setRowHeight(20);
		$sheet->getRowDimension('4')->setRowHeight(20);


		$item_group = '';
        $principal = '';
        $qty_jan = 0;
        $qty_feb = 0;
        $qty_mar = 0;
        $qty_apr = 0;
        $qty_mei = 0;
        $qty_jun = 0;
        $qty_jul = 0;
        $qty_agu = 0;
        $qty_sep = 0;
        $qty_okt = 0;
        $qty_nop = 0;
        $qty_des = 0;
        $qty_year = 0;
        $qty_avg = 0;

        $sub_qty_jan = 0;
        $sub_qty_feb = 0;
        $sub_qty_mar = 0;
        $sub_qty_apr = 0;
        $sub_qty_mei = 0;
        $sub_qty_jun = 0;
        $sub_qty_jul = 0;
        $sub_qty_agu = 0;
        $sub_qty_sep = 0;
        $sub_qty_okt = 0;
        $sub_qty_nop = 0;
        $sub_qty_des = 0;
        $sub_qty_year = 0;
        $sub_qty_avg = 0;

        $total_qty_jan = 0;
        $total_qty_feb = 0;
        $total_qty_mar = 0;
        $total_qty_apr = 0;
        $total_qty_mei = 0;
        $total_qty_jun = 0;
        $total_qty_jul = 0;
        $total_qty_agu = 0;
        $total_qty_sep = 0;
        $total_qty_okt = 0;
        $total_qty_nop = 0;
        $total_qty_des = 0;
        $total_qty_year = 0;
        $total_qty_avg = 0;


		$no = 1; // Untuk penomoran tabel, di awal set dengan 1
		$row = 7;

		$data1 = array(
			'island' => $island,
			'region' => $region,
			'area' => $area,
			'year' => $year
		);

		//$data['sellingin_Dist'] = $this->model('ReportModel')->getSellingIn_Dist2($data1);
		$data['sellingin_qty'] = $this->model('ReportModel')->getSellingIn_Year_pivot();
		//$data['sellingin_OT'] = $this->model('ReportModel')->getSellingIn_OT2();

		foreach ($data['sellingin_qty'] as $rows) :

			if ($item_group != $rows['item_group'] and $item_group != '' )
            {
				
				$sheet->setCellValue('A' . $row, '');
				$sheet->setCellValue('B' . $row, $principal);
				$sheet->setCellValue('C' . $row, $item_group);
				$sheet->setCellValue('D' . $row, '');
				$sheet->setCellValue('E' . $row, 'Sub Total ' . $item_group);
				$sheet->setCellValue('F' . $row, '');
				$sheet->setCellValue('G' . $row, number_format($qty_jan, 0));
				$sheet->setCellValue('H' . $row, number_format($qty_feb, 0));
				$sheet->setCellValue('I' . $row, number_format($qty_mar, 0));
				$sheet->setCellValue('J' . $row, number_format($qty_apr, 0));
				$sheet->setCellValue('K' . $row, number_format($qty_mei, 0));
				$sheet->setCellValue('L' . $row, number_format($qty_jun, 0));
				$sheet->setCellValue('M' . $row, number_format($qty_jul, 0));
				$sheet->setCellValue('N' . $row, number_format($qty_agu, 0));
				$sheet->setCellValue('O' . $row, number_format($qty_sep, 0));
				$sheet->setCellValue('P' . $row, number_format($qty_okt, 0));
				$sheet->setCellValue('Q' . $row, number_format($qty_nop, 0));
				$sheet->setCellValue('R' . $row, number_format($qty_des, 0));
				$sheet->setCellValue('S' . $row, number_format($qty_year, 0));

				// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
				$sheet->getStyle('A' . $row)->applyFromArray($style_row);
				$sheet->getStyle('B' . $row)->applyFromArray($style_row);
				$sheet->getStyle('C' . $row)->applyFromArray($style_row);
				$sheet->getStyle('D' . $row)->applyFromArray($style_row);
				$sheet->getStyle('E' . $row)->applyFromArray($style_row);
				$sheet->getStyle('F' . $row)->applyFromArray($style_row);
				$sheet->getStyle('G' . $row)->applyFromArray($style_row);
				$sheet->getStyle('H' . $row)->applyFromArray($style_row);
				$sheet->getStyle('I' . $row)->applyFromArray($style_row);
				$sheet->getStyle('J' . $row)->applyFromArray($style_row);
				$sheet->getStyle('K' . $row)->applyFromArray($style_row);
				$sheet->getStyle('L' . $row)->applyFromArray($style_row);
				$sheet->getStyle('M' . $row)->applyFromArray($style_row);
				$sheet->getStyle('N' . $row)->applyFromArray($style_row);
				$sheet->getStyle('O' . $row)->applyFromArray($style_row);
				$sheet->getStyle('P' . $row)->applyFromArray($style_row);
				$sheet->getStyle('Q' . $row)->applyFromArray($style_row);
				$sheet->getStyle('R' . $row)->applyFromArray($style_row);
				$sheet->getStyle('S' . $row)->applyFromArray($style_row);

				$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
				$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
				$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
				$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
				$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
				$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
				$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('I' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('J' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('K' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('L' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('M' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('N' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('O' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('P' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('Q' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('R' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('S' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

				$sheet->getStyle('A' . $row . ':S' . $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');
				$sheet->getStyle('A' . $row . ':S' . $row)->getFont()->setBold(true);

				$qty_jan = 0;
                $qty_feb = 0;
                $qty_mar = 0;
                $qty_apr = 0;
                $qty_mei = 0;
                $qty_jun = 0;
                $qty_jul = 0;
                $qty_agu = 0;
                $qty_sep = 0;
                $qty_okt = 0;
                $qty_nop = 0;
                $qty_des = 0;
                $qty_year = 0;
                $qty_avg = 0;

				$row++;
            }

			if ($principal != $rows['principal'] and $principal != '' )
            {
				
				$sheet->setCellValue('A' . $row, '');
				$sheet->setCellValue('B' . $row, $principal);
				$sheet->setCellValue('C' . $row, '');
				$sheet->setCellValue('D' . $row, '');
				$sheet->setCellValue('E' . $row, 'TOTAL ' . $principal);
				$sheet->setCellValue('F' . $row, '');
				$sheet->setCellValue('G' . $row, number_format($sub_qty_jan, 0));
				$sheet->setCellValue('H' . $row, number_format($sub_qty_feb, 0));
				$sheet->setCellValue('I' . $row, number_format($sub_qty_mar, 0));
				$sheet->setCellValue('J' . $row, number_format($sub_qty_apr, 0));
				$sheet->setCellValue('K' . $row, number_format($sub_qty_mei, 0));
				$sheet->setCellValue('L' . $row, number_format($sub_qty_jun, 0));
				$sheet->setCellValue('M' . $row, number_format($sub_qty_jul, 0));
				$sheet->setCellValue('N' . $row, number_format($sub_qty_agu, 0));
				$sheet->setCellValue('O' . $row, number_format($sub_qty_sep, 0));
				$sheet->setCellValue('P' . $row, number_format($sub_qty_okt, 0));
				$sheet->setCellValue('Q' . $row, number_format($sub_qty_nop, 0));
				$sheet->setCellValue('R' . $row, number_format($sub_qty_des, 0));
				$sheet->setCellValue('S' . $row, number_format($sub_qty_year, 0));

				// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
				$sheet->getStyle('A' . $row)->applyFromArray($style_row);
				$sheet->getStyle('B' . $row)->applyFromArray($style_row);
				$sheet->getStyle('C' . $row)->applyFromArray($style_row);
				$sheet->getStyle('D' . $row)->applyFromArray($style_row);
				$sheet->getStyle('E' . $row)->applyFromArray($style_row);
				$sheet->getStyle('F' . $row)->applyFromArray($style_row);
				$sheet->getStyle('G' . $row)->applyFromArray($style_row);
				$sheet->getStyle('H' . $row)->applyFromArray($style_row);
				$sheet->getStyle('I' . $row)->applyFromArray($style_row);
				$sheet->getStyle('J' . $row)->applyFromArray($style_row);
				$sheet->getStyle('K' . $row)->applyFromArray($style_row);
				$sheet->getStyle('L' . $row)->applyFromArray($style_row);
				$sheet->getStyle('M' . $row)->applyFromArray($style_row);
				$sheet->getStyle('N' . $row)->applyFromArray($style_row);
				$sheet->getStyle('O' . $row)->applyFromArray($style_row);
				$sheet->getStyle('P' . $row)->applyFromArray($style_row);
				$sheet->getStyle('Q' . $row)->applyFromArray($style_row);
				$sheet->getStyle('R' . $row)->applyFromArray($style_row);
				$sheet->getStyle('S' . $row)->applyFromArray($style_row);

				$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
				$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
				$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
				$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
				$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
				$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
				$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('I' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('J' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('K' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('L' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('M' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('N' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('O' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('P' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('Q' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('R' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('S' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

				$sheet->getStyle('A' . $row . ':S' . $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFA07A');
				$sheet->getStyle('A' . $row . ':S' . $row)->getFont()->setBold(true);

				$sub_qty_jan = 0;
				$sub_qty_feb = 0;
				$sub_qty_mar = 0;
				$sub_qty_apr = 0;
				$sub_qty_mei = 0;
				$sub_qty_jun = 0;
				$sub_qty_jul = 0;
				$sub_qty_agu = 0;
				$sub_qty_sep = 0;
				$sub_qty_okt = 0;
				$sub_qty_nop = 0;
				$sub_qty_des = 0;
				$sub_qty_year = 0;
				$sub_qty_avg = 0;

				$row++;
            }

			$sheet->setCellValue('A' . $row, $no);
    		$sheet->setCellValue('B' . $row, $rows['principal']);
			$sheet->setCellValue('C' . $row, $rows['item_group']);
			$sheet->setCellValue('D' . $row, $rows['item_code']);
			$sheet->setCellValue('E' . $row, $rows['item_name']);
			$sheet->setCellValue('F' . $row, $rows['unit']);
			$sheet->setCellValue('G' . $row, number_format($rows['value_jan'], 0));			
			$sheet->setCellValue('H' . $row, number_format($rows['value_feb'], 0));			
			$sheet->setCellValue('I' . $row, number_format($rows['value_mar'], 0));			
			$sheet->setCellValue('J' . $row, number_format($rows['value_apr'], 0));			
			$sheet->setCellValue('K' . $row, number_format($rows['value_mei'], 0));			
			$sheet->setCellValue('L' . $row, number_format($rows['value_jun'], 0));			
			$sheet->setCellValue('M' . $row, number_format($rows['value_jul'], 0));			
			$sheet->setCellValue('N' . $row, number_format($rows['value_agu'], 0));			
			$sheet->setCellValue('O' . $row, number_format($rows['value_sep'], 0));			
			$sheet->setCellValue('P' . $row, number_format($rows['value_okt'], 0));			
			$sheet->setCellValue('Q' . $row, number_format($rows['value_nop'], 0));			
			$sheet->setCellValue('R' . $row, number_format($rows['value_des'], 0));			
			$sheet->setCellValue('S' . $row, number_format($rows['value_total'], 0));

			// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
			$sheet->getStyle('A' . $row)->applyFromArray($style_row);
			$sheet->getStyle('B' . $row)->applyFromArray($style_row);
			$sheet->getStyle('C' . $row)->applyFromArray($style_row);
			$sheet->getStyle('D' . $row)->applyFromArray($style_row);
			$sheet->getStyle('E' . $row)->applyFromArray($style_row);
			$sheet->getStyle('F' . $row)->applyFromArray($style_row);
			$sheet->getStyle('G' . $row)->applyFromArray($style_row);
			$sheet->getStyle('H' . $row)->applyFromArray($style_row);
			$sheet->getStyle('I' . $row)->applyFromArray($style_row);
			$sheet->getStyle('J' . $row)->applyFromArray($style_row);
			$sheet->getStyle('K' . $row)->applyFromArray($style_row);
			$sheet->getStyle('L' . $row)->applyFromArray($style_row);
			$sheet->getStyle('M' . $row)->applyFromArray($style_row);
			$sheet->getStyle('N' . $row)->applyFromArray($style_row);
			$sheet->getStyle('O' . $row)->applyFromArray($style_row);
			$sheet->getStyle('P' . $row)->applyFromArray($style_row);
			$sheet->getStyle('Q' . $row)->applyFromArray($style_row);
			$sheet->getStyle('R' . $row)->applyFromArray($style_row);
			$sheet->getStyle('S' . $row)->applyFromArray($style_row);

			$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('I' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('J' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('K' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('L' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('M' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('N' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('O' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('P' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('Q' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('R' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('S' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

			$item_group = $rows['item_group'];
			$principal = $rows['principal'];

			$qty_jan += $rows['value_jan'];
            $qty_feb += $rows['value_feb'];
            $qty_mar += $rows['value_mar'];
            $qty_apr += $rows['value_apr'];
            $qty_mei += $rows['value_mei'];
            $qty_jun += $rows['value_jun'];
            $qty_jul += $rows['value_jul'];
            $qty_agu += $rows['value_agu'];
            $qty_sep += $rows['value_sep'];
            $qty_okt += $rows['value_okt'];
            $qty_nop += $rows['value_nop'];
            $qty_des += $rows['value_des'];
            $qty_year += $rows['value_total'];

            $sub_qty_jan += $rows['value_jan'];
            $sub_qty_feb += $rows['value_feb'];
            $sub_qty_mar += $rows['value_mar'];
            $sub_qty_apr += $rows['value_apr'];
            $sub_qty_mei += $rows['value_mei'];
            $sub_qty_jun += $rows['value_jun'];
            $sub_qty_jul += $rows['value_jul'];
            $sub_qty_agu += $rows['value_agu'];
            $sub_qty_sep += $rows['value_sep'];
            $sub_qty_okt += $rows['value_okt'];
            $sub_qty_nop += $rows['value_nop'];
            $sub_qty_des += $rows['value_des'];
            $sub_qty_year += $rows['value_total'];

            $total_qty_jan += $rows['value_jan'];
            $total_qty_feb += $rows['value_feb'];
            $total_qty_mar += $rows['value_mar'];
            $total_qty_apr += $rows['value_apr'];
            $total_qty_mei += $rows['value_mei'];
            $total_qty_jun += $rows['value_jun'];
            $total_qty_jul += $rows['value_jul'];
            $total_qty_agu += $rows['value_agu'];
            $total_qty_sep += $rows['value_sep'];
            $total_qty_okt += $rows['value_okt'];
            $total_qty_nop += $rows['value_nop'];
            $total_qty_des += $rows['value_des'];
            $total_qty_year += $rows['value_total'];

			$no++; // Tambah 1 setiap kali looping
    		$row++; // Tambah 1 setiap kali looping
		endforeach;

		//item_group end
		//$row = $row + 1;
		$sheet->setCellValue('A' . $row, '');
		$sheet->setCellValue('B' . $row, $principal);
		$sheet->setCellValue('C' . $row, $item_group);
		$sheet->setCellValue('D' . $row, '');
		$sheet->setCellValue('E' . $row, 'Sub Total ' . $item_group);
		$sheet->setCellValue('F' . $row, '');
		$sheet->setCellValue('G' . $row, number_format($qty_jan, 0));
		$sheet->setCellValue('H' . $row, number_format($qty_feb, 0));
		$sheet->setCellValue('I' . $row, number_format($qty_mar, 0));
		$sheet->setCellValue('J' . $row, number_format($qty_apr, 0));
		$sheet->setCellValue('K' . $row, number_format($qty_mei, 0));
		$sheet->setCellValue('L' . $row, number_format($qty_jun, 0));
		$sheet->setCellValue('M' . $row, number_format($qty_jul, 0));
		$sheet->setCellValue('N' . $row, number_format($qty_agu, 0));
		$sheet->setCellValue('O' . $row, number_format($qty_sep, 0));
		$sheet->setCellValue('P' . $row, number_format($qty_okt, 0));
		$sheet->setCellValue('Q' . $row, number_format($qty_nop, 0));
		$sheet->setCellValue('R' . $row, number_format($qty_des, 0));
		$sheet->setCellValue('S' . $row, number_format($qty_year, 0));

		// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
		$sheet->getStyle('A' . $row)->applyFromArray($style_row);
		$sheet->getStyle('B' . $row)->applyFromArray($style_row);
		$sheet->getStyle('C' . $row)->applyFromArray($style_row);
		$sheet->getStyle('D' . $row)->applyFromArray($style_row);
		$sheet->getStyle('E' . $row)->applyFromArray($style_row);
		$sheet->getStyle('F' . $row)->applyFromArray($style_row);
		$sheet->getStyle('G' . $row)->applyFromArray($style_row);
		$sheet->getStyle('H' . $row)->applyFromArray($style_row);
		$sheet->getStyle('I' . $row)->applyFromArray($style_row);
		$sheet->getStyle('J' . $row)->applyFromArray($style_row);
		$sheet->getStyle('K' . $row)->applyFromArray($style_row);
		$sheet->getStyle('L' . $row)->applyFromArray($style_row);
		$sheet->getStyle('M' . $row)->applyFromArray($style_row);
		$sheet->getStyle('N' . $row)->applyFromArray($style_row);
		$sheet->getStyle('O' . $row)->applyFromArray($style_row);
		$sheet->getStyle('P' . $row)->applyFromArray($style_row);
		$sheet->getStyle('Q' . $row)->applyFromArray($style_row);
		$sheet->getStyle('R' . $row)->applyFromArray($style_row);
		$sheet->getStyle('S' . $row)->applyFromArray($style_row);

		$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('I' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('J' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('K' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('L' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('M' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('N' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('O' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('P' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('Q' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('R' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('S' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

		$sheet->getStyle('A' . $row . ':S' . $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');
		$sheet->getStyle('A' . $row . ':S' . $row)->getFont()->setBold(true);

		//principal end
		$row = $row + 1;
		$sheet->setCellValue('A' . $row, '');
		$sheet->setCellValue('B' . $row, $principal);
		$sheet->setCellValue('C' . $row, '');
		$sheet->setCellValue('D' . $row, '');
		$sheet->setCellValue('E' . $row, 'TOTAL ' . $principal);
		$sheet->setCellValue('F' . $row, '');
		$sheet->setCellValue('G' . $row, number_format($sub_qty_jan, 0));
		$sheet->setCellValue('H' . $row, number_format($sub_qty_feb, 0));
		$sheet->setCellValue('I' . $row, number_format($sub_qty_mar, 0));
		$sheet->setCellValue('J' . $row, number_format($sub_qty_apr, 0));
		$sheet->setCellValue('K' . $row, number_format($sub_qty_mei, 0));
		$sheet->setCellValue('L' . $row, number_format($sub_qty_jun, 0));
		$sheet->setCellValue('M' . $row, number_format($sub_qty_jul, 0));
		$sheet->setCellValue('N' . $row, number_format($sub_qty_agu, 0));
		$sheet->setCellValue('O' . $row, number_format($sub_qty_sep, 0));
		$sheet->setCellValue('P' . $row, number_format($sub_qty_okt, 0));
		$sheet->setCellValue('Q' . $row, number_format($sub_qty_nop, 0));
		$sheet->setCellValue('R' . $row, number_format($sub_qty_des, 0));
		$sheet->setCellValue('S' . $row, number_format($sub_qty_year, 0));

		// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
		$sheet->getStyle('A' . $row)->applyFromArray($style_row);
		$sheet->getStyle('B' . $row)->applyFromArray($style_row);
		$sheet->getStyle('C' . $row)->applyFromArray($style_row);
		$sheet->getStyle('D' . $row)->applyFromArray($style_row);
		$sheet->getStyle('E' . $row)->applyFromArray($style_row);
		$sheet->getStyle('F' . $row)->applyFromArray($style_row);
		$sheet->getStyle('G' . $row)->applyFromArray($style_row);
		$sheet->getStyle('H' . $row)->applyFromArray($style_row);
		$sheet->getStyle('I' . $row)->applyFromArray($style_row);
		$sheet->getStyle('J' . $row)->applyFromArray($style_row);
		$sheet->getStyle('K' . $row)->applyFromArray($style_row);
		$sheet->getStyle('L' . $row)->applyFromArray($style_row);
		$sheet->getStyle('M' . $row)->applyFromArray($style_row);
		$sheet->getStyle('N' . $row)->applyFromArray($style_row);
		$sheet->getStyle('O' . $row)->applyFromArray($style_row);
		$sheet->getStyle('P' . $row)->applyFromArray($style_row);
		$sheet->getStyle('Q' . $row)->applyFromArray($style_row);
		$sheet->getStyle('R' . $row)->applyFromArray($style_row);
		$sheet->getStyle('S' . $row)->applyFromArray($style_row);

		$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('I' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('J' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('K' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('L' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('M' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('N' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('O' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('P' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('Q' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('R' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('S' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

		$sheet->getStyle('A' . $row . ':S' . $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFA07A');
		$sheet->getStyle('A' . $row . ':S' . $row)->getFont()->setBold(true);

		//grand total
		$row = $row + 1;
		$sheet->setCellValue('A' . $row, '');
		$sheet->setCellValue('B' . $row, '');
		$sheet->setCellValue('C' . $row, '');
		$sheet->setCellValue('D' . $row, '');
		$sheet->setCellValue('E' . $row, 'GRAND TOTAL');
		$sheet->setCellValue('F' . $row, '');
		$sheet->setCellValue('G' . $row, number_format($total_qty_jan, 0));
		$sheet->setCellValue('H' . $row, number_format($total_qty_feb, 0));
		$sheet->setCellValue('I' . $row, number_format($total_qty_mar, 0));
		$sheet->setCellValue('J' . $row, number_format($total_qty_apr, 0));
		$sheet->setCellValue('K' . $row, number_format($total_qty_mei, 0));
		$sheet->setCellValue('L' . $row, number_format($total_qty_jun, 0));
		$sheet->setCellValue('M' . $row, number_format($total_qty_jul, 0));
		$sheet->setCellValue('N' . $row, number_format($total_qty_agu, 0));
		$sheet->setCellValue('O' . $row, number_format($total_qty_sep, 0));
		$sheet->setCellValue('P' . $row, number_format($total_qty_okt, 0));
		$sheet->setCellValue('Q' . $row, number_format($total_qty_nop, 0));
		$sheet->setCellValue('R' . $row, number_format($total_qty_des, 0));
		$sheet->setCellValue('S' . $row, number_format($total_qty_year, 0));

		// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
		$sheet->getStyle('A' . $row)->applyFromArray($style_row);
		$sheet->getStyle('B' . $row)->applyFromArray($style_row);
		$sheet->getStyle('C' . $row)->applyFromArray($style_row);
		$sheet->getStyle('D' . $row)->applyFromArray($style_row);
		$sheet->getStyle('E' . $row)->applyFromArray($style_row);
		$sheet->getStyle('F' . $row)->applyFromArray($style_row);
		$sheet->getStyle('G' . $row)->applyFromArray($style_row);
		$sheet->getStyle('H' . $row)->applyFromArray($style_row);
		$sheet->getStyle('I' . $row)->applyFromArray($style_row);
		$sheet->getStyle('J' . $row)->applyFromArray($style_row);
		$sheet->getStyle('K' . $row)->applyFromArray($style_row);
		$sheet->getStyle('L' . $row)->applyFromArray($style_row);
		$sheet->getStyle('M' . $row)->applyFromArray($style_row);
		$sheet->getStyle('N' . $row)->applyFromArray($style_row);
		$sheet->getStyle('O' . $row)->applyFromArray($style_row);
		$sheet->getStyle('P' . $row)->applyFromArray($style_row);
		$sheet->getStyle('Q' . $row)->applyFromArray($style_row);
		$sheet->getStyle('R' . $row)->applyFromArray($style_row);
		$sheet->getStyle('S' . $row)->applyFromArray($style_row);

		$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('I' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('J' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('K' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('L' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('M' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('N' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('O' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('P' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('Q' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('R' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('S' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

		$sheet->getStyle('A' . $row . ':S' . $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFA07A');
		$sheet->getStyle('A' . $row . ':S' . $row)->getFont()->setBold(true);


		//set columns width
		$sheet->getColumnDimension('A')->setWidth(5); 
		$sheet->getColumnDimension('B')->setWidth(11); 
		$sheet->getColumnDimension('C')->setWidth(22);
		$sheet->getColumnDimension('D')->setWidth(12);
		$sheet->getColumnDimension('E')->setWidth(53);
		$sheet->getColumnDimension('F')->setWidth(6);
		$sheet->getColumnDimension('G')->setWidth(10);
		$sheet->getColumnDimension('H')->setWidth(10);
		$sheet->getColumnDimension('I')->setWidth(10);
		$sheet->getColumnDimension('J')->setWidth(10);
		$sheet->getColumnDimension('K')->setWidth(10);
		$sheet->getColumnDimension('L')->setWidth(10);
		$sheet->getColumnDimension('M')->setWidth(10);
		$sheet->getColumnDimension('N')->setWidth(10);
		$sheet->getColumnDimension('O')->setWidth(10);
		$sheet->getColumnDimension('P')->setWidth(10);
		$sheet->getColumnDimension('Q')->setWidth(10);
		$sheet->getColumnDimension('R')->setWidth(10);
		$sheet->getColumnDimension('S')->setWidth(10);
		

		// Set orientasi kertas jadi LANDSCAPE
		$sheet->getPageSetup()->setOrientation(\PhpOffice\PhpSpreadsheet\Worksheet\PageSetup::ORIENTATION_LANDSCAPE);
		// Set judul file excel nya
		$sheet->setTitle("Report Selling In - Value");
		// Proses file excel
		header('Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet');
		header('Content-Disposition: attachment; filename="Report Selling In - Value ("' . $year . '").xlsx"'); // Set nama file excel nya
		header('Cache-Control: max-age=0');

		$writer = new Xlsx($spreadsheet);
		$writer->save('php://output');

	}

	public function export_sellingout_qty()
	{
		$spreadsheet = new Spreadsheet();
		$sheet = $spreadsheet->getActiveSheet();
		// Buat sebuah variabel untuk menampung pengaturan style dari header tabel
		$style_col = [
			'font' => ['bold' => true], // Set font nya jadi bold
			'alignment' => [
				'horizontal' => \PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER, // Set text jadi ditengah secara horizontal (center)
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'top' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border top dengan garis tipis
				'right' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN],  // Set border right dengan garis tipis
				'bottom' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border bottom dengan garis tipis
				'left' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN] // Set border left dengan garis tipis
			]
		];
		// Buat sebuah variabel untuk menampung pengaturan style dari isi tabel
		$style_row = [
			'alignment' => [
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'top' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border top dengan garis tipis
				'right' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN],  // Set border right dengan garis tipis
				'bottom' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border bottom dengan garis tipis
				'left' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN] // Set border left dengan garis tipis
			]
		];


		if (isset($_POST['by_island']))
		{
			$island = $_POST['by_island'];
		}
		else
		{
			$island = "";
		}

		if (isset($_POST['by_region']))
		{
			$region = $_POST['by_region'];
		}
		else
		{
			$region = "";
		}

		if (isset($_POST['by_area']))
		{
			$area = implode(',', $_POST['by_area']);
			$area = str_replace(",", "','", $area);;
		}
		else
		{
			$area = "";
		}

		if (isset($_POST['by_year']))
		{
			$year = $_POST['by_year'];
		}
		else
		{
			$year = "";
		}


		$sheet->setCellValue('A1', "Report Selling Out - Quantity (" . $year . ")"); // Set kolom A1 dengan tulisan 
		$sheet->setCellValue('A2', "Island : " . $island);
		$sheet->setCellValue('A3', "Region : " . $region); 
		$sheet->setCellValue('A4', "Area : " . $area); 
		//$sheet->mergeCells('A1:F1'); // Set Merge Cell pada kolom A1 sampai F1
		$sheet->getStyle('A1')->getFont()->setBold(true); // Set bold kolom A1
		$sheet->getStyle('A2')->getFont()->setBold(true);
		$sheet->getStyle('A3')->getFont()->setBold(true);
		$sheet->getStyle('A4')->getFont()->setBold(true);
		$sheet->getStyle('A1')->getFont()->setSize(20); // Set font size 15 untuk kolom A1
		// Buat header tabel nya pada baris ke 6
		$sheet->setCellValue('A6', "#"); // Set kolom A6 dengan tulisan "#"
		$sheet->setCellValue('B6', "Principal");
		$sheet->setCellValue('C6', "Group SKU"); 
		$sheet->setCellValue('D6', "Kode Item"); 
		$sheet->setCellValue('E6', "SKU");
		$sheet->setCellValue('F6', "Unit");
		$sheet->setCellValue('G6', "January");
		$sheet->setCellValue('H6', "February");
		$sheet->setCellValue('I6', "March");
		$sheet->setCellValue('J6', "April");
		$sheet->setCellValue('K6', "May");
		$sheet->setCellValue('L6', "June");
		$sheet->setCellValue('M6', "July");
		$sheet->setCellValue('N6', "August");
		$sheet->setCellValue('O6', "September");
		$sheet->setCellValue('P6', "October");
		$sheet->setCellValue('Q6', "November");
		$sheet->setCellValue('R6', "December");
		$sheet->setCellValue('S6', "Total");
		
		

		// Apply style header yang telah kita buat tadi ke masing-masing kolom header
		$sheet->getStyle('A6')->applyFromArray($style_col);
		$sheet->getStyle('B6')->applyFromArray($style_col);
		$sheet->getStyle('C6')->applyFromArray($style_col);
		$sheet->getStyle('D6')->applyFromArray($style_col);
		$sheet->getStyle('E6')->applyFromArray($style_col);
		$sheet->getStyle('F6')->applyFromArray($style_col);
		$sheet->getStyle('G6')->applyFromArray($style_col);
		$sheet->getStyle('H6')->applyFromArray($style_col);
		$sheet->getStyle('I6')->applyFromArray($style_col);
		$sheet->getStyle('J6')->applyFromArray($style_col);
		$sheet->getStyle('K6')->applyFromArray($style_col);
		$sheet->getStyle('L6')->applyFromArray($style_col);
		$sheet->getStyle('M6')->applyFromArray($style_col);
		$sheet->getStyle('N6')->applyFromArray($style_col);
		$sheet->getStyle('O6')->applyFromArray($style_col);
		$sheet->getStyle('P6')->applyFromArray($style_col);
		$sheet->getStyle('Q6')->applyFromArray($style_col);
		$sheet->getStyle('R6')->applyFromArray($style_col);
		$sheet->getStyle('S6')->applyFromArray($style_col);

		$sheet->getStyle('A6:R6')->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');
		$sheet->getStyle('S6')->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFA07A');

		// Set height baris ke 1 dan 2
		$sheet->getRowDimension('1')->setRowHeight(40);
		$sheet->getRowDimension('2')->setRowHeight(20);
		$sheet->getRowDimension('3')->setRowHeight(20);
		$sheet->getRowDimension('4')->setRowHeight(20);


		$item_group = '';
        $principal = '';
        $qty_jan = 0;
        $qty_feb = 0;
        $qty_mar = 0;
        $qty_apr = 0;
        $qty_mei = 0;
        $qty_jun = 0;
        $qty_jul = 0;
        $qty_agu = 0;
        $qty_sep = 0;
        $qty_okt = 0;
        $qty_nop = 0;
        $qty_des = 0;
        $qty_year = 0;
        $qty_avg = 0;

        $sub_qty_jan = 0;
        $sub_qty_feb = 0;
        $sub_qty_mar = 0;
        $sub_qty_apr = 0;
        $sub_qty_mei = 0;
        $sub_qty_jun = 0;
        $sub_qty_jul = 0;
        $sub_qty_agu = 0;
        $sub_qty_sep = 0;
        $sub_qty_okt = 0;
        $sub_qty_nop = 0;
        $sub_qty_des = 0;
        $sub_qty_year = 0;
        $sub_qty_avg = 0;

        $total_qty_jan = 0;
        $total_qty_feb = 0;
        $total_qty_mar = 0;
        $total_qty_apr = 0;
        $total_qty_mei = 0;
        $total_qty_jun = 0;
        $total_qty_jul = 0;
        $total_qty_agu = 0;
        $total_qty_sep = 0;
        $total_qty_okt = 0;
        $total_qty_nop = 0;
        $total_qty_des = 0;
        $total_qty_year = 0;
        $total_qty_avg = 0;


		$no = 1; // Untuk penomoran tabel, di awal set dengan 1
		$row = 7;

		$data1 = array(
			'island' => $island,
			'region' => $region,
			'area' => $area,
			'year' => $year
		);

		//$data['sellingin_Dist'] = $this->model('ReportModel')->getSellingIn_Dist2($data1);
		$data['sellingout_qty'] = $this->model('ReportModel')->getSellingOut_Year2($data1);
		//$data['sellingin_OT'] = $this->model('ReportModel')->getSellingIn_OT2();

		foreach ($data['sellingout_qty'] as $rows) :

			if ($item_group != $rows['item_group'] and $item_group != '' )
            {
				
				$sheet->setCellValue('A' . $row, '');
				$sheet->setCellValue('B' . $row, $principal);
				$sheet->setCellValue('C' . $row, $item_group);
				$sheet->setCellValue('D' . $row, '');
				$sheet->setCellValue('E' . $row, 'Sub Total ' . $item_group);
				$sheet->setCellValue('F' . $row, '');
				$sheet->setCellValue('G' . $row, number_format($qty_jan, 0));
				$sheet->setCellValue('H' . $row, number_format($qty_feb, 0));
				$sheet->setCellValue('I' . $row, number_format($qty_mar, 0));
				$sheet->setCellValue('J' . $row, number_format($qty_apr, 0));
				$sheet->setCellValue('K' . $row, number_format($qty_mei, 0));
				$sheet->setCellValue('L' . $row, number_format($qty_jun, 0));
				$sheet->setCellValue('M' . $row, number_format($qty_jul, 0));
				$sheet->setCellValue('N' . $row, number_format($qty_agu, 0));
				$sheet->setCellValue('O' . $row, number_format($qty_sep, 0));
				$sheet->setCellValue('P' . $row, number_format($qty_okt, 0));
				$sheet->setCellValue('Q' . $row, number_format($qty_nop, 0));
				$sheet->setCellValue('R' . $row, number_format($qty_des, 0));
				$sheet->setCellValue('S' . $row, number_format($qty_year, 0));

				// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
				$sheet->getStyle('A' . $row)->applyFromArray($style_row);
				$sheet->getStyle('B' . $row)->applyFromArray($style_row);
				$sheet->getStyle('C' . $row)->applyFromArray($style_row);
				$sheet->getStyle('D' . $row)->applyFromArray($style_row);
				$sheet->getStyle('E' . $row)->applyFromArray($style_row);
				$sheet->getStyle('F' . $row)->applyFromArray($style_row);
				$sheet->getStyle('G' . $row)->applyFromArray($style_row);
				$sheet->getStyle('H' . $row)->applyFromArray($style_row);
				$sheet->getStyle('I' . $row)->applyFromArray($style_row);
				$sheet->getStyle('J' . $row)->applyFromArray($style_row);
				$sheet->getStyle('K' . $row)->applyFromArray($style_row);
				$sheet->getStyle('L' . $row)->applyFromArray($style_row);
				$sheet->getStyle('M' . $row)->applyFromArray($style_row);
				$sheet->getStyle('N' . $row)->applyFromArray($style_row);
				$sheet->getStyle('O' . $row)->applyFromArray($style_row);
				$sheet->getStyle('P' . $row)->applyFromArray($style_row);
				$sheet->getStyle('Q' . $row)->applyFromArray($style_row);
				$sheet->getStyle('R' . $row)->applyFromArray($style_row);
				$sheet->getStyle('S' . $row)->applyFromArray($style_row);

				$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
				$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
				$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
				$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
				$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
				$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
				$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('I' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('J' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('K' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('L' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('M' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('N' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('O' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('P' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('Q' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('R' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('S' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

				$sheet->getStyle('A' . $row . ':S' . $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');
				$sheet->getStyle('A' . $row . ':S' . $row)->getFont()->setBold(true);

				$qty_jan = 0;
                $qty_feb = 0;
                $qty_mar = 0;
                $qty_apr = 0;
                $qty_mei = 0;
                $qty_jun = 0;
                $qty_jul = 0;
                $qty_agu = 0;
                $qty_sep = 0;
                $qty_okt = 0;
                $qty_nop = 0;
                $qty_des = 0;
                $qty_year = 0;
                $qty_avg = 0;

				$row++;
            }

			if ($principal != $rows['principal'] and $principal != '' )
            {
				
				$sheet->setCellValue('A' . $row, '');
				$sheet->setCellValue('B' . $row, $principal);
				$sheet->setCellValue('C' . $row, '');
				$sheet->setCellValue('D' . $row, '');
				$sheet->setCellValue('E' . $row, 'TOTAL ' . $principal);
				$sheet->setCellValue('F' . $row, '');
				$sheet->setCellValue('G' . $row, number_format($sub_qty_jan, 0));
				$sheet->setCellValue('H' . $row, number_format($sub_qty_feb, 0));
				$sheet->setCellValue('I' . $row, number_format($sub_qty_mar, 0));
				$sheet->setCellValue('J' . $row, number_format($sub_qty_apr, 0));
				$sheet->setCellValue('K' . $row, number_format($sub_qty_mei, 0));
				$sheet->setCellValue('L' . $row, number_format($sub_qty_jun, 0));
				$sheet->setCellValue('M' . $row, number_format($sub_qty_jul, 0));
				$sheet->setCellValue('N' . $row, number_format($sub_qty_agu, 0));
				$sheet->setCellValue('O' . $row, number_format($sub_qty_sep, 0));
				$sheet->setCellValue('P' . $row, number_format($sub_qty_okt, 0));
				$sheet->setCellValue('Q' . $row, number_format($sub_qty_nop, 0));
				$sheet->setCellValue('R' . $row, number_format($sub_qty_des, 0));
				$sheet->setCellValue('S' . $row, number_format($sub_qty_year, 0));

				// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
				$sheet->getStyle('A' . $row)->applyFromArray($style_row);
				$sheet->getStyle('B' . $row)->applyFromArray($style_row);
				$sheet->getStyle('C' . $row)->applyFromArray($style_row);
				$sheet->getStyle('D' . $row)->applyFromArray($style_row);
				$sheet->getStyle('E' . $row)->applyFromArray($style_row);
				$sheet->getStyle('F' . $row)->applyFromArray($style_row);
				$sheet->getStyle('G' . $row)->applyFromArray($style_row);
				$sheet->getStyle('H' . $row)->applyFromArray($style_row);
				$sheet->getStyle('I' . $row)->applyFromArray($style_row);
				$sheet->getStyle('J' . $row)->applyFromArray($style_row);
				$sheet->getStyle('K' . $row)->applyFromArray($style_row);
				$sheet->getStyle('L' . $row)->applyFromArray($style_row);
				$sheet->getStyle('M' . $row)->applyFromArray($style_row);
				$sheet->getStyle('N' . $row)->applyFromArray($style_row);
				$sheet->getStyle('O' . $row)->applyFromArray($style_row);
				$sheet->getStyle('P' . $row)->applyFromArray($style_row);
				$sheet->getStyle('Q' . $row)->applyFromArray($style_row);
				$sheet->getStyle('R' . $row)->applyFromArray($style_row);
				$sheet->getStyle('S' . $row)->applyFromArray($style_row);

				$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
				$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
				$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
				$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
				$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
				$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
				$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('I' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('J' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('K' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('L' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('M' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('N' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('O' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('P' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('Q' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('R' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('S' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

				$sheet->getStyle('A' . $row . ':S' . $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFA07A');
				$sheet->getStyle('A' . $row . ':S' . $row)->getFont()->setBold(true);

				$sub_qty_jan = 0;
				$sub_qty_feb = 0;
				$sub_qty_mar = 0;
				$sub_qty_apr = 0;
				$sub_qty_mei = 0;
				$sub_qty_jun = 0;
				$sub_qty_jul = 0;
				$sub_qty_agu = 0;
				$sub_qty_sep = 0;
				$sub_qty_okt = 0;
				$sub_qty_nop = 0;
				$sub_qty_des = 0;
				$sub_qty_year = 0;
				$sub_qty_avg = 0;

				$row++;
            }

			$sheet->setCellValue('A' . $row, $no);
    		$sheet->setCellValue('B' . $row, $rows['principal']);
			$sheet->setCellValue('C' . $row, $rows['item_group']);
			$sheet->setCellValue('D' . $row, $rows['item_code']);
			$sheet->setCellValue('E' . $row, $rows['item_name']);
			$sheet->setCellValue('F' . $row, $rows['unit']);
			$sheet->setCellValue('G' . $row, number_format($rows['qty_jan'], 0));			
			$sheet->setCellValue('H' . $row, number_format($rows['qty_feb'], 0));			
			$sheet->setCellValue('I' . $row, number_format($rows['qty_mar'], 0));			
			$sheet->setCellValue('J' . $row, number_format($rows['qty_apr'], 0));			
			$sheet->setCellValue('K' . $row, number_format($rows['qty_mei'], 0));			
			$sheet->setCellValue('L' . $row, number_format($rows['qty_jun'], 0));			
			$sheet->setCellValue('M' . $row, number_format($rows['qty_jul'], 0));			
			$sheet->setCellValue('N' . $row, number_format($rows['qty_agu'], 0));			
			$sheet->setCellValue('O' . $row, number_format($rows['qty_sep'], 0));			
			$sheet->setCellValue('P' . $row, number_format($rows['qty_okt'], 0));			
			$sheet->setCellValue('Q' . $row, number_format($rows['qty_nop'], 0));			
			$sheet->setCellValue('R' . $row, number_format($rows['qty_des'], 0));			
			$sheet->setCellValue('S' . $row, number_format($rows['qty_total'], 0));

			// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
			$sheet->getStyle('A' . $row)->applyFromArray($style_row);
			$sheet->getStyle('B' . $row)->applyFromArray($style_row);
			$sheet->getStyle('C' . $row)->applyFromArray($style_row);
			$sheet->getStyle('D' . $row)->applyFromArray($style_row);
			$sheet->getStyle('E' . $row)->applyFromArray($style_row);
			$sheet->getStyle('F' . $row)->applyFromArray($style_row);
			$sheet->getStyle('G' . $row)->applyFromArray($style_row);
			$sheet->getStyle('H' . $row)->applyFromArray($style_row);
			$sheet->getStyle('I' . $row)->applyFromArray($style_row);
			$sheet->getStyle('J' . $row)->applyFromArray($style_row);
			$sheet->getStyle('K' . $row)->applyFromArray($style_row);
			$sheet->getStyle('L' . $row)->applyFromArray($style_row);
			$sheet->getStyle('M' . $row)->applyFromArray($style_row);
			$sheet->getStyle('N' . $row)->applyFromArray($style_row);
			$sheet->getStyle('O' . $row)->applyFromArray($style_row);
			$sheet->getStyle('P' . $row)->applyFromArray($style_row);
			$sheet->getStyle('Q' . $row)->applyFromArray($style_row);
			$sheet->getStyle('R' . $row)->applyFromArray($style_row);
			$sheet->getStyle('S' . $row)->applyFromArray($style_row);

			$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('I' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('J' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('K' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('L' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('M' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('N' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('O' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('P' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('Q' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('R' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('S' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

			$item_group = $rows['item_group'];
			$principal = $rows['principal'];

			$qty_jan += $rows['qty_jan'];
            $qty_feb += $rows['qty_feb'];
            $qty_mar += $rows['qty_mar'];
            $qty_apr += $rows['qty_apr'];
            $qty_mei += $rows['qty_mei'];
            $qty_jun += $rows['qty_jun'];
            $qty_jul += $rows['qty_jul'];
            $qty_agu += $rows['qty_agu'];
            $qty_sep += $rows['qty_sep'];
            $qty_okt += $rows['qty_okt'];
            $qty_nop += $rows['qty_nop'];
            $qty_des += $rows['qty_des'];
            $qty_year += $rows['qty_total'];

            $sub_qty_jan += $rows['qty_jan'];
            $sub_qty_feb += $rows['qty_feb'];
            $sub_qty_mar += $rows['qty_mar'];
            $sub_qty_apr += $rows['qty_apr'];
            $sub_qty_mei += $rows['qty_mei'];
            $sub_qty_jun += $rows['qty_jun'];
            $sub_qty_jul += $rows['qty_jul'];
            $sub_qty_agu += $rows['qty_agu'];
            $sub_qty_sep += $rows['qty_sep'];
            $sub_qty_okt += $rows['qty_okt'];
            $sub_qty_nop += $rows['qty_nop'];
            $sub_qty_des += $rows['qty_des'];
            $sub_qty_year += $rows['qty_total'];

            $total_qty_jan += $rows['qty_jan'];
            $total_qty_feb += $rows['qty_feb'];
            $total_qty_mar += $rows['qty_mar'];
            $total_qty_apr += $rows['qty_apr'];
            $total_qty_mei += $rows['qty_mei'];
            $total_qty_jun += $rows['qty_jun'];
            $total_qty_jul += $rows['qty_jul'];
            $total_qty_agu += $rows['qty_agu'];
            $total_qty_sep += $rows['qty_sep'];
            $total_qty_okt += $rows['qty_okt'];
            $total_qty_nop += $rows['qty_nop'];
            $total_qty_des += $rows['qty_des'];
            $total_qty_year += $rows['qty_total'];

			$no++; // Tambah 1 setiap kali looping
    		$row++; // Tambah 1 setiap kali looping
		endforeach;

		//item_group end
		//$row = $row + 1;
		$sheet->setCellValue('A' . $row, '');
		$sheet->setCellValue('B' . $row, $principal);
		$sheet->setCellValue('C' . $row, $item_group);
		$sheet->setCellValue('D' . $row, '');
		$sheet->setCellValue('E' . $row, 'Sub Total ' . $item_group);
		$sheet->setCellValue('F' . $row, '');
		$sheet->setCellValue('G' . $row, number_format($qty_jan, 0));
		$sheet->setCellValue('H' . $row, number_format($qty_feb, 0));
		$sheet->setCellValue('I' . $row, number_format($qty_mar, 0));
		$sheet->setCellValue('J' . $row, number_format($qty_apr, 0));
		$sheet->setCellValue('K' . $row, number_format($qty_mei, 0));
		$sheet->setCellValue('L' . $row, number_format($qty_jun, 0));
		$sheet->setCellValue('M' . $row, number_format($qty_jul, 0));
		$sheet->setCellValue('N' . $row, number_format($qty_agu, 0));
		$sheet->setCellValue('O' . $row, number_format($qty_sep, 0));
		$sheet->setCellValue('P' . $row, number_format($qty_okt, 0));
		$sheet->setCellValue('Q' . $row, number_format($qty_nop, 0));
		$sheet->setCellValue('R' . $row, number_format($qty_des, 0));
		$sheet->setCellValue('S' . $row, number_format($qty_year, 0));

		// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
		$sheet->getStyle('A' . $row)->applyFromArray($style_row);
		$sheet->getStyle('B' . $row)->applyFromArray($style_row);
		$sheet->getStyle('C' . $row)->applyFromArray($style_row);
		$sheet->getStyle('D' . $row)->applyFromArray($style_row);
		$sheet->getStyle('E' . $row)->applyFromArray($style_row);
		$sheet->getStyle('F' . $row)->applyFromArray($style_row);
		$sheet->getStyle('G' . $row)->applyFromArray($style_row);
		$sheet->getStyle('H' . $row)->applyFromArray($style_row);
		$sheet->getStyle('I' . $row)->applyFromArray($style_row);
		$sheet->getStyle('J' . $row)->applyFromArray($style_row);
		$sheet->getStyle('K' . $row)->applyFromArray($style_row);
		$sheet->getStyle('L' . $row)->applyFromArray($style_row);
		$sheet->getStyle('M' . $row)->applyFromArray($style_row);
		$sheet->getStyle('N' . $row)->applyFromArray($style_row);
		$sheet->getStyle('O' . $row)->applyFromArray($style_row);
		$sheet->getStyle('P' . $row)->applyFromArray($style_row);
		$sheet->getStyle('Q' . $row)->applyFromArray($style_row);
		$sheet->getStyle('R' . $row)->applyFromArray($style_row);
		$sheet->getStyle('S' . $row)->applyFromArray($style_row);

		$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('I' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('J' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('K' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('L' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('M' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('N' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('O' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('P' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('Q' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('R' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('S' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

		$sheet->getStyle('A' . $row . ':S' . $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');
		$sheet->getStyle('A' . $row . ':S' . $row)->getFont()->setBold(true);

		//principal end
		$row = $row + 1;
		$sheet->setCellValue('A' . $row, '');
		$sheet->setCellValue('B' . $row, $principal);
		$sheet->setCellValue('C' . $row, '');
		$sheet->setCellValue('D' . $row, '');
		$sheet->setCellValue('E' . $row, 'TOTAL ' . $principal);
		$sheet->setCellValue('F' . $row, '');
		$sheet->setCellValue('G' . $row, number_format($sub_qty_jan, 0));
		$sheet->setCellValue('H' . $row, number_format($sub_qty_feb, 0));
		$sheet->setCellValue('I' . $row, number_format($sub_qty_mar, 0));
		$sheet->setCellValue('J' . $row, number_format($sub_qty_apr, 0));
		$sheet->setCellValue('K' . $row, number_format($sub_qty_mei, 0));
		$sheet->setCellValue('L' . $row, number_format($sub_qty_jun, 0));
		$sheet->setCellValue('M' . $row, number_format($sub_qty_jul, 0));
		$sheet->setCellValue('N' . $row, number_format($sub_qty_agu, 0));
		$sheet->setCellValue('O' . $row, number_format($sub_qty_sep, 0));
		$sheet->setCellValue('P' . $row, number_format($sub_qty_okt, 0));
		$sheet->setCellValue('Q' . $row, number_format($sub_qty_nop, 0));
		$sheet->setCellValue('R' . $row, number_format($sub_qty_des, 0));
		$sheet->setCellValue('S' . $row, number_format($sub_qty_year, 0));

		// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
		$sheet->getStyle('A' . $row)->applyFromArray($style_row);
		$sheet->getStyle('B' . $row)->applyFromArray($style_row);
		$sheet->getStyle('C' . $row)->applyFromArray($style_row);
		$sheet->getStyle('D' . $row)->applyFromArray($style_row);
		$sheet->getStyle('E' . $row)->applyFromArray($style_row);
		$sheet->getStyle('F' . $row)->applyFromArray($style_row);
		$sheet->getStyle('G' . $row)->applyFromArray($style_row);
		$sheet->getStyle('H' . $row)->applyFromArray($style_row);
		$sheet->getStyle('I' . $row)->applyFromArray($style_row);
		$sheet->getStyle('J' . $row)->applyFromArray($style_row);
		$sheet->getStyle('K' . $row)->applyFromArray($style_row);
		$sheet->getStyle('L' . $row)->applyFromArray($style_row);
		$sheet->getStyle('M' . $row)->applyFromArray($style_row);
		$sheet->getStyle('N' . $row)->applyFromArray($style_row);
		$sheet->getStyle('O' . $row)->applyFromArray($style_row);
		$sheet->getStyle('P' . $row)->applyFromArray($style_row);
		$sheet->getStyle('Q' . $row)->applyFromArray($style_row);
		$sheet->getStyle('R' . $row)->applyFromArray($style_row);
		$sheet->getStyle('S' . $row)->applyFromArray($style_row);

		$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('I' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('J' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('K' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('L' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('M' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('N' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('O' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('P' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('Q' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('R' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('S' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

		$sheet->getStyle('A' . $row . ':S' . $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFA07A');
		$sheet->getStyle('A' . $row . ':S' . $row)->getFont()->setBold(true);

		//grand total
		$row = $row + 1;
		$sheet->setCellValue('A' . $row, '');
		$sheet->setCellValue('B' . $row, '');
		$sheet->setCellValue('C' . $row, '');
		$sheet->setCellValue('D' . $row, '');
		$sheet->setCellValue('E' . $row, 'GRAND TOTAL');
		$sheet->setCellValue('F' . $row, '');
		$sheet->setCellValue('G' . $row, number_format($total_qty_jan, 0));
		$sheet->setCellValue('H' . $row, number_format($total_qty_feb, 0));
		$sheet->setCellValue('I' . $row, number_format($total_qty_mar, 0));
		$sheet->setCellValue('J' . $row, number_format($total_qty_apr, 0));
		$sheet->setCellValue('K' . $row, number_format($total_qty_mei, 0));
		$sheet->setCellValue('L' . $row, number_format($total_qty_jun, 0));
		$sheet->setCellValue('M' . $row, number_format($total_qty_jul, 0));
		$sheet->setCellValue('N' . $row, number_format($total_qty_agu, 0));
		$sheet->setCellValue('O' . $row, number_format($total_qty_sep, 0));
		$sheet->setCellValue('P' . $row, number_format($total_qty_okt, 0));
		$sheet->setCellValue('Q' . $row, number_format($total_qty_nop, 0));
		$sheet->setCellValue('R' . $row, number_format($total_qty_des, 0));
		$sheet->setCellValue('S' . $row, number_format($total_qty_year, 0));

		// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
		$sheet->getStyle('A' . $row)->applyFromArray($style_row);
		$sheet->getStyle('B' . $row)->applyFromArray($style_row);
		$sheet->getStyle('C' . $row)->applyFromArray($style_row);
		$sheet->getStyle('D' . $row)->applyFromArray($style_row);
		$sheet->getStyle('E' . $row)->applyFromArray($style_row);
		$sheet->getStyle('F' . $row)->applyFromArray($style_row);
		$sheet->getStyle('G' . $row)->applyFromArray($style_row);
		$sheet->getStyle('H' . $row)->applyFromArray($style_row);
		$sheet->getStyle('I' . $row)->applyFromArray($style_row);
		$sheet->getStyle('J' . $row)->applyFromArray($style_row);
		$sheet->getStyle('K' . $row)->applyFromArray($style_row);
		$sheet->getStyle('L' . $row)->applyFromArray($style_row);
		$sheet->getStyle('M' . $row)->applyFromArray($style_row);
		$sheet->getStyle('N' . $row)->applyFromArray($style_row);
		$sheet->getStyle('O' . $row)->applyFromArray($style_row);
		$sheet->getStyle('P' . $row)->applyFromArray($style_row);
		$sheet->getStyle('Q' . $row)->applyFromArray($style_row);
		$sheet->getStyle('R' . $row)->applyFromArray($style_row);
		$sheet->getStyle('S' . $row)->applyFromArray($style_row);

		$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('I' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('J' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('K' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('L' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('M' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('N' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('O' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('P' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('Q' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('R' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('S' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

		$sheet->getStyle('A' . $row . ':S' . $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFA07A');
		$sheet->getStyle('A' . $row . ':S' . $row)->getFont()->setBold(true);


		//set columns width
		$sheet->getColumnDimension('A')->setWidth(5); 
		$sheet->getColumnDimension('B')->setWidth(11); 
		$sheet->getColumnDimension('C')->setWidth(22);
		$sheet->getColumnDimension('D')->setWidth(12);
		$sheet->getColumnDimension('E')->setWidth(53);
		$sheet->getColumnDimension('F')->setWidth(6);
		$sheet->getColumnDimension('G')->setWidth(10);
		$sheet->getColumnDimension('H')->setWidth(10);
		$sheet->getColumnDimension('I')->setWidth(10);
		$sheet->getColumnDimension('J')->setWidth(10);
		$sheet->getColumnDimension('K')->setWidth(10);
		$sheet->getColumnDimension('L')->setWidth(10);
		$sheet->getColumnDimension('M')->setWidth(10);
		$sheet->getColumnDimension('N')->setWidth(10);
		$sheet->getColumnDimension('O')->setWidth(10);
		$sheet->getColumnDimension('P')->setWidth(10);
		$sheet->getColumnDimension('Q')->setWidth(10);
		$sheet->getColumnDimension('R')->setWidth(10);
		$sheet->getColumnDimension('S')->setWidth(10);
		

		// Set orientasi kertas jadi LANDSCAPE
		$sheet->getPageSetup()->setOrientation(\PhpOffice\PhpSpreadsheet\Worksheet\PageSetup::ORIENTATION_LANDSCAPE);
		// Set judul file excel nya
		$sheet->setTitle("Selling Out - Quantity");
		// Proses file excel
		header('Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet');
		header('Content-Disposition: attachment; filename="Report Selling Out - Quantity ("' . $year . '").xlsx"'); // Set nama file excel nya
		header('Cache-Control: max-age=0');

		$writer = new Xlsx($spreadsheet);
		$writer->save('php://output');

	}

	public function export_sellingout_val()
	{
		$spreadsheet = new Spreadsheet();
		$sheet = $spreadsheet->getActiveSheet();
		// Buat sebuah variabel untuk menampung pengaturan style dari header tabel
		$style_col = [
			'font' => ['bold' => true], // Set font nya jadi bold
			'alignment' => [
				'horizontal' => \PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER, // Set text jadi ditengah secara horizontal (center)
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'top' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border top dengan garis tipis
				'right' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN],  // Set border right dengan garis tipis
				'bottom' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border bottom dengan garis tipis
				'left' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN] // Set border left dengan garis tipis
			]
		];
		// Buat sebuah variabel untuk menampung pengaturan style dari isi tabel
		$style_row = [
			'alignment' => [
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'top' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border top dengan garis tipis
				'right' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN],  // Set border right dengan garis tipis
				'bottom' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border bottom dengan garis tipis
				'left' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN] // Set border left dengan garis tipis
			]
		];


		if (isset($_POST['by_island']))
		{
			$island = $_POST['by_island'];
		}
		else
		{
			$island = "";
		}

		if (isset($_POST['by_region']))
		{
			$region = $_POST['by_region'];
		}
		else
		{
			$region = "";
		}

		if (isset($_POST['by_area']))
		{
			$area = implode(',', $_POST['by_area']);
			$area = str_replace(",", "','", $area);;
		}
		else
		{
			$area = "";
		}

		if (isset($_POST['by_year']))
		{
			$year = $_POST['by_year'];
		}
		else
		{
			$year = date('Y');
		}


		$sheet->setCellValue('A1', "Report Selling Out - Value (" . $year . ")"); // Set kolom A1 dengan tulisan 
		$sheet->setCellValue('A2', "Island : " . $island);
		$sheet->setCellValue('A3', "Region : " . $region); 
		$sheet->setCellValue('A4', "Area : " . $area); 
		//$sheet->mergeCells('A1:F1'); // Set Merge Cell pada kolom A1 sampai F1
		$sheet->getStyle('A1')->getFont()->setBold(true); // Set bold kolom A1
		$sheet->getStyle('A2')->getFont()->setBold(true);
		$sheet->getStyle('A3')->getFont()->setBold(true);
		$sheet->getStyle('A4')->getFont()->setBold(true);
		$sheet->getStyle('A1')->getFont()->setSize(20); // Set font size 15 untuk kolom A1
		// Buat header tabel nya pada baris ke 6
		$sheet->setCellValue('A6', "#"); // Set kolom A6 dengan tulisan "#"
		$sheet->setCellValue('B6', "Principal");
		$sheet->setCellValue('C6', "Group SKU"); 
		$sheet->setCellValue('D6', "Kode Item"); 
		$sheet->setCellValue('E6', "SKU");
		$sheet->setCellValue('F6', "Unit");
		$sheet->setCellValue('G6', "January");
		$sheet->setCellValue('H6', "February");
		$sheet->setCellValue('I6', "March");
		$sheet->setCellValue('J6', "April");
		$sheet->setCellValue('K6', "May");
		$sheet->setCellValue('L6', "June");
		$sheet->setCellValue('M6', "July");
		$sheet->setCellValue('N6', "August");
		$sheet->setCellValue('O6', "September");
		$sheet->setCellValue('P6', "October");
		$sheet->setCellValue('Q6', "November");
		$sheet->setCellValue('R6', "December");
		$sheet->setCellValue('S6', "Total");
		
		

		// Apply style header yang telah kita buat tadi ke masing-masing kolom header
		$sheet->getStyle('A6')->applyFromArray($style_col);
		$sheet->getStyle('B6')->applyFromArray($style_col);
		$sheet->getStyle('C6')->applyFromArray($style_col);
		$sheet->getStyle('D6')->applyFromArray($style_col);
		$sheet->getStyle('E6')->applyFromArray($style_col);
		$sheet->getStyle('F6')->applyFromArray($style_col);
		$sheet->getStyle('G6')->applyFromArray($style_col);
		$sheet->getStyle('H6')->applyFromArray($style_col);
		$sheet->getStyle('I6')->applyFromArray($style_col);
		$sheet->getStyle('J6')->applyFromArray($style_col);
		$sheet->getStyle('K6')->applyFromArray($style_col);
		$sheet->getStyle('L6')->applyFromArray($style_col);
		$sheet->getStyle('M6')->applyFromArray($style_col);
		$sheet->getStyle('N6')->applyFromArray($style_col);
		$sheet->getStyle('O6')->applyFromArray($style_col);
		$sheet->getStyle('P6')->applyFromArray($style_col);
		$sheet->getStyle('Q6')->applyFromArray($style_col);
		$sheet->getStyle('R6')->applyFromArray($style_col);
		$sheet->getStyle('S6')->applyFromArray($style_col);

		$sheet->getStyle('A6:R6')->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');
		$sheet->getStyle('S6')->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFA07A');

		// Set height baris ke 1 dan 2
		$sheet->getRowDimension('1')->setRowHeight(40);
		$sheet->getRowDimension('2')->setRowHeight(20);
		$sheet->getRowDimension('3')->setRowHeight(20);
		$sheet->getRowDimension('4')->setRowHeight(20);


		$item_group = '';
        $principal = '';
        $qty_jan = 0;
        $qty_feb = 0;
        $qty_mar = 0;
        $qty_apr = 0;
        $qty_mei = 0;
        $qty_jun = 0;
        $qty_jul = 0;
        $qty_agu = 0;
        $qty_sep = 0;
        $qty_okt = 0;
        $qty_nop = 0;
        $qty_des = 0;
        $qty_year = 0;
        $qty_avg = 0;

        $sub_qty_jan = 0;
        $sub_qty_feb = 0;
        $sub_qty_mar = 0;
        $sub_qty_apr = 0;
        $sub_qty_mei = 0;
        $sub_qty_jun = 0;
        $sub_qty_jul = 0;
        $sub_qty_agu = 0;
        $sub_qty_sep = 0;
        $sub_qty_okt = 0;
        $sub_qty_nop = 0;
        $sub_qty_des = 0;
        $sub_qty_year = 0;
        $sub_qty_avg = 0;

        $total_qty_jan = 0;
        $total_qty_feb = 0;
        $total_qty_mar = 0;
        $total_qty_apr = 0;
        $total_qty_mei = 0;
        $total_qty_jun = 0;
        $total_qty_jul = 0;
        $total_qty_agu = 0;
        $total_qty_sep = 0;
        $total_qty_okt = 0;
        $total_qty_nop = 0;
        $total_qty_des = 0;
        $total_qty_year = 0;
        $total_qty_avg = 0;


		$no = 1; // Untuk penomoran tabel, di awal set dengan 1
		$row = 7;

		$data1 = array(
			'island' => $island,
			'region' => $region,
			'area' => $area,
			'year' => $year
		);

		//$data['sellingin_Dist'] = $this->model('ReportModel')->getSellingIn_Dist2($data1);
		$data['sellingout_qty'] = $this->model('ReportModel')->getSellingOut_Year2($data1);
		//$data['sellingin_OT'] = $this->model('ReportModel')->getSellingIn_OT2();

		foreach ($data['sellingout_qty'] as $rows) :

			if ($item_group != $rows['item_group'] and $item_group != '' )
            {
				
				$sheet->setCellValue('A' . $row, '');
				$sheet->setCellValue('B' . $row, $principal);
				$sheet->setCellValue('C' . $row, $item_group);
				$sheet->setCellValue('D' . $row, '');
				$sheet->setCellValue('E' . $row, 'Sub Total ' . $item_group);
				$sheet->setCellValue('F' . $row, '');
				$sheet->setCellValue('G' . $row, number_format($qty_jan, 0));
				$sheet->setCellValue('H' . $row, number_format($qty_feb, 0));
				$sheet->setCellValue('I' . $row, number_format($qty_mar, 0));
				$sheet->setCellValue('J' . $row, number_format($qty_apr, 0));
				$sheet->setCellValue('K' . $row, number_format($qty_mei, 0));
				$sheet->setCellValue('L' . $row, number_format($qty_jun, 0));
				$sheet->setCellValue('M' . $row, number_format($qty_jul, 0));
				$sheet->setCellValue('N' . $row, number_format($qty_agu, 0));
				$sheet->setCellValue('O' . $row, number_format($qty_sep, 0));
				$sheet->setCellValue('P' . $row, number_format($qty_okt, 0));
				$sheet->setCellValue('Q' . $row, number_format($qty_nop, 0));
				$sheet->setCellValue('R' . $row, number_format($qty_des, 0));
				$sheet->setCellValue('S' . $row, number_format($qty_year, 0));

				// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
				$sheet->getStyle('A' . $row)->applyFromArray($style_row);
				$sheet->getStyle('B' . $row)->applyFromArray($style_row);
				$sheet->getStyle('C' . $row)->applyFromArray($style_row);
				$sheet->getStyle('D' . $row)->applyFromArray($style_row);
				$sheet->getStyle('E' . $row)->applyFromArray($style_row);
				$sheet->getStyle('F' . $row)->applyFromArray($style_row);
				$sheet->getStyle('G' . $row)->applyFromArray($style_row);
				$sheet->getStyle('H' . $row)->applyFromArray($style_row);
				$sheet->getStyle('I' . $row)->applyFromArray($style_row);
				$sheet->getStyle('J' . $row)->applyFromArray($style_row);
				$sheet->getStyle('K' . $row)->applyFromArray($style_row);
				$sheet->getStyle('L' . $row)->applyFromArray($style_row);
				$sheet->getStyle('M' . $row)->applyFromArray($style_row);
				$sheet->getStyle('N' . $row)->applyFromArray($style_row);
				$sheet->getStyle('O' . $row)->applyFromArray($style_row);
				$sheet->getStyle('P' . $row)->applyFromArray($style_row);
				$sheet->getStyle('Q' . $row)->applyFromArray($style_row);
				$sheet->getStyle('R' . $row)->applyFromArray($style_row);
				$sheet->getStyle('S' . $row)->applyFromArray($style_row);

				$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
				$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
				$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
				$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
				$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
				$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
				$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('I' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('J' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('K' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('L' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('M' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('N' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('O' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('P' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('Q' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('R' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('S' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

				$sheet->getStyle('A' . $row . ':S' . $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');
				$sheet->getStyle('A' . $row . ':S' . $row)->getFont()->setBold(true);

				$qty_jan = 0;
                $qty_feb = 0;
                $qty_mar = 0;
                $qty_apr = 0;
                $qty_mei = 0;
                $qty_jun = 0;
                $qty_jul = 0;
                $qty_agu = 0;
                $qty_sep = 0;
                $qty_okt = 0;
                $qty_nop = 0;
                $qty_des = 0;
                $qty_year = 0;
                $qty_avg = 0;

				$row++;
            }

			if ($principal != $rows['principal'] and $principal != '' )
            {
				
				$sheet->setCellValue('A' . $row, '');
				$sheet->setCellValue('B' . $row, $principal);
				$sheet->setCellValue('C' . $row, '');
				$sheet->setCellValue('D' . $row, '');
				$sheet->setCellValue('E' . $row, 'TOTAL ' . $principal);
				$sheet->setCellValue('F' . $row, '');
				$sheet->setCellValue('G' . $row, number_format($sub_qty_jan, 0));
				$sheet->setCellValue('H' . $row, number_format($sub_qty_feb, 0));
				$sheet->setCellValue('I' . $row, number_format($sub_qty_mar, 0));
				$sheet->setCellValue('J' . $row, number_format($sub_qty_apr, 0));
				$sheet->setCellValue('K' . $row, number_format($sub_qty_mei, 0));
				$sheet->setCellValue('L' . $row, number_format($sub_qty_jun, 0));
				$sheet->setCellValue('M' . $row, number_format($sub_qty_jul, 0));
				$sheet->setCellValue('N' . $row, number_format($sub_qty_agu, 0));
				$sheet->setCellValue('O' . $row, number_format($sub_qty_sep, 0));
				$sheet->setCellValue('P' . $row, number_format($sub_qty_okt, 0));
				$sheet->setCellValue('Q' . $row, number_format($sub_qty_nop, 0));
				$sheet->setCellValue('R' . $row, number_format($sub_qty_des, 0));
				$sheet->setCellValue('S' . $row, number_format($sub_qty_year, 0));

				// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
				$sheet->getStyle('A' . $row)->applyFromArray($style_row);
				$sheet->getStyle('B' . $row)->applyFromArray($style_row);
				$sheet->getStyle('C' . $row)->applyFromArray($style_row);
				$sheet->getStyle('D' . $row)->applyFromArray($style_row);
				$sheet->getStyle('E' . $row)->applyFromArray($style_row);
				$sheet->getStyle('F' . $row)->applyFromArray($style_row);
				$sheet->getStyle('G' . $row)->applyFromArray($style_row);
				$sheet->getStyle('H' . $row)->applyFromArray($style_row);
				$sheet->getStyle('I' . $row)->applyFromArray($style_row);
				$sheet->getStyle('J' . $row)->applyFromArray($style_row);
				$sheet->getStyle('K' . $row)->applyFromArray($style_row);
				$sheet->getStyle('L' . $row)->applyFromArray($style_row);
				$sheet->getStyle('M' . $row)->applyFromArray($style_row);
				$sheet->getStyle('N' . $row)->applyFromArray($style_row);
				$sheet->getStyle('O' . $row)->applyFromArray($style_row);
				$sheet->getStyle('P' . $row)->applyFromArray($style_row);
				$sheet->getStyle('Q' . $row)->applyFromArray($style_row);
				$sheet->getStyle('R' . $row)->applyFromArray($style_row);
				$sheet->getStyle('S' . $row)->applyFromArray($style_row);

				$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
				$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
				$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
				$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
				$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
				$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
				$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('I' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('J' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('K' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('L' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('M' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('N' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('O' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('P' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('Q' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('R' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('S' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

				$sheet->getStyle('A' . $row . ':S' . $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFA07A');
				$sheet->getStyle('A' . $row . ':S' . $row)->getFont()->setBold(true);

				$sub_qty_jan = 0;
				$sub_qty_feb = 0;
				$sub_qty_mar = 0;
				$sub_qty_apr = 0;
				$sub_qty_mei = 0;
				$sub_qty_jun = 0;
				$sub_qty_jul = 0;
				$sub_qty_agu = 0;
				$sub_qty_sep = 0;
				$sub_qty_okt = 0;
				$sub_qty_nop = 0;
				$sub_qty_des = 0;
				$sub_qty_year = 0;
				$sub_qty_avg = 0;

				$row++;
            }

			$sheet->setCellValue('A' . $row, $no);
    		$sheet->setCellValue('B' . $row, $rows['principal']);
			$sheet->setCellValue('C' . $row, $rows['item_group']);
			$sheet->setCellValue('D' . $row, $rows['item_code']);
			$sheet->setCellValue('E' . $row, $rows['item_name']);
			$sheet->setCellValue('F' . $row, $rows['unit']);
			$sheet->setCellValue('G' . $row, number_format($rows['value_jan'], 0));			
			$sheet->setCellValue('H' . $row, number_format($rows['value_feb'], 0));			
			$sheet->setCellValue('I' . $row, number_format($rows['value_mar'], 0));			
			$sheet->setCellValue('J' . $row, number_format($rows['value_apr'], 0));			
			$sheet->setCellValue('K' . $row, number_format($rows['value_mei'], 0));			
			$sheet->setCellValue('L' . $row, number_format($rows['value_jun'], 0));			
			$sheet->setCellValue('M' . $row, number_format($rows['value_jul'], 0));			
			$sheet->setCellValue('N' . $row, number_format($rows['value_agu'], 0));			
			$sheet->setCellValue('O' . $row, number_format($rows['value_sep'], 0));			
			$sheet->setCellValue('P' . $row, number_format($rows['value_okt'], 0));			
			$sheet->setCellValue('Q' . $row, number_format($rows['value_nop'], 0));			
			$sheet->setCellValue('R' . $row, number_format($rows['value_des'], 0));			
			$sheet->setCellValue('S' . $row, number_format($rows['value_total'], 0));

			// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
			$sheet->getStyle('A' . $row)->applyFromArray($style_row);
			$sheet->getStyle('B' . $row)->applyFromArray($style_row);
			$sheet->getStyle('C' . $row)->applyFromArray($style_row);
			$sheet->getStyle('D' . $row)->applyFromArray($style_row);
			$sheet->getStyle('E' . $row)->applyFromArray($style_row);
			$sheet->getStyle('F' . $row)->applyFromArray($style_row);
			$sheet->getStyle('G' . $row)->applyFromArray($style_row);
			$sheet->getStyle('H' . $row)->applyFromArray($style_row);
			$sheet->getStyle('I' . $row)->applyFromArray($style_row);
			$sheet->getStyle('J' . $row)->applyFromArray($style_row);
			$sheet->getStyle('K' . $row)->applyFromArray($style_row);
			$sheet->getStyle('L' . $row)->applyFromArray($style_row);
			$sheet->getStyle('M' . $row)->applyFromArray($style_row);
			$sheet->getStyle('N' . $row)->applyFromArray($style_row);
			$sheet->getStyle('O' . $row)->applyFromArray($style_row);
			$sheet->getStyle('P' . $row)->applyFromArray($style_row);
			$sheet->getStyle('Q' . $row)->applyFromArray($style_row);
			$sheet->getStyle('R' . $row)->applyFromArray($style_row);
			$sheet->getStyle('S' . $row)->applyFromArray($style_row);

			$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('I' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('J' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('K' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('L' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('M' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('N' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('O' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('P' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('Q' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('R' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('S' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

			$item_group = $rows['item_group'];
			$principal = $rows['principal'];

			$qty_jan += $rows['value_jan'];
            $qty_feb += $rows['value_feb'];
            $qty_mar += $rows['value_mar'];
            $qty_apr += $rows['value_apr'];
            $qty_mei += $rows['value_mei'];
            $qty_jun += $rows['value_jun'];
            $qty_jul += $rows['value_jul'];
            $qty_agu += $rows['value_agu'];
            $qty_sep += $rows['value_sep'];
            $qty_okt += $rows['value_okt'];
            $qty_nop += $rows['value_nop'];
            $qty_des += $rows['value_des'];
            $qty_year += $rows['value_total'];

            $sub_qty_jan += $rows['value_jan'];
            $sub_qty_feb += $rows['value_feb'];
            $sub_qty_mar += $rows['value_mar'];
            $sub_qty_apr += $rows['value_apr'];
            $sub_qty_mei += $rows['value_mei'];
            $sub_qty_jun += $rows['value_jun'];
            $sub_qty_jul += $rows['value_jul'];
            $sub_qty_agu += $rows['value_agu'];
            $sub_qty_sep += $rows['value_sep'];
            $sub_qty_okt += $rows['value_okt'];
            $sub_qty_nop += $rows['value_nop'];
            $sub_qty_des += $rows['value_des'];
            $sub_qty_year += $rows['value_total'];

            $total_qty_jan += $rows['value_jan'];
            $total_qty_feb += $rows['value_feb'];
            $total_qty_mar += $rows['value_mar'];
            $total_qty_apr += $rows['value_apr'];
            $total_qty_mei += $rows['value_mei'];
            $total_qty_jun += $rows['value_jun'];
            $total_qty_jul += $rows['value_jul'];
            $total_qty_agu += $rows['value_agu'];
            $total_qty_sep += $rows['value_sep'];
            $total_qty_okt += $rows['value_okt'];
            $total_qty_nop += $rows['value_nop'];
            $total_qty_des += $rows['value_des'];
            $total_qty_year += $rows['value_total'];

			$no++; // Tambah 1 setiap kali looping
    		$row++; // Tambah 1 setiap kali looping
		endforeach;

		//item_group end
		//$row = $row + 1;
		$sheet->setCellValue('A' . $row, '');
		$sheet->setCellValue('B' . $row, $principal);
		$sheet->setCellValue('C' . $row, $item_group);
		$sheet->setCellValue('D' . $row, '');
		$sheet->setCellValue('E' . $row, 'Sub Total ' . $item_group);
		$sheet->setCellValue('F' . $row, '');
		$sheet->setCellValue('G' . $row, number_format($qty_jan, 0));
		$sheet->setCellValue('H' . $row, number_format($qty_feb, 0));
		$sheet->setCellValue('I' . $row, number_format($qty_mar, 0));
		$sheet->setCellValue('J' . $row, number_format($qty_apr, 0));
		$sheet->setCellValue('K' . $row, number_format($qty_mei, 0));
		$sheet->setCellValue('L' . $row, number_format($qty_jun, 0));
		$sheet->setCellValue('M' . $row, number_format($qty_jul, 0));
		$sheet->setCellValue('N' . $row, number_format($qty_agu, 0));
		$sheet->setCellValue('O' . $row, number_format($qty_sep, 0));
		$sheet->setCellValue('P' . $row, number_format($qty_okt, 0));
		$sheet->setCellValue('Q' . $row, number_format($qty_nop, 0));
		$sheet->setCellValue('R' . $row, number_format($qty_des, 0));
		$sheet->setCellValue('S' . $row, number_format($qty_year, 0));

		// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
		$sheet->getStyle('A' . $row)->applyFromArray($style_row);
		$sheet->getStyle('B' . $row)->applyFromArray($style_row);
		$sheet->getStyle('C' . $row)->applyFromArray($style_row);
		$sheet->getStyle('D' . $row)->applyFromArray($style_row);
		$sheet->getStyle('E' . $row)->applyFromArray($style_row);
		$sheet->getStyle('F' . $row)->applyFromArray($style_row);
		$sheet->getStyle('G' . $row)->applyFromArray($style_row);
		$sheet->getStyle('H' . $row)->applyFromArray($style_row);
		$sheet->getStyle('I' . $row)->applyFromArray($style_row);
		$sheet->getStyle('J' . $row)->applyFromArray($style_row);
		$sheet->getStyle('K' . $row)->applyFromArray($style_row);
		$sheet->getStyle('L' . $row)->applyFromArray($style_row);
		$sheet->getStyle('M' . $row)->applyFromArray($style_row);
		$sheet->getStyle('N' . $row)->applyFromArray($style_row);
		$sheet->getStyle('O' . $row)->applyFromArray($style_row);
		$sheet->getStyle('P' . $row)->applyFromArray($style_row);
		$sheet->getStyle('Q' . $row)->applyFromArray($style_row);
		$sheet->getStyle('R' . $row)->applyFromArray($style_row);
		$sheet->getStyle('S' . $row)->applyFromArray($style_row);

		$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('I' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('J' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('K' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('L' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('M' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('N' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('O' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('P' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('Q' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('R' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('S' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

		$sheet->getStyle('A' . $row . ':S' . $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');
		$sheet->getStyle('A' . $row . ':S' . $row)->getFont()->setBold(true);

		//principal end
		$row = $row + 1;
		$sheet->setCellValue('A' . $row, '');
		$sheet->setCellValue('B' . $row, $principal);
		$sheet->setCellValue('C' . $row, '');
		$sheet->setCellValue('D' . $row, '');
		$sheet->setCellValue('E' . $row, 'TOTAL ' . $principal);
		$sheet->setCellValue('F' . $row, '');
		$sheet->setCellValue('G' . $row, number_format($sub_qty_jan, 0));
		$sheet->setCellValue('H' . $row, number_format($sub_qty_feb, 0));
		$sheet->setCellValue('I' . $row, number_format($sub_qty_mar, 0));
		$sheet->setCellValue('J' . $row, number_format($sub_qty_apr, 0));
		$sheet->setCellValue('K' . $row, number_format($sub_qty_mei, 0));
		$sheet->setCellValue('L' . $row, number_format($sub_qty_jun, 0));
		$sheet->setCellValue('M' . $row, number_format($sub_qty_jul, 0));
		$sheet->setCellValue('N' . $row, number_format($sub_qty_agu, 0));
		$sheet->setCellValue('O' . $row, number_format($sub_qty_sep, 0));
		$sheet->setCellValue('P' . $row, number_format($sub_qty_okt, 0));
		$sheet->setCellValue('Q' . $row, number_format($sub_qty_nop, 0));
		$sheet->setCellValue('R' . $row, number_format($sub_qty_des, 0));
		$sheet->setCellValue('S' . $row, number_format($sub_qty_year, 0));

		// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
		$sheet->getStyle('A' . $row)->applyFromArray($style_row);
		$sheet->getStyle('B' . $row)->applyFromArray($style_row);
		$sheet->getStyle('C' . $row)->applyFromArray($style_row);
		$sheet->getStyle('D' . $row)->applyFromArray($style_row);
		$sheet->getStyle('E' . $row)->applyFromArray($style_row);
		$sheet->getStyle('F' . $row)->applyFromArray($style_row);
		$sheet->getStyle('G' . $row)->applyFromArray($style_row);
		$sheet->getStyle('H' . $row)->applyFromArray($style_row);
		$sheet->getStyle('I' . $row)->applyFromArray($style_row);
		$sheet->getStyle('J' . $row)->applyFromArray($style_row);
		$sheet->getStyle('K' . $row)->applyFromArray($style_row);
		$sheet->getStyle('L' . $row)->applyFromArray($style_row);
		$sheet->getStyle('M' . $row)->applyFromArray($style_row);
		$sheet->getStyle('N' . $row)->applyFromArray($style_row);
		$sheet->getStyle('O' . $row)->applyFromArray($style_row);
		$sheet->getStyle('P' . $row)->applyFromArray($style_row);
		$sheet->getStyle('Q' . $row)->applyFromArray($style_row);
		$sheet->getStyle('R' . $row)->applyFromArray($style_row);
		$sheet->getStyle('S' . $row)->applyFromArray($style_row);

		$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('I' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('J' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('K' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('L' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('M' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('N' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('O' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('P' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('Q' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('R' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('S' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

		$sheet->getStyle('A' . $row . ':S' . $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFA07A');
		$sheet->getStyle('A' . $row . ':S' . $row)->getFont()->setBold(true);

		//grand total
		$row = $row + 1;
		$sheet->setCellValue('A' . $row, '');
		$sheet->setCellValue('B' . $row, '');
		$sheet->setCellValue('C' . $row, '');
		$sheet->setCellValue('D' . $row, '');
		$sheet->setCellValue('E' . $row, 'GRAND TOTAL');
		$sheet->setCellValue('F' . $row, '');
		$sheet->setCellValue('G' . $row, number_format($total_qty_jan, 0));
		$sheet->setCellValue('H' . $row, number_format($total_qty_feb, 0));
		$sheet->setCellValue('I' . $row, number_format($total_qty_mar, 0));
		$sheet->setCellValue('J' . $row, number_format($total_qty_apr, 0));
		$sheet->setCellValue('K' . $row, number_format($total_qty_mei, 0));
		$sheet->setCellValue('L' . $row, number_format($total_qty_jun, 0));
		$sheet->setCellValue('M' . $row, number_format($total_qty_jul, 0));
		$sheet->setCellValue('N' . $row, number_format($total_qty_agu, 0));
		$sheet->setCellValue('O' . $row, number_format($total_qty_sep, 0));
		$sheet->setCellValue('P' . $row, number_format($total_qty_okt, 0));
		$sheet->setCellValue('Q' . $row, number_format($total_qty_nop, 0));
		$sheet->setCellValue('R' . $row, number_format($total_qty_des, 0));
		$sheet->setCellValue('S' . $row, number_format($total_qty_year, 0));

		// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
		$sheet->getStyle('A' . $row)->applyFromArray($style_row);
		$sheet->getStyle('B' . $row)->applyFromArray($style_row);
		$sheet->getStyle('C' . $row)->applyFromArray($style_row);
		$sheet->getStyle('D' . $row)->applyFromArray($style_row);
		$sheet->getStyle('E' . $row)->applyFromArray($style_row);
		$sheet->getStyle('F' . $row)->applyFromArray($style_row);
		$sheet->getStyle('G' . $row)->applyFromArray($style_row);
		$sheet->getStyle('H' . $row)->applyFromArray($style_row);
		$sheet->getStyle('I' . $row)->applyFromArray($style_row);
		$sheet->getStyle('J' . $row)->applyFromArray($style_row);
		$sheet->getStyle('K' . $row)->applyFromArray($style_row);
		$sheet->getStyle('L' . $row)->applyFromArray($style_row);
		$sheet->getStyle('M' . $row)->applyFromArray($style_row);
		$sheet->getStyle('N' . $row)->applyFromArray($style_row);
		$sheet->getStyle('O' . $row)->applyFromArray($style_row);
		$sheet->getStyle('P' . $row)->applyFromArray($style_row);
		$sheet->getStyle('Q' . $row)->applyFromArray($style_row);
		$sheet->getStyle('R' . $row)->applyFromArray($style_row);
		$sheet->getStyle('S' . $row)->applyFromArray($style_row);

		$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('I' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('J' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('K' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('L' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('M' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('N' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('O' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('P' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('Q' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('R' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('S' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

		$sheet->getStyle('A' . $row . ':S' . $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFA07A');
		$sheet->getStyle('A' . $row . ':S' . $row)->getFont()->setBold(true);


		//set columns width
		$sheet->getColumnDimension('A')->setWidth(5); 
		$sheet->getColumnDimension('B')->setWidth(11); 
		$sheet->getColumnDimension('C')->setWidth(22);
		$sheet->getColumnDimension('D')->setWidth(12);
		$sheet->getColumnDimension('E')->setWidth(53);
		$sheet->getColumnDimension('F')->setWidth(6);
		$sheet->getColumnDimension('G')->setWidth(20);
		$sheet->getColumnDimension('H')->setWidth(20);
		$sheet->getColumnDimension('I')->setWidth(20);
		$sheet->getColumnDimension('J')->setWidth(20);
		$sheet->getColumnDimension('K')->setWidth(20);
		$sheet->getColumnDimension('L')->setWidth(20);
		$sheet->getColumnDimension('M')->setWidth(20);
		$sheet->getColumnDimension('N')->setWidth(20);
		$sheet->getColumnDimension('O')->setWidth(20);
		$sheet->getColumnDimension('P')->setWidth(20);
		$sheet->getColumnDimension('Q')->setWidth(20);
		$sheet->getColumnDimension('R')->setWidth(20);
		$sheet->getColumnDimension('S')->setWidth(20);
		

		// Set orientasi kertas jadi LANDSCAPE
		$sheet->getPageSetup()->setOrientation(\PhpOffice\PhpSpreadsheet\Worksheet\PageSetup::ORIENTATION_LANDSCAPE);
		// Set judul file excel nya
		$sheet->setTitle("Selling Out - Value");
		// Proses file excel
		header('Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet');
		header('Content-Disposition: attachment; filename="Report Selling Out - Value ("' . $year . '").xlsx"'); // Set nama file excel nya
		header('Cache-Control: max-age=0');

		$writer = new Xlsx($spreadsheet);
		$writer->save('php://output');

	}

	public function export_sellingout_growth_channel()
	{
		$spreadsheet = new Spreadsheet();
		$sheet = $spreadsheet->getActiveSheet();
		// Buat sebuah variabel untuk menampung pengaturan style dari header tabel
		$style_col = [
			'font' => ['bold' => true], // Set font nya jadi bold
			'alignment' => [
				'horizontal' => \PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER, // Set text jadi ditengah secara horizontal (center)
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'top' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border top dengan garis tipis
				'right' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN],  // Set border right dengan garis tipis
				'bottom' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border bottom dengan garis tipis
				'left' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN] // Set border left dengan garis tipis
			]
		];
		// Buat sebuah variabel untuk menampung pengaturan style dari isi tabel
		$style_row = [
			'alignment' => [
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'top' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border top dengan garis tipis
				'right' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN],  // Set border right dengan garis tipis
				'bottom' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border bottom dengan garis tipis
				'left' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN] // Set border left dengan garis tipis
			]
		];

		if (isset($_POST['by_area']))
		{
			$area = implode(',', $_POST['by_area']);
			$area = str_replace(",", "','", $area);;
		}
		else
		{
			$area = "";
		}

		if (isset($_POST['by_year']))
		{
			$year = $_POST['by_year'];
		}
		else
		{
			$year = "";
		}

		$year_to = $year;
		$year_from = $year_to - 1;

		$sheet->setCellValue('A1', "Report Selling Out - Growth By Channel (" . $year . ")"); // Set kolom A1 dengan tulisan 
		$sheet->setCellValue('A2', "Area : " . $area); 
		//$sheet->mergeCells('A1:F1'); // Set Merge Cell pada kolom A1 sampai F1
		$sheet->getStyle('A1')->getFont()->setBold(true); // Set bold kolom A1
		$sheet->getStyle('A2')->getFont()->setBold(true);
		$sheet->getStyle('A1')->getFont()->setSize(20); // Set font size 20 untuk kolom A1
		// Buat header tabel nya pada baris ke 4
		$sheet->setCellValue('A4', "#"); // Set kolom A4 dengan tulisan "#"
		$sheet->mergeCells('A4:A5');
		$sheet->setCellValue('B4', "Outlet Type");
		$sheet->mergeCells('B4:B5');
		$sheet->setCellValue('C4', "Full Year"); 
		$sheet->mergeCells('C4:E4');
		$sheet->setCellValue('F4', "SKU Existing"); 
		$sheet->mergeCells('F4:H4');
		$sheet->setCellValue('I4', "Add SKU"); 
		$sheet->mergeCells('I4:J4');
		$sheet->setCellValue('K4', "NOO"); 
		$sheet->mergeCells('K4:L4');

		$sheet->setCellValue('C5', $year_from);
		$sheet->setCellValue('D5', $year_to);
		$sheet->setCellValue('E5', "Growth %");
		$sheet->setCellValue('F5', $year_from);
		$sheet->setCellValue('G5', $year_to);
		$sheet->setCellValue('H5', "Growth %");
		$sheet->setCellValue('I5', "Value");
		$sheet->setCellValue('J5', "Contr %");
		$sheet->setCellValue('K5', "Value");
		$sheet->setCellValue('L5', "Contr %");
		
		

		// Apply style header yang telah kita buat tadi ke masing-masing kolom header
		$sheet->getStyle('A4')->applyFromArray($style_col);
		$sheet->getStyle('B4')->applyFromArray($style_col);
		$sheet->getStyle('C4')->applyFromArray($style_col);
		$sheet->getStyle('D4')->applyFromArray($style_col);
		$sheet->getStyle('E4')->applyFromArray($style_col);
		$sheet->getStyle('F4')->applyFromArray($style_col);
		$sheet->getStyle('G4')->applyFromArray($style_col);
		$sheet->getStyle('H4')->applyFromArray($style_col);
		$sheet->getStyle('I4')->applyFromArray($style_col);
		$sheet->getStyle('J4')->applyFromArray($style_col);
		$sheet->getStyle('K4')->applyFromArray($style_col);
		$sheet->getStyle('L4')->applyFromArray($style_col);

		$sheet->getStyle('A5')->applyFromArray($style_col);
		$sheet->getStyle('B5')->applyFromArray($style_col);
		$sheet->getStyle('C5')->applyFromArray($style_col);
		$sheet->getStyle('D5')->applyFromArray($style_col);
		$sheet->getStyle('E5')->applyFromArray($style_col);
		$sheet->getStyle('F5')->applyFromArray($style_col);
		$sheet->getStyle('G5')->applyFromArray($style_col);
		$sheet->getStyle('H5')->applyFromArray($style_col);
		$sheet->getStyle('I5')->applyFromArray($style_col);
		$sheet->getStyle('J5')->applyFromArray($style_col);
		$sheet->getStyle('K5')->applyFromArray($style_col);
		$sheet->getStyle('L5')->applyFromArray($style_col);

		$sheet->getStyle('A4:L5')->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');
		// $sheet->getStyle('S6')->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFA07A');

		// Set height baris ke 1 dan 2
		$sheet->getRowDimension('1')->setRowHeight(40);
		$sheet->getRowDimension('2')->setRowHeight(20);


		$channel = '';
		$outlet_category = '';

		$sub_value_from = 0;
		$sub_value_to = 0;
		$sub_value_exist = 0;
		$sub_value_add_sku = 0;
		$sub_value_noo = 0;

		$total_value_from = 0;
		$total_value_to = 0;
		$total_value_exist = 0;
		$total_value_add_sku = 0;
		$total_value_noo = 0;

		$total_from = 0;
		$total_to = 0;
		$total_exist = 0;
		$total_add_sku = 0;
		$total_noo = 0;


		$no = 1; // Untuk penomoran tabel, di awal set dengan 1
		$row = 6;

		// $data1 = array(
		// 	'island' => $island,
		// 	'region' => $region,
		// 	'area' => $area,
		// 	'year' => $year
		// );

		$data['so_growth_channel'] = $this->model('ReportModel')->getSellingOut_Growth_Channel2();

		foreach ($data['so_growth_channel'] as $row2):

			$total_from += $row2['value_from'];
			$total_to += $row2['value_to'];
			$total_exist += $row2['value_exist'];
			$total_add_sku += $row2['value_add_sku'];
			$total_noo += $row2['value_noo'];

		endforeach;

		foreach ($data['so_growth_channel'] as $rows) :

			if ($channel != $rows['channel'] and $channel != '' )
            {
				
				$sheet->setCellValue('A' . $row, '');
				$sheet->setCellValue('B' . $row, $channel);
				$sheet->setCellValue('C' . $row, $sub_value_from);
				$sheet->setCellValue('D' . $row, $sub_value_to);
				if($sub_value_from == 0 or $sub_value_to == 0)
				{
					$sub_growth_year = 0;
				}
				else
				{
					$sub_growth_year = (($sub_value_to/$sub_value_from) - 1)*100;
				}
				$sheet->setCellValue('E' . $row, $sub_growth_year);
				$sheet->setCellValue('F' . $row, $sub_value_from);
				$sheet->setCellValue('G' . $row, $sub_value_exist);
				if($sub_value_from == 0 or $sub_value_exist == 0)
				{
					$sub_growth_exist = 0;
				}
				else
				{
					$sub_growth_exist = (($sub_value_exist/$sub_value_from) - 1)*100;
				}
				$sheet->setCellValue('H' . $row, $sub_growth_exist);
				$sheet->setCellValue('I' . $row, $sub_value_add_sku);
				if($sub_value_from == 0 or $sub_value_add_sku == 0)
				{
					$sub_growth_add_sku = 0;
				}
				else
				{
					$sub_growth_add_sku = ($sub_value_add_sku/$total_add_sku)*100;
				}
				$sheet->setCellValue('J' . $row, $sub_growth_add_sku);
				$sheet->setCellValue('K' . $row, $sub_value_noo);
				if($sub_value_from == 0 or $sub_value_noo == 0)
				{
					$sub_growth_noo = 0;
				}
				else
				{
					$sub_growth_noo = ($sub_value_noo/$total_noo)*100;
				}
				$sheet->setCellValue('L' . $row, $sub_growth_noo);

				// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
				$sheet->getStyle('A' . $row)->applyFromArray($style_row);
				$sheet->getStyle('B' . $row)->applyFromArray($style_row);
				$sheet->getStyle('C' . $row)->applyFromArray($style_row);
				$sheet->getStyle('D' . $row)->applyFromArray($style_row);
				$sheet->getStyle('E' . $row)->applyFromArray($style_row);
				$sheet->getStyle('F' . $row)->applyFromArray($style_row);
				$sheet->getStyle('G' . $row)->applyFromArray($style_row);
				$sheet->getStyle('H' . $row)->applyFromArray($style_row);
				$sheet->getStyle('I' . $row)->applyFromArray($style_row);
				$sheet->getStyle('J' . $row)->applyFromArray($style_row);
				$sheet->getStyle('K' . $row)->applyFromArray($style_row);
				$sheet->getStyle('L' . $row)->applyFromArray($style_row);

				$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
				$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
				$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('I' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('J' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('K' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('L' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

				$sheet->getStyle('C' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('D' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('E' . $row)->getNumberFormat()->setFormatCode('#,##0.##');
				$sheet->getStyle('F' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('G' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('H' . $row)->getNumberFormat()->setFormatCode('#,##0.##');
				$sheet->getStyle('I' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('J' . $row)->getNumberFormat()->setFormatCode('#,##0.##');
				$sheet->getStyle('K' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('L' . $row)->getNumberFormat()->setFormatCode('#,##0.##');

				$sheet->getStyle('A' . $row . ':L' . $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');
				$sheet->getStyle('A' . $row . ':L' . $row)->getFont()->setBold(true);

				$sub_value_from = 0;
				$sub_value_to = 0;
				$sub_value_exist = 0;
				$sub_value_add_sku = 0;
				$sub_value_noo = 0;

				$row++;
            }

			$sheet->setCellValue('A' . $row, $no);
    		$sheet->setCellValue('B' . $row, $rows['outlet_category']);
			$sheet->setCellValue('C' . $row, $rows['value_from']);
			$sheet->setCellValue('D' . $row, $rows['value_to']);
			if($rows['value_from'] == 0 or $rows['value_to'] == 0)
			{
				$growth_year = 0;
			}
			else
			{
				$growth_year = (($rows['value_to']/$rows['value_from']) - 1)*100;
			}
			$sheet->setCellValue('E' . $row, $growth_year);
			$sheet->setCellValue('F' . $row, $rows['value_from']);
			$sheet->setCellValue('G' . $row, $rows['value_exist']);
			if($rows['value_from'] == 0 or $rows['value_exist'] == 0)
			{
				$growth_exist = 0;
			}
			else
			{
				$growth_exist = (($rows['value_exist']/$rows['value_from']) - 1)*100;
			}			
			$sheet->setCellValue('H' . $row, $growth_exist);			
			$sheet->setCellValue('I' . $row, $rows['value_add_sku']);	
			if($rows['value_from'] == 0 or $rows['value_add_sku'] == 0)
			{
				$growth_add_sku = 0;
			}
			else
			{
				$growth_add_sku = ($rows['value_add_sku']/$total_add_sku)*100;
			}		
			$sheet->setCellValue('J' . $row, $growth_add_sku);			
			$sheet->setCellValue('K' . $row, $rows['value_noo']);	
			if($rows['value_from'] == 0 or $rows['value_noo'] == 0)
			{
				$growth_noo = 0;
			}
			else
			{
				$growth_noo = ($rows['value_noo']/$total_noo)*100;
			}		
			$sheet->setCellValue('L' . $row, $growth_noo);			
			
			// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
			$sheet->getStyle('A' . $row)->applyFromArray($style_row);
			$sheet->getStyle('B' . $row)->applyFromArray($style_row);
			$sheet->getStyle('C' . $row)->applyFromArray($style_row);
			$sheet->getStyle('D' . $row)->applyFromArray($style_row);
			$sheet->getStyle('E' . $row)->applyFromArray($style_row);
			$sheet->getStyle('F' . $row)->applyFromArray($style_row);
			$sheet->getStyle('G' . $row)->applyFromArray($style_row);
			$sheet->getStyle('H' . $row)->applyFromArray($style_row);
			$sheet->getStyle('I' . $row)->applyFromArray($style_row);
			$sheet->getStyle('J' . $row)->applyFromArray($style_row);
			$sheet->getStyle('K' . $row)->applyFromArray($style_row);
			$sheet->getStyle('L' . $row)->applyFromArray($style_row);
			
			$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('I' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('J' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('K' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('L' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

			$sheet->getStyle('C' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('D' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('E' . $row)->getNumberFormat()->setFormatCode('#,##0.##');
			$sheet->getStyle('F' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('G' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('H' . $row)->getNumberFormat()->setFormatCode('#,##0.##');
			$sheet->getStyle('I' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('J' . $row)->getNumberFormat()->setFormatCode('#,##0.##');
			$sheet->getStyle('K' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('L' . $row)->getNumberFormat()->setFormatCode('#,##0.##');

			$channel = $rows['channel'];

			$sub_value_from += $rows['value_from'];
			$sub_value_to += $rows['value_to'];
			$sub_value_exist += $rows['value_exist'];
			$sub_value_add_sku += $rows['value_add_sku'];
			$sub_value_noo += $rows['value_noo'];

			$total_value_from += $rows['value_from'];
			$total_value_to += $rows['value_to'];
			$total_value_exist += $rows['value_exist'];
			$total_value_add_sku += $rows['value_add_sku'];
			$total_value_noo += $rows['value_noo'];

			$no++; // Tambah 1 setiap kali looping
    		$row++; // Tambah 1 setiap kali looping
		endforeach;

		//channel end
		//$row = $row + 1;
		$sheet->setCellValue('A' . $row, '');
		$sheet->setCellValue('B' . $row, $channel);
		$sheet->setCellValue('C' . $row, $sub_value_from);
		$sheet->setCellValue('D' . $row, $sub_value_to);
		if($sub_value_from == 0 or $sub_value_to == 0)
		{
			$sub_growth_year = 0;
		}
		else
		{
			$sub_growth_year = (($sub_value_to/$sub_value_from) - 1)*100;
		}
		$sheet->setCellValue('E' . $row, $sub_growth_year);
		$sheet->setCellValue('F' . $row, $sub_value_from);
		$sheet->setCellValue('G' . $row, $sub_value_exist);
		if($sub_value_from == 0 or $sub_value_exist == 0)
		{
			$sub_growth_exist = 0;
		}
		else
		{
			$sub_growth_exist = (($sub_value_exist/$sub_value_from) - 1)*100;
		}
		$sheet->setCellValue('H' . $row, $sub_growth_exist);
		$sheet->setCellValue('I' . $row, $sub_value_add_sku);
		if($sub_value_from == 0 or $sub_value_add_sku == 0)
		{
			$sub_growth_add_sku = 0;
		}
		else
		{
			$sub_growth_add_sku = ($sub_value_add_sku/$total_add_sku)*100;
		}
		$sheet->setCellValue('J' . $row, $sub_growth_add_sku);
		$sheet->setCellValue('K' . $row, $sub_value_noo);
		if($sub_value_from == 0 or $sub_value_noo == 0)
		{
			$sub_growth_noo = 0;
		}
		else
		{
			$sub_growth_noo = ($sub_value_noo/$total_noo)*100;
		}
		$sheet->setCellValue('L' . $row, $sub_growth_noo);

		// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
		$sheet->getStyle('A' . $row)->applyFromArray($style_row);
		$sheet->getStyle('B' . $row)->applyFromArray($style_row);
		$sheet->getStyle('C' . $row)->applyFromArray($style_row);
		$sheet->getStyle('D' . $row)->applyFromArray($style_row);
		$sheet->getStyle('E' . $row)->applyFromArray($style_row);
		$sheet->getStyle('F' . $row)->applyFromArray($style_row);
		$sheet->getStyle('G' . $row)->applyFromArray($style_row);
		$sheet->getStyle('H' . $row)->applyFromArray($style_row);
		$sheet->getStyle('I' . $row)->applyFromArray($style_row);
		$sheet->getStyle('J' . $row)->applyFromArray($style_row);
		$sheet->getStyle('K' . $row)->applyFromArray($style_row);
		$sheet->getStyle('L' . $row)->applyFromArray($style_row);
		
		$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('I' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('J' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('K' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('L' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

		$sheet->getStyle('C' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('D' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('E' . $row)->getNumberFormat()->setFormatCode('#,##0.##');
		$sheet->getStyle('F' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('G' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('H' . $row)->getNumberFormat()->setFormatCode('#,##0.##');
		$sheet->getStyle('I' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('J' . $row)->getNumberFormat()->setFormatCode('#,##0.##');
		$sheet->getStyle('K' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('L' . $row)->getNumberFormat()->setFormatCode('#,##0.##');

		$sheet->getStyle('A' . $row . ':L' . $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');
		$sheet->getStyle('A' . $row . ':L' . $row)->getFont()->setBold(true);

		//grand total
		$row = $row + 1;
		$sheet->setCellValue('A' . $row, '');
		$sheet->setCellValue('B' . $row, 'GRAND TOTAL');
		$sheet->setCellValue('C' . $row, $total_value_from);
		$sheet->setCellValue('D' . $row, $total_value_to);
		if($total_value_from == 0 or $total_value_to == 0)
		{
			$total_growth_year = 0;
		}
		else
		{
			$total_growth_year = (($total_value_to/$total_value_from) - 1)*100;
		}
		$sheet->setCellValue('E' . $row, $total_growth_year);
		$sheet->setCellValue('F' . $row, $total_value_from);
		$sheet->setCellValue('G' . $row, $total_value_exist);
		if($total_value_from == 0 or $total_value_exist == 0)
		{
			$total_growth_exist = 0;
		}
		else
		{
			$total_growth_exist = (($total_value_exist/$total_value_from) - 1)*100;
		}
		$sheet->setCellValue('H' . $row, $total_growth_exist);
		$sheet->setCellValue('I' . $row, $total_value_add_sku);
		if($total_value_from == 0 or $total_value_add_sku == 0)
		{
			$total_growth_add_sku = 0;
		}
		else
		{
			$total_growth_add_sku = ($total_value_add_sku/$total_value_to)*100;
		}
		$sheet->setCellValue('J' . $row, $total_growth_add_sku);
		$sheet->setCellValue('K' . $row, $total_value_noo);
		if($total_value_from == 0 or $total_value_noo == 0)
		{
			$total_growth_noo = 0;
		}
		else
		{
			$total_growth_noo = ($total_value_noo/$total_value_to)*100;
		}
		$sheet->setCellValue('L' . $row, $total_growth_noo);

		// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
		$sheet->getStyle('A' . $row)->applyFromArray($style_row);
		$sheet->getStyle('B' . $row)->applyFromArray($style_row);
		$sheet->getStyle('C' . $row)->applyFromArray($style_row);
		$sheet->getStyle('D' . $row)->applyFromArray($style_row);
		$sheet->getStyle('E' . $row)->applyFromArray($style_row);
		$sheet->getStyle('F' . $row)->applyFromArray($style_row);
		$sheet->getStyle('G' . $row)->applyFromArray($style_row);
		$sheet->getStyle('H' . $row)->applyFromArray($style_row);
		$sheet->getStyle('I' . $row)->applyFromArray($style_row);
		$sheet->getStyle('J' . $row)->applyFromArray($style_row);
		$sheet->getStyle('K' . $row)->applyFromArray($style_row);
		$sheet->getStyle('L' . $row)->applyFromArray($style_row);

		$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('I' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('J' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('K' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('L' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

		$sheet->getStyle('C' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('D' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('E' . $row)->getNumberFormat()->setFormatCode('#,##0.##');
		$sheet->getStyle('F' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('G' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('H' . $row)->getNumberFormat()->setFormatCode('#,##0.##');
		$sheet->getStyle('I' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('J' . $row)->getNumberFormat()->setFormatCode('#,##0.##');
		$sheet->getStyle('K' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('L' . $row)->getNumberFormat()->setFormatCode('#,##0.##');

		$sheet->getStyle('A' . $row . ':L' . $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFA07A');
		$sheet->getStyle('A' . $row . ':L' . $row)->getFont()->setBold(true);


		//set columns width
		$sheet->getColumnDimension('A')->setWidth(5); 
		$sheet->getColumnDimension('B')->setWidth(35); 
		$sheet->getColumnDimension('C')->setWidth(18);
		$sheet->getColumnDimension('D')->setWidth(18);
		$sheet->getColumnDimension('E')->setWidth(12);
		$sheet->getColumnDimension('F')->setWidth(18);
		$sheet->getColumnDimension('G')->setWidth(18);
		$sheet->getColumnDimension('H')->setWidth(12);
		$sheet->getColumnDimension('I')->setWidth(18);
		$sheet->getColumnDimension('J')->setWidth(12);
		$sheet->getColumnDimension('K')->setWidth(18);
		$sheet->getColumnDimension('L')->setWidth(12);
		

		// Set orientasi kertas jadi LANDSCAPE
		$sheet->getPageSetup()->setOrientation(\PhpOffice\PhpSpreadsheet\Worksheet\PageSetup::ORIENTATION_LANDSCAPE);
		// Set judul file excel nya
		$sheet->setTitle("Selling Out - Growth By Channel");
		// Proses file excel
		header('Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet');
		header('Content-Disposition: attachment; filename="Report Selling Out - Growth By Channel ("' . $year . '").xlsx"'); // Set nama file excel nya
		header('Cache-Control: max-age=0');

		$writer = new Xlsx($spreadsheet);
		$writer->save('php://output');

	}

	public function export_sellingout_growth_outlet_type()
	{
		$spreadsheet = new Spreadsheet();
		$sheet = $spreadsheet->getActiveSheet();
		// Buat sebuah variabel untuk menampung pengaturan style dari header tabel
		$style_col = [
			'font' => ['bold' => true], // Set font nya jadi bold
			'alignment' => [
				'horizontal' => \PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER, // Set text jadi ditengah secara horizontal (center)
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'top' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border top dengan garis tipis
				'right' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN],  // Set border right dengan garis tipis
				'bottom' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border bottom dengan garis tipis
				'left' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN] // Set border left dengan garis tipis
			]
		];
		// Buat sebuah variabel untuk menampung pengaturan style dari isi tabel
		$style_row = [
			'alignment' => [
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'top' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border top dengan garis tipis
				'right' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN],  // Set border right dengan garis tipis
				'bottom' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border bottom dengan garis tipis
				'left' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN] // Set border left dengan garis tipis
			]
		];

		if (isset($_POST['by_area']))
		{
			$area = implode(',', $_POST['by_area']);
			$area = str_replace(",", "','", $area);;
		}
		else
		{
			$area = "";
		}

		if (isset($_POST['by_year']))
		{
			$year = $_POST['by_year'];
		}
		else
		{
			$year = "";
		}

		$year_to = $year;
		$year_from = $year_to - 1;

		$sheet->setCellValue('A1', "Report Selling Out - Growth By Outlet Type (" . $year . ")"); // Set kolom A1 dengan tulisan 
		$sheet->setCellValue('A2', "Area : " . $area); 
		//$sheet->mergeCells('A1:F1'); // Set Merge Cell pada kolom A1 sampai F1
		$sheet->getStyle('A1')->getFont()->setBold(true); // Set bold kolom A1
		$sheet->getStyle('A2')->getFont()->setBold(true);
		$sheet->getStyle('A1')->getFont()->setSize(20); // Set font size 20 untuk kolom A1
		// Buat header tabel nya pada baris ke 4
		$sheet->setCellValue('A4', "#"); // Set kolom A4 dengan tulisan "#"
		$sheet->mergeCells('A4:A5');
		$sheet->setCellValue('B4', "Outlet Type");
		$sheet->mergeCells('B4:B5');
		$sheet->setCellValue('C4', "Code");
		$sheet->mergeCells('C4:C5');
		$sheet->setCellValue('D4', "Full Year"); 
		$sheet->mergeCells('D4:F4');
		$sheet->setCellValue('G4', "SKU Existing"); 
		$sheet->mergeCells('G4:I4');
		$sheet->setCellValue('J4', "Add SKU"); 
		$sheet->mergeCells('J4:K4');
		$sheet->setCellValue('L4', "NOO"); 
		$sheet->mergeCells('L4:M4');

		$sheet->setCellValue('D5', $year_from);
		$sheet->setCellValue('E5', $year_to);
		$sheet->setCellValue('F5', "Growth %");
		$sheet->setCellValue('G5', $year_from);
		$sheet->setCellValue('H5', $year_to);
		$sheet->setCellValue('I5', "Growth %");
		$sheet->setCellValue('J5', "Value");
		$sheet->setCellValue('K5', "Contr %");
		$sheet->setCellValue('L5', "Value");
		$sheet->setCellValue('M5', "Contr %");
		
		

		// Apply style header yang telah kita buat tadi ke masing-masing kolom header
		$sheet->getStyle('A4')->applyFromArray($style_col);
		$sheet->getStyle('B4')->applyFromArray($style_col);
		$sheet->getStyle('C4')->applyFromArray($style_col);
		$sheet->getStyle('D4')->applyFromArray($style_col);
		$sheet->getStyle('E4')->applyFromArray($style_col);
		$sheet->getStyle('F4')->applyFromArray($style_col);
		$sheet->getStyle('G4')->applyFromArray($style_col);
		$sheet->getStyle('H4')->applyFromArray($style_col);
		$sheet->getStyle('I4')->applyFromArray($style_col);
		$sheet->getStyle('J4')->applyFromArray($style_col);
		$sheet->getStyle('K4')->applyFromArray($style_col);
		$sheet->getStyle('L4')->applyFromArray($style_col);
		$sheet->getStyle('M4')->applyFromArray($style_col);

		$sheet->getStyle('A5')->applyFromArray($style_col);
		$sheet->getStyle('B5')->applyFromArray($style_col);
		$sheet->getStyle('C5')->applyFromArray($style_col);
		$sheet->getStyle('D5')->applyFromArray($style_col);
		$sheet->getStyle('E5')->applyFromArray($style_col);
		$sheet->getStyle('F5')->applyFromArray($style_col);
		$sheet->getStyle('G5')->applyFromArray($style_col);
		$sheet->getStyle('H5')->applyFromArray($style_col);
		$sheet->getStyle('I5')->applyFromArray($style_col);
		$sheet->getStyle('J5')->applyFromArray($style_col);
		$sheet->getStyle('K5')->applyFromArray($style_col);
		$sheet->getStyle('L5')->applyFromArray($style_col);
		$sheet->getStyle('M5')->applyFromArray($style_col);

		$sheet->getStyle('A4:M5')->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');
		// $sheet->getStyle('S6')->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFA07A');

		// Set height baris ke 1 dan 2
		$sheet->getRowDimension('1')->setRowHeight(40);
		$sheet->getRowDimension('2')->setRowHeight(20);


		$channel = '';
		$outlet_type = '';

		$sub_value_from = 0;
		$sub_value_to = 0;
		$sub_value_exist = 0;
		$sub_value_add_sku = 0;
		$sub_value_noo = 0;

		$total_value_from = 0;
		$total_value_to = 0;
		$total_value_exist = 0;
		$total_value_add_sku = 0;
		$total_value_noo = 0;

		$total_from = 0;
		$total_to = 0;
		$total_exist = 0;
		$total_add_sku = 0;
		$total_noo = 0;


		$no = 1; // Untuk penomoran tabel, di awal set dengan 1
		$row = 6;

		// $data1 = array(
		// 	'island' => $island,
		// 	'region' => $region,
		// 	'area' => $area,
		// 	'year' => $year
		// );

		$data['so_growth_outlet_type'] = $this->model('ReportModel')->getSellingOut_Growth_Outlet_Type();

		foreach ($data['so_growth_outlet_type'] as $row2):

			$total_from += $row2['value_from'];
			$total_to += $row2['value_to'];
			$total_exist += $row2['value_exist'];
			$total_add_sku += $row2['value_add_sku'];
			$total_noo += $row2['value_noo'];

		endforeach;

		foreach ($data['so_growth_outlet_type'] as $rows) :

			if ($channel != $rows['channel'] and $channel != '' )
            {
				
				$sheet->setCellValue('A' . $row, '');
				$sheet->setCellValue('B' . $row, $channel);
				$sheet->setCellValue('C' . $row, '');
				$sheet->setCellValue('D' . $row, $sub_value_from);
				$sheet->setCellValue('E' . $row, $sub_value_to);
				if($sub_value_from == 0 or $sub_value_to == 0)
				{
					$sub_growth_year = 0;
				}
				else
				{
					$sub_growth_year = (($sub_value_to/$sub_value_from) - 1)*100;
				}
				$sheet->setCellValue('F' . $row, $sub_growth_year);
				$sheet->setCellValue('G' . $row, $sub_value_from);
				$sheet->setCellValue('H' . $row, $sub_value_exist);
				if($sub_value_from == 0 or $sub_value_exist == 0)
				{
					$sub_growth_exist = 0;
				}
				else
				{
					$sub_growth_exist = (($sub_value_exist/$sub_value_from) - 1)*100;
				}
				$sheet->setCellValue('I' . $row, $sub_growth_exist);
				$sheet->setCellValue('J' . $row, $sub_value_add_sku);
				if($sub_value_from == 0 or $sub_value_add_sku == 0)
				{
					$sub_growth_add_sku = 0;
				}
				else
				{
					$sub_growth_add_sku = ($sub_value_add_sku/$total_add_sku)*100;
				}
				$sheet->setCellValue('K' . $row, $sub_growth_add_sku);
				$sheet->setCellValue('L' . $row, $sub_value_noo);
				if($sub_value_from == 0 or $sub_value_noo == 0)
				{
					$sub_growth_noo = 0;
				}
				else
				{
					$sub_growth_noo = ($sub_value_noo/$total_noo)*100;
				}
				$sheet->setCellValue('M' . $row, $sub_growth_noo);

				// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
				$sheet->getStyle('A' . $row)->applyFromArray($style_row);
				$sheet->getStyle('B' . $row)->applyFromArray($style_row);
				$sheet->getStyle('C' . $row)->applyFromArray($style_row);
				$sheet->getStyle('D' . $row)->applyFromArray($style_row);
				$sheet->getStyle('E' . $row)->applyFromArray($style_row);
				$sheet->getStyle('F' . $row)->applyFromArray($style_row);
				$sheet->getStyle('G' . $row)->applyFromArray($style_row);
				$sheet->getStyle('H' . $row)->applyFromArray($style_row);
				$sheet->getStyle('I' . $row)->applyFromArray($style_row);
				$sheet->getStyle('J' . $row)->applyFromArray($style_row);
				$sheet->getStyle('K' . $row)->applyFromArray($style_row);
				$sheet->getStyle('L' . $row)->applyFromArray($style_row);
				$sheet->getStyle('M' . $row)->applyFromArray($style_row);

				$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
				$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
				$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
				$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('I' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('J' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('K' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('L' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('M' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

				$sheet->getStyle('C' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('D' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('E' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('F' . $row)->getNumberFormat()->setFormatCode('#,##0.##');
				$sheet->getStyle('G' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('H' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('I' . $row)->getNumberFormat()->setFormatCode('#,##0.##');
				$sheet->getStyle('J' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('K' . $row)->getNumberFormat()->setFormatCode('#,##0.##');
				$sheet->getStyle('L' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('M' . $row)->getNumberFormat()->setFormatCode('#,##0.##');

				$sheet->getStyle('A' . $row . ':M' . $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');
				$sheet->getStyle('A' . $row . ':M' . $row)->getFont()->setBold(true);

				$sub_value_from = 0;
				$sub_value_to = 0;
				$sub_value_exist = 0;
				$sub_value_add_sku = 0;
				$sub_value_noo = 0;

				$row++;
            }

			$sheet->setCellValue('A' . $row, $no);
    		$sheet->setCellValue('B' . $row, $rows['desc_type']);
			$sheet->setCellValue('C' . $row, $rows['outlet_type']);
			$sheet->setCellValue('D' . $row, $rows['value_from']);
			$sheet->setCellValue('E' . $row, $rows['value_to']);
			if($rows['value_from'] == 0 or $rows['value_to'] == 0)
			{
				$growth_year = 0;
			}
			else
			{
				$growth_year = (($rows['value_to']/$rows['value_from']) - 1)*100;
			}
			$sheet->setCellValue('F' . $row, $growth_year);
			$sheet->setCellValue('G' . $row, $rows['value_from']);
			$sheet->setCellValue('H' . $row, $rows['value_exist']);
			if($rows['value_from'] == 0 or $rows['value_exist'] == 0)
			{
				$growth_exist = 0;
			}
			else
			{
				$growth_exist = (($rows['value_exist']/$rows['value_from']) - 1)*100;
			}			
			$sheet->setCellValue('I' . $row, $growth_exist);			
			$sheet->setCellValue('J' . $row, $rows['value_add_sku']);	
			if($rows['value_from'] == 0 or $rows['value_add_sku'] == 0)
			{
				$growth_add_sku = 0;
			}
			else
			{
				$growth_add_sku = ($rows['value_add_sku']/$total_add_sku)*100;
			}		
			$sheet->setCellValue('K' . $row, $growth_add_sku);			
			$sheet->setCellValue('L' . $row, $rows['value_noo']);	
			if($rows['value_from'] == 0 or $rows['value_noo'] == 0)
			{
				$growth_noo = 0;
			}
			else
			{
				$growth_noo = ($rows['value_noo']/$total_noo)*100;
			}		
			$sheet->setCellValue('M' . $row, $growth_noo);			
			
			// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
			$sheet->getStyle('A' . $row)->applyFromArray($style_row);
			$sheet->getStyle('B' . $row)->applyFromArray($style_row);
			$sheet->getStyle('C' . $row)->applyFromArray($style_row);
			$sheet->getStyle('D' . $row)->applyFromArray($style_row);
			$sheet->getStyle('E' . $row)->applyFromArray($style_row);
			$sheet->getStyle('F' . $row)->applyFromArray($style_row);
			$sheet->getStyle('G' . $row)->applyFromArray($style_row);
			$sheet->getStyle('H' . $row)->applyFromArray($style_row);
			$sheet->getStyle('I' . $row)->applyFromArray($style_row);
			$sheet->getStyle('J' . $row)->applyFromArray($style_row);
			$sheet->getStyle('K' . $row)->applyFromArray($style_row);
			$sheet->getStyle('L' . $row)->applyFromArray($style_row);
			$sheet->getStyle('M' . $row)->applyFromArray($style_row);
			
			$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('I' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('J' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('K' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('L' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('M' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

			$sheet->getStyle('C' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('D' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('E' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('F' . $row)->getNumberFormat()->setFormatCode('#,##0.##');
			$sheet->getStyle('G' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('H' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('I' . $row)->getNumberFormat()->setFormatCode('#,##0.##');
			$sheet->getStyle('J' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('K' . $row)->getNumberFormat()->setFormatCode('#,##0.##');
			$sheet->getStyle('L' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('M' . $row)->getNumberFormat()->setFormatCode('#,##0.##');

			$channel = $rows['channel'];

			$sub_value_from += $rows['value_from'];
			$sub_value_to += $rows['value_to'];
			$sub_value_exist += $rows['value_exist'];
			$sub_value_add_sku += $rows['value_add_sku'];
			$sub_value_noo += $rows['value_noo'];

			$total_value_from += $rows['value_from'];
			$total_value_to += $rows['value_to'];
			$total_value_exist += $rows['value_exist'];
			$total_value_add_sku += $rows['value_add_sku'];
			$total_value_noo += $rows['value_noo'];

			$no++; // Tambah 1 setiap kali looping
    		$row++; // Tambah 1 setiap kali looping
		endforeach;

		//channel end
		//$row = $row + 1;
		$sheet->setCellValue('A' . $row, '');
		$sheet->setCellValue('B' . $row, $channel);
		$sheet->setCellValue('C' . $row, '');
		$sheet->setCellValue('D' . $row, $sub_value_from);
		$sheet->setCellValue('E' . $row, $sub_value_to);
		if($sub_value_from == 0 or $sub_value_to == 0)
		{
			$sub_growth_year = 0;
		}
		else
		{
			$sub_growth_year = (($sub_value_to/$sub_value_from) - 1)*100;
		}
		$sheet->setCellValue('F' . $row, $sub_growth_year);
		$sheet->setCellValue('G' . $row, $sub_value_from);
		$sheet->setCellValue('H' . $row, $sub_value_exist);
		if($sub_value_from == 0 or $sub_value_exist == 0)
		{
			$sub_growth_exist = 0;
		}
		else
		{
			$sub_growth_exist = (($sub_value_exist/$sub_value_from) - 1)*100;
		}
		$sheet->setCellValue('I' . $row, $sub_growth_exist);
		$sheet->setCellValue('J' . $row, $sub_value_add_sku);
		if($sub_value_from == 0 or $sub_value_add_sku == 0)
		{
			$sub_growth_add_sku = 0;
		}
		else
		{
			$sub_growth_add_sku = ($sub_value_add_sku/$total_add_sku)*100;
		}
		$sheet->setCellValue('K' . $row, $sub_growth_add_sku);
		$sheet->setCellValue('L' . $row, $sub_value_noo);
		if($sub_value_from == 0 or $sub_value_noo == 0)
		{
			$sub_growth_noo = 0;
		}
		else
		{
			$sub_growth_noo = ($sub_value_noo/$total_noo)*100;
		}
		$sheet->setCellValue('M' . $row, $sub_growth_noo);

		// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
		$sheet->getStyle('A' . $row)->applyFromArray($style_row);
		$sheet->getStyle('B' . $row)->applyFromArray($style_row);
		$sheet->getStyle('C' . $row)->applyFromArray($style_row);
		$sheet->getStyle('D' . $row)->applyFromArray($style_row);
		$sheet->getStyle('E' . $row)->applyFromArray($style_row);
		$sheet->getStyle('F' . $row)->applyFromArray($style_row);
		$sheet->getStyle('G' . $row)->applyFromArray($style_row);
		$sheet->getStyle('H' . $row)->applyFromArray($style_row);
		$sheet->getStyle('I' . $row)->applyFromArray($style_row);
		$sheet->getStyle('J' . $row)->applyFromArray($style_row);
		$sheet->getStyle('K' . $row)->applyFromArray($style_row);
		$sheet->getStyle('L' . $row)->applyFromArray($style_row);
		$sheet->getStyle('M' . $row)->applyFromArray($style_row);
		
		$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('I' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('J' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('K' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('L' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('M' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

		$sheet->getStyle('C' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('D' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('E' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('F' . $row)->getNumberFormat()->setFormatCode('#,##0.##');
		$sheet->getStyle('G' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('H' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('I' . $row)->getNumberFormat()->setFormatCode('#,##0.##');
		$sheet->getStyle('J' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('K' . $row)->getNumberFormat()->setFormatCode('#,##0.##');
		$sheet->getStyle('L' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('M' . $row)->getNumberFormat()->setFormatCode('#,##0.##');

		$sheet->getStyle('A' . $row . ':M' . $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');
		$sheet->getStyle('A' . $row . ':M' . $row)->getFont()->setBold(true);

		//grand total
		$row = $row + 1;
		$sheet->setCellValue('A' . $row, '');
		$sheet->setCellValue('B' . $row, 'GRAND TOTAL');
		$sheet->setCellValue('C' . $row, '');
		$sheet->setCellValue('D' . $row, $total_value_from);
		$sheet->setCellValue('E' . $row, $total_value_to);
		if($total_value_from == 0 or $total_value_to == 0)
		{
			$total_growth_year = 0;
		}
		else
		{
			$total_growth_year = (($total_value_to/$total_value_from) - 1)*100;
		}
		$sheet->setCellValue('F' . $row, $total_growth_year);
		$sheet->setCellValue('G' . $row, $total_value_from);
		$sheet->setCellValue('H' . $row, $total_value_exist);
		if($total_value_from == 0 or $total_value_exist == 0)
		{
			$total_growth_exist = 0;
		}
		else
		{
			$total_growth_exist = (($total_value_exist/$total_value_from) - 1)*100;
		}
		$sheet->setCellValue('I' . $row, $total_growth_exist);
		$sheet->setCellValue('J' . $row, $total_value_add_sku);
		if($total_value_from == 0 or $total_value_add_sku == 0)
		{
			$total_growth_add_sku = 0;
		}
		else
		{
			$total_growth_add_sku = ($total_value_add_sku/$total_value_to)*100;
		}
		$sheet->setCellValue('K' . $row, $total_growth_add_sku);
		$sheet->setCellValue('L' . $row, $total_value_noo);
		if($total_value_from == 0 or $total_value_noo == 0)
		{
			$total_growth_noo = 0;
		}
		else
		{
			$total_growth_noo = ($total_value_noo/$total_value_to)*100;
		}
		$sheet->setCellValue('M' . $row, $total_growth_noo);

		// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
		$sheet->getStyle('A' . $row)->applyFromArray($style_row);
		$sheet->getStyle('B' . $row)->applyFromArray($style_row);
		$sheet->getStyle('C' . $row)->applyFromArray($style_row);
		$sheet->getStyle('D' . $row)->applyFromArray($style_row);
		$sheet->getStyle('E' . $row)->applyFromArray($style_row);
		$sheet->getStyle('F' . $row)->applyFromArray($style_row);
		$sheet->getStyle('G' . $row)->applyFromArray($style_row);
		$sheet->getStyle('H' . $row)->applyFromArray($style_row);
		$sheet->getStyle('I' . $row)->applyFromArray($style_row);
		$sheet->getStyle('J' . $row)->applyFromArray($style_row);
		$sheet->getStyle('K' . $row)->applyFromArray($style_row);
		$sheet->getStyle('L' . $row)->applyFromArray($style_row);
		$sheet->getStyle('M' . $row)->applyFromArray($style_row);

		$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('I' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('J' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('K' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('L' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('M' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

		$sheet->getStyle('C' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('D' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('E' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('F' . $row)->getNumberFormat()->setFormatCode('#,##0.##');
		$sheet->getStyle('G' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('H' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('I' . $row)->getNumberFormat()->setFormatCode('#,##0.##');
		$sheet->getStyle('J' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('K' . $row)->getNumberFormat()->setFormatCode('#,##0.##');
		$sheet->getStyle('L' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('M' . $row)->getNumberFormat()->setFormatCode('#,##0.##');

		$sheet->getStyle('A' . $row . ':M' . $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFA07A');
		$sheet->getStyle('A' . $row . ':M' . $row)->getFont()->setBold(true);


		//set columns width
		$sheet->getColumnDimension('A')->setWidth(5); 
		$sheet->getColumnDimension('B')->setWidth(35); 
		$sheet->getColumnDimension('C')->setWidth(18);
		$sheet->getColumnDimension('D')->setWidth(18);
		$sheet->getColumnDimension('E')->setWidth(18);
		$sheet->getColumnDimension('F')->setWidth(12);
		$sheet->getColumnDimension('G')->setWidth(18);
		$sheet->getColumnDimension('H')->setWidth(18);
		$sheet->getColumnDimension('I')->setWidth(12);
		$sheet->getColumnDimension('J')->setWidth(18);
		$sheet->getColumnDimension('K')->setWidth(12);
		$sheet->getColumnDimension('L')->setWidth(18);
		$sheet->getColumnDimension('M')->setWidth(12);
		

		// Set orientasi kertas jadi LANDSCAPE
		$sheet->getPageSetup()->setOrientation(\PhpOffice\PhpSpreadsheet\Worksheet\PageSetup::ORIENTATION_LANDSCAPE);
		// Set judul file excel nya
		$sheet->setTitle("SO - Growth By Outlet Type");
		// Proses file excel
		header('Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet');
		header('Content-Disposition: attachment; filename="Report Selling Out - Growth By Outlet Type ("' . $year . '").xlsx"'); // Set nama file excel nya
		header('Cache-Control: max-age=0');

		$writer = new Xlsx($spreadsheet);
		$writer->save('php://output');

	}

	public function export_sellingout_growth_SKUCategory()
	{
		$spreadsheet = new Spreadsheet();
		$sheet = $spreadsheet->getActiveSheet();
		// Buat sebuah variabel untuk menampung pengaturan style dari header tabel
		$style_col = [
			'font' => ['bold' => true], // Set font nya jadi bold
			'alignment' => [
				'horizontal' => \PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER, // Set text jadi ditengah secara horizontal (center)
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'top' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border top dengan garis tipis
				'right' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN],  // Set border right dengan garis tipis
				'bottom' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border bottom dengan garis tipis
				'left' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN] // Set border left dengan garis tipis
			]
		];
		// Buat sebuah variabel untuk menampung pengaturan style dari isi tabel
		$style_row = [
			'alignment' => [
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'top' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border top dengan garis tipis
				'right' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN],  // Set border right dengan garis tipis
				'bottom' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border bottom dengan garis tipis
				'left' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN] // Set border left dengan garis tipis
			]
		];

		if (isset($_POST['by_area']))
		{
			$area = implode(',', $_POST['by_area']);
			$area = str_replace(",", "','", $area);;
		}
		else
		{
			$area = "";
		}

		if (isset($_POST['by_year']))
		{
			$year = $_POST['by_year'];
		}
		else
		{
			$year = "";
		}

		$year_to = $year;
		$year_from = $year_to - 1;

		$sheet->setCellValue('A1', "Report Selling Out - Growth By SKU Category (" . $year . ")"); // Set kolom A1 dengan tulisan 
		$sheet->setCellValue('A2', "Area : " . $area); 
		//$sheet->mergeCells('A1:F1'); // Set Merge Cell pada kolom A1 sampai F1
		$sheet->getStyle('A1')->getFont()->setBold(true); // Set bold kolom A1
		$sheet->getStyle('A2')->getFont()->setBold(true);
		$sheet->getStyle('A1')->getFont()->setSize(20); // Set font size 20 untuk kolom A1
		// Buat header tabel nya pada baris ke 4
		$sheet->setCellValue('A4', "#"); // Set kolom A4 dengan tulisan "#"
		$sheet->mergeCells('A4:A5');
		$sheet->setCellValue('B4', "Category");
		$sheet->mergeCells('B4:B5');
		$sheet->setCellValue('C4', "Full Year"); 
		$sheet->mergeCells('C4:E4');
		$sheet->setCellValue('F4', "SKU Existing"); 
		$sheet->mergeCells('F4:H4');
		$sheet->setCellValue('I4', "Add SKU"); 
		$sheet->mergeCells('I4:J4');
		$sheet->setCellValue('K4', "NOO"); 
		$sheet->mergeCells('K4:L4');

		$sheet->setCellValue('C5', $year_from);
		$sheet->setCellValue('D5', $year_to);
		$sheet->setCellValue('E5', "Growth %");
		$sheet->setCellValue('F5', $year_from);
		$sheet->setCellValue('G5', $year_to);
		$sheet->setCellValue('H5', "Growth %");
		$sheet->setCellValue('I5', "Value");
		$sheet->setCellValue('J5', "Contr %");
		$sheet->setCellValue('K5', "Value");
		$sheet->setCellValue('L5', "Contr %");
		
		

		// Apply style header yang telah kita buat tadi ke masing-masing kolom header
		$sheet->getStyle('A4')->applyFromArray($style_col);
		$sheet->getStyle('B4')->applyFromArray($style_col);
		$sheet->getStyle('C4')->applyFromArray($style_col);
		$sheet->getStyle('D4')->applyFromArray($style_col);
		$sheet->getStyle('E4')->applyFromArray($style_col);
		$sheet->getStyle('F4')->applyFromArray($style_col);
		$sheet->getStyle('G4')->applyFromArray($style_col);
		$sheet->getStyle('H4')->applyFromArray($style_col);
		$sheet->getStyle('I4')->applyFromArray($style_col);
		$sheet->getStyle('J4')->applyFromArray($style_col);
		$sheet->getStyle('K4')->applyFromArray($style_col);
		$sheet->getStyle('L4')->applyFromArray($style_col);

		$sheet->getStyle('A5')->applyFromArray($style_col);
		$sheet->getStyle('B5')->applyFromArray($style_col);
		$sheet->getStyle('C5')->applyFromArray($style_col);
		$sheet->getStyle('D5')->applyFromArray($style_col);
		$sheet->getStyle('E5')->applyFromArray($style_col);
		$sheet->getStyle('F5')->applyFromArray($style_col);
		$sheet->getStyle('G5')->applyFromArray($style_col);
		$sheet->getStyle('H5')->applyFromArray($style_col);
		$sheet->getStyle('I5')->applyFromArray($style_col);
		$sheet->getStyle('J5')->applyFromArray($style_col);
		$sheet->getStyle('K5')->applyFromArray($style_col);
		$sheet->getStyle('L5')->applyFromArray($style_col);

		$sheet->getStyle('A4:L5')->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');
		// $sheet->getStyle('S6')->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFA07A');

		// Set height baris ke 1 dan 2
		$sheet->getRowDimension('1')->setRowHeight(40);
		$sheet->getRowDimension('2')->setRowHeight(20);


		$item_group = '';
		$item_category = '';

		$sub_value_from = 0;
		$sub_value_to = 0;
		$sub_value_exist = 0;
		$sub_value_add_sku = 0;
		$sub_value_noo = 0;

		$total_value_from = 0;
		$total_value_to = 0;
		$total_value_exist = 0;
		$total_value_add_sku = 0;
		$total_value_noo = 0;


		$no = 1; // Untuk penomoran tabel, di awal set dengan 1
		$row = 6;

		// $data1 = array(
		// 	'island' => $island,
		// 	'region' => $region,
		// 	'area' => $area,
		// 	'year' => $year
		// );

		$data['so_growth_sku'] = $this->model('ReportModel')->getSellingOut_Growth_SKU_Category2();

		foreach ($data['so_growth_sku'] as $row2):

			$total_from += $row2['value_from'];
			$total_to += $row2['value_to'];
			$total_exist += $row2['value_exist'];
			$total_add_sku += $row2['value_add_sku'];
			$total_noo += $row2['value_noo'];

		endforeach;

		foreach ($data['so_growth_sku'] as $rows) :

			if ($item_group != $rows['item_group'] and $item_group != '' )
            {
				
				$sheet->setCellValue('A' . $row, '');
				$sheet->setCellValue('B' . $row, $item_group);
				$sheet->setCellValue('C' . $row, $sub_value_from);
				$sheet->setCellValue('D' . $row, $sub_value_to);
				if($sub_value_from == 0 or $sub_value_to == 0)
				{
					$sub_growth_year = 0;
				}
				else
				{
					$sub_growth_year = (($sub_value_to/$sub_value_from) - 1)*100;
				}
				$sheet->setCellValue('E' . $row, $sub_growth_year);
				$sheet->setCellValue('F' . $row, $sub_value_from);
				$sheet->setCellValue('G' . $row, $sub_value_exist);
				if($sub_value_from == 0 or $sub_value_exist == 0)
				{
					$sub_growth_exist = 0;
				}
				else
				{
					$sub_growth_exist = (($sub_value_exist/$sub_value_from) - 1)*100;
				}
				$sheet->setCellValue('H' . $row, $sub_growth_exist);
				$sheet->setCellValue('I' . $row, $sub_value_add_sku);
				if($sub_value_from == 0 or $sub_value_add_sku == 0)
				{
					$sub_growth_add_sku = 0;
				}
				else
				{
					$sub_growth_add_sku = ($sub_value_add_sku/$total_add_sku)*100;
				}
				$sheet->setCellValue('J' . $row, $sub_growth_add_sku);
				$sheet->setCellValue('K' . $row, $sub_value_noo);
				if($sub_value_from == 0 or $sub_value_noo == 0)
				{
					$sub_growth_noo = 0;
				}
				else
				{
					$sub_growth_noo = ($sub_value_noo/$total_noo)*100;
				}
				$sheet->setCellValue('L' . $row, $sub_growth_noo);

				// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
				$sheet->getStyle('A' . $row)->applyFromArray($style_row);
				$sheet->getStyle('B' . $row)->applyFromArray($style_row);
				$sheet->getStyle('C' . $row)->applyFromArray($style_row);
				$sheet->getStyle('D' . $row)->applyFromArray($style_row);
				$sheet->getStyle('E' . $row)->applyFromArray($style_row);
				$sheet->getStyle('F' . $row)->applyFromArray($style_row);
				$sheet->getStyle('G' . $row)->applyFromArray($style_row);
				$sheet->getStyle('H' . $row)->applyFromArray($style_row);
				$sheet->getStyle('I' . $row)->applyFromArray($style_row);
				$sheet->getStyle('J' . $row)->applyFromArray($style_row);
				$sheet->getStyle('K' . $row)->applyFromArray($style_row);
				$sheet->getStyle('L' . $row)->applyFromArray($style_row);

				$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
				$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
				$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('I' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('J' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('K' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('L' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

				$sheet->getStyle('C' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('D' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('E' . $row)->getNumberFormat()->setFormatCode('#,##0.##');
				$sheet->getStyle('F' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('G' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('H' . $row)->getNumberFormat()->setFormatCode('#,##0.##');
				$sheet->getStyle('I' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('J' . $row)->getNumberFormat()->setFormatCode('#,##0.##');
				$sheet->getStyle('K' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('L' . $row)->getNumberFormat()->setFormatCode('#,##0.##');

				$sheet->getStyle('A' . $row . ':L' . $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');
				$sheet->getStyle('A' . $row . ':L' . $row)->getFont()->setBold(true);

				$sub_value_from = 0;
				$sub_value_to = 0;
				$sub_value_exist = 0;
				$sub_value_add_sku = 0;
				$sub_value_noo = 0;

				$row++;
            }

			$sheet->setCellValue('A' . $row, $no);
    		$sheet->setCellValue('B' . $row, $rows['item_category']);
			$sheet->setCellValue('C' . $row, $rows['value_from']);
			$sheet->setCellValue('D' . $row, $rows['value_to']);
			if($rows['value_from'] == 0 or $rows['value_to'] == 0)
			{
				$growth_year = 0;
			}
			else
			{
				$growth_year = (($rows['value_to']/$rows['value_from']) - 1)*100;
			}
			$sheet->setCellValue('E' . $row, $growth_year);
			$sheet->setCellValue('F' . $row, $rows['value_from']);
			$sheet->setCellValue('G' . $row, $rows['value_exist']);
			if($rows['value_from'] == 0 or $rows['value_exist'] == 0)
			{
				$growth_exist = 0;
			}
			else
			{
				$growth_exist = (($rows['value_exist']/$rows['value_from']) - 1)*100;
			}			
			$sheet->setCellValue('H' . $row, $growth_exist);			
			$sheet->setCellValue('I' . $row, $rows['value_add_sku']);	
			if($rows['value_from'] == 0 or $rows['value_add_sku'] == 0)
			{
				$growth_add_sku = 0;
			}
			else
			{
				$growth_add_sku = ($rows['value_add_sku']/$total_add_sku)*100;
			}		
			$sheet->setCellValue('J' . $row, $growth_add_sku);			
			$sheet->setCellValue('K' . $row, $rows['value_noo']);	
			if($rows['value_from'] == 0 or $rows['value_noo'] == 0)
			{
				$growth_noo = 0;
			}
			else
			{
				$growth_noo = ($rows['value_noo']/$total_noo)*100;
			}		
			$sheet->setCellValue('L' . $row, $growth_noo);			
			
			// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
			$sheet->getStyle('A' . $row)->applyFromArray($style_row);
			$sheet->getStyle('B' . $row)->applyFromArray($style_row);
			$sheet->getStyle('C' . $row)->applyFromArray($style_row);
			$sheet->getStyle('D' . $row)->applyFromArray($style_row);
			$sheet->getStyle('E' . $row)->applyFromArray($style_row);
			$sheet->getStyle('F' . $row)->applyFromArray($style_row);
			$sheet->getStyle('G' . $row)->applyFromArray($style_row);
			$sheet->getStyle('H' . $row)->applyFromArray($style_row);
			$sheet->getStyle('I' . $row)->applyFromArray($style_row);
			$sheet->getStyle('J' . $row)->applyFromArray($style_row);
			$sheet->getStyle('K' . $row)->applyFromArray($style_row);
			$sheet->getStyle('L' . $row)->applyFromArray($style_row);
			
			$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('I' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('J' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('K' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('L' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

			$sheet->getStyle('C' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('D' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('E' . $row)->getNumberFormat()->setFormatCode('#,##0.##');
			$sheet->getStyle('F' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('G' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('H' . $row)->getNumberFormat()->setFormatCode('#,##0.##');
			$sheet->getStyle('I' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('J' . $row)->getNumberFormat()->setFormatCode('#,##0.##');
			$sheet->getStyle('K' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('L' . $row)->getNumberFormat()->setFormatCode('#,##0.##');

			$item_group = $rows['item_group'];

			$sub_value_from += $rows['value_from'];
			$sub_value_to += $rows['value_to'];
			$sub_value_exist += $rows['value_exist'];
			$sub_value_add_sku += $rows['value_add_sku'];
			$sub_value_noo += $rows['value_noo'];

			$total_value_from += $rows['value_from'];
			$total_value_to += $rows['value_to'];
			$total_value_exist += $rows['value_exist'];
			$total_value_add_sku += $rows['value_add_sku'];
			$total_value_noo += $rows['value_noo'];

			$no++; // Tambah 1 setiap kali looping
    		$row++; // Tambah 1 setiap kali looping
		endforeach;

		//item_group end
		//$row = $row + 1;
		$sheet->setCellValue('A' . $row, '');
		$sheet->setCellValue('B' . $row, $item_group);
		$sheet->setCellValue('C' . $row, $sub_value_from);
		$sheet->setCellValue('D' . $row, $sub_value_to);
		if($sub_value_from == 0 or $sub_value_to == 0)
		{
			$sub_growth_year = 0;
		}
		else
		{
			$sub_growth_year = (($sub_value_to/$sub_value_from) - 1)*100;
		}
		$sheet->setCellValue('E' . $row, $sub_growth_year);
		$sheet->setCellValue('F' . $row, $sub_value_from);
		$sheet->setCellValue('G' . $row, $sub_value_exist);
		if($sub_value_from == 0 or $sub_value_exist == 0)
		{
			$sub_growth_exist = 0;
		}
		else
		{
			$sub_growth_exist = (($sub_value_exist/$sub_value_from) - 1)*100;
		}
		$sheet->setCellValue('H' . $row, $sub_growth_exist);
		$sheet->setCellValue('I' . $row, $sub_value_add_sku);
		if($sub_value_from == 0 or $sub_value_add_sku == 0)
		{
			$sub_growth_add_sku = 0;
		}
		else
		{
			$sub_growth_add_sku = ($sub_value_add_sku/$total_add_sku)*100;
		}
		$sheet->setCellValue('J' . $row, $sub_growth_add_sku);
		$sheet->setCellValue('K' . $row, $sub_value_noo);
		if($sub_value_from == 0 or $sub_value_noo == 0)
		{
			$sub_growth_noo = 0;
		}
		else
		{
			$sub_growth_noo = ($sub_value_noo/$total_noo)*100;
		}
		$sheet->setCellValue('L' . $row, $sub_growth_noo);

		// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
		$sheet->getStyle('A' . $row)->applyFromArray($style_row);
		$sheet->getStyle('B' . $row)->applyFromArray($style_row);
		$sheet->getStyle('C' . $row)->applyFromArray($style_row);
		$sheet->getStyle('D' . $row)->applyFromArray($style_row);
		$sheet->getStyle('E' . $row)->applyFromArray($style_row);
		$sheet->getStyle('F' . $row)->applyFromArray($style_row);
		$sheet->getStyle('G' . $row)->applyFromArray($style_row);
		$sheet->getStyle('H' . $row)->applyFromArray($style_row);
		$sheet->getStyle('I' . $row)->applyFromArray($style_row);
		$sheet->getStyle('J' . $row)->applyFromArray($style_row);
		$sheet->getStyle('K' . $row)->applyFromArray($style_row);
		$sheet->getStyle('L' . $row)->applyFromArray($style_row);
		
		$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('I' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('J' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('K' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('L' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

		$sheet->getStyle('C' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('D' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('E' . $row)->getNumberFormat()->setFormatCode('#,##0.##');
		$sheet->getStyle('F' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('G' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('H' . $row)->getNumberFormat()->setFormatCode('#,##0.##');
		$sheet->getStyle('I' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('J' . $row)->getNumberFormat()->setFormatCode('#,##0.##');
		$sheet->getStyle('K' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('L' . $row)->getNumberFormat()->setFormatCode('#,##0.##');

		$sheet->getStyle('A' . $row . ':L' . $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');
		$sheet->getStyle('A' . $row . ':L' . $row)->getFont()->setBold(true);

		//grand total
		$row = $row + 1;
		$sheet->setCellValue('A' . $row, '');
		$sheet->setCellValue('B' . $row, 'GRAND TOTAL');
		$sheet->setCellValue('C' . $row, $total_value_from);
		$sheet->setCellValue('D' . $row, $total_value_to);
		if($total_value_from == 0 or $total_value_to == 0)
		{
			$total_growth_year = 0;
		}
		else
		{
			$total_growth_year = (($total_value_to/$total_value_from) - 1)*100;
		}
		$sheet->setCellValue('E' . $row, $total_growth_year);
		$sheet->setCellValue('F' . $row, $total_value_from);
		$sheet->setCellValue('G' . $row, $total_value_exist);
		if($total_value_from == 0 or $total_value_exist == 0)
		{
			$total_growth_exist = 0;
		}
		else
		{
			$total_growth_exist = (($total_value_exist/$total_value_from) - 1)*100;
		}
		$sheet->setCellValue('H' . $row, $total_growth_exist);
		$sheet->setCellValue('I' . $row, $total_value_add_sku);
		if($total_value_from == 0 or $total_value_add_sku == 0)
		{
			$total_growth_add_sku = 0;
		}
		else
		{
			$total_growth_add_sku = ($total_value_add_sku/$total_value_to)*100;
		}
		$sheet->setCellValue('J' . $row, $total_growth_add_sku);
		$sheet->setCellValue('K' . $row, $total_value_noo);
		if($total_value_from == 0 or $total_value_noo == 0)
		{
			$total_growth_noo = 0;
		}
		else
		{
			$total_growth_noo = ($total_value_noo/$total_value_to)*100;
		}
		$sheet->setCellValue('L' . $row, $total_growth_noo);

		// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
		$sheet->getStyle('A' . $row)->applyFromArray($style_row);
		$sheet->getStyle('B' . $row)->applyFromArray($style_row);
		$sheet->getStyle('C' . $row)->applyFromArray($style_row);
		$sheet->getStyle('D' . $row)->applyFromArray($style_row);
		$sheet->getStyle('E' . $row)->applyFromArray($style_row);
		$sheet->getStyle('F' . $row)->applyFromArray($style_row);
		$sheet->getStyle('G' . $row)->applyFromArray($style_row);
		$sheet->getStyle('H' . $row)->applyFromArray($style_row);
		$sheet->getStyle('I' . $row)->applyFromArray($style_row);
		$sheet->getStyle('J' . $row)->applyFromArray($style_row);
		$sheet->getStyle('K' . $row)->applyFromArray($style_row);
		$sheet->getStyle('L' . $row)->applyFromArray($style_row);

		$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('I' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('J' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('K' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('L' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

		$sheet->getStyle('C' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('D' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('E' . $row)->getNumberFormat()->setFormatCode('#,##0.##');
		$sheet->getStyle('F' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('G' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('H' . $row)->getNumberFormat()->setFormatCode('#,##0.##');
		$sheet->getStyle('I' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('J' . $row)->getNumberFormat()->setFormatCode('#,##0.##');
		$sheet->getStyle('K' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('L' . $row)->getNumberFormat()->setFormatCode('#,##0.##');

		$sheet->getStyle('A' . $row . ':L' . $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFA07A');
		$sheet->getStyle('A' . $row . ':L' . $row)->getFont()->setBold(true);


		//set columns width
		$sheet->getColumnDimension('A')->setWidth(5); 
		$sheet->getColumnDimension('B')->setWidth(35); 
		$sheet->getColumnDimension('C')->setWidth(18);
		$sheet->getColumnDimension('D')->setWidth(18);
		$sheet->getColumnDimension('E')->setWidth(12);
		$sheet->getColumnDimension('F')->setWidth(18);
		$sheet->getColumnDimension('G')->setWidth(18);
		$sheet->getColumnDimension('H')->setWidth(12);
		$sheet->getColumnDimension('I')->setWidth(18);
		$sheet->getColumnDimension('J')->setWidth(12);
		$sheet->getColumnDimension('K')->setWidth(18);
		$sheet->getColumnDimension('L')->setWidth(12);
		

		// Set orientasi kertas jadi LANDSCAPE
		$sheet->getPageSetup()->setOrientation(\PhpOffice\PhpSpreadsheet\Worksheet\PageSetup::ORIENTATION_LANDSCAPE);
		// Set judul file excel nya
		$sheet->setTitle("Selling Out - Growth By Channel");
		// Proses file excel
		header('Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet');
		header('Content-Disposition: attachment; filename="Report Selling Out - Growth By SKU Category ("' . $year . '").xlsx"'); // Set nama file excel nya
		header('Cache-Control: max-age=0');

		$writer = new Xlsx($spreadsheet);
		$writer->save('php://output');

	}


	public function export_sellingin_performance()
	{
		$spreadsheet = new Spreadsheet();
		$sheet = $spreadsheet->getActiveSheet();
		// Buat sebuah variabel untuk menampung pengaturan style dari header tabel
		$style_col = [
			'font' => ['bold' => true], // Set font nya jadi bold
			'alignment' => [
				'horizontal' => \PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER, // Set text jadi ditengah secara horizontal (center)
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'top' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border top dengan garis tipis
				'right' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN],  // Set border right dengan garis tipis
				'bottom' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border bottom dengan garis tipis
				'left' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN] // Set border left dengan garis tipis
			]
		];
		// Buat sebuah variabel untuk menampung pengaturan style dari isi tabel
		$style_row = [
			'alignment' => [
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'top' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border top dengan garis tipis
				'right' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN],  // Set border right dengan garis tipis
				'bottom' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border bottom dengan garis tipis
				'left' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN] // Set border left dengan garis tipis
			]
		];


		if (isset($_POST['by_island']))
		{
			$island = $_POST['by_island'];
		}
		else
		{
			$island = "";
		}

		if (isset($_POST['by_region']))
		{
			$region = $_POST['by_region'];
		}
		else
		{
			$region = "";
		}

		if (isset($_POST['by_area']))
		{
			$area = implode(',', $_POST['by_area']);
			$area = str_replace(",", "','", $area);;
		}
		else
		{
			$area = "";
		}

		if (isset($_POST['by_year']))
		{
			$year = $_POST['by_year'];
		}
		else
		{
			$year = date('Y');
		}


		$sheet->setCellValue('A1', "Report Selling In - Performance (" . $year . ")"); // Set kolom A1 dengan tulisan 
		$sheet->setCellValue('A2', "Island : " . $island);
		$sheet->setCellValue('A3', "Region : " . $region); 
		$sheet->setCellValue('A4', "Area : " . $area); 
		//$sheet->mergeCells('A1:F1'); // Set Merge Cell pada kolom A1 sampai F1
		$sheet->getStyle('A1')->getFont()->setBold(true); // Set bold kolom A1
		$sheet->getStyle('A2')->getFont()->setBold(true);
		$sheet->getStyle('A3')->getFont()->setBold(true);
		$sheet->getStyle('A4')->getFont()->setBold(true);
		$sheet->getStyle('A1')->getFont()->setSize(20); // Set font size 15 untuk kolom A1
		// Buat header tabel nya pada baris ke 6
		$sheet->setCellValue('A6', "#"); // Set kolom A6 dengan tulisan "#"
		$sheet->mergeCells('A6:A8');//Set Merge Cell
		$sheet->setCellValue('B6', "Principal");
		$sheet->mergeCells('B6:B8');
		$sheet->setCellValue('C6', "Group SKU");
		$sheet->mergeCells('C6:C8'); 
		$sheet->setCellValue('D6', "Kode Item");
		$sheet->mergeCells('D6:D8'); 
		$sheet->setCellValue('E6', "SKU");
		$sheet->mergeCells('E6:E8');
		$sheet->setCellValue('F6', "Unit");
		$sheet->mergeCells('F6:F8');
		//Header Month
		$sheet->setCellValue('G6', "January");
		$sheet->mergeCells('G6:N6');
		$sheet->setCellValue('O6', "February");
		$sheet->mergeCells('O6:V6');
		$sheet->setCellValue('W6', "March");
		$sheet->mergeCells('W6:AD6');
		$sheet->setCellValue('AE6', "Quarter 1");
		$sheet->mergeCells('AE6:AJ6');
		$sheet->setCellValue('AK6', "April");
		$sheet->mergeCells('AK6:AR6');
		$sheet->setCellValue('AS6', "May");
		$sheet->mergeCells('AS6:AZ6');
		$sheet->setCellValue('BA6', "June");
		$sheet->mergeCells('BA6:BH6');
		$sheet->setCellValue('BI6', "Quarter 2");
		$sheet->mergeCells('BI6:BN6');
		$sheet->setCellValue('BO6', "July");
		$sheet->mergeCells('BO6:BV6');
		$sheet->setCellValue('BW6', "August");
		$sheet->mergeCells('BW6:CD6');
		$sheet->setCellValue('CE6', "September");
		$sheet->mergeCells('CE6:CL6');
		$sheet->setCellValue('CM6', "Quarter 3");
		$sheet->mergeCells('CM6:CR6');
		$sheet->setCellValue('CS6', "October");
		$sheet->mergeCells('CS6:CZ6');
		$sheet->setCellValue('DA6', "November");
		$sheet->mergeCells('DA6:DH6');
		$sheet->setCellValue('DI6', "December");
		$sheet->mergeCells('DI6:DP6');
		$sheet->setCellValue('DQ6', "Quarter 4");
		$sheet->mergeCells('DQ6:DV6');
		$sheet->setCellValue('DW6', "Total");
		$sheet->mergeCells('DW6:EB6');
		$sheet->setCellValue('EC6', "Average");
		$sheet->mergeCells('EC6:EH6');

		//Header Actual, Target, Index
		$sheet->setCellValue('G7', "Actual");
		$sheet->mergeCells('G7:H7');
		$sheet->setCellValue('I7', "Target");
		$sheet->mergeCells('I7:J7');
		$sheet->setCellValue('K7', "Index(%)");
		$sheet->mergeCells('K7:L7');
		$sheet->setCellValue('M7', "STOCK");
		$sheet->mergeCells('M7:N7');
		$sheet->setCellValue('O7', "Actual");
		$sheet->mergeCells('O7:P7');
		$sheet->setCellValue('Q7', "Target");
		$sheet->mergeCells('Q7:R7');
		$sheet->setCellValue('S7', "Index(%)");
		$sheet->mergeCells('S7:T7');
		$sheet->setCellValue('U7', "STOCK");
		$sheet->mergeCells('U7:V7');
		$sheet->setCellValue('W7', "Actual");
		$sheet->mergeCells('W7:X7');
		$sheet->setCellValue('Y7', "Target");
		$sheet->mergeCells('Y7:Z7');
		$sheet->setCellValue('AA7', "Index(%)");
		$sheet->mergeCells('AA7:AB7');
		$sheet->setCellValue('AC7', "STOCK");
		$sheet->mergeCells('AC7:AD7');
		$sheet->setCellValue('AE7', "Actual");//Q1
		$sheet->mergeCells('AE7:AF7');
		$sheet->setCellValue('AG7', "Target");
		$sheet->mergeCells('AG7:AH7');
		$sheet->setCellValue('AI7', "Index(%)");//Q1
		$sheet->mergeCells('AI7:AJ7');
		$sheet->setCellValue('AK7', "Actual");
		$sheet->mergeCells('AK7:AL7');
		$sheet->setCellValue('AM7', "Target");
		$sheet->mergeCells('AM7:AN7');
		$sheet->setCellValue('AO7', "Index(%)");
		$sheet->mergeCells('AO7:AP7');
		$sheet->setCellValue('AQ7', "STOCK");
		$sheet->mergeCells('AQ7:AR7');
		$sheet->setCellValue('AS7', "Actual");
		$sheet->mergeCells('AS7:AT7');
		$sheet->setCellValue('AU7', "Target");
		$sheet->mergeCells('AU7:AV7');
		$sheet->setCellValue('AW7', "Index(%)");
		$sheet->mergeCells('AW7:AX7');
		$sheet->setCellValue('AY7', "STOCK");
		$sheet->mergeCells('AY7:AZ7');
		$sheet->setCellValue('BA7', "Actual");
		$sheet->mergeCells('BA7:BB7');
		$sheet->setCellValue('BC7', "Target");
		$sheet->mergeCells('BC7:BD7');
		$sheet->setCellValue('BE7', "Index(%)");
		$sheet->mergeCells('BE7:BF7');
		$sheet->setCellValue('BG7', "STOCK");
		$sheet->mergeCells('BG7:BH7');
		$sheet->setCellValue('BI7', "Actual");//Q2
		$sheet->mergeCells('BI7:BJ7');
		$sheet->setCellValue('BK7', "Target");
		$sheet->mergeCells('BK7:BL7');
		$sheet->setCellValue('BM7', "Index(%)");//Q2
		$sheet->mergeCells('BM7:BN7');
		$sheet->setCellValue('BO7', "Actual");
		$sheet->mergeCells('BO7:BP7');
		$sheet->setCellValue('BQ7', "Target");
		$sheet->mergeCells('BQ7:BR7');
		$sheet->setCellValue('BS7', "Index(%)");
		$sheet->mergeCells('BS7:BT7');
		$sheet->setCellValue('BU7', "STOCK");
		$sheet->mergeCells('BU7:BV7');
		$sheet->setCellValue('BW7', "Actual");
		$sheet->mergeCells('BW7:BX7');
		$sheet->setCellValue('BY7', "Target");
		$sheet->mergeCells('BY7:BZ7');
		$sheet->setCellValue('CA7', "Index(%)");
		$sheet->mergeCells('CA7:CB7');
		$sheet->setCellValue('CC7', "STOCK");
		$sheet->mergeCells('CC7:CD7');
		$sheet->setCellValue('CE7', "Actual");
		$sheet->mergeCells('CE7:CF7');
		$sheet->setCellValue('CG7', "Target");
		$sheet->mergeCells('CG7:CH7');
		$sheet->setCellValue('CI7', "Index(%)");
		$sheet->mergeCells('CI7:CJ7');
		$sheet->setCellValue('CK7', "STOCK");
		$sheet->mergeCells('CK7:CL7');
		$sheet->setCellValue('CM7', "Actual");//Q3
		$sheet->mergeCells('CM7:CN7');
		$sheet->setCellValue('CO7', "Target");
		$sheet->mergeCells('CO7:CP7');
		$sheet->setCellValue('CQ7', "Index(%)");//Q3
		$sheet->mergeCells('CQ7:CR7');
		$sheet->setCellValue('CS7', "Actual");
		$sheet->mergeCells('CS7:CT7');
		$sheet->setCellValue('CU7', "Target");
		$sheet->mergeCells('CU7:CV7');
		$sheet->setCellValue('CW7', "Index(%)");
		$sheet->mergeCells('CW7:CX7');
		$sheet->setCellValue('CY7', "STOCK");
		$sheet->mergeCells('CY7:CZ7');
		$sheet->setCellValue('DA7', "Actual");
		$sheet->mergeCells('DA7:DB7');
		$sheet->setCellValue('DC7', "Target");
		$sheet->mergeCells('DC7:DD7');
		$sheet->setCellValue('DE7', "Index(%)");
		$sheet->mergeCells('DE7:DF7');
		$sheet->setCellValue('DG7', "STOCK");
		$sheet->mergeCells('DG7:DH7');
		$sheet->setCellValue('DI7', "Actual");
		$sheet->mergeCells('DI7:DJ7');
		$sheet->setCellValue('DK7', "Target");
		$sheet->mergeCells('DK7:DL7');
		$sheet->setCellValue('DM7', "Index(%)");
		$sheet->mergeCells('DM7:DN7');
		$sheet->setCellValue('DO7', "STOCK");
		$sheet->mergeCells('DO7:DP7');
		$sheet->setCellValue('DQ7', "Actual");//Q4
		$sheet->mergeCells('DQ7:DR7');
		$sheet->setCellValue('DS7', "Target");
		$sheet->mergeCells('DS7:DT7');
		$sheet->setCellValue('DU7', "Index(%)");//4
		$sheet->mergeCells('DU7:DV7');
		$sheet->setCellValue('DW7', "Actual");//TOTAL
		$sheet->mergeCells('DW7:DX7');
		$sheet->setCellValue('DY7', "Target");
		$sheet->mergeCells('DY7:DZ7');
		$sheet->setCellValue('EA7', "Index(%)");//TOTAL
		$sheet->mergeCells('EA7:EB7');
		$sheet->setCellValue('EC7', "Actual");//AVG
		$sheet->mergeCells('EC7:ED7');
		$sheet->setCellValue('EE7', "Target");
		$sheet->mergeCells('EE7:EF7');
		$sheet->setCellValue('EG7', "Index(%)");//AVG
		$sheet->mergeCells('EG7:EH7');


		//Header QTY, VALUE
		$sheet->setCellValue('G8', "Qty");
		$sheet->setCellValue('H8', "Value");
		$sheet->setCellValue('I8', "Qty");
		$sheet->setCellValue('J8', "Value");
		$sheet->setCellValue('K8', "Qty");
		$sheet->setCellValue('L8', "Value");
		$sheet->setCellValue('M8', "Qty");
		$sheet->setCellValue('N8', "Value");
		$sheet->setCellValue('O8', "Qty");
		$sheet->setCellValue('P8', "Value");
		$sheet->setCellValue('Q8', "Qty");
		$sheet->setCellValue('R8', "Value");
		$sheet->setCellValue('S8', "Qty");
		$sheet->setCellValue('T8', "Value");
		$sheet->setCellValue('U8', "Qty");
		$sheet->setCellValue('V8', "Value");
		$sheet->setCellValue('W8', "Qty");
		$sheet->setCellValue('X8', "Value");
		$sheet->setCellValue('Y8', "Qty");
		$sheet->setCellValue('Z8', "Value");
		$sheet->setCellValue('AA8', "Qty");
		$sheet->setCellValue('AB8', "Value");
		$sheet->setCellValue('AC8', "Qty");
		$sheet->setCellValue('AD8', "Value");
		$sheet->setCellValue('AE8', "Qty");
		$sheet->setCellValue('AF8', "Value");
		$sheet->setCellValue('AG8', "Qty");
		$sheet->setCellValue('AH8', "Value");
		$sheet->setCellValue('AI8', "Qty");
		$sheet->setCellValue('AJ8', "Value");
		$sheet->setCellValue('AK8', "Qty");
		$sheet->setCellValue('AL8', "Value");
		$sheet->setCellValue('AM8', "Qty");
		$sheet->setCellValue('AN8', "Value");
		$sheet->setCellValue('AO8', "Qty");
		$sheet->setCellValue('AP8', "Value");
		$sheet->setCellValue('AQ8', "Qty");
		$sheet->setCellValue('AR8', "Value");
		$sheet->setCellValue('AS8', "Qty");
		$sheet->setCellValue('AT8', "Value");
		$sheet->setCellValue('AU8', "Qty");
		$sheet->setCellValue('AV8', "Value");
		$sheet->setCellValue('AW8', "Qty");
		$sheet->setCellValue('AX8', "Value");
		$sheet->setCellValue('AY8', "Qty");
		$sheet->setCellValue('AZ8', "Value");
		$sheet->setCellValue('BA8', "Qty");
		$sheet->setCellValue('BB8', "Value");
		$sheet->setCellValue('BC8', "Qty");
		$sheet->setCellValue('BD8', "Value");
		$sheet->setCellValue('BE8', "Qty");
		$sheet->setCellValue('BF8', "Value");
		$sheet->setCellValue('BG8', "Qty");
		$sheet->setCellValue('BH8', "Value");
		$sheet->setCellValue('BI8', "Qty");
		$sheet->setCellValue('BJ8', "Value");
		$sheet->setCellValue('BK8', "Qty");
		$sheet->setCellValue('BL8', "Value");
		$sheet->setCellValue('BM8', "Qty");
		$sheet->setCellValue('BN8', "Value");
		$sheet->setCellValue('BO8', "Qty");
		$sheet->setCellValue('BP8', "Value");
		$sheet->setCellValue('BQ8', "Qty");
		$sheet->setCellValue('BR8', "Value");
		$sheet->setCellValue('BS8', "Qty");
		$sheet->setCellValue('BT8', "Value");
		$sheet->setCellValue('BU8', "Qty");
		$sheet->setCellValue('BV8', "Value");
		$sheet->setCellValue('BW8', "Qty");
		$sheet->setCellValue('BX8', "Value");
		$sheet->setCellValue('BY8', "Qty");
		$sheet->setCellValue('BZ8', "Value");
		$sheet->setCellValue('CA8', "Qty");
		$sheet->setCellValue('CB8', "Value");
		$sheet->setCellValue('CC8', "Qty");
		$sheet->setCellValue('CD8', "Value");
		$sheet->setCellValue('CE8', "Qty");
		$sheet->setCellValue('CF8', "Value");
		$sheet->setCellValue('CG8', "Qty");
		$sheet->setCellValue('CH8', "Value");
		$sheet->setCellValue('CI8', "Qty");
		$sheet->setCellValue('CJ8', "Value");
		$sheet->setCellValue('CK8', "Qty");
		$sheet->setCellValue('CL8', "Value");
		$sheet->setCellValue('CM8', "Qty");
		$sheet->setCellValue('CN8', "Value");
		$sheet->setCellValue('CO8', "Qty");
		$sheet->setCellValue('CP8', "Value");
		$sheet->setCellValue('CQ8', "Qty");
		$sheet->setCellValue('CR8', "Value");
		$sheet->setCellValue('CS8', "Qty");
		$sheet->setCellValue('CT8', "Value");
		$sheet->setCellValue('CU8', "Qty");
		$sheet->setCellValue('CV8', "Value");
		$sheet->setCellValue('CW8', "Qty");
		$sheet->setCellValue('CX8', "Value");
		$sheet->setCellValue('CY8', "Qty");
		$sheet->setCellValue('CZ8', "Value");
		$sheet->setCellValue('DA8', "Qty");
		$sheet->setCellValue('DB8', "Value");
		$sheet->setCellValue('DC8', "Qty");
		$sheet->setCellValue('DD8', "Value");
		$sheet->setCellValue('DE8', "Qty");
		$sheet->setCellValue('DF8', "Value");
		$sheet->setCellValue('DG8', "Qty");
		$sheet->setCellValue('DH8', "Value");
		$sheet->setCellValue('DI8', "Qty");
		$sheet->setCellValue('DJ8', "Value");
		$sheet->setCellValue('DK8', "Qty");
		$sheet->setCellValue('DL8', "Value");
		$sheet->setCellValue('DM8', "Qty");
		$sheet->setCellValue('DN8', "Value");
		$sheet->setCellValue('DO8', "Qty");
		$sheet->setCellValue('DP8', "Value");
		$sheet->setCellValue('DQ8', "Qty");
		$sheet->setCellValue('DR8', "Value");
		$sheet->setCellValue('DS8', "Qty");
		$sheet->setCellValue('DT8', "Value");
		$sheet->setCellValue('DU8', "Qty");
		$sheet->setCellValue('DV8', "Value");
		$sheet->setCellValue('DW8', "Qty");
		$sheet->setCellValue('DX8', "Value");
		$sheet->setCellValue('DY8', "Qty");
		$sheet->setCellValue('DZ8', "Value");
		$sheet->setCellValue('EA8', "Qty");
		$sheet->setCellValue('EB8', "Value");
		$sheet->setCellValue('EC8', "Qty");
		$sheet->setCellValue('ED8', "Value");
		$sheet->setCellValue('EE8', "Qty");
		$sheet->setCellValue('EF8', "Value");
		$sheet->setCellValue('EG8', "Qty");
		$sheet->setCellValue('EH8', "Value");
		
		
		// Apply style header yang telah kita buat tadi ke masing-masing kolom header
		$sheet->getStyle('A6')->applyFromArray($style_col);
		$sheet->getStyle('B6')->applyFromArray($style_col);
		$sheet->getStyle('C6')->applyFromArray($style_col);
		$sheet->getStyle('D6')->applyFromArray($style_col);
		$sheet->getStyle('E6')->applyFromArray($style_col);
		$sheet->getStyle('F6')->applyFromArray($style_col);
		$sheet->getStyle('G6')->applyFromArray($style_col);
		$sheet->getStyle('H6')->applyFromArray($style_col);
		$sheet->getStyle('I6')->applyFromArray($style_col);
		$sheet->getStyle('J6')->applyFromArray($style_col);
		$sheet->getStyle('K6')->applyFromArray($style_col);
		$sheet->getStyle('L6')->applyFromArray($style_col);
		$sheet->getStyle('M6')->applyFromArray($style_col);
		$sheet->getStyle('N6')->applyFromArray($style_col);
		$sheet->getStyle('O6')->applyFromArray($style_col);
		$sheet->getStyle('P6')->applyFromArray($style_col);
		$sheet->getStyle('Q6')->applyFromArray($style_col);
		$sheet->getStyle('R6')->applyFromArray($style_col);
		$sheet->getStyle('S6')->applyFromArray($style_col);
		$sheet->getStyle('T6')->applyFromArray($style_col);
		$sheet->getStyle('U6')->applyFromArray($style_col);
		$sheet->getStyle('V6')->applyFromArray($style_col);
		$sheet->getStyle('W6')->applyFromArray($style_col);
		$sheet->getStyle('X6')->applyFromArray($style_col);
		$sheet->getStyle('Y6')->applyFromArray($style_col);
		$sheet->getStyle('Z6')->applyFromArray($style_col);
		$sheet->getStyle('AA6')->applyFromArray($style_col);
		$sheet->getStyle('AB6')->applyFromArray($style_col);
		$sheet->getStyle('AC6')->applyFromArray($style_col);
		$sheet->getStyle('AD6')->applyFromArray($style_col);
		$sheet->getStyle('AE6')->applyFromArray($style_col);
		$sheet->getStyle('AF6')->applyFromArray($style_col);
		$sheet->getStyle('AG6')->applyFromArray($style_col);
		$sheet->getStyle('AH6')->applyFromArray($style_col);
		$sheet->getStyle('AI6')->applyFromArray($style_col);
		$sheet->getStyle('AJ6')->applyFromArray($style_col);
		$sheet->getStyle('AK6')->applyFromArray($style_col);
		$sheet->getStyle('AL6')->applyFromArray($style_col);
		$sheet->getStyle('AM6')->applyFromArray($style_col);
		$sheet->getStyle('AN6')->applyFromArray($style_col);
		$sheet->getStyle('AO6')->applyFromArray($style_col);
		$sheet->getStyle('AP6')->applyFromArray($style_col);
		$sheet->getStyle('AQ6')->applyFromArray($style_col);
		$sheet->getStyle('AR6')->applyFromArray($style_col);
		$sheet->getStyle('AS6')->applyFromArray($style_col);
		$sheet->getStyle('AT6')->applyFromArray($style_col);
		$sheet->getStyle('AU6')->applyFromArray($style_col);
		$sheet->getStyle('AV6')->applyFromArray($style_col);
		$sheet->getStyle('AW6')->applyFromArray($style_col);
		$sheet->getStyle('AX6')->applyFromArray($style_col);
		$sheet->getStyle('AY6')->applyFromArray($style_col);
		$sheet->getStyle('AZ6')->applyFromArray($style_col);
		$sheet->getStyle('BA6')->applyFromArray($style_col);
		$sheet->getStyle('BB6')->applyFromArray($style_col);
		$sheet->getStyle('BC6')->applyFromArray($style_col);
		$sheet->getStyle('BD6')->applyFromArray($style_col);
		$sheet->getStyle('BE6')->applyFromArray($style_col);
		$sheet->getStyle('BF6')->applyFromArray($style_col);
		$sheet->getStyle('BG6')->applyFromArray($style_col);
		$sheet->getStyle('BH6')->applyFromArray($style_col);
		$sheet->getStyle('BI6')->applyFromArray($style_col);
		$sheet->getStyle('BJ6')->applyFromArray($style_col);
		$sheet->getStyle('BK6')->applyFromArray($style_col);
		$sheet->getStyle('BL6')->applyFromArray($style_col);
		$sheet->getStyle('BM6')->applyFromArray($style_col);
		$sheet->getStyle('BN6')->applyFromArray($style_col);
		$sheet->getStyle('BO6')->applyFromArray($style_col);
		$sheet->getStyle('BP6')->applyFromArray($style_col);
		$sheet->getStyle('BQ6')->applyFromArray($style_col);
		$sheet->getStyle('BR6')->applyFromArray($style_col);
		$sheet->getStyle('BS6')->applyFromArray($style_col);
		$sheet->getStyle('BT6')->applyFromArray($style_col);
		$sheet->getStyle('BU6')->applyFromArray($style_col);
		$sheet->getStyle('BV6')->applyFromArray($style_col);
		$sheet->getStyle('BW6')->applyFromArray($style_col);
		$sheet->getStyle('BX6')->applyFromArray($style_col);
		$sheet->getStyle('BY6')->applyFromArray($style_col);
		$sheet->getStyle('BZ6')->applyFromArray($style_col);
		$sheet->getStyle('CA6')->applyFromArray($style_col);
		$sheet->getStyle('CB6')->applyFromArray($style_col);
		$sheet->getStyle('CC6')->applyFromArray($style_col);
		$sheet->getStyle('CD6')->applyFromArray($style_col);
		$sheet->getStyle('CE6')->applyFromArray($style_col);
		$sheet->getStyle('CF6')->applyFromArray($style_col);
		$sheet->getStyle('CG6')->applyFromArray($style_col);
		$sheet->getStyle('CH6')->applyFromArray($style_col);
		$sheet->getStyle('CI6')->applyFromArray($style_col);
		$sheet->getStyle('CJ6')->applyFromArray($style_col);
		$sheet->getStyle('CK6')->applyFromArray($style_col);
		$sheet->getStyle('CL6')->applyFromArray($style_col);
		$sheet->getStyle('CM6')->applyFromArray($style_col);
		$sheet->getStyle('CN6')->applyFromArray($style_col);
		$sheet->getStyle('CO6')->applyFromArray($style_col);
		$sheet->getStyle('CP6')->applyFromArray($style_col);
		$sheet->getStyle('CQ6')->applyFromArray($style_col);
		$sheet->getStyle('CR6')->applyFromArray($style_col);
		$sheet->getStyle('CS6')->applyFromArray($style_col);
		$sheet->getStyle('CT6')->applyFromArray($style_col);
		$sheet->getStyle('CU6')->applyFromArray($style_col);
		$sheet->getStyle('CV6')->applyFromArray($style_col);
		$sheet->getStyle('CW6')->applyFromArray($style_col);
		$sheet->getStyle('CX6')->applyFromArray($style_col);
		$sheet->getStyle('CY6')->applyFromArray($style_col);
		$sheet->getStyle('CZ6')->applyFromArray($style_col);
		$sheet->getStyle('DA6')->applyFromArray($style_col);
		$sheet->getStyle('DB6')->applyFromArray($style_col);
		$sheet->getStyle('DC6')->applyFromArray($style_col);
		$sheet->getStyle('DD6')->applyFromArray($style_col);
		$sheet->getStyle('DE6')->applyFromArray($style_col);
		$sheet->getStyle('DF6')->applyFromArray($style_col);
		$sheet->getStyle('DG6')->applyFromArray($style_col);
		$sheet->getStyle('DH6')->applyFromArray($style_col);
		$sheet->getStyle('DI6')->applyFromArray($style_col);
		$sheet->getStyle('DJ6')->applyFromArray($style_col);
		$sheet->getStyle('DK6')->applyFromArray($style_col);
		$sheet->getStyle('DL6')->applyFromArray($style_col);
		$sheet->getStyle('DM6')->applyFromArray($style_col);
		$sheet->getStyle('DN6')->applyFromArray($style_col);
		$sheet->getStyle('DO6')->applyFromArray($style_col);
		$sheet->getStyle('DP6')->applyFromArray($style_col);
		$sheet->getStyle('DQ6')->applyFromArray($style_col);
		$sheet->getStyle('DR6')->applyFromArray($style_col);
		$sheet->getStyle('DS6')->applyFromArray($style_col);
		$sheet->getStyle('DT6')->applyFromArray($style_col);
		$sheet->getStyle('DU6')->applyFromArray($style_col);
		$sheet->getStyle('DV6')->applyFromArray($style_col);
		$sheet->getStyle('DW6')->applyFromArray($style_col);
		$sheet->getStyle('DX6')->applyFromArray($style_col);
		$sheet->getStyle('DY6')->applyFromArray($style_col);
		$sheet->getStyle('DZ6')->applyFromArray($style_col);
		$sheet->getStyle('EA6')->applyFromArray($style_col);
		$sheet->getStyle('EB6')->applyFromArray($style_col);
		$sheet->getStyle('EC6')->applyFromArray($style_col);
		$sheet->getStyle('ED6')->applyFromArray($style_col);
		$sheet->getStyle('EE6')->applyFromArray($style_col);
		$sheet->getStyle('EF6')->applyFromArray($style_col);
		$sheet->getStyle('EG6')->applyFromArray($style_col);
		$sheet->getStyle('EH6')->applyFromArray($style_col);

		$sheet->getStyle('A7')->applyFromArray($style_col);
		$sheet->getStyle('B7')->applyFromArray($style_col);
		$sheet->getStyle('C7')->applyFromArray($style_col);
		$sheet->getStyle('D7')->applyFromArray($style_col);
		$sheet->getStyle('E7')->applyFromArray($style_col);
		$sheet->getStyle('F7')->applyFromArray($style_col);
		$sheet->getStyle('G7')->applyFromArray($style_col);
		$sheet->getStyle('H7')->applyFromArray($style_col);
		$sheet->getStyle('I7')->applyFromArray($style_col);
		$sheet->getStyle('J7')->applyFromArray($style_col);
		$sheet->getStyle('K7')->applyFromArray($style_col);
		$sheet->getStyle('L7')->applyFromArray($style_col);
		$sheet->getStyle('M7')->applyFromArray($style_col);
		$sheet->getStyle('N7')->applyFromArray($style_col);
		$sheet->getStyle('O7')->applyFromArray($style_col);
		$sheet->getStyle('P7')->applyFromArray($style_col);
		$sheet->getStyle('Q7')->applyFromArray($style_col);
		$sheet->getStyle('R7')->applyFromArray($style_col);
		$sheet->getStyle('S7')->applyFromArray($style_col);
		$sheet->getStyle('T7')->applyFromArray($style_col);
		$sheet->getStyle('U7')->applyFromArray($style_col);
		$sheet->getStyle('V7')->applyFromArray($style_col);
		$sheet->getStyle('W7')->applyFromArray($style_col);
		$sheet->getStyle('X7')->applyFromArray($style_col);
		$sheet->getStyle('Y7')->applyFromArray($style_col);
		$sheet->getStyle('Z7')->applyFromArray($style_col);
		$sheet->getStyle('AA7')->applyFromArray($style_col);
		$sheet->getStyle('AB7')->applyFromArray($style_col);
		$sheet->getStyle('AC7')->applyFromArray($style_col);
		$sheet->getStyle('AD7')->applyFromArray($style_col);
		$sheet->getStyle('AE7')->applyFromArray($style_col);
		$sheet->getStyle('AF7')->applyFromArray($style_col);
		$sheet->getStyle('AG7')->applyFromArray($style_col);
		$sheet->getStyle('AH7')->applyFromArray($style_col);
		$sheet->getStyle('AI7')->applyFromArray($style_col);
		$sheet->getStyle('AJ7')->applyFromArray($style_col);
		$sheet->getStyle('AK7')->applyFromArray($style_col);
		$sheet->getStyle('AL7')->applyFromArray($style_col);
		$sheet->getStyle('AM7')->applyFromArray($style_col);
		$sheet->getStyle('AN7')->applyFromArray($style_col);
		$sheet->getStyle('AO7')->applyFromArray($style_col);
		$sheet->getStyle('AP7')->applyFromArray($style_col);
		$sheet->getStyle('AQ7')->applyFromArray($style_col);
		$sheet->getStyle('AR7')->applyFromArray($style_col);
		$sheet->getStyle('AS7')->applyFromArray($style_col);
		$sheet->getStyle('AT7')->applyFromArray($style_col);
		$sheet->getStyle('AU7')->applyFromArray($style_col);
		$sheet->getStyle('AV7')->applyFromArray($style_col);
		$sheet->getStyle('AW7')->applyFromArray($style_col);
		$sheet->getStyle('AX7')->applyFromArray($style_col);
		$sheet->getStyle('AY7')->applyFromArray($style_col);
		$sheet->getStyle('AZ7')->applyFromArray($style_col);
		$sheet->getStyle('BA7')->applyFromArray($style_col);
		$sheet->getStyle('BB7')->applyFromArray($style_col);
		$sheet->getStyle('BC7')->applyFromArray($style_col);
		$sheet->getStyle('BD7')->applyFromArray($style_col);
		$sheet->getStyle('BE7')->applyFromArray($style_col);
		$sheet->getStyle('BF7')->applyFromArray($style_col);
		$sheet->getStyle('BG7')->applyFromArray($style_col);
		$sheet->getStyle('BH7')->applyFromArray($style_col);
		$sheet->getStyle('BI7')->applyFromArray($style_col);
		$sheet->getStyle('BJ7')->applyFromArray($style_col);
		$sheet->getStyle('BK7')->applyFromArray($style_col);
		$sheet->getStyle('BL7')->applyFromArray($style_col);
		$sheet->getStyle('BM7')->applyFromArray($style_col);
		$sheet->getStyle('BN7')->applyFromArray($style_col);
		$sheet->getStyle('BO7')->applyFromArray($style_col);
		$sheet->getStyle('BP7')->applyFromArray($style_col);
		$sheet->getStyle('BQ7')->applyFromArray($style_col);
		$sheet->getStyle('BR7')->applyFromArray($style_col);
		$sheet->getStyle('BS7')->applyFromArray($style_col);
		$sheet->getStyle('BT7')->applyFromArray($style_col);
		$sheet->getStyle('BU7')->applyFromArray($style_col);
		$sheet->getStyle('BV7')->applyFromArray($style_col);
		$sheet->getStyle('BW7')->applyFromArray($style_col);
		$sheet->getStyle('BX7')->applyFromArray($style_col);
		$sheet->getStyle('BY7')->applyFromArray($style_col);
		$sheet->getStyle('BZ7')->applyFromArray($style_col);
		$sheet->getStyle('CA7')->applyFromArray($style_col);
		$sheet->getStyle('CB7')->applyFromArray($style_col);
		$sheet->getStyle('CC7')->applyFromArray($style_col);
		$sheet->getStyle('CD7')->applyFromArray($style_col);
		$sheet->getStyle('CE7')->applyFromArray($style_col);
		$sheet->getStyle('CF7')->applyFromArray($style_col);
		$sheet->getStyle('CG7')->applyFromArray($style_col);
		$sheet->getStyle('CH7')->applyFromArray($style_col);
		$sheet->getStyle('CI7')->applyFromArray($style_col);
		$sheet->getStyle('CJ7')->applyFromArray($style_col);
		$sheet->getStyle('CK7')->applyFromArray($style_col);
		$sheet->getStyle('CL7')->applyFromArray($style_col);
		$sheet->getStyle('CM7')->applyFromArray($style_col);
		$sheet->getStyle('CN7')->applyFromArray($style_col);
		$sheet->getStyle('CO7')->applyFromArray($style_col);
		$sheet->getStyle('CP7')->applyFromArray($style_col);
		$sheet->getStyle('CQ7')->applyFromArray($style_col);
		$sheet->getStyle('CR7')->applyFromArray($style_col);
		$sheet->getStyle('CS7')->applyFromArray($style_col);
		$sheet->getStyle('CT7')->applyFromArray($style_col);
		$sheet->getStyle('CU7')->applyFromArray($style_col);
		$sheet->getStyle('CV7')->applyFromArray($style_col);
		$sheet->getStyle('CW7')->applyFromArray($style_col);
		$sheet->getStyle('CX7')->applyFromArray($style_col);
		$sheet->getStyle('CY7')->applyFromArray($style_col);
		$sheet->getStyle('CZ7')->applyFromArray($style_col);
		$sheet->getStyle('DA7')->applyFromArray($style_col);
		$sheet->getStyle('DB7')->applyFromArray($style_col);
		$sheet->getStyle('DC7')->applyFromArray($style_col);
		$sheet->getStyle('DD7')->applyFromArray($style_col);
		$sheet->getStyle('DE7')->applyFromArray($style_col);
		$sheet->getStyle('DF7')->applyFromArray($style_col);
		$sheet->getStyle('DG7')->applyFromArray($style_col);
		$sheet->getStyle('DH7')->applyFromArray($style_col);
		$sheet->getStyle('DI7')->applyFromArray($style_col);
		$sheet->getStyle('DJ7')->applyFromArray($style_col);
		$sheet->getStyle('DK7')->applyFromArray($style_col);
		$sheet->getStyle('DL7')->applyFromArray($style_col);
		$sheet->getStyle('DM7')->applyFromArray($style_col);
		$sheet->getStyle('DN7')->applyFromArray($style_col);
		$sheet->getStyle('DO7')->applyFromArray($style_col);
		$sheet->getStyle('DP7')->applyFromArray($style_col);
		$sheet->getStyle('DQ7')->applyFromArray($style_col);
		$sheet->getStyle('DR7')->applyFromArray($style_col);
		$sheet->getStyle('DS7')->applyFromArray($style_col);
		$sheet->getStyle('DT7')->applyFromArray($style_col);
		$sheet->getStyle('DU7')->applyFromArray($style_col);
		$sheet->getStyle('DV7')->applyFromArray($style_col);
		$sheet->getStyle('DW7')->applyFromArray($style_col);
		$sheet->getStyle('DX7')->applyFromArray($style_col);
		$sheet->getStyle('DY7')->applyFromArray($style_col);
		$sheet->getStyle('DZ7')->applyFromArray($style_col);
		$sheet->getStyle('EA7')->applyFromArray($style_col);
		$sheet->getStyle('EB7')->applyFromArray($style_col);
		$sheet->getStyle('EC7')->applyFromArray($style_col);
		$sheet->getStyle('ED7')->applyFromArray($style_col);
		$sheet->getStyle('EE7')->applyFromArray($style_col);
		$sheet->getStyle('EF7')->applyFromArray($style_col);
		$sheet->getStyle('EG7')->applyFromArray($style_col);
		$sheet->getStyle('EH7')->applyFromArray($style_col);

		$sheet->getStyle('A8')->applyFromArray($style_col);
		$sheet->getStyle('B8')->applyFromArray($style_col);
		$sheet->getStyle('C8')->applyFromArray($style_col);
		$sheet->getStyle('D8')->applyFromArray($style_col);
		$sheet->getStyle('E8')->applyFromArray($style_col);
		$sheet->getStyle('F8')->applyFromArray($style_col);
		$sheet->getStyle('G8')->applyFromArray($style_col);
		$sheet->getStyle('H8')->applyFromArray($style_col);
		$sheet->getStyle('I8')->applyFromArray($style_col);
		$sheet->getStyle('J8')->applyFromArray($style_col);
		$sheet->getStyle('K8')->applyFromArray($style_col);
		$sheet->getStyle('L8')->applyFromArray($style_col);
		$sheet->getStyle('M8')->applyFromArray($style_col);
		$sheet->getStyle('N8')->applyFromArray($style_col);
		$sheet->getStyle('O8')->applyFromArray($style_col);
		$sheet->getStyle('P8')->applyFromArray($style_col);
		$sheet->getStyle('Q8')->applyFromArray($style_col);
		$sheet->getStyle('R8')->applyFromArray($style_col);
		$sheet->getStyle('S8')->applyFromArray($style_col);
		$sheet->getStyle('T8')->applyFromArray($style_col);
		$sheet->getStyle('U8')->applyFromArray($style_col);
		$sheet->getStyle('V8')->applyFromArray($style_col);
		$sheet->getStyle('W8')->applyFromArray($style_col);
		$sheet->getStyle('X8')->applyFromArray($style_col);
		$sheet->getStyle('Y8')->applyFromArray($style_col);
		$sheet->getStyle('Z8')->applyFromArray($style_col);
		$sheet->getStyle('AA8')->applyFromArray($style_col);
		$sheet->getStyle('AB8')->applyFromArray($style_col);
		$sheet->getStyle('AC8')->applyFromArray($style_col);
		$sheet->getStyle('AD8')->applyFromArray($style_col);
		$sheet->getStyle('AE8')->applyFromArray($style_col);
		$sheet->getStyle('AF8')->applyFromArray($style_col);
		$sheet->getStyle('AG8')->applyFromArray($style_col);
		$sheet->getStyle('AH8')->applyFromArray($style_col);
		$sheet->getStyle('AI8')->applyFromArray($style_col);
		$sheet->getStyle('AJ8')->applyFromArray($style_col);
		$sheet->getStyle('AK8')->applyFromArray($style_col);
		$sheet->getStyle('AL8')->applyFromArray($style_col);
		$sheet->getStyle('AM8')->applyFromArray($style_col);
		$sheet->getStyle('AN8')->applyFromArray($style_col);
		$sheet->getStyle('AO8')->applyFromArray($style_col);
		$sheet->getStyle('AP8')->applyFromArray($style_col);
		$sheet->getStyle('AQ8')->applyFromArray($style_col);
		$sheet->getStyle('AR8')->applyFromArray($style_col);
		$sheet->getStyle('AS8')->applyFromArray($style_col);
		$sheet->getStyle('AT8')->applyFromArray($style_col);
		$sheet->getStyle('AU8')->applyFromArray($style_col);
		$sheet->getStyle('AV8')->applyFromArray($style_col);
		$sheet->getStyle('AW8')->applyFromArray($style_col);
		$sheet->getStyle('AX8')->applyFromArray($style_col);
		$sheet->getStyle('AY8')->applyFromArray($style_col);
		$sheet->getStyle('AZ8')->applyFromArray($style_col);
		$sheet->getStyle('BA8')->applyFromArray($style_col);
		$sheet->getStyle('BB8')->applyFromArray($style_col);
		$sheet->getStyle('BC8')->applyFromArray($style_col);
		$sheet->getStyle('BD8')->applyFromArray($style_col);
		$sheet->getStyle('BE8')->applyFromArray($style_col);
		$sheet->getStyle('BF8')->applyFromArray($style_col);
		$sheet->getStyle('BG8')->applyFromArray($style_col);
		$sheet->getStyle('BH8')->applyFromArray($style_col);
		$sheet->getStyle('BI8')->applyFromArray($style_col);
		$sheet->getStyle('BJ8')->applyFromArray($style_col);
		$sheet->getStyle('BK8')->applyFromArray($style_col);
		$sheet->getStyle('BL8')->applyFromArray($style_col);
		$sheet->getStyle('BM8')->applyFromArray($style_col);
		$sheet->getStyle('BN8')->applyFromArray($style_col);
		$sheet->getStyle('BO8')->applyFromArray($style_col);
		$sheet->getStyle('BP8')->applyFromArray($style_col);
		$sheet->getStyle('BQ8')->applyFromArray($style_col);
		$sheet->getStyle('BR8')->applyFromArray($style_col);
		$sheet->getStyle('BS8')->applyFromArray($style_col);
		$sheet->getStyle('BT8')->applyFromArray($style_col);
		$sheet->getStyle('BU8')->applyFromArray($style_col);
		$sheet->getStyle('BV8')->applyFromArray($style_col);
		$sheet->getStyle('BW8')->applyFromArray($style_col);
		$sheet->getStyle('BX8')->applyFromArray($style_col);
		$sheet->getStyle('BY8')->applyFromArray($style_col);
		$sheet->getStyle('BZ8')->applyFromArray($style_col);
		$sheet->getStyle('CA8')->applyFromArray($style_col);
		$sheet->getStyle('CB8')->applyFromArray($style_col);
		$sheet->getStyle('CC8')->applyFromArray($style_col);
		$sheet->getStyle('CD8')->applyFromArray($style_col);
		$sheet->getStyle('CE8')->applyFromArray($style_col);
		$sheet->getStyle('CF8')->applyFromArray($style_col);
		$sheet->getStyle('CG8')->applyFromArray($style_col);
		$sheet->getStyle('CH8')->applyFromArray($style_col);
		$sheet->getStyle('CI8')->applyFromArray($style_col);
		$sheet->getStyle('CJ8')->applyFromArray($style_col);
		$sheet->getStyle('CK8')->applyFromArray($style_col);
		$sheet->getStyle('CL8')->applyFromArray($style_col);
		$sheet->getStyle('CM8')->applyFromArray($style_col);
		$sheet->getStyle('CN8')->applyFromArray($style_col);
		$sheet->getStyle('CO8')->applyFromArray($style_col);
		$sheet->getStyle('CP8')->applyFromArray($style_col);
		$sheet->getStyle('CQ8')->applyFromArray($style_col);
		$sheet->getStyle('CR8')->applyFromArray($style_col);
		$sheet->getStyle('CS8')->applyFromArray($style_col);
		$sheet->getStyle('CT8')->applyFromArray($style_col);
		$sheet->getStyle('CU8')->applyFromArray($style_col);
		$sheet->getStyle('CV8')->applyFromArray($style_col);
		$sheet->getStyle('CW8')->applyFromArray($style_col);
		$sheet->getStyle('CX8')->applyFromArray($style_col);
		$sheet->getStyle('CY8')->applyFromArray($style_col);
		$sheet->getStyle('CZ8')->applyFromArray($style_col);
		$sheet->getStyle('DA8')->applyFromArray($style_col);
		$sheet->getStyle('DB8')->applyFromArray($style_col);
		$sheet->getStyle('DC8')->applyFromArray($style_col);
		$sheet->getStyle('DD8')->applyFromArray($style_col);
		$sheet->getStyle('DE8')->applyFromArray($style_col);
		$sheet->getStyle('DF8')->applyFromArray($style_col);
		$sheet->getStyle('DG8')->applyFromArray($style_col);
		$sheet->getStyle('DH8')->applyFromArray($style_col);
		$sheet->getStyle('DI8')->applyFromArray($style_col);
		$sheet->getStyle('DJ8')->applyFromArray($style_col);
		$sheet->getStyle('DK8')->applyFromArray($style_col);
		$sheet->getStyle('DL8')->applyFromArray($style_col);
		$sheet->getStyle('DM8')->applyFromArray($style_col);
		$sheet->getStyle('DN8')->applyFromArray($style_col);
		$sheet->getStyle('DO8')->applyFromArray($style_col);
		$sheet->getStyle('DP8')->applyFromArray($style_col);
		$sheet->getStyle('DQ8')->applyFromArray($style_col);
		$sheet->getStyle('DR8')->applyFromArray($style_col);
		$sheet->getStyle('DS8')->applyFromArray($style_col);
		$sheet->getStyle('DT8')->applyFromArray($style_col);
		$sheet->getStyle('DU8')->applyFromArray($style_col);
		$sheet->getStyle('DV8')->applyFromArray($style_col);
		$sheet->getStyle('DW8')->applyFromArray($style_col);
		$sheet->getStyle('DX8')->applyFromArray($style_col);
		$sheet->getStyle('DY8')->applyFromArray($style_col);
		$sheet->getStyle('DZ8')->applyFromArray($style_col);
		$sheet->getStyle('EA8')->applyFromArray($style_col);
		$sheet->getStyle('EB8')->applyFromArray($style_col);
		$sheet->getStyle('EC8')->applyFromArray($style_col);
		$sheet->getStyle('ED8')->applyFromArray($style_col);
		$sheet->getStyle('EE8')->applyFromArray($style_col);
		$sheet->getStyle('EF8')->applyFromArray($style_col);
		$sheet->getStyle('EG8')->applyFromArray($style_col);
		$sheet->getStyle('EH8')->applyFromArray($style_col);

		$sheet->getStyle('A6:AD8')->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');
		$sheet->getStyle('AE6:AJ8')->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFFF00');//Q1
		$sheet->getStyle('AK6:BH8')->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');
		$sheet->getStyle('BI6:BN8')->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFFF00');//Q2
		$sheet->getStyle('BO6:CL8')->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');
		$sheet->getStyle('CM6:CR8')->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFFF00');//Q3
		$sheet->getStyle('CS6:DP8')->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');
		$sheet->getStyle('DQ6:DV8')->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFFF00');//Q4
		$sheet->getStyle('DW6:EB8')->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFA07A');//TOTAL
		$sheet->getStyle('EC6:EH8')->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('98FB98');//AVG

		// Set height baris ke 1 dan 2
		$sheet->getRowDimension('1')->setRowHeight(40);
		$sheet->getRowDimension('2')->setRowHeight(20);
		$sheet->getRowDimension('3')->setRowHeight(20);
		$sheet->getRowDimension('4')->setRowHeight(20);


		$item_group = '';
        $principal = '';

        $qty_jan = 0;
		$qty_feb = 0;
		$qty_mar = 0;
		$qty_q1 = 0;
		$qty_apr = 0;
		$qty_mei = 0;
		$qty_jun = 0;
		$qty_q2 = 0;
		$qty_jul = 0;
		$qty_agu = 0;
		$qty_sep = 0;
		$qty_q3 = 0;
		$qty_okt = 0;
		$qty_nop = 0;
		$qty_des = 0;
		$qty_q4 = 0;
		$qty_year = 0;
		$qty_avg = 0;

		$val_jan = 0;
		$val_feb = 0;
		$val_mar = 0;
		$val_q1 = 0;
		$val_apr = 0;
		$val_mei = 0;
		$val_jun = 0;
		$val_q2 = 0;
		$val_jul = 0;
		$val_agu = 0;
		$val_sep = 0;
		$val_q3 = 0;
		$val_okt = 0;
		$val_nop = 0;
		$val_des = 0;
		$val_q4 = 0;
		$val_year = 0;
		$val_avg = 0;

		$target_qty_jan = 0;
		$target_qty_feb = 0;
		$target_qty_mar = 0;
		$target_qty_q1 = 0;
		$target_qty_apr = 0;
		$target_qty_mei = 0;
		$target_qty_jun = 0;
		$target_qty_q2 = 0;
		$target_qty_jul = 0;
		$target_qty_agu = 0;
		$target_qty_sep = 0;
		$target_qty_q3 = 0;
		$target_qty_okt = 0;
		$target_qty_nop = 0;
		$target_qty_des = 0;
		$target_qty_q4 = 0;
		$target_qty_year = 0;
		$target_qty_avg = 0;

		$target_val_jan = 0;
		$target_val_feb = 0;
		$target_val_mar = 0;
		$target_val_q1 = 0;
		$target_val_apr = 0;
		$target_val_mei = 0;
		$target_val_jun = 0;
		$target_val_q2 = 0;
		$target_val_jul = 0;
		$target_val_agu = 0;
		$target_val_sep = 0;
		$target_val_q3 = 0;
		$target_val_okt = 0;
		$target_val_nop = 0;
		$target_val_des = 0;
		$target_val_q4 = 0;
		$target_val_year = 0;
		$target_val_avg = 0;

		$idx_qty_jan = 0;
		$idx_qty_feb = 0;
		$idx_qty_mar = 0;
		$idx_qty_q1 = 0;
		$idx_qty_apr = 0;
		$idx_qty_mei = 0;
		$idx_qty_jun = 0;
		$idx_qty_q2 = 0;
		$idx_qty_jul = 0;
		$idx_qty_agu = 0;
		$idx_qty_sep = 0;
		$idx_qty_q3 = 0;
		$idx_qty_okt = 0;
		$idx_qty_nop = 0;
		$idx_qty_des = 0;
		$idx_qty_q4 = 0;
		$idx_qty_year = 0;
		$idx_qty_avg = 0;

		$idx_val_jan = 0;
		$idx_val_feb = 0;
		$idx_val_mar = 0;
		$idx_val_q1 = 0;
		$idx_val_apr = 0;
		$idx_val_mei = 0;
		$idx_val_jun = 0;
		$idx_val_q2 = 0;
		$idx_val_jul = 0;
		$idx_val_agu = 0;
		$idx_val_sep = 0;
		$idx_val_q3 = 0;
		$idx_val_okt = 0;
		$idx_val_nop = 0;
		$idx_val_des = 0;
		$idx_val_q4 = 0;
		$idx_val_year = 0;
		$idx_val_avg = 0;

		$stok_qty_jan = 0;
		$stok_qty_feb = 0;
		$stok_qty_mar = 0;
		$stok_qty_q1 = 0;
		$stok_qty_apr = 0;
		$stok_qty_mei = 0;
		$stok_qty_jun = 0;
		$stok_qty_q2 = 0;
		$stok_qty_jul = 0;
		$stok_qty_agu = 0;
		$stok_qty_sep = 0;
		$stok_qty_q3 = 0;
		$stok_qty_okt = 0;
		$stok_qty_nop = 0;
		$stok_qty_des = 0;
		$stok_qty_q4 = 0;
		$stok_qty_year = 0;
		$stok_qty_avg = 0;

		$stok_val_jan = 0;
		$stok_val_feb = 0;
		$stok_val_mar = 0;
		$stok_val_q1 = 0;
		$stok_val_apr = 0;
		$stok_val_mei = 0;
		$stok_val_jun = 0;
		$stok_val_q2 = 0;
		$stok_val_jul = 0;
		$stok_val_agu = 0;
		$stok_val_sep = 0;
		$stok_val_q3 = 0;
		$stok_val_okt = 0;
		$stok_val_nop = 0;
		$stok_val_des = 0;
		$stok_val_q4 = 0;
		$stok_val_year = 0;
		$stok_val_avg = 0;

		$sub_qty_jan = 0;
		$sub_qty_feb = 0;
		$sub_qty_mar = 0;
		$sub_qty_q1 = 0;
		$sub_qty_apr = 0;
		$sub_qty_mei = 0;
		$sub_qty_jun = 0;
		$sub_qty_q2 = 0;
		$sub_qty_jul = 0;
		$sub_qty_agu = 0;
		$sub_qty_sep = 0;
		$sub_qty_q3 = 0;
		$sub_qty_okt = 0;
		$sub_qty_nop = 0;
		$sub_qty_des = 0;
		$sub_qty_q4 = 0;
		$sub_qty_year = 0;
		$sub_qty_avg = 0;

		$sub_val_jan = 0;
		$sub_val_feb = 0;
		$sub_val_mar = 0;
		$sub_val_q1 = 0;
		$sub_val_apr = 0;
		$sub_val_mei = 0;
		$sub_val_jun = 0;
		$sub_val_q2 = 0;
		$sub_val_jul = 0;
		$sub_val_agu = 0;
		$sub_val_sep = 0;
		$sub_val_q3 = 0;
		$sub_val_okt = 0;
		$sub_val_nop = 0;
		$sub_val_des = 0;
		$sub_val_q4 = 0;
		$sub_val_year = 0;
		$sub_val_avg = 0;

		$sub_target_qty_jan = 0;
		$sub_target_qty_feb = 0;
		$sub_target_qty_mar = 0;
		$sub_target_qty_q1 = 0;
		$sub_target_qty_apr = 0;
		$sub_target_qty_mei = 0;
		$sub_target_qty_jun = 0;
		$sub_target_qty_q2 = 0;
		$sub_target_qty_jul = 0;
		$sub_target_qty_agu = 0;
		$sub_target_qty_sep = 0;
		$sub_target_qty_q3 = 0;
		$sub_target_qty_okt = 0;
		$sub_target_qty_nop = 0;
		$sub_target_qty_des = 0;
		$sub_target_qty_q4 = 0;
		$sub_target_qty_year = 0;
		$sub_target_qty_avg = 0;

		$sub_target_val_jan = 0;
		$sub_target_val_feb = 0;
		$sub_target_val_mar = 0;
		$sub_target_val_q1 = 0;
		$sub_target_val_apr = 0;
		$sub_target_val_mei = 0;
		$sub_target_val_jun = 0;
		$sub_target_val_q2 = 0;
		$sub_target_val_jul = 0;
		$sub_target_val_agu = 0;
		$sub_target_val_sep = 0;
		$sub_target_val_q3 = 0;
		$sub_target_val_okt = 0;
		$sub_target_val_nop = 0;
		$sub_target_val_des = 0;
		$sub_target_val_q4 = 0;
		$sub_target_val_year = 0;
		$sub_target_val_avg = 0;

		$sub_idx_qty_jan = 0;
		$sub_idx_qty_feb = 0;
		$sub_idx_qty_mar = 0;
		$sub_idx_qty_q1 = 0;
		$sub_idx_qty_apr = 0;
		$sub_idx_qty_mei = 0;
		$sub_idx_qty_jun = 0;
		$sub_idx_qty_q2 = 0;
		$sub_idx_qty_jul = 0;
		$sub_idx_qty_agu = 0;
		$sub_idx_qty_sep = 0;
		$sub_idx_qty_q3 = 0;
		$sub_idx_qty_okt = 0;
		$sub_idx_qty_nop = 0;
		$sub_idx_qty_des = 0;
		$sub_idx_qty_q4 = 0;
		$sub_idx_qty_year = 0;
		$sub_idx_qty_avg = 0;

		$sub_idx_val_jan = 0;
		$sub_idx_val_feb = 0;
		$sub_idx_val_mar = 0;
		$sub_idx_val_q1 = 0;
		$sub_idx_val_apr = 0;
		$sub_idx_val_mei = 0;
		$sub_idx_val_jun = 0;
		$sub_idx_val_q2 = 0;
		$sub_idx_val_jul = 0;
		$sub_idx_val_agu = 0;
		$sub_idx_val_sep = 0;
		$sub_idx_val_q3 = 0;
		$sub_idx_val_okt = 0;
		$sub_idx_val_nop = 0;
		$sub_idx_val_des = 0;
		$sub_idx_val_q4 = 0;
		$sub_idx_val_year = 0;
		$sub_idx_val_avg = 0;

		$sub_stok_qty_jan = 0;
		$sub_stok_qty_feb = 0;
		$sub_stok_qty_mar = 0;
		$sub_stok_qty_q1 = 0;
		$sub_stok_qty_apr = 0;
		$sub_stok_qty_mei = 0;
		$sub_stok_qty_jun = 0;
		$sub_stok_qty_q2 = 0;
		$sub_stok_qty_jul = 0;
		$sub_stok_qty_agu = 0;
		$sub_stok_qty_sep = 0;
		$sub_stok_qty_q3 = 0;
		$sub_stok_qty_okt = 0;
		$sub_stok_qty_nop = 0;
		$sub_stok_qty_des = 0;
		$sub_stok_qty_q4 = 0;
		$sub_stok_qty_year = 0;
		$sub_stok_qty_avg = 0;

		$sub_stok_val_jan = 0;
		$sub_stok_val_feb = 0;
		$sub_stok_val_mar = 0;
		$sub_stok_val_q1 = 0;
		$sub_stok_val_apr = 0;
		$sub_stok_val_mei = 0;
		$sub_stok_val_jun = 0;
		$sub_stok_val_q2 = 0;
		$sub_stok_val_jul = 0;
		$sub_stok_val_agu = 0;
		$sub_stok_val_sep = 0;
		$sub_stok_val_q3 = 0;
		$sub_stok_val_okt = 0;
		$sub_stok_val_nop = 0;
		$sub_stok_val_des = 0;
		$sub_stok_val_q4 = 0;
		$sub_stok_val_year = 0;
		$sub_stok_val_avg = 0;

		$total_qty_jan = 0;
		$total_qty_feb = 0;
		$total_qty_mar = 0;
		$total_qty_q1 = 0;
		$total_qty_apr = 0;
		$total_qty_mei = 0;
		$total_qty_jun = 0;
		$total_qty_q2 = 0;
		$total_qty_jul = 0;
		$total_qty_agu = 0;
		$total_qty_sep = 0;
		$total_qty_q3 = 0;
		$total_qty_okt = 0;
		$total_qty_nop = 0;
		$total_qty_des = 0;
		$total_qty_q4 = 0;
		$total_qty_year = 0;
		$total_qty_avg = 0;

		$total_val_jan = 0;
		$total_val_feb = 0;
		$total_val_mar = 0;
		$total_val_q1 = 0;
		$total_val_apr = 0;
		$total_val_mei = 0;
		$total_val_jun = 0;
		$total_val_q2 = 0;
		$total_val_jul = 0;
		$total_val_agu = 0;
		$total_val_sep = 0;
		$total_val_q3 = 0;
		$total_val_okt = 0;
		$total_val_nop = 0;
		$total_val_des = 0;
		$total_val_q4 = 0;
		$total_val_year = 0;
		$total_val_avg = 0;

		$total_target_qty_jan = 0;
		$total_target_qty_feb = 0;
		$total_target_qty_mar = 0;
		$total_target_qty_q1 = 0;
		$total_target_qty_apr = 0;
		$total_target_qty_mei = 0;
		$total_target_qty_jun = 0;
		$total_target_qty_q2 = 0;
		$total_target_qty_jul = 0;
		$total_target_qty_agu = 0;
		$total_target_qty_sep = 0;
		$total_target_qty_q3 = 0;
		$total_target_qty_okt = 0;
		$total_target_qty_nop = 0;
		$total_target_qty_des = 0;
		$total_target_qty_q4 = 0;
		$total_target_qty_year = 0;
		$total_target_qty_avg = 0;

		$total_target_val_jan = 0;
		$total_target_val_feb = 0;
		$total_target_val_mar = 0;
		$total_target_val_q1 = 0;
		$total_target_val_apr = 0;
		$total_target_val_mei = 0;
		$total_target_val_jun = 0;
		$total_target_val_q2 = 0;
		$total_target_val_jul = 0;
		$total_target_val_agu = 0;
		$total_target_val_sep = 0;
		$total_target_val_q3 = 0;
		$total_target_val_okt = 0;
		$total_target_val_nop = 0;
		$total_target_val_des = 0;
		$total_target_val_q4 = 0;
		$total_target_val_year = 0;
		$total_target_val_avg = 0;

		$total_idx_qty_jan = 0;
		$total_idx_qty_feb = 0;
		$total_idx_qty_mar = 0;
		$total_idx_qty_q1 = 0;
		$total_idx_qty_apr = 0;
		$total_idx_qty_mei = 0;
		$total_idx_qty_jun = 0;
		$total_idx_qty_q2 = 0;
		$total_idx_qty_jul = 0;
		$total_idx_qty_agu = 0;
		$total_idx_qty_sep = 0;
		$total_idx_qty_q3 = 0;
		$total_idx_qty_okt = 0;
		$total_idx_qty_nop = 0;
		$total_idx_qty_des = 0;
		$total_idx_qty_q4 = 0;
		$total_idx_qty_year = 0;
		$total_idx_qty_avg = 0;

		$total_idx_val_jan = 0;
		$total_idx_val_feb = 0;
		$total_idx_val_mar = 0;
		$total_idx_val_q1 = 0;
		$total_idx_val_apr = 0;
		$total_idx_val_mei = 0;
		$total_idx_val_jun = 0;
		$total_idx_val_q2 = 0;
		$total_idx_val_jul = 0;
		$total_idx_val_agu = 0;
		$total_idx_val_sep = 0;
		$total_idx_val_q3 = 0;
		$total_idx_val_okt = 0;
		$total_idx_val_nop = 0;
		$total_idx_val_des = 0;
		$total_idx_val_q4 = 0;
		$total_idx_val_year = 0;
		$total_idx_val_avg = 0;

		$total_stok_qty_jan = 0;
		$total_stok_qty_feb = 0;
		$total_stok_qty_mar = 0;
		$total_stok_qty_q1 = 0;
		$total_stok_qty_apr = 0;
		$total_stok_qty_mei = 0;
		$total_stok_qty_jun = 0;
		$total_stok_qty_q2 = 0;
		$total_stok_qty_jul = 0;
		$total_stok_qty_agu = 0;
		$total_stok_qty_sep = 0;
		$total_stok_qty_q3 = 0;
		$total_stok_qty_okt = 0;
		$total_stok_qty_nop = 0;
		$total_stok_qty_des = 0;
		$total_stok_qty_q4 = 0;
		$total_stok_qty_year = 0;
		$total_stok_qty_avg = 0;

		$total_stok_val_jan = 0;
		$total_stok_val_feb = 0;
		$total_stok_val_mar = 0;
		$total_stok_val_q1 = 0;
		$total_stok_val_apr = 0;
		$total_stok_val_mei = 0;
		$total_stok_val_jun = 0;
		$total_stok_val_q2 = 0;
		$total_stok_val_jul = 0;
		$total_stok_val_agu = 0;
		$total_stok_val_sep = 0;
		$total_stok_val_q3 = 0;
		$total_stok_val_okt = 0;
		$total_stok_val_nop = 0;
		$total_stok_val_des = 0;
		$total_stok_val_q4 = 0;
		$total_stok_val_year = 0;
		$total_stok_val_avg = 0;


		$no = 1; // Untuk penomoran tabel, di awal set dengan 1
		$row = 9;

		$data1 = array(
			'island' => $island,
			'region' => $region,
			'area' => $area,
			'year' => $year
		);

		$data['sellingin'] = $this->model('ReportModel')->getSellingIn_Year_pivot();

		foreach ($data['sellingin'] as $rows) :

			if ($item_group != $rows['item_group'] and $item_group != '' )
            {
				
				$sheet->setCellValue('A' . $row, '');
				$sheet->setCellValue('B' . $row, $principal);
				$sheet->setCellValue('C' . $row, $item_group);
				$sheet->setCellValue('D' . $row, '');
				$sheet->setCellValue('E' . $row, 'Sub Total ' . $item_group);
				$sheet->setCellValue('F' . $row, '');
				$sheet->setCellValue('G' . $row, $qty_jan);
				$sheet->setCellValue('H' . $row, $val_jan);
				$sheet->setCellValue('I' . $row, $target_qty_jan);
				$sheet->setCellValue('J' . $row, $target_val_jan);
				$sheet->setCellValue('K' . $row, $idx_qty_jan);
				$sheet->setCellValue('L' . $row, $idx_val_jan);
				$sheet->setCellValue('M' . $row, $stok_qty_jan);
				$sheet->setCellValue('N' . $row, $stok_val_jan);
				$sheet->setCellValue('O' . $row, $qty_feb);
				$sheet->setCellValue('P' . $row, $val_feb);
				$sheet->setCellValue('Q' . $row, $target_qty_feb);
				$sheet->setCellValue('R' . $row, $target_val_feb);
				$sheet->setCellValue('S' . $row, $idx_qty_feb);
				$sheet->setCellValue('T' . $row, $idx_val_feb);
				$sheet->setCellValue('U' . $row, $stok_qty_feb);
				$sheet->setCellValue('V' . $row, $stok_val_feb);
				$sheet->setCellValue('W' . $row, $qty_mar);
				$sheet->setCellValue('X' . $row, $val_mar);
				$sheet->setCellValue('Y' . $row, $target_qty_mar);
				$sheet->setCellValue('Z' . $row, $target_val_mar);
				$sheet->setCellValue('AA' . $row, $idx_qty_mar);
				$sheet->setCellValue('AB' . $row, $idx_val_mar);
				$sheet->setCellValue('AC' . $row, $stok_qty_mar);
				$sheet->setCellValue('AD' . $row, $stok_val_mar);
				$sheet->setCellValue('AE' . $row, $qty_q1);
				$sheet->setCellValue('AF' . $row, $val_q1);
				$sheet->setCellValue('AG' . $row, $target_qty_q1);
				$sheet->setCellValue('AH' . $row, $target_val_q1);
				$sheet->setCellValue('AI' . $row, $idx_qty_q1);
				$sheet->setCellValue('AJ' . $row, $idx_val_q1);

				$sheet->setCellValue('AK' . $row, $qty_apr);
				$sheet->setCellValue('AL' . $row, $val_apr);
				$sheet->setCellValue('AM' . $row, $target_qty_apr);
				$sheet->setCellValue('AN' . $row, $target_val_apr);
				$sheet->setCellValue('AO' . $row, $idx_qty_apr);
				$sheet->setCellValue('AP' . $row, $idx_val_apr);
				$sheet->setCellValue('AQ' . $row, $stok_qty_apr);
				$sheet->setCellValue('AR' . $row, $stok_val_apr);
				$sheet->setCellValue('AS' . $row, $qty_mei);
				$sheet->setCellValue('AT' . $row, $val_mei);
				$sheet->setCellValue('AU' . $row, $target_qty_mei);
				$sheet->setCellValue('AV' . $row, $target_val_mei);
				$sheet->setCellValue('AW' . $row, $idx_qty_mei);
				$sheet->setCellValue('AX' . $row, $idx_val_mei);
				$sheet->setCellValue('AY' . $row, $stok_qty_mei);
				$sheet->setCellValue('AZ' . $row, $stok_val_mei);
				$sheet->setCellValue('BA' . $row, $qty_jun);
				$sheet->setCellValue('BB' . $row, $val_jun);
				$sheet->setCellValue('BC' . $row, $target_qty_jun);
				$sheet->setCellValue('BD' . $row, $target_val_jun);
				$sheet->setCellValue('BE' . $row, $idx_qty_jun);
				$sheet->setCellValue('BF' . $row, $idx_val_jun);
				$sheet->setCellValue('BG' . $row, $stok_qty_jun);
				$sheet->setCellValue('BH' . $row, $stok_val_jun);
				$sheet->setCellValue('BI' . $row, $qty_q2);
				$sheet->setCellValue('BJ' . $row, $val_q2);
				$sheet->setCellValue('BK' . $row, $target_qty_q2);
				$sheet->setCellValue('BL' . $row, $target_val_q2);
				$sheet->setCellValue('BM' . $row, $idx_qty_q2);
				$sheet->setCellValue('BN' . $row, $idx_val_q2);

				$sheet->setCellValue('BO' . $row, $qty_jul);
				$sheet->setCellValue('BP' . $row, $val_jul);
				$sheet->setCellValue('BQ' . $row, $target_qty_jul);
				$sheet->setCellValue('BR' . $row, $target_val_jul);
				$sheet->setCellValue('BS' . $row, $idx_qty_jul);
				$sheet->setCellValue('BT' . $row, $idx_val_jul);
				$sheet->setCellValue('BU' . $row, $stok_qty_jul);
				$sheet->setCellValue('BV' . $row, $stok_val_jul);
				$sheet->setCellValue('BW' . $row, $qty_agu);
				$sheet->setCellValue('BX' . $row, $val_agu);
				$sheet->setCellValue('BY' . $row, $target_qty_agu);
				$sheet->setCellValue('BZ' . $row, $target_val_agu);
				$sheet->setCellValue('CA' . $row, $idx_qty_agu);
				$sheet->setCellValue('CB' . $row, $idx_val_agu);
				$sheet->setCellValue('CC' . $row, $stok_qty_agu);
				$sheet->setCellValue('CD' . $row, $stok_val_agu);
				$sheet->setCellValue('CE' . $row, $qty_sep);
				$sheet->setCellValue('CF' . $row, $val_sep);
				$sheet->setCellValue('CG' . $row, $target_qty_sep);
				$sheet->setCellValue('CH' . $row, $target_val_sep);
				$sheet->setCellValue('CI' . $row, $idx_qty_sep);
				$sheet->setCellValue('CJ' . $row, $idx_val_sep);
				$sheet->setCellValue('CK' . $row, $stok_qty_sep);
				$sheet->setCellValue('CL' . $row, $stok_val_sep);
				$sheet->setCellValue('CM' . $row, $qty_q3);
				$sheet->setCellValue('CN' . $row, $val_q3);
				$sheet->setCellValue('CO' . $row, $target_qty_q3);
				$sheet->setCellValue('CP' . $row, $target_val_q3);
				$sheet->setCellValue('CQ' . $row, $idx_qty_q3);
				$sheet->setCellValue('CR' . $row, $idx_val_q3);

				$sheet->setCellValue('CS' . $row, $qty_okt);
				$sheet->setCellValue('CT' . $row, $val_okt);
				$sheet->setCellValue('CU' . $row, $target_qty_okt);
				$sheet->setCellValue('CV' . $row, $target_val_okt);
				$sheet->setCellValue('CW' . $row, $idx_qty_okt);
				$sheet->setCellValue('CX' . $row, $idx_val_okt);
				$sheet->setCellValue('CY' . $row, $stok_qty_okt);
				$sheet->setCellValue('CZ' . $row, $stok_val_okt);
				$sheet->setCellValue('DA' . $row, $qty_nop);
				$sheet->setCellValue('DB' . $row, $val_nop);
				$sheet->setCellValue('DC' . $row, $target_qty_nop);
				$sheet->setCellValue('DD' . $row, $target_val_nop);
				$sheet->setCellValue('DE' . $row, $idx_qty_nop);
				$sheet->setCellValue('DF' . $row, $idx_val_nop);
				$sheet->setCellValue('DG' . $row, $stok_qty_nop);
				$sheet->setCellValue('DH' . $row, $stok_val_nop);
				$sheet->setCellValue('DI' . $row, $qty_des);
				$sheet->setCellValue('DJ' . $row, $val_des);
				$sheet->setCellValue('DK' . $row, $target_qty_des);
				$sheet->setCellValue('DL' . $row, $target_val_des);
				$sheet->setCellValue('DM' . $row, $idx_qty_des);
				$sheet->setCellValue('DN' . $row, $idx_val_des);
				$sheet->setCellValue('DO' . $row, $stok_qty_des);
				$sheet->setCellValue('DP' . $row, $stok_val_des);
				$sheet->setCellValue('DQ' . $row, $qty_q4);
				$sheet->setCellValue('DR' . $row, $val_q4);
				$sheet->setCellValue('DS' . $row, $target_qty_q4);
				$sheet->setCellValue('DT' . $row, $target_val_q4);
				$sheet->setCellValue('DU' . $row, $idx_qty_q4);
				$sheet->setCellValue('DV' . $row, $idx_val_q4);

				$qty_year = $qty_jan + $qty_feb + $qty_mar + $qty_apr + $qty_mei + $qty_jun + $qty_jul + $qty_agu + $qty_sep + $qty_okt + $qty_nop + $qty_des;
				$target_qty_year = $target_qty_jan + $target_qty_feb + $target_qty_mar + $target_qty_apr + $target_qty_mei + $target_qty_jun + $target_qty_jul + $target_qty_agu + $target_qty_sep + $target_qty_okt + $target_qty_nop + $target_qty_des;
				$idx_qty_year = ($qty_year/($target_qty_year ?: 1))*100;
				$val_year = $val_jan + $val_feb + $val_mar + $val_apr + $val_mei + $val_jun + $val_jul + $val_agu + $val_sep + $val_okt + $val_nop + $val_des;
				$target_val_year = $target_val_jan + $target_val_feb + $target_val_mar + $target_val_apr + $target_val_mei + $target_val_jun + $target_val_jul + $target_val_agu + $target_val_sep + $target_val_okt + $target_val_nop + $target_val_des;
				$idx_val_year = ($val_year/($target_val_year ?: 1))*100;
				$qty_avg = $qty_year / 12;
				$target_qty_avg = $target_qty_year / 12;
				$idx_qty_avg = ($qty_avg/($target_qty_avg ?: 1))*100;
				$val_avg = $val_year / 12;
				$target_val_avg = $target_val_year / 12;
				$idx_val_avg = ($val_avg/($target_val_avg ?: 1))*100;

				$sheet->setCellValue('DW' . $row, $qty_year);
				$sheet->setCellValue('DX' . $row, $val_year);
				$sheet->setCellValue('DY' . $row, $target_qty_year);
				$sheet->setCellValue('DZ' . $row, $target_val_year);
				$sheet->setCellValue('EA' . $row, $idx_qty_year);
				$sheet->setCellValue('EB' . $row, $idx_val_year);
				$sheet->setCellValue('EC' . $row, $qty_avg);
				$sheet->setCellValue('ED' . $row, $val_avg);
				$sheet->setCellValue('EE' . $row, $target_qty_avg);
				$sheet->setCellValue('EF' . $row, $target_val_avg);
				$sheet->setCellValue('EG' . $row, $idx_qty_avg);
				$sheet->setCellValue('EH' . $row, $idx_val_avg);

				// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
				$sheet->getStyle('A' . $row)->applyFromArray($style_row);
				$sheet->getStyle('B' . $row)->applyFromArray($style_row);
				$sheet->getStyle('C' . $row)->applyFromArray($style_row);
				$sheet->getStyle('D' . $row)->applyFromArray($style_row);
				$sheet->getStyle('E' . $row)->applyFromArray($style_row);
				$sheet->getStyle('F' . $row)->applyFromArray($style_row);
				$sheet->getStyle('G' . $row)->applyFromArray($style_row);
				$sheet->getStyle('H' . $row)->applyFromArray($style_row);
				$sheet->getStyle('I' . $row)->applyFromArray($style_row);
				$sheet->getStyle('J' . $row)->applyFromArray($style_row);
				$sheet->getStyle('K' . $row)->applyFromArray($style_row);
				$sheet->getStyle('L' . $row)->applyFromArray($style_row);
				$sheet->getStyle('M' . $row)->applyFromArray($style_row);
				$sheet->getStyle('N' . $row)->applyFromArray($style_row);
				$sheet->getStyle('O' . $row)->applyFromArray($style_row);
				$sheet->getStyle('P' . $row)->applyFromArray($style_row);
				$sheet->getStyle('Q' . $row)->applyFromArray($style_row);
				$sheet->getStyle('R' . $row)->applyFromArray($style_row);
				$sheet->getStyle('S' . $row)->applyFromArray($style_row);
				$sheet->getStyle('T' . $row)->applyFromArray($style_row);
				$sheet->getStyle('U' . $row)->applyFromArray($style_row);
				$sheet->getStyle('V' . $row)->applyFromArray($style_row);
				$sheet->getStyle('W' . $row)->applyFromArray($style_row);
				$sheet->getStyle('X' . $row)->applyFromArray($style_row);
				$sheet->getStyle('Y' . $row)->applyFromArray($style_row);
				$sheet->getStyle('Z' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AA' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AB' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AC' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AD' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AE' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AF' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AG' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AH' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AI' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AJ' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AK' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AL' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AM' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AN' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AO' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AP' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AQ' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AR' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AS' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AT' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AU' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AV' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AW' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AX' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AY' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AZ' . $row)->applyFromArray($style_row);
				$sheet->getStyle('BA' . $row)->applyFromArray($style_row);
				$sheet->getStyle('BB' . $row)->applyFromArray($style_row);
				$sheet->getStyle('BC' . $row)->applyFromArray($style_row);
				$sheet->getStyle('BD' . $row)->applyFromArray($style_row);
				$sheet->getStyle('BE' . $row)->applyFromArray($style_row);
				$sheet->getStyle('BF' . $row)->applyFromArray($style_row);
				$sheet->getStyle('BG' . $row)->applyFromArray($style_row);
				$sheet->getStyle('BH' . $row)->applyFromArray($style_row);
				$sheet->getStyle('BI' . $row)->applyFromArray($style_row);
				$sheet->getStyle('BJ' . $row)->applyFromArray($style_row);
				$sheet->getStyle('BK' . $row)->applyFromArray($style_row);
				$sheet->getStyle('BL' . $row)->applyFromArray($style_row);
				$sheet->getStyle('BM' . $row)->applyFromArray($style_row);
				$sheet->getStyle('BN' . $row)->applyFromArray($style_row);
				$sheet->getStyle('BO' . $row)->applyFromArray($style_row);
				$sheet->getStyle('BP' . $row)->applyFromArray($style_row);
				$sheet->getStyle('BQ' . $row)->applyFromArray($style_row);
				$sheet->getStyle('BR' . $row)->applyFromArray($style_row);
				$sheet->getStyle('BS' . $row)->applyFromArray($style_row);
				$sheet->getStyle('BT' . $row)->applyFromArray($style_row);
				$sheet->getStyle('BU' . $row)->applyFromArray($style_row);
				$sheet->getStyle('BV' . $row)->applyFromArray($style_row);
				$sheet->getStyle('BW' . $row)->applyFromArray($style_row);
				$sheet->getStyle('BX' . $row)->applyFromArray($style_row);
				$sheet->getStyle('BY' . $row)->applyFromArray($style_row);
				$sheet->getStyle('BZ' . $row)->applyFromArray($style_row);
				$sheet->getStyle('CA' . $row)->applyFromArray($style_row);
				$sheet->getStyle('CB' . $row)->applyFromArray($style_row);
				$sheet->getStyle('CC' . $row)->applyFromArray($style_row);
				$sheet->getStyle('CD' . $row)->applyFromArray($style_row);
				$sheet->getStyle('CE' . $row)->applyFromArray($style_row);
				$sheet->getStyle('CF' . $row)->applyFromArray($style_row);
				$sheet->getStyle('CG' . $row)->applyFromArray($style_row);
				$sheet->getStyle('CH' . $row)->applyFromArray($style_row);
				$sheet->getStyle('CI' . $row)->applyFromArray($style_row);
				$sheet->getStyle('CJ' . $row)->applyFromArray($style_row);
				$sheet->getStyle('CK' . $row)->applyFromArray($style_row);
				$sheet->getStyle('CL' . $row)->applyFromArray($style_row);
				$sheet->getStyle('CM' . $row)->applyFromArray($style_row);
				$sheet->getStyle('CN' . $row)->applyFromArray($style_row);
				$sheet->getStyle('CO' . $row)->applyFromArray($style_row);
				$sheet->getStyle('CP' . $row)->applyFromArray($style_row);
				$sheet->getStyle('CQ' . $row)->applyFromArray($style_row);
				$sheet->getStyle('CR' . $row)->applyFromArray($style_row);
				$sheet->getStyle('CS' . $row)->applyFromArray($style_row);
				$sheet->getStyle('CT' . $row)->applyFromArray($style_row);
				$sheet->getStyle('CU' . $row)->applyFromArray($style_row);
				$sheet->getStyle('CV' . $row)->applyFromArray($style_row);
				$sheet->getStyle('CW' . $row)->applyFromArray($style_row);
				$sheet->getStyle('CX' . $row)->applyFromArray($style_row);
				$sheet->getStyle('CY' . $row)->applyFromArray($style_row);
				$sheet->getStyle('CZ' . $row)->applyFromArray($style_row);
				$sheet->getStyle('DA' . $row)->applyFromArray($style_row);
				$sheet->getStyle('DB' . $row)->applyFromArray($style_row);
				$sheet->getStyle('DC' . $row)->applyFromArray($style_row);
				$sheet->getStyle('DD' . $row)->applyFromArray($style_row);
				$sheet->getStyle('DE' . $row)->applyFromArray($style_row);
				$sheet->getStyle('DF' . $row)->applyFromArray($style_row);
				$sheet->getStyle('DG' . $row)->applyFromArray($style_row);
				$sheet->getStyle('DH' . $row)->applyFromArray($style_row);
				$sheet->getStyle('DI' . $row)->applyFromArray($style_row);
				$sheet->getStyle('DJ' . $row)->applyFromArray($style_row);
				$sheet->getStyle('DK' . $row)->applyFromArray($style_row);
				$sheet->getStyle('DL' . $row)->applyFromArray($style_row);
				$sheet->getStyle('DM' . $row)->applyFromArray($style_row);
				$sheet->getStyle('DN' . $row)->applyFromArray($style_row);
				$sheet->getStyle('DO' . $row)->applyFromArray($style_row);
				$sheet->getStyle('DP' . $row)->applyFromArray($style_row);
				$sheet->getStyle('DQ' . $row)->applyFromArray($style_row);
				$sheet->getStyle('DR' . $row)->applyFromArray($style_row);
				$sheet->getStyle('DS' . $row)->applyFromArray($style_row);
				$sheet->getStyle('DT' . $row)->applyFromArray($style_row);
				$sheet->getStyle('DU' . $row)->applyFromArray($style_row);
				$sheet->getStyle('DV' . $row)->applyFromArray($style_row);
				$sheet->getStyle('DW' . $row)->applyFromArray($style_row);
				$sheet->getStyle('DX' . $row)->applyFromArray($style_row);
				$sheet->getStyle('DY' . $row)->applyFromArray($style_row);
				$sheet->getStyle('DZ' . $row)->applyFromArray($style_row);
				$sheet->getStyle('EA' . $row)->applyFromArray($style_row);
				$sheet->getStyle('EB' . $row)->applyFromArray($style_row);
				$sheet->getStyle('EC' . $row)->applyFromArray($style_row);
				$sheet->getStyle('ED' . $row)->applyFromArray($style_row);
				$sheet->getStyle('EE' . $row)->applyFromArray($style_row);
				$sheet->getStyle('EF' . $row)->applyFromArray($style_row);
				$sheet->getStyle('EG' . $row)->applyFromArray($style_row);
				$sheet->getStyle('EH' . $row)->applyFromArray($style_row);


				$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
				$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
				$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
				$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
				$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
				$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
				$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('I' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('J' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('K' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('L' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('M' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('N' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('O' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('P' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('Q' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('R' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('S' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('T' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('U' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('V' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('W' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('X' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('Y' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('Z' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AA' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AB' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AC' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AD' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AE' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AF' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AG' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AH' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AI' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AJ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AK' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AL' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AM' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AN' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AO' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AP' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AQ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AR' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AS' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AT' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AU' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AV' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AX' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AY' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AZ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('BA' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('BB' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('BC' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('BD' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('BE' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('BF' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('BG' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('BH' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('BI' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('BJ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('BK' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('BL' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('BM' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('BN' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('BO' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('BQ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('BR' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('BS' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('BT' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('BU' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('BV' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('BW' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('BX' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('BY' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('BZ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('CA' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('CB' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('CC' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('CD' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('CE' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('CF' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('CG' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('CH' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('CI' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('CJ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('CK' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('CL' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('CM' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('CN' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('CO' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('CP' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('CQ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('CR' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('CS' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('CT' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('CU' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('CV' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('CW' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('CX' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('CY' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('CZ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('DA' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('DB' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('DC' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('DD' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('DE' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('DF' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('DG' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('DH' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('DI' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('DJ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('DK' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('DL' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('DM' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('DN' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('DO' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('DP' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('DQ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('DR' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('DS' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('DT' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('DU' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('DV' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('DW' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('DX' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('DY' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('DZ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('EA' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('EB' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('EC' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('ED' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('EE' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('EF' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('EG' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('EH' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

				$sheet->getStyle('G' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('H' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('I' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('J' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('K' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('L' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('M' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('N' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('O' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('P' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('Q' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('R' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('S' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('T' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('U' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('V' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('W' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('X' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('Y' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('Z' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('AA' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('AB' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('AC' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('AD' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('AE' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('AF' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('AG' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('AH' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('AI' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('AJ' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('AK' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('AL' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('AM' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('AN' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('AO' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('AP' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('AQ' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('AR' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('AS' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('AT' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('AU' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('AV' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('AW' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('AX' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('AY' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('AZ' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('AB' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('BB' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('BC' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('BD' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('BE' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('BF' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('BG' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('BH' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('BI' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('BJ' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('BK' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('BL' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('BM' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('BN' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('BO' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('BP' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('BQ' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('BR' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('BS' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('BT' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('BU' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('BV' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('BW' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('BX' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('BY' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('BZ' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('CA' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('CB' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('CC' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('CD' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('CE' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('CF' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('CG' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('CH' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('CI' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('CJ' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('CK' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('CL' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('CM' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('CN' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('CO' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('CP' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('CQ' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('CR' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('CS' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('CT' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('CU' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('CV' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('CW' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('CX' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('CY' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('CZ' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('DA' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('DB' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('DC' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('DD' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('DE' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('DF' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('DG' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('DH' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('DI' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('DJ' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('DK' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('DL' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('DM' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('DN' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('DO' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('DP' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('DQ' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('DR' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('DS' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('DT' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('DU' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('DW' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('DW' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('DX' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('DY' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('DZ' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('EA' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('EB' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('EC' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('ED' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('EE' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('EF' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('EG' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('EH' . $row)->getNumberFormat()->setFormatCode('#.00');
	

				$sheet->getStyle('A' . $row . ':EH' . $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');
				$sheet->getStyle('A' . $row . ':EH' . $row)->getFont()->setBold(true);

				$qty_jan = 0;
				$qty_feb = 0;
				$qty_mar = 0;
				$qty_q1 = 0;
				$qty_apr = 0;
				$qty_mei = 0;
				$qty_jun = 0;
				$qty_q2 = 0;
				$qty_jul = 0;
				$qty_agu = 0;
				$qty_sep = 0;
				$qty_q3 = 0;
				$qty_okt = 0;
				$qty_nop = 0;
				$qty_des = 0;
				$qty_q4 = 0;
				$qty_year = 0;
				$qty_avg = 0;

				$val_jan = 0;
				$val_feb = 0;
				$val_mar = 0;
				$val_q1 = 0;
				$val_apr = 0;
				$val_mei = 0;
				$val_jun = 0;
				$val_q2 = 0;
				$val_jul = 0;
				$val_agu = 0;
				$val_sep = 0;
				$val_q3 = 0;
				$val_okt = 0;
				$val_nop = 0;
				$val_des = 0;
				$val_q4 = 0;
				$val_year = 0;
				$val_avg = 0;

				$target_qty_jan = 0;
				$target_qty_feb = 0;
				$target_qty_mar = 0;
				$target_qty_q1 = 0;
				$target_qty_apr = 0;
				$target_qty_mei = 0;
				$target_qty_jun = 0;
				$target_qty_q2 = 0;
				$target_qty_jul = 0;
				$target_qty_agu = 0;
				$target_qty_sep = 0;
				$target_qty_q3 = 0;
				$target_qty_okt = 0;
				$target_qty_nop = 0;
				$target_qty_des = 0;
				$target_qty_q4 = 0;
				$target_qty_year = 0;
				$target_qty_avg = 0;

				$target_val_jan = 0;
				$target_val_feb = 0;
				$target_val_mar = 0;
				$target_val_q1 = 0;
				$target_val_apr = 0;
				$target_val_mei = 0;
				$target_val_jun = 0;
				$target_val_q2 = 0;
				$target_val_jul = 0;
				$target_val_agu = 0;
				$target_val_sep = 0;
				$target_val_q3 = 0;
				$target_val_okt = 0;
				$target_val_nop = 0;
				$target_val_des = 0;
				$target_val_q4 = 0;
				$target_val_year = 0;
				$target_val_avg = 0;

				$idx_qty_jan = 0;
				$idx_qty_feb = 0;
				$idx_qty_mar = 0;
				$idx_qty_q1 = 0;
				$idx_qty_apr = 0;
				$idx_qty_mei = 0;
				$idx_qty_jun = 0;
				$idx_qty_q2 = 0;
				$idx_qty_jul = 0;
				$idx_qty_agu = 0;
				$idx_qty_sep = 0;
				$idx_qty_q3 = 0;
				$idx_qty_okt = 0;
				$idx_qty_nop = 0;
				$idx_qty_des = 0;
				$idx_qty_q4 = 0;
				$idx_qty_year = 0;
				$idx_qty_avg = 0;

				$idx_val_jan = 0;
				$idx_val_feb = 0;
				$idx_val_mar = 0;
				$idx_val_q1 = 0;
				$idx_val_apr = 0;
				$idx_val_mei = 0;
				$idx_val_jun = 0;
				$idx_val_q2 = 0;
				$idx_val_jul = 0;
				$idx_val_agu = 0;
				$idx_val_sep = 0;
				$idx_val_q3 = 0;
				$idx_val_okt = 0;
				$idx_val_nop = 0;
				$idx_val_des = 0;
				$idx_val_q4 = 0;
				$idx_val_year = 0;
				$idx_val_avg = 0;

				$stok_qty_jan = 0;
				$stok_qty_feb = 0;
				$stok_qty_mar = 0;
				$stok_qty_q1 = 0;
				$stok_qty_apr = 0;
				$stok_qty_mei = 0;
				$stok_qty_jun = 0;
				$stok_qty_q2 = 0;
				$stok_qty_jul = 0;
				$stok_qty_agu = 0;
				$stok_qty_sep = 0;
				$stok_qty_q3 = 0;
				$stok_qty_okt = 0;
				$stok_qty_nop = 0;
				$stok_qty_des = 0;
				$stok_qty_q4 = 0;
				$stok_qty_year = 0;
				$stok_qty_avg = 0;

				$stok_val_jan = 0;
				$stok_val_feb = 0;
				$stok_val_mar = 0;
				$stok_val_q1 = 0;
				$stok_val_apr = 0;
				$stok_val_mei = 0;
				$stok_val_jun = 0;
				$stok_val_q2 = 0;
				$stok_val_jul = 0;
				$stok_val_agu = 0;
				$stok_val_sep = 0;
				$stok_val_q3 = 0;
				$stok_val_okt = 0;
				$stok_val_nop = 0;
				$stok_val_des = 0;
				$stok_val_q4 = 0;
				$stok_val_year = 0;
				$stok_val_avg = 0;

				$row++;
            }

			if ($principal != $rows['principal'] and $principal != '' )
            {
				
				$sheet->setCellValue('A' . $row, '');
				$sheet->setCellValue('B' . $row, $principal);
				$sheet->setCellValue('C' . $row, '');
				$sheet->setCellValue('D' . $row, '');
				$sheet->setCellValue('E' . $row, 'TOTAL ' . $principal);
				$sheet->setCellValue('F' . $row, '');
				$sheet->setCellValue('G' . $row, $sub_qty_jan);
				$sheet->setCellValue('H' . $row, $sub_val_jan);
				$sheet->setCellValue('I' . $row, $sub_target_qty_jan);
				$sheet->setCellValue('J' . $row, $sub_target_val_jan);
				$sheet->setCellValue('K' . $row, $sub_idx_qty_jan);
				$sheet->setCellValue('L' . $row, $sub_idx_val_jan);
				$sheet->setCellValue('M' . $row, $sub_stok_qty_jan);
				$sheet->setCellValue('N' . $row, $sub_stok_val_jan);
				$sheet->setCellValue('O' . $row, $sub_qty_feb);
				$sheet->setCellValue('P' . $row, $sub_val_feb);
				$sheet->setCellValue('Q' . $row, $sub_target_qty_feb);
				$sheet->setCellValue('R' . $row, $sub_target_val_feb);
				$sheet->setCellValue('S' . $row, $sub_idx_qty_feb);
				$sheet->setCellValue('T' . $row, $sub_idx_val_feb);
				$sheet->setCellValue('U' . $row, $sub_stok_qty_feb);
				$sheet->setCellValue('V' . $row, $sub_stok_val_feb);
				$sheet->setCellValue('W' . $row, $sub_qty_mar);
				$sheet->setCellValue('X' . $row, $sub_val_mar);
				$sheet->setCellValue('Y' . $row, $sub_target_qty_mar);
				$sheet->setCellValue('Z' . $row, $sub_target_val_mar);
				$sheet->setCellValue('AA' . $row, $sub_idx_qty_mar);
				$sheet->setCellValue('AB' . $row, $sub_idx_val_mar);
				$sheet->setCellValue('AC' . $row, $sub_stok_qty_mar);
				$sheet->setCellValue('AD' . $row, $sub_stok_val_mar);
				$sheet->setCellValue('AE' . $row, $sub_qty_q1);
				$sheet->setCellValue('AF' . $row, $sub_val_q1);
				$sheet->setCellValue('AG' . $row, $sub_target_qty_q1);
				$sheet->setCellValue('AH' . $row, $sub_target_val_q1);
				$sheet->setCellValue('AI' . $row, $sub_idx_qty_q1);
				$sheet->setCellValue('AJ' . $row, $sub_idx_val_q1);

				$sheet->setCellValue('AK' . $row, $sub_qty_apr);
				$sheet->setCellValue('AL' . $row, $sub_val_apr);
				$sheet->setCellValue('AM' . $row, $sub_target_qty_apr);
				$sheet->setCellValue('AN' . $row, $sub_target_val_apr);
				$sheet->setCellValue('AO' . $row, $sub_idx_qty_apr);
				$sheet->setCellValue('AP' . $row, $sub_idx_val_apr);
				$sheet->setCellValue('AQ' . $row, $sub_stok_qty_apr);
				$sheet->setCellValue('AR' . $row, $sub_stok_val_apr);
				$sheet->setCellValue('AS' . $row, $sub_qty_mei);
				$sheet->setCellValue('AT' . $row, $sub_val_mei);
				$sheet->setCellValue('AU' . $row, $sub_target_qty_mei);
				$sheet->setCellValue('AV' . $row, $sub_target_val_mei);
				$sheet->setCellValue('AW' . $row, $sub_idx_qty_mei);
				$sheet->setCellValue('AX' . $row, $sub_idx_val_mei);
				$sheet->setCellValue('AY' . $row, $sub_stok_qty_mei);
				$sheet->setCellValue('AZ' . $row, $sub_stok_val_mei);
				$sheet->setCellValue('BA' . $row, $sub_qty_jun);
				$sheet->setCellValue('BB' . $row, $sub_val_jun);
				$sheet->setCellValue('BC' . $row, $sub_target_qty_jun);
				$sheet->setCellValue('BD' . $row, $sub_target_val_jun);
				$sheet->setCellValue('BE' . $row, $sub_idx_qty_jun);
				$sheet->setCellValue('BF' . $row, $sub_idx_val_jun);
				$sheet->setCellValue('BG' . $row, $sub_stok_qty_jun);
				$sheet->setCellValue('BH' . $row, $sub_stok_val_jun);
				$sheet->setCellValue('BI' . $row, $sub_qty_q2);
				$sheet->setCellValue('BJ' . $row, $sub_val_q2);
				$sheet->setCellValue('BK' . $row, $sub_target_qty_q2);
				$sheet->setCellValue('BL' . $row, $sub_target_val_q2);
				$sheet->setCellValue('BM' . $row, $sub_idx_qty_q2);
				$sheet->setCellValue('BN' . $row, $sub_idx_val_q2);

				$sheet->setCellValue('BO' . $row, $sub_qty_jul);
				$sheet->setCellValue('BP' . $row, $sub_val_jul);
				$sheet->setCellValue('BQ' . $row, $sub_target_qty_jul);
				$sheet->setCellValue('BR' . $row, $sub_target_val_jul);
				$sheet->setCellValue('BS' . $row, $sub_idx_qty_jul);
				$sheet->setCellValue('BT' . $row, $sub_idx_val_jul);
				$sheet->setCellValue('BU' . $row, $sub_stok_qty_jul);
				$sheet->setCellValue('BV' . $row, $sub_stok_val_jul);
				$sheet->setCellValue('BW' . $row, $sub_qty_agu);
				$sheet->setCellValue('BX' . $row, $sub_val_agu);
				$sheet->setCellValue('BY' . $row, $sub_target_qty_agu);
				$sheet->setCellValue('BZ' . $row, $sub_target_val_agu);
				$sheet->setCellValue('CA' . $row, $sub_idx_qty_agu);
				$sheet->setCellValue('CB' . $row, $sub_idx_val_agu);
				$sheet->setCellValue('CC' . $row, $sub_stok_qty_agu);
				$sheet->setCellValue('CD' . $row, $sub_stok_val_agu);
				$sheet->setCellValue('CE' . $row, $sub_qty_sep);
				$sheet->setCellValue('CF' . $row, $sub_val_sep);
				$sheet->setCellValue('CG' . $row, $sub_target_qty_sep);
				$sheet->setCellValue('CH' . $row, $sub_target_val_sep);
				$sheet->setCellValue('CI' . $row, $sub_idx_qty_sep);
				$sheet->setCellValue('CJ' . $row, $sub_idx_val_sep);
				$sheet->setCellValue('CK' . $row, $sub_stok_qty_sep);
				$sheet->setCellValue('CL' . $row, $sub_stok_val_sep);
				$sheet->setCellValue('CM' . $row, $sub_qty_q3);
				$sheet->setCellValue('CN' . $row, $sub_val_q3);
				$sheet->setCellValue('CO' . $row, $sub_target_qty_q3);
				$sheet->setCellValue('CP' . $row, $sub_target_val_q3);
				$sheet->setCellValue('CQ' . $row, $sub_idx_qty_q3);
				$sheet->setCellValue('CR' . $row, $sub_idx_val_q3);

				$sheet->setCellValue('CS' . $row, $sub_qty_okt);
				$sheet->setCellValue('CT' . $row, $sub_val_okt);
				$sheet->setCellValue('CU' . $row, $sub_target_qty_okt);
				$sheet->setCellValue('CV' . $row, $sub_target_val_okt);
				$sheet->setCellValue('CW' . $row, $sub_idx_qty_okt);
				$sheet->setCellValue('CX' . $row, $sub_idx_val_okt);
				$sheet->setCellValue('CY' . $row, $sub_stok_qty_okt);
				$sheet->setCellValue('CZ' . $row, $sub_stok_val_okt);
				$sheet->setCellValue('DA' . $row, $sub_qty_nop);
				$sheet->setCellValue('DB' . $row, $sub_val_nop);
				$sheet->setCellValue('DC' . $row, $sub_target_qty_nop);
				$sheet->setCellValue('DD' . $row, $sub_target_val_nop);
				$sheet->setCellValue('DE' . $row, $sub_idx_qty_nop);
				$sheet->setCellValue('DF' . $row, $sub_idx_val_nop);
				$sheet->setCellValue('DG' . $row, $sub_stok_qty_nop);
				$sheet->setCellValue('DH' . $row, $sub_stok_val_nop);
				$sheet->setCellValue('DI' . $row, $sub_qty_des);
				$sheet->setCellValue('DJ' . $row, $sub_val_des);
				$sheet->setCellValue('DK' . $row, $sub_target_qty_des);
				$sheet->setCellValue('DL' . $row, $sub_target_val_des);
				$sheet->setCellValue('DM' . $row, $sub_idx_qty_des);
				$sheet->setCellValue('DN' . $row, $sub_idx_val_des);
				$sheet->setCellValue('DO' . $row, $sub_stok_qty_des);
				$sheet->setCellValue('DP' . $row, $sub_stok_val_des);
				$sheet->setCellValue('DQ' . $row, $sub_qty_q4);
				$sheet->setCellValue('DR' . $row, $sub_val_q4);
				$sheet->setCellValue('DS' . $row, $sub_target_qty_q4);
				$sheet->setCellValue('DT' . $row, $sub_target_val_q4);
				$sheet->setCellValue('DU' . $row, $sub_idx_qty_q4);
				$sheet->setCellValue('DV' . $row, $sub_idx_val_q4);

				$sub_qty_year = $sub_qty_jan + $sub_qty_feb + $sub_qty_mar + $sub_qty_apr + $sub_qty_mei + $sub_qty_jun + $sub_qty_jul + $sub_qty_agu + $sub_qty_sep + $sub_qty_okt + $sub_qty_nop + $sub_qty_des;
				$sub_target_qty_year = $sub_target_qty_jan + $sub_target_qty_feb + $sub_target_qty_mar + $sub_target_qty_apr + $sub_target_qty_mei + $sub_target_qty_jun + $sub_target_qty_jul + $sub_target_qty_agu + $sub_target_qty_sep + $sub_target_qty_okt + $sub_target_qty_nop + $sub_target_qty_des;
				$sub_idx_qty_year = ($sub_qty_year/($sub_target_qty_year ?: 1))*100;
				$sub_val_year = $sub_val_jan + $sub_val_feb + $sub_val_mar + $sub_val_apr + $sub_val_mei + $sub_val_jun + $sub_val_jul + $sub_val_agu + $sub_val_sep + $sub_val_okt + $sub_val_nop + $sub_val_des;
				$sub_target_val_year = $sub_target_val_jan + $sub_target_val_feb + $sub_target_val_mar + $sub_target_val_apr + $sub_target_val_mei + $sub_target_val_jun + $sub_target_val_jul + $sub_target_val_agu + $sub_target_val_sep + $sub_target_val_okt + $sub_target_val_nop + $sub_target_val_des;
				$sub_idx_val_year = ($sub_val_year/($sub_target_val_year ?: 1))*100;
				$sub_qty_avg = $sub_qty_year / 12;
				$sub_target_qty_avg = $sub_target_qty_year / 12;
				$sub_idx_qty_avg = ($sub_qty_avg/($sub_target_qty_avg ?: 1))*100;
				$sub_val_avg = $sub_val_year / 12;
				$sub_target_val_avg = $sub_target_val_year / 12;
				$sub_idx_val_avg = ($sub_val_avg/($sub_target_val_avg ?: 1))*100;

				$sheet->setCellValue('DW' . $row, $sub_qty_year);
				$sheet->setCellValue('DX' . $row, $sub_val_year);
				$sheet->setCellValue('DY' . $row, $sub_target_qty_year);
				$sheet->setCellValue('DZ' . $row, $sub_target_val_year);
				$sheet->setCellValue('EA' . $row, $sub_idx_qty_year);
				$sheet->setCellValue('EB' . $row, $sub_idx_val_year);
				$sheet->setCellValue('EC' . $row, $sub_qty_avg);
				$sheet->setCellValue('ED' . $row, $sub_val_avg);
				$sheet->setCellValue('EE' . $row, $sub_target_qty_avg);
				$sheet->setCellValue('EF' . $row, $sub_target_val_avg);
				$sheet->setCellValue('EG' . $row, $sub_idx_qty_avg);
				$sheet->setCellValue('EH' . $row, $sub_idx_val_avg);

				// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
				$sheet->getStyle('A' . $row)->applyFromArray($style_row);
				$sheet->getStyle('B' . $row)->applyFromArray($style_row);
				$sheet->getStyle('C' . $row)->applyFromArray($style_row);
				$sheet->getStyle('D' . $row)->applyFromArray($style_row);
				$sheet->getStyle('E' . $row)->applyFromArray($style_row);
				$sheet->getStyle('F' . $row)->applyFromArray($style_row);
				$sheet->getStyle('G' . $row)->applyFromArray($style_row);
				$sheet->getStyle('H' . $row)->applyFromArray($style_row);
				$sheet->getStyle('I' . $row)->applyFromArray($style_row);
				$sheet->getStyle('J' . $row)->applyFromArray($style_row);
				$sheet->getStyle('K' . $row)->applyFromArray($style_row);
				$sheet->getStyle('L' . $row)->applyFromArray($style_row);
				$sheet->getStyle('M' . $row)->applyFromArray($style_row);
				$sheet->getStyle('N' . $row)->applyFromArray($style_row);
				$sheet->getStyle('O' . $row)->applyFromArray($style_row);
				$sheet->getStyle('P' . $row)->applyFromArray($style_row);
				$sheet->getStyle('Q' . $row)->applyFromArray($style_row);
				$sheet->getStyle('R' . $row)->applyFromArray($style_row);
				$sheet->getStyle('S' . $row)->applyFromArray($style_row);
				$sheet->getStyle('T' . $row)->applyFromArray($style_row);
				$sheet->getStyle('U' . $row)->applyFromArray($style_row);
				$sheet->getStyle('V' . $row)->applyFromArray($style_row);
				$sheet->getStyle('W' . $row)->applyFromArray($style_row);
				$sheet->getStyle('X' . $row)->applyFromArray($style_row);
				$sheet->getStyle('Y' . $row)->applyFromArray($style_row);
				$sheet->getStyle('Z' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AA' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AB' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AC' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AD' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AE' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AF' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AG' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AH' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AI' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AJ' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AK' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AL' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AM' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AN' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AO' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AP' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AQ' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AR' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AS' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AT' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AU' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AV' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AW' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AX' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AY' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AZ' . $row)->applyFromArray($style_row);
				$sheet->getStyle('BA' . $row)->applyFromArray($style_row);
				$sheet->getStyle('BB' . $row)->applyFromArray($style_row);
				$sheet->getStyle('BC' . $row)->applyFromArray($style_row);
				$sheet->getStyle('BD' . $row)->applyFromArray($style_row);
				$sheet->getStyle('BE' . $row)->applyFromArray($style_row);
				$sheet->getStyle('BF' . $row)->applyFromArray($style_row);
				$sheet->getStyle('BG' . $row)->applyFromArray($style_row);
				$sheet->getStyle('BH' . $row)->applyFromArray($style_row);
				$sheet->getStyle('BI' . $row)->applyFromArray($style_row);
				$sheet->getStyle('BJ' . $row)->applyFromArray($style_row);
				$sheet->getStyle('BK' . $row)->applyFromArray($style_row);
				$sheet->getStyle('BL' . $row)->applyFromArray($style_row);
				$sheet->getStyle('BM' . $row)->applyFromArray($style_row);
				$sheet->getStyle('BN' . $row)->applyFromArray($style_row);
				$sheet->getStyle('BO' . $row)->applyFromArray($style_row);
				$sheet->getStyle('BP' . $row)->applyFromArray($style_row);
				$sheet->getStyle('BQ' . $row)->applyFromArray($style_row);
				$sheet->getStyle('BR' . $row)->applyFromArray($style_row);
				$sheet->getStyle('BS' . $row)->applyFromArray($style_row);
				$sheet->getStyle('BT' . $row)->applyFromArray($style_row);
				$sheet->getStyle('BU' . $row)->applyFromArray($style_row);
				$sheet->getStyle('BV' . $row)->applyFromArray($style_row);
				$sheet->getStyle('BW' . $row)->applyFromArray($style_row);
				$sheet->getStyle('BX' . $row)->applyFromArray($style_row);
				$sheet->getStyle('BY' . $row)->applyFromArray($style_row);
				$sheet->getStyle('BZ' . $row)->applyFromArray($style_row);
				$sheet->getStyle('CA' . $row)->applyFromArray($style_row);
				$sheet->getStyle('CB' . $row)->applyFromArray($style_row);
				$sheet->getStyle('CC' . $row)->applyFromArray($style_row);
				$sheet->getStyle('CD' . $row)->applyFromArray($style_row);
				$sheet->getStyle('CE' . $row)->applyFromArray($style_row);
				$sheet->getStyle('CF' . $row)->applyFromArray($style_row);
				$sheet->getStyle('CG' . $row)->applyFromArray($style_row);
				$sheet->getStyle('CH' . $row)->applyFromArray($style_row);
				$sheet->getStyle('CI' . $row)->applyFromArray($style_row);
				$sheet->getStyle('CJ' . $row)->applyFromArray($style_row);
				$sheet->getStyle('CK' . $row)->applyFromArray($style_row);
				$sheet->getStyle('CL' . $row)->applyFromArray($style_row);
				$sheet->getStyle('CM' . $row)->applyFromArray($style_row);
				$sheet->getStyle('CN' . $row)->applyFromArray($style_row);
				$sheet->getStyle('CO' . $row)->applyFromArray($style_row);
				$sheet->getStyle('CP' . $row)->applyFromArray($style_row);
				$sheet->getStyle('CQ' . $row)->applyFromArray($style_row);
				$sheet->getStyle('CR' . $row)->applyFromArray($style_row);
				$sheet->getStyle('CS' . $row)->applyFromArray($style_row);
				$sheet->getStyle('CT' . $row)->applyFromArray($style_row);
				$sheet->getStyle('CU' . $row)->applyFromArray($style_row);
				$sheet->getStyle('CV' . $row)->applyFromArray($style_row);
				$sheet->getStyle('CW' . $row)->applyFromArray($style_row);
				$sheet->getStyle('CX' . $row)->applyFromArray($style_row);
				$sheet->getStyle('CY' . $row)->applyFromArray($style_row);
				$sheet->getStyle('CZ' . $row)->applyFromArray($style_row);
				$sheet->getStyle('DA' . $row)->applyFromArray($style_row);
				$sheet->getStyle('DB' . $row)->applyFromArray($style_row);
				$sheet->getStyle('DC' . $row)->applyFromArray($style_row);
				$sheet->getStyle('DD' . $row)->applyFromArray($style_row);
				$sheet->getStyle('DE' . $row)->applyFromArray($style_row);
				$sheet->getStyle('DF' . $row)->applyFromArray($style_row);
				$sheet->getStyle('DG' . $row)->applyFromArray($style_row);
				$sheet->getStyle('DH' . $row)->applyFromArray($style_row);
				$sheet->getStyle('DI' . $row)->applyFromArray($style_row);
				$sheet->getStyle('DJ' . $row)->applyFromArray($style_row);
				$sheet->getStyle('DK' . $row)->applyFromArray($style_row);
				$sheet->getStyle('DL' . $row)->applyFromArray($style_row);
				$sheet->getStyle('DM' . $row)->applyFromArray($style_row);
				$sheet->getStyle('DN' . $row)->applyFromArray($style_row);
				$sheet->getStyle('DO' . $row)->applyFromArray($style_row);
				$sheet->getStyle('DP' . $row)->applyFromArray($style_row);
				$sheet->getStyle('DQ' . $row)->applyFromArray($style_row);
				$sheet->getStyle('DR' . $row)->applyFromArray($style_row);
				$sheet->getStyle('DS' . $row)->applyFromArray($style_row);
				$sheet->getStyle('DT' . $row)->applyFromArray($style_row);
				$sheet->getStyle('DU' . $row)->applyFromArray($style_row);
				$sheet->getStyle('DV' . $row)->applyFromArray($style_row);
				$sheet->getStyle('DW' . $row)->applyFromArray($style_row);
				$sheet->getStyle('DX' . $row)->applyFromArray($style_row);
				$sheet->getStyle('DY' . $row)->applyFromArray($style_row);
				$sheet->getStyle('DZ' . $row)->applyFromArray($style_row);
				$sheet->getStyle('EA' . $row)->applyFromArray($style_row);
				$sheet->getStyle('EB' . $row)->applyFromArray($style_row);
				$sheet->getStyle('EC' . $row)->applyFromArray($style_row);
				$sheet->getStyle('ED' . $row)->applyFromArray($style_row);
				$sheet->getStyle('EE' . $row)->applyFromArray($style_row);
				$sheet->getStyle('EF' . $row)->applyFromArray($style_row);
				$sheet->getStyle('EG' . $row)->applyFromArray($style_row);
				$sheet->getStyle('EH' . $row)->applyFromArray($style_row);


				$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
				$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
				$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
				$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
				$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
				$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
				$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('I' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('J' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('K' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('L' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('M' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('N' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('O' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('P' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('Q' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('R' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('S' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('T' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('U' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('V' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('W' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('X' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('Y' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('Z' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AA' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AB' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AC' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AD' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AE' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AF' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AG' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AH' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AI' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AJ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AK' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AL' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AM' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AN' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AO' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AP' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AQ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AR' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AS' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AT' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AU' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AV' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AX' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AY' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AZ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('BA' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('BB' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('BC' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('BD' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('BE' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('BF' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('BG' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('BH' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('BI' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('BJ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('BK' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('BL' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('BM' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('BN' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('BO' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('BQ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('BR' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('BS' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('BT' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('BU' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('BV' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('BW' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('BX' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('BY' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('BZ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('CA' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('CB' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('CC' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('CD' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('CE' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('CF' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('CG' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('CH' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('CI' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('CJ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('CK' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('CL' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('CM' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('CN' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('CO' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('CP' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('CQ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('CR' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('CS' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('CT' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('CU' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('CV' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('CW' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('CX' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('CY' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('CZ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('DA' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('DB' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('DC' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('DD' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('DE' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('DF' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('DG' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('DH' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('DI' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('DJ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('DK' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('DL' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('DM' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('DN' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('DO' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('DP' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('DQ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('DR' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('DS' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('DT' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('DU' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('DV' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('DW' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('DX' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('DY' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('DZ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('EA' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('EB' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('EC' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('ED' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('EE' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('EF' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('EG' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('EH' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

				$sheet->getStyle('G' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('H' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('I' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('J' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('K' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('L' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('M' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('N' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('O' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('P' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('Q' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('R' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('S' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('T' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('U' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('V' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('W' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('X' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('Y' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('Z' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('AA' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('AB' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('AC' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('AD' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('AE' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('AF' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('AG' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('AH' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('AI' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('AJ' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('AK' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('AL' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('AM' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('AN' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('AO' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('AP' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('AQ' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('AR' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('AS' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('AT' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('AU' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('AV' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('AW' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('AX' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('AY' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('AZ' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('AB' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('BB' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('BC' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('BD' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('BE' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('BF' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('BG' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('BH' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('BI' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('BJ' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('BK' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('BL' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('BM' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('BN' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('BO' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('BP' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('BQ' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('BR' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('BS' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('BT' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('BU' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('BV' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('BW' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('BX' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('BY' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('BZ' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('CA' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('CB' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('CC' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('CD' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('CE' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('CF' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('CG' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('CH' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('CI' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('CJ' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('CK' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('CL' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('CM' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('CN' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('CO' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('CP' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('CQ' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('CR' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('CS' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('CT' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('CU' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('CV' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('CW' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('CX' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('CY' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('CZ' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('DA' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('DB' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('DC' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('DD' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('DE' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('DF' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('DG' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('DH' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('DI' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('DJ' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('DK' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('DL' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('DM' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('DN' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('DO' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('DP' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('DQ' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('DR' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('DS' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('DT' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('DU' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('DW' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('DW' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('DX' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('DY' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('DZ' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('EA' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('EB' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('EC' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('ED' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('EE' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('EF' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('EG' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('EH' . $row)->getNumberFormat()->setFormatCode('#.00');

				$sheet->getStyle('A' . $row . ':EH' . $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFA07A');
				$sheet->getStyle('A' . $row . ':EH' . $row)->getFont()->setBold(true);

				$sub_qty_jan = 0;
				$sub_qty_feb = 0;
				$sub_qty_mar = 0;
				$sub_qty_q1 = 0;
				$sub_qty_apr = 0;
				$sub_qty_mei = 0;
				$sub_qty_jun = 0;
				$sub_qty_q2 = 0;
				$sub_qty_jul = 0;
				$sub_qty_agu = 0;
				$sub_qty_sep = 0;
				$sub_qty_q3 = 0;
				$sub_qty_okt = 0;
				$sub_qty_nop = 0;
				$sub_qty_des = 0;
				$sub_qty_q4 = 0;
				$sub_qty_year = 0;
				$sub_qty_avg = 0;

				$sub_val_jan = 0;
				$sub_val_feb = 0;
				$sub_val_mar = 0;
				$sub_val_q1 = 0;
				$sub_val_apr = 0;
				$sub_val_mei = 0;
				$sub_val_jun = 0;
				$sub_val_q2 = 0;
				$sub_val_jul = 0;
				$sub_val_agu = 0;
				$sub_val_sep = 0;
				$sub_val_q3 = 0;
				$sub_val_okt = 0;
				$sub_val_nop = 0;
				$sub_val_des = 0;
				$sub_val_q4 = 0;
				$sub_val_year = 0;
				$sub_val_avg = 0;

				$sub_target_qty_jan = 0;
				$sub_target_qty_feb = 0;
				$sub_target_qty_mar = 0;
				$sub_target_qty_q1 = 0;
				$sub_target_qty_apr = 0;
				$sub_target_qty_mei = 0;
				$sub_target_qty_jun = 0;
				$sub_target_qty_q2 = 0;
				$sub_target_qty_jul = 0;
				$sub_target_qty_agu = 0;
				$sub_target_qty_sep = 0;
				$sub_target_qty_q3 = 0;
				$sub_target_qty_okt = 0;
				$sub_target_qty_nop = 0;
				$sub_target_qty_des = 0;
				$sub_target_qty_q4 = 0;
				$sub_target_qty_year = 0;
				$sub_target_qty_avg = 0;

				$sub_target_val_jan = 0;
				$sub_target_val_feb = 0;
				$sub_target_val_mar = 0;
				$sub_target_val_q1 = 0;
				$sub_target_val_apr = 0;
				$sub_target_val_mei = 0;
				$sub_target_val_jun = 0;
				$sub_target_val_q2 = 0;
				$sub_target_val_jul = 0;
				$sub_target_val_agu = 0;
				$sub_target_val_sep = 0;
				$sub_target_val_q3 = 0;
				$sub_target_val_okt = 0;
				$sub_target_val_nop = 0;
				$sub_target_val_des = 0;
				$sub_target_val_q4 = 0;
				$sub_target_val_year = 0;
				$sub_target_val_avg = 0;

				$sub_idx_qty_jan = 0;
				$sub_idx_qty_feb = 0;
				$sub_idx_qty_mar = 0;
				$sub_idx_qty_q1 = 0;
				$sub_idx_qty_apr = 0;
				$sub_idx_qty_mei = 0;
				$sub_idx_qty_jun = 0;
				$sub_idx_qty_q2 = 0;
				$sub_idx_qty_jul = 0;
				$sub_idx_qty_agu = 0;
				$sub_idx_qty_sep = 0;
				$sub_idx_qty_q3 = 0;
				$sub_idx_qty_okt = 0;
				$sub_idx_qty_nop = 0;
				$sub_idx_qty_des = 0;
				$sub_idx_qty_q4 = 0;
				$sub_idx_qty_year = 0;
				$sub_idx_qty_avg = 0;

				$sub_idx_val_jan = 0;
				$sub_idx_val_feb = 0;
				$sub_idx_val_mar = 0;
				$sub_idx_val_q1 = 0;
				$sub_idx_val_apr = 0;
				$sub_idx_val_mei = 0;
				$sub_idx_val_jun = 0;
				$sub_idx_val_q2 = 0;
				$sub_idx_val_jul = 0;
				$sub_idx_val_agu = 0;
				$sub_idx_val_sep = 0;
				$sub_idx_val_q3 = 0;
				$sub_idx_val_okt = 0;
				$sub_idx_val_nop = 0;
				$sub_idx_val_des = 0;
				$sub_idx_val_q4 = 0;
				$sub_idx_val_year = 0;
				$sub_idx_val_avg = 0;

				$sub_stok_qty_jan = 0;
				$sub_stok_qty_feb = 0;
				$sub_stok_qty_mar = 0;
				$sub_stok_qty_q1 = 0;
				$sub_stok_qty_apr = 0;
				$sub_stok_qty_mei = 0;
				$sub_stok_qty_jun = 0;
				$sub_stok_qty_q2 = 0;
				$sub_stok_qty_jul = 0;
				$sub_stok_qty_agu = 0;
				$sub_stok_qty_sep = 0;
				$sub_stok_qty_q3 = 0;
				$sub_stok_qty_okt = 0;
				$sub_stok_qty_nop = 0;
				$sub_stok_qty_des = 0;
				$sub_stok_qty_q4 = 0;
				$sub_stok_qty_year = 0;
				$sub_stok_qty_avg = 0;

				$sub_stok_val_jan = 0;
				$sub_stok_val_feb = 0;
				$sub_stok_val_mar = 0;
				$sub_stok_val_q1 = 0;
				$sub_stok_val_apr = 0;
				$sub_stok_val_mei = 0;
				$sub_stok_val_jun = 0;
				$sub_stok_val_q2 = 0;
				$sub_stok_val_jul = 0;
				$sub_stok_val_agu = 0;
				$sub_stok_val_sep = 0;
				$sub_stok_val_q3 = 0;
				$sub_stok_val_okt = 0;
				$sub_stok_val_nop = 0;
				$sub_stok_val_des = 0;
				$sub_stok_val_q4 = 0;
				$sub_stok_val_year = 0;
				$sub_stok_val_avg = 0;

				$row++;
            }

			$sheet->setCellValue('A' . $row, $no);
    		$sheet->setCellValue('B' . $row, $rows['principal']);
			$sheet->setCellValue('C' . $row, $rows['item_group']);
			$sheet->setCellValue('D' . $row, $rows['item_code']);
			$sheet->setCellValue('E' . $row, $rows['item_name']);
			$sheet->setCellValue('F' . $row, $rows['unit']);

			$sheet->setCellValue('G' . $row, $rows['qty_jan']);
			$sheet->setCellValue('H' . $row, $rows['value_jan']);
			$sheet->setCellValue('I' . $row, $rows['target_qty_jan']);
			$sheet->setCellValue('J' . $row, $rows['target_val_jan']);
			$sheet->setCellValue('K' . $row, $rows['idx_qty_jan']);
			$sheet->setCellValue('L' . $row, $rows['idx_val_jan']);
			$sheet->setCellValue('M' . $row, $rows['stok_qty_jan']);
			$sheet->setCellValue('N' . $row, $rows['stok_val_jan']);
			$sheet->setCellValue('O' . $row, $rows['qty_feb']);
			$sheet->setCellValue('P' . $row, $rows['value_feb']);
			$sheet->setCellValue('Q' . $row, $rows['target_qty_feb']);
			$sheet->setCellValue('R' . $row, $rows['target_val_feb']);
			$sheet->setCellValue('S' . $row, $rows['idx_qty_feb']);
			$sheet->setCellValue('T' . $row, $rows['idx_val_feb']);
			$sheet->setCellValue('U' . $row, $rows['stok_qty_feb']);
			$sheet->setCellValue('V' . $row, $rows['stok_val_feb']);
			$sheet->setCellValue('W' . $row, $rows['qty_mar']);
			$sheet->setCellValue('X' . $row, $rows['value_mar']);
			$sheet->setCellValue('Y' . $row, $rows['target_qty_mar']);
			$sheet->setCellValue('Z' . $row, $rows['target_val_mar']);
			$sheet->setCellValue('AA' . $row, $rows['idx_qty_mar']);
			$sheet->setCellValue('AB' . $row, $rows['idx_val_mar']);
			$sheet->setCellValue('AC' . $row, $rows['stok_qty_mar']);
			$sheet->setCellValue('AD' . $row, $rows['stok_val_mar']);
			$sheet->setCellValue('AE' . $row, $rows['qty_q1']);
			$sheet->setCellValue('AF' . $row, $rows['value_q1']);
			$sheet->setCellValue('AG' . $row, $rows['target_qty_q1']);
			$sheet->setCellValue('AH' . $row, $rows['target_value_q1']);
			$sheet->setCellValue('AI' . $row, $rows['idx_qty_q1']);
			$sheet->setCellValue('AJ' . $row, $rows['idx_val_q1']);

			$sheet->setCellValue('AK' . $row, $rows['qty_apr']);
			$sheet->setCellValue('AL' . $row, $rows['value_apr']);
			$sheet->setCellValue('AM' . $row, $rows['target_qty_apr']);
			$sheet->setCellValue('AN' . $row, $rows['target_val_apr']);
			$sheet->setCellValue('AO' . $row, $rows['idx_qty_apr']);
			$sheet->setCellValue('AP' . $row, $rows['idx_val_apr']);
			$sheet->setCellValue('AQ' . $row, $rows['stok_qty_apr']);
			$sheet->setCellValue('AR' . $row, $rows['stok_val_apr']);
			$sheet->setCellValue('AS' . $row, $rows['qty_mei']);
			$sheet->setCellValue('AT' . $row, $rows['value_mei']);
			$sheet->setCellValue('AU' . $row, $rows['target_qty_mei']);
			$sheet->setCellValue('AV' . $row, $rows['target_val_mei']);
			$sheet->setCellValue('AW' . $row, $rows['idx_qty_mei']);
			$sheet->setCellValue('AX' . $row, $rows['idx_val_mei']);
			$sheet->setCellValue('AY' . $row, $rows['stok_qty_mei']);
			$sheet->setCellValue('AZ' . $row, $rows['stok_val_mei']);
			$sheet->setCellValue('BA' . $row, $rows['qty_jun']);
			$sheet->setCellValue('BB' . $row, $rows['value_jun']);
			$sheet->setCellValue('BC' . $row, $rows['target_qty_jun']);
			$sheet->setCellValue('BD' . $row, $rows['target_val_jun']);
			$sheet->setCellValue('BE' . $row, $rows['idx_qty_jun']);
			$sheet->setCellValue('BF' . $row, $rows['idx_val_jun']);
			$sheet->setCellValue('BG' . $row, $rows['stok_qty_jun']);
			$sheet->setCellValue('BH' . $row, $rows['stok_val_jun']);
			$sheet->setCellValue('BI' . $row, $rows['qty_q2']);
			$sheet->setCellValue('BJ' . $row, $rows['value_q2']);
			$sheet->setCellValue('BK' . $row, $rows['target_qty_q2']);
			$sheet->setCellValue('BL' . $row, $rows['target_value_q2']);
			$sheet->setCellValue('BM' . $row, $rows['idx_qty_q2']);
			$sheet->setCellValue('BN' . $row, $rows['idx_val_q2']);

			$sheet->setCellValue('BO' . $row, $rows['qty_jul']);
			$sheet->setCellValue('BP' . $row, $rows['value_jul']);
			$sheet->setCellValue('BQ' . $row, $rows['target_qty_jul']);
			$sheet->setCellValue('BR' . $row, $rows['target_val_jul']);
			$sheet->setCellValue('BS' . $row, $rows['idx_qty_jul']);
			$sheet->setCellValue('BT' . $row, $rows['idx_val_jul']);
			$sheet->setCellValue('BU' . $row, $rows['stok_qty_jul']);
			$sheet->setCellValue('BV' . $row, $rows['stok_val_jul']);
			$sheet->setCellValue('BW' . $row, $rows['qty_agu']);
			$sheet->setCellValue('BX' . $row, $rows['value_agu']);
			$sheet->setCellValue('BY' . $row, $rows['target_qty_agu']);
			$sheet->setCellValue('BZ' . $row, $rows['target_val_agu']);
			$sheet->setCellValue('CA' . $row, $rows['idx_qty_agu']);
			$sheet->setCellValue('CB' . $row, $rows['idx_val_agu']);
			$sheet->setCellValue('CC' . $row, $rows['stok_qty_agu']);
			$sheet->setCellValue('CD' . $row, $rows['stok_val_agu']);
			$sheet->setCellValue('CE' . $row, $rows['qty_sep']);
			$sheet->setCellValue('CF' . $row, $rows['value_sep']);
			$sheet->setCellValue('CG' . $row, $rows['target_qty_sep']);
			$sheet->setCellValue('CH' . $row, $rows['target_val_sep']);
			$sheet->setCellValue('CI' . $row, $rows['idx_qty_sep']);
			$sheet->setCellValue('CJ' . $row, $rows['idx_val_sep']);
			$sheet->setCellValue('CK' . $row, $rows['stok_qty_sep']);
			$sheet->setCellValue('CL' . $row, $rows['stok_val_sep']);
			$sheet->setCellValue('CM' . $row, $rows['qty_q3']);
			$sheet->setCellValue('CN' . $row, $rows['value_q3']);
			$sheet->setCellValue('CO' . $row, $rows['target_qty_q3']);
			$sheet->setCellValue('CP' . $row, $rows['target_value_q3']);
			$sheet->setCellValue('CQ' . $row, $rows['idx_qty_q3']);
			$sheet->setCellValue('CR' . $row, $rows['idx_val_q3']);

			$sheet->setCellValue('CS' . $row, $rows['qty_okt']);
			$sheet->setCellValue('CT' . $row, $rows['value_okt']);
			$sheet->setCellValue('CU' . $row, $rows['target_qty_okt']);
			$sheet->setCellValue('CV' . $row, $rows['target_val_okt']);
			$sheet->setCellValue('CW' . $row, $rows['idx_qty_okt']);
			$sheet->setCellValue('CX' . $row, $rows['idx_val_okt']);
			$sheet->setCellValue('CY' . $row, $rows['stok_qty_okt']);
			$sheet->setCellValue('CZ' . $row, $rows['stok_val_okt']);
			$sheet->setCellValue('DA' . $row, $rows['qty_nop']);
			$sheet->setCellValue('DB' . $row, $rows['value_nop']);
			$sheet->setCellValue('DC' . $row, $rows['target_qty_nop']);
			$sheet->setCellValue('DD' . $row, $rows['target_val_nop']);
			$sheet->setCellValue('DE' . $row, $rows['idx_qty_nop']);
			$sheet->setCellValue('DF' . $row, $rows['idx_val_nop']);
			$sheet->setCellValue('DG' . $row, $rows['stok_qty_nop']);
			$sheet->setCellValue('DH' . $row, $rows['stok_val_nop']);
			$sheet->setCellValue('DI' . $row, $rows['qty_des']);
			$sheet->setCellValue('DJ' . $row, $rows['value_des']);
			$sheet->setCellValue('DK' . $row, $rows['target_qty_des']);
			$sheet->setCellValue('DL' . $row, $rows['target_val_des']);
			$sheet->setCellValue('DM' . $row, $rows['idx_qty_des']);
			$sheet->setCellValue('DN' . $row, $rows['idx_val_des']);
			$sheet->setCellValue('DO' . $row, $rows['stok_qty_des']);
			$sheet->setCellValue('DP' . $row, $rows['stok_val_des']);
			$sheet->setCellValue('DQ' . $row, $rows['qty_q4']);
			$sheet->setCellValue('DR' . $row, $rows['value_q4']);
			$sheet->setCellValue('DS' . $row, $rows['target_qty_q4']);
			$sheet->setCellValue('DT' . $row, $rows['target_value_q4']);
			$sheet->setCellValue('DU' . $row, $rows['idx_qty_q4']);
			$sheet->setCellValue('DV' . $row, $rows['idx_val_q4']);

			$qty_year = $rows['qty_jan'] + $rows['qty_feb'] + $rows['qty_mar'] + $rows['qty_apr'] + $rows['qty_mei'] + $rows['qty_jun'] + $rows['qty_jul'] + $rows['qty_agu'] + $rows['qty_sep'] + $rows['qty_okt'] + $rows['qty_nop'] + $rows['qty_des'];
			$target_qty_year = $rows['target_qty_jan'] + $rows['target_qty_feb'] + $rows['target_qty_mar'] + $rows['target_qty_apr'] + $rows['target_qty_mei'] + $rows['target_qty_jun'] + $rows['target_qty_jul'] + $rows['target_qty_agu'] + $rows['target_qty_sep'] + $rows['target_qty_okt'] + $rows['target_qty_nop'] + $rows['target_qty_des'];
			$idx_qty_year = ($qty_year/($target_qty_year ?: 1))*100;
			$val_year = $rows['value_jan'] + $rows['value_feb'] + $rows['value_mar'] + $rows['value_apr'] + $rows['value_mei'] + $rows['value_jun'] + $rows['value_jul'] + $rows['value_agu'] + $rows['value_sep'] + $rows['value_okt'] + $rows['value_nop'] + $rows['value_des'];
			$target_val_year = $rows['target_val_jan'] + $rows['target_val_feb'] + $rows['target_val_mar'] + $rows['target_val_apr'] + $rows['target_val_mei'] + $rows['target_val_jun'] + $rows['target_val_jul'] + $rows['target_val_agu'] + $rows['target_val_sep'] + $rows['target_val_okt'] + $rows['target_val_nop'] + $rows['target_val_des'];
			$idx_val_year = ($val_year/($target_val_year ?: 1))*100;
			$qty_avg = $qty_year / 12;
			$target_qty_avg = $target_qty_year / 12;
			$idx_qty_avg = ($qty_avg/($target_qty_avg ?: 1))*100;
			$val_avg = $val_year / 12;
			$target_val_avg = $target_val_year / 12;
			$idx_val_avg = ($val_avg/($target_val_avg ?: 1))*100;

			/* $qty_year = $qty_jan + $qty_feb + $qty_mar + $qty_apr + $qty_mei + $qty_jun + $qty_jul + $qty_agu + $qty_sep + $qty_okt + $qty_nop + $qty_des;
			$target_qty_year = $target_qty_jan + $target_qty_feb + $target_qty_mar + $target_qty_apr + $target_qty_mei + $target_qty_jun + $target_qty_jul + $target_qty_agu + $target_qty_sep + $target_qty_okt + $target_qty_nop + $target_qty_des;
			$idx_qty_year = ($qty_year/($target_qty_year ?: 1))*100;
			$val_year = $val_jan + $val_feb + $val_mar + $val_apr + $val_mei + $val_jun + $val_jul + $val_agu + $val_sep + $val_okt + $val_nop + $val_des;
			$target_val_year = $target_val_jan + $target_val_feb + $target_val_mar + $target_val_apr + $target_val_mei + $target_val_jun + $target_val_jul + $target_val_agu + $target_val_sep + $target_val_okt + $target_val_nop + $target_val_des;
			$idx_val_year = ($val_year/($target_val_year ?: 1))*100;
			$qty_avg = $qty_year / 12;
			$target_qty_avg = $target_qty_year / 12;
			$idx_qty_avg = ($qty_avg/($target_qty_avg ?: 1))*100;
			$val_avg = $val_year / 12;
			$target_val_avg = $target_val_year / 12;
			$idx_val_avg = ($val_avg/($target_val_avg ?: 1))*100; */

			$sheet->setCellValue('DW' . $row, $qty_year);
			$sheet->setCellValue('DX' . $row, $val_year);
			$sheet->setCellValue('DY' . $row, $target_qty_year);
			$sheet->setCellValue('DZ' . $row, $target_val_year);
			$sheet->setCellValue('EA' . $row, $idx_qty_year);
			$sheet->setCellValue('EB' . $row, $idx_val_year);
			$sheet->setCellValue('EC' . $row, $qty_avg);
			$sheet->setCellValue('ED' . $row, $val_avg);
			$sheet->setCellValue('EE' . $row, $target_qty_avg);
			$sheet->setCellValue('EF' . $row, $target_val_avg);
			$sheet->setCellValue('EG' . $row, $idx_qty_avg);
			$sheet->setCellValue('EH' . $row, $idx_val_avg);

			// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
			$sheet->getStyle('A' . $row)->applyFromArray($style_row);
			$sheet->getStyle('B' . $row)->applyFromArray($style_row);
			$sheet->getStyle('C' . $row)->applyFromArray($style_row);
			$sheet->getStyle('D' . $row)->applyFromArray($style_row);
			$sheet->getStyle('E' . $row)->applyFromArray($style_row);
			$sheet->getStyle('F' . $row)->applyFromArray($style_row);
			$sheet->getStyle('G' . $row)->applyFromArray($style_row);
			$sheet->getStyle('H' . $row)->applyFromArray($style_row);
			$sheet->getStyle('I' . $row)->applyFromArray($style_row);
			$sheet->getStyle('J' . $row)->applyFromArray($style_row);
			$sheet->getStyle('K' . $row)->applyFromArray($style_row);
			$sheet->getStyle('L' . $row)->applyFromArray($style_row);
			$sheet->getStyle('M' . $row)->applyFromArray($style_row);
			$sheet->getStyle('N' . $row)->applyFromArray($style_row);
			$sheet->getStyle('O' . $row)->applyFromArray($style_row);
			$sheet->getStyle('P' . $row)->applyFromArray($style_row);
			$sheet->getStyle('Q' . $row)->applyFromArray($style_row);
			$sheet->getStyle('R' . $row)->applyFromArray($style_row);
			$sheet->getStyle('S' . $row)->applyFromArray($style_row);
			$sheet->getStyle('T' . $row)->applyFromArray($style_row);
			$sheet->getStyle('U' . $row)->applyFromArray($style_row);
			$sheet->getStyle('V' . $row)->applyFromArray($style_row);
			$sheet->getStyle('W' . $row)->applyFromArray($style_row);
			$sheet->getStyle('X' . $row)->applyFromArray($style_row);
			$sheet->getStyle('Y' . $row)->applyFromArray($style_row);
			$sheet->getStyle('Z' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AA' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AB' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AC' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AD' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AE' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AF' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AG' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AH' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AI' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AJ' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AK' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AL' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AM' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AN' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AO' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AP' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AQ' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AR' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AS' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AT' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AU' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AV' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AW' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AX' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AY' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AZ' . $row)->applyFromArray($style_row);
			$sheet->getStyle('BA' . $row)->applyFromArray($style_row);
			$sheet->getStyle('BB' . $row)->applyFromArray($style_row);
			$sheet->getStyle('BC' . $row)->applyFromArray($style_row);
			$sheet->getStyle('BD' . $row)->applyFromArray($style_row);
			$sheet->getStyle('BE' . $row)->applyFromArray($style_row);
			$sheet->getStyle('BF' . $row)->applyFromArray($style_row);
			$sheet->getStyle('BG' . $row)->applyFromArray($style_row);
			$sheet->getStyle('BH' . $row)->applyFromArray($style_row);
			$sheet->getStyle('BI' . $row)->applyFromArray($style_row);
			$sheet->getStyle('BJ' . $row)->applyFromArray($style_row);
			$sheet->getStyle('BK' . $row)->applyFromArray($style_row);
			$sheet->getStyle('BL' . $row)->applyFromArray($style_row);
			$sheet->getStyle('BM' . $row)->applyFromArray($style_row);
			$sheet->getStyle('BN' . $row)->applyFromArray($style_row);
			$sheet->getStyle('BO' . $row)->applyFromArray($style_row);
			$sheet->getStyle('BP' . $row)->applyFromArray($style_row);
			$sheet->getStyle('BQ' . $row)->applyFromArray($style_row);
			$sheet->getStyle('BR' . $row)->applyFromArray($style_row);
			$sheet->getStyle('BS' . $row)->applyFromArray($style_row);
			$sheet->getStyle('BT' . $row)->applyFromArray($style_row);
			$sheet->getStyle('BU' . $row)->applyFromArray($style_row);
			$sheet->getStyle('BV' . $row)->applyFromArray($style_row);
			$sheet->getStyle('BW' . $row)->applyFromArray($style_row);
			$sheet->getStyle('BX' . $row)->applyFromArray($style_row);
			$sheet->getStyle('BY' . $row)->applyFromArray($style_row);
			$sheet->getStyle('BZ' . $row)->applyFromArray($style_row);
			$sheet->getStyle('CA' . $row)->applyFromArray($style_row);
			$sheet->getStyle('CB' . $row)->applyFromArray($style_row);
			$sheet->getStyle('CC' . $row)->applyFromArray($style_row);
			$sheet->getStyle('CD' . $row)->applyFromArray($style_row);
			$sheet->getStyle('CE' . $row)->applyFromArray($style_row);
			$sheet->getStyle('CF' . $row)->applyFromArray($style_row);
			$sheet->getStyle('CG' . $row)->applyFromArray($style_row);
			$sheet->getStyle('CH' . $row)->applyFromArray($style_row);
			$sheet->getStyle('CI' . $row)->applyFromArray($style_row);
			$sheet->getStyle('CJ' . $row)->applyFromArray($style_row);
			$sheet->getStyle('CK' . $row)->applyFromArray($style_row);
			$sheet->getStyle('CL' . $row)->applyFromArray($style_row);
			$sheet->getStyle('CM' . $row)->applyFromArray($style_row);
			$sheet->getStyle('CN' . $row)->applyFromArray($style_row);
			$sheet->getStyle('CO' . $row)->applyFromArray($style_row);
			$sheet->getStyle('CP' . $row)->applyFromArray($style_row);
			$sheet->getStyle('CQ' . $row)->applyFromArray($style_row);
			$sheet->getStyle('CR' . $row)->applyFromArray($style_row);
			$sheet->getStyle('CS' . $row)->applyFromArray($style_row);
			$sheet->getStyle('CT' . $row)->applyFromArray($style_row);
			$sheet->getStyle('CU' . $row)->applyFromArray($style_row);
			$sheet->getStyle('CV' . $row)->applyFromArray($style_row);
			$sheet->getStyle('CW' . $row)->applyFromArray($style_row);
			$sheet->getStyle('CX' . $row)->applyFromArray($style_row);
			$sheet->getStyle('CY' . $row)->applyFromArray($style_row);
			$sheet->getStyle('CZ' . $row)->applyFromArray($style_row);
			$sheet->getStyle('DA' . $row)->applyFromArray($style_row);
			$sheet->getStyle('DB' . $row)->applyFromArray($style_row);
			$sheet->getStyle('DC' . $row)->applyFromArray($style_row);
			$sheet->getStyle('DD' . $row)->applyFromArray($style_row);
			$sheet->getStyle('DE' . $row)->applyFromArray($style_row);
			$sheet->getStyle('DF' . $row)->applyFromArray($style_row);
			$sheet->getStyle('DG' . $row)->applyFromArray($style_row);
			$sheet->getStyle('DH' . $row)->applyFromArray($style_row);
			$sheet->getStyle('DI' . $row)->applyFromArray($style_row);
			$sheet->getStyle('DJ' . $row)->applyFromArray($style_row);
			$sheet->getStyle('DK' . $row)->applyFromArray($style_row);
			$sheet->getStyle('DL' . $row)->applyFromArray($style_row);
			$sheet->getStyle('DM' . $row)->applyFromArray($style_row);
			$sheet->getStyle('DN' . $row)->applyFromArray($style_row);
			$sheet->getStyle('DO' . $row)->applyFromArray($style_row);
			$sheet->getStyle('DP' . $row)->applyFromArray($style_row);
			$sheet->getStyle('DQ' . $row)->applyFromArray($style_row);
			$sheet->getStyle('DR' . $row)->applyFromArray($style_row);
			$sheet->getStyle('DS' . $row)->applyFromArray($style_row);
			$sheet->getStyle('DT' . $row)->applyFromArray($style_row);
			$sheet->getStyle('DU' . $row)->applyFromArray($style_row);
			$sheet->getStyle('DV' . $row)->applyFromArray($style_row);
			$sheet->getStyle('DW' . $row)->applyFromArray($style_row);
			$sheet->getStyle('DX' . $row)->applyFromArray($style_row);
			$sheet->getStyle('DY' . $row)->applyFromArray($style_row);
			$sheet->getStyle('DZ' . $row)->applyFromArray($style_row);
			$sheet->getStyle('EA' . $row)->applyFromArray($style_row);
			$sheet->getStyle('EB' . $row)->applyFromArray($style_row);
			$sheet->getStyle('EC' . $row)->applyFromArray($style_row);
			$sheet->getStyle('ED' . $row)->applyFromArray($style_row);
			$sheet->getStyle('EE' . $row)->applyFromArray($style_row);
			$sheet->getStyle('EF' . $row)->applyFromArray($style_row);
			$sheet->getStyle('EG' . $row)->applyFromArray($style_row);
			$sheet->getStyle('EH' . $row)->applyFromArray($style_row);


			$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('I' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('J' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('K' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('L' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('M' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('N' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('O' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('P' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('Q' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('R' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('S' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('T' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('U' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('V' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('W' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('X' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('Y' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('Z' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AA' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AB' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AC' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AD' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AE' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AF' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AG' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AH' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AI' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AJ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AK' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AL' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AM' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AN' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AO' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AP' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AQ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AR' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AS' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AT' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AU' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AV' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AX' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AY' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AZ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('BA' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('BB' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('BC' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('BD' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('BE' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('BF' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('BG' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('BH' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('BI' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('BJ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('BK' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('BL' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('BM' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('BN' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('BO' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('BQ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('BR' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('BS' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('BT' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('BU' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('BV' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('BW' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('BX' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('BY' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('BZ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('CA' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('CB' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('CC' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('CD' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('CE' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('CF' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('CG' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('CH' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('CI' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('CJ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('CK' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('CL' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('CM' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('CN' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('CO' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('CP' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('CQ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('CR' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('CS' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('CT' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('CU' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('CV' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('CW' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('CX' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('CY' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('CZ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('DA' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('DB' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('DC' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('DD' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('DE' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('DF' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('DG' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('DH' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('DI' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('DJ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('DK' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('DL' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('DM' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('DN' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('DO' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('DP' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('DQ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('DR' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('DS' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('DT' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('DU' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('DV' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('DW' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('DX' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('DY' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('DZ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('EA' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('EB' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('EC' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('ED' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('EE' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('EF' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('EG' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('EH' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

			$sheet->getStyle('G' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('H' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
			$sheet->getStyle('I' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('J' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
			$sheet->getStyle('K' . $row)->getNumberFormat()->setFormatCode('#.00');
			$sheet->getStyle('L' . $row)->getNumberFormat()->setFormatCode('#.00');
			$sheet->getStyle('M' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('N' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
			$sheet->getStyle('O' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('P' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
			$sheet->getStyle('Q' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('R' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
			$sheet->getStyle('S' . $row)->getNumberFormat()->setFormatCode('#.00');
			$sheet->getStyle('T' . $row)->getNumberFormat()->setFormatCode('#.00');
			$sheet->getStyle('U' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('V' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
			$sheet->getStyle('W' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('X' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
			$sheet->getStyle('Y' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('Z' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
			$sheet->getStyle('AA' . $row)->getNumberFormat()->setFormatCode('#.00');
			$sheet->getStyle('AB' . $row)->getNumberFormat()->setFormatCode('#.00');
			$sheet->getStyle('AC' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('AD' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
			$sheet->getStyle('AE' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('AF' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
			$sheet->getStyle('AG' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('AH' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
			$sheet->getStyle('AI' . $row)->getNumberFormat()->setFormatCode('#.00');
			$sheet->getStyle('AJ' . $row)->getNumberFormat()->setFormatCode('#.00');
			$sheet->getStyle('AK' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('AL' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
			$sheet->getStyle('AM' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('AN' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
			$sheet->getStyle('AO' . $row)->getNumberFormat()->setFormatCode('#.00');
			$sheet->getStyle('AP' . $row)->getNumberFormat()->setFormatCode('#.00');
			$sheet->getStyle('AQ' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('AR' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
			$sheet->getStyle('AS' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('AT' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
			$sheet->getStyle('AU' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('AV' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
			$sheet->getStyle('AW' . $row)->getNumberFormat()->setFormatCode('#.00');
			$sheet->getStyle('AX' . $row)->getNumberFormat()->setFormatCode('#.00');
			$sheet->getStyle('AY' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('AZ' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
			$sheet->getStyle('AB' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('BB' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
			$sheet->getStyle('BC' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('BD' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
			$sheet->getStyle('BE' . $row)->getNumberFormat()->setFormatCode('#.00');
			$sheet->getStyle('BF' . $row)->getNumberFormat()->setFormatCode('#.00');
			$sheet->getStyle('BG' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('BH' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
			$sheet->getStyle('BI' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('BJ' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
			$sheet->getStyle('BK' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('BL' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
			$sheet->getStyle('BM' . $row)->getNumberFormat()->setFormatCode('#.00');
			$sheet->getStyle('BN' . $row)->getNumberFormat()->setFormatCode('#.00');
			$sheet->getStyle('BO' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('BP' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
			$sheet->getStyle('BQ' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('BR' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
			$sheet->getStyle('BS' . $row)->getNumberFormat()->setFormatCode('#.00');
			$sheet->getStyle('BT' . $row)->getNumberFormat()->setFormatCode('#.00');
			$sheet->getStyle('BU' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('BV' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
			$sheet->getStyle('BW' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('BX' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
			$sheet->getStyle('BY' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('BZ' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
			$sheet->getStyle('CA' . $row)->getNumberFormat()->setFormatCode('#.00');
			$sheet->getStyle('CB' . $row)->getNumberFormat()->setFormatCode('#.00');
			$sheet->getStyle('CC' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('CD' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
			$sheet->getStyle('CE' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('CF' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
			$sheet->getStyle('CG' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('CH' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
			$sheet->getStyle('CI' . $row)->getNumberFormat()->setFormatCode('#.00');
			$sheet->getStyle('CJ' . $row)->getNumberFormat()->setFormatCode('#.00');
			$sheet->getStyle('CK' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('CL' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
			$sheet->getStyle('CM' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('CN' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
			$sheet->getStyle('CO' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('CP' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
			$sheet->getStyle('CQ' . $row)->getNumberFormat()->setFormatCode('#.00');
			$sheet->getStyle('CR' . $row)->getNumberFormat()->setFormatCode('#.00');
			$sheet->getStyle('CS' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('CT' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
			$sheet->getStyle('CU' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('CV' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
			$sheet->getStyle('CW' . $row)->getNumberFormat()->setFormatCode('#.00');
			$sheet->getStyle('CX' . $row)->getNumberFormat()->setFormatCode('#.00');
			$sheet->getStyle('CY' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('CZ' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
			$sheet->getStyle('DA' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('DB' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
			$sheet->getStyle('DC' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('DD' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
			$sheet->getStyle('DE' . $row)->getNumberFormat()->setFormatCode('#.00');
			$sheet->getStyle('DF' . $row)->getNumberFormat()->setFormatCode('#.00');
			$sheet->getStyle('DG' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('DH' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
			$sheet->getStyle('DI' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('DJ' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
			$sheet->getStyle('DK' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('DL' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
			$sheet->getStyle('DM' . $row)->getNumberFormat()->setFormatCode('#.00');
			$sheet->getStyle('DN' . $row)->getNumberFormat()->setFormatCode('#.00');
			$sheet->getStyle('DO' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('DP' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
			$sheet->getStyle('DQ' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('DR' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
			$sheet->getStyle('DS' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('DT' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
			$sheet->getStyle('DU' . $row)->getNumberFormat()->setFormatCode('#.00');
			$sheet->getStyle('DW' . $row)->getNumberFormat()->setFormatCode('#.00');
			$sheet->getStyle('DW' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('DX' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
			$sheet->getStyle('DY' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('DZ' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
			$sheet->getStyle('EA' . $row)->getNumberFormat()->setFormatCode('#.00');
			$sheet->getStyle('EB' . $row)->getNumberFormat()->setFormatCode('#.00');
			$sheet->getStyle('EC' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('ED' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
			$sheet->getStyle('EE' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('EF' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
			$sheet->getStyle('EG' . $row)->getNumberFormat()->setFormatCode('#.00');
			$sheet->getStyle('EH' . $row)->getNumberFormat()->setFormatCode('#.00');

			$item_group = $rows['item_group'];
			$principal = $rows['principal'];

			$qty_jan += $rows['qty_jan'];
			$qty_feb += $rows['qty_feb'];
			$qty_mar += $rows['qty_mar'];
			$qty_q1 += $rows['qty_q1'];

			$qty_apr += $rows['qty_apr'];
			$qty_mei += $rows['qty_mei'];
			$qty_jun += $rows['qty_jun'];
			$qty_q2 += $rows['qty_q2'];

			$qty_jul += $rows['qty_jul'];
			$qty_agu += $rows['qty_agu'];
			$qty_sep += $rows['qty_sep'];
			$qty_q3 += $rows['qty_q3'];

			$qty_okt += $rows['qty_okt'];
			$qty_nop += $rows['qty_nop'];
			$qty_des += $rows['qty_des'];
			$qty_q4 += $rows['qty_q4'];
			
			$val_jan += $rows['value_jan'];
			$val_feb += $rows['value_feb'];
			$val_mar += $rows['value_mar'];
			$val_q1 += $rows['value_q1'];

			$val_apr += $rows['value_apr'];
			$val_mei += $rows['value_mei'];
			$val_jun += $rows['value_jun'];
			$val_q2 += $rows['value_q2'];

			$val_jul += $rows['value_jul'];
			$val_agu += $rows['value_agu'];
			$val_sep += $rows['value_sep'];
			$val_q3 += $rows['value_q3'];

			$val_okt += $rows['value_okt'];
			$val_nop += $rows['value_nop'];
			$val_des += $rows['value_des'];
			$val_q4 += $rows['value_q4'];

			$target_qty_jan += $rows['target_qty_jan'];
			$target_qty_feb += $rows['target_qty_feb'];
			$target_qty_mar += $rows['target_qty_mar'];
			$target_qty_q1 += $rows['target_qty_q1'];

			$target_qty_apr += $rows['target_qty_apr'];
			$target_qty_mei += $rows['target_qty_mei'];
			$target_qty_jun += $rows['target_qty_jun'];
			$target_qty_q2 += $rows['target_qty_q2'];

			$target_qty_jul += $rows['target_qty_jul'];
			$target_qty_agu += $rows['target_qty_agu'];
			$target_qty_sep += $rows['target_qty_sep'];
			$target_qty_q3 += $rows['target_qty_q3'];

			$target_qty_okt += $rows['target_qty_okt'];
			$target_qty_nop += $rows['target_qty_nop'];
			$target_qty_des += $rows['target_qty_des'];
			$target_qty_q4 += $rows['target_qty_q4'];
			
			$target_val_jan += $rows['target_val_jan'];
			$target_val_feb += $rows['target_val_feb'];
			$target_val_mar += $rows['target_val_mar'];
			$target_val_q1 += $rows['target_value_q1'];

			$target_val_apr += $rows['target_val_apr'];
			$target_val_mei += $rows['target_val_mei'];
			$target_val_jun += $rows['target_val_jun'];
			$target_val_q2 += $rows['target_value_q2'];

			$target_val_jul += $rows['target_val_jul'];
			$target_val_agu += $rows['target_val_agu'];
			$target_val_sep += $rows['target_val_sep'];
			$target_val_q3 += $rows['target_value_q3'];

			$target_val_okt += $rows['target_val_okt'];
			$target_val_nop += $rows['target_val_nop'];
			$target_val_des += $rows['target_val_des'];
			$target_val_q4 += $rows['target_value_q4'];

			$idx_qty_jan = ($qty_jan/($target_qty_jan ?: 1))*100;
			$idx_qty_feb = ($qty_feb/($target_qty_feb ?: 1))*100;
			$idx_qty_mar = ($qty_mar/($target_qty_mar ?: 1))*100;
			$idx_qty_q1 = ($qty_q1/($target_qty_q1 ?: 1))*100;

			$idx_qty_apr = ($qty_apr/($target_qty_apr ?: 1))*100;
			$idx_qty_mei = ($qty_mei/($target_qty_mei ?: 1))*100;
			$idx_qty_jun = ($qty_jun/($target_qty_jun ?: 1))*100;
			$idx_qty_q2 = ($qty_q2/($target_qty_q2 ?: 1))*100;

			$idx_qty_jul = ($qty_jul/($target_qty_jul ?: 1))*100;
			$idx_qty_agu = ($qty_agu/($target_qty_agu ?: 1))*100;
			$idx_qty_sep = ($qty_sep/($target_qty_sep ?: 1))*100;
			$idx_qty_q3 = ($qty_q3/($target_qty_q3 ?: 1))*100;

			$idx_qty_okt = ($qty_okt/($target_qty_okt ?: 1))*100;
			$idx_qty_nop = ($qty_nop/($target_qty_nop ?: 1))*100;
			$idx_qty_des = ($qty_des/($target_qty_des ?: 1))*100;
			$idx_qty_q4 = ($qty_q4/($target_qty_q4 ?: 1))*100;
			
			$idx_val_jan = ($val_jan/($target_val_jan ?: 1))*100;
			$idx_val_feb = ($val_feb/($target_val_feb ?: 1))*100;
			$idx_val_mar = ($val_mar/($target_val_mar ?: 1))*100;
			$idx_val_q1 = ($val_q1/($target_val_q1 ?: 1))*100;

			$idx_val_apr = ($val_apr/($target_val_apr ?: 1))*100;
			$idx_val_mei = ($val_mei/($target_val_mei ?: 1))*100;
			$idx_val_jun = ($val_jun/($target_val_jun ?: 1))*100;
			$idx_val_q2 = ($val_q2/($target_val_q2 ?: 1))*100;

			$idx_val_jul = ($val_jul/($target_val_jul ?: 1))*100;
			$idx_val_agu = ($val_agu/($target_val_agu ?: 1))*100;
			$idx_val_sep = ($val_sep/($target_val_sep ?: 1))*100;
			$idx_val_q3 = ($val_q3/($target_val_q3 ?: 1))*100;

			$idx_val_okt = ($val_okt/($target_val_okt ?: 1))*100;
			$idx_val_nop = ($val_nop/($target_val_nop ?: 1))*100;
			$idx_val_des = ($val_des/($target_val_des ?: 1))*100;
			$idx_val_q4 = ($val_q4/($target_val_q4 ?: 1))*100;

			$stok_qty_jan += $row['stok_qty_jan'];
			$stok_qty_feb += $row['stok_qty_feb'];
			$stok_qty_mar += $row['stok_qty_mar'];
			
			$stok_qty_apr += $row['stok_qty_apr'];
			$stok_qty_mei += $row['stok_qty_mei'];
			$stok_qty_jun += $row['stok_qty_jun'];
			
			$stok_qty_jul += $row['stok_qty_jul'];
			$stok_qty_agu += $row['stok_qty_agu'];
			$stok_qty_sep += $row['stok_qty_sep'];
			
			$stok_qty_okt += $row['stok_qty_okt'];
			$stok_qty_nop += $row['stok_qty_nop'];
			$stok_qty_des += $row['stok_qty_des'];
			
			$stok_val_jan += $row['stok_val_jan'];
			$stok_val_feb += $row['stok_val_feb'];
			$stok_val_mar += $row['stok_val_mar'];
			
			$stok_val_apr += $row['stok_val_apr'];
			$stok_val_mei += $row['stok_val_mei'];
			$stok_val_jun += $row['stok_val_jun'];
			
			$stok_val_jul += $row['stok_val_jul'];
			$stok_val_agu += $row['stok_val_agu'];
			$stok_val_sep += $row['stok_val_sep'];
			
			$stok_val_okt += $row['stok_val_okt'];
			$stok_val_nop += $row['stok_val_nop'];
			$stok_val_des += $row['stok_val_des'];

			
			$sub_qty_jan += $rows['qty_jan'];
			$sub_qty_feb += $rows['qty_feb'];
			$sub_qty_mar += $rows['qty_mar'];
			$sub_qty_q1 += $rows['qty_q1'];

			$sub_qty_apr += $rows['qty_apr'];
			$sub_qty_mei += $rows['qty_mei'];
			$sub_qty_jun += $rows['qty_jun'];
			$sub_qty_q2 += $rows['qty_q2'];

			$sub_qty_jul += $rows['qty_jul'];
			$sub_qty_agu += $rows['qty_agu'];
			$sub_qty_sep += $rows['qty_sep'];
			$sub_qty_q3 += $rows['qty_q3'];

			$sub_qty_okt += $rows['qty_okt'];
			$sub_qty_nop += $rows['qty_nop'];
			$sub_qty_des += $rows['qty_des'];
			$sub_qty_q4 += $rows['qty_q4'];
			
			$sub_val_jan += $rows['value_jan'];
			$sub_val_feb += $rows['value_feb'];
			$sub_val_mar += $rows['value_mar'];
			$sub_val_q1 += $rows['value_q1'];

			$sub_val_apr += $rows['value_apr'];
			$sub_val_mei += $rows['value_mei'];
			$sub_val_jun += $rows['value_jun'];
			$sub_val_q2 += $rows['value_q2'];

			$sub_val_jul += $rows['value_jul'];
			$sub_val_agu += $rows['value_agu'];
			$sub_val_sep += $rows['value_sep'];
			$sub_val_q3 += $rows['value_q3'];

			$sub_val_okt += $rows['value_okt'];
			$sub_val_nop += $rows['value_nop'];
			$sub_val_des += $rows['value_des'];
			$sub_val_q4 += $rows['value_q4'];

			$sub_target_qty_jan += $rows['target_qty_jan'];
			$sub_target_qty_feb += $rows['target_qty_feb'];
			$sub_target_qty_mar += $rows['target_qty_mar'];
			$sub_target_qty_q1 += $rows['target_qty_q1'];

			$sub_target_qty_apr += $rows['target_qty_apr'];
			$sub_target_qty_mei += $rows['target_qty_mei'];
			$sub_target_qty_jun += $rows['target_qty_jun'];
			$sub_target_qty_q2 += $rows['target_qty_q2'];

			$sub_target_qty_jul += $rows['target_qty_jul'];
			$sub_target_qty_agu += $rows['target_qty_agu'];
			$sub_target_qty_sep += $rows['target_qty_sep'];
			$sub_target_qty_q3 += $rows['target_qty_q3'];

			$sub_target_qty_okt += $rows['target_qty_okt'];
			$sub_target_qty_nop += $rows['target_qty_nop'];
			$sub_target_qty_des += $rows['target_qty_des'];
			$sub_target_qty_q4 += $rows['target_qty_q4'];
			
			$sub_target_val_jan += $rows['target_val_jan'];
			$sub_target_val_feb += $rows['target_val_feb'];
			$sub_target_val_mar += $rows['target_val_mar'];
			$sub_target_val_q1 += $rows['target_value_q1'];

			$sub_target_val_apr += $rows['target_val_apr'];
			$sub_target_val_mei += $rows['target_val_mei'];
			$sub_target_val_jun += $rows['target_val_jun'];
			$sub_target_val_q2 += $rows['target_value_q2'];

			$sub_target_val_jul += $rows['target_val_jul'];
			$sub_target_val_agu += $rows['target_val_agu'];
			$sub_target_val_sep += $rows['target_val_sep'];
			$sub_target_val_q3 += $rows['target_value_q3'];

			$sub_target_val_okt += $rows['target_val_okt'];
			$sub_target_val_nop += $rows['target_val_nop'];
			$sub_target_val_des += $rows['target_val_des'];
			$sub_target_val_q4 += $rows['target_value_q4'];

			$sub_idx_qty_jan = ($sub_qty_jan/($sub_target_qty_jan ?: 1))*100;
			$sub_idx_qty_feb = ($sub_qty_feb/($sub_target_qty_feb ?: 1))*100;
			$sub_idx_qty_mar = ($sub_qty_mar/($sub_target_qty_mar ?: 1))*100;
			$sub_idx_qty_q1 = ($sub_qty_q1/($sub_target_qty_q1 ?: 1))*100;

			$sub_idx_qty_apr = ($sub_qty_apr/($sub_target_qty_apr ?: 1))*100;
			$sub_idx_qty_mei = ($sub_qty_mei/($sub_target_qty_mei ?: 1))*100;
			$sub_idx_qty_jun = ($sub_qty_jun/($sub_target_qty_jun ?: 1))*100;
			$sub_idx_qty_q2 = ($sub_qty_q2/($sub_target_qty_q2 ?: 1))*100;

			$sub_idx_qty_jul = ($sub_qty_jul/($sub_target_qty_jul ?: 1))*100;
			$sub_idx_qty_agu = ($sub_qty_agu/($sub_target_qty_agu ?: 1))*100;
			$sub_idx_qty_sep = ($sub_qty_sep/($sub_target_qty_sep ?: 1))*100;
			$sub_idx_qty_q3 = ($sub_qty_q3/($sub_target_qty_q3 ?: 1))*100;

			$sub_idx_qty_okt = ($sub_qty_okt/($sub_target_qty_okt ?: 1))*100;
			$sub_idx_qty_nop = ($sub_qty_nop/($sub_target_qty_nop ?: 1))*100;
			$sub_idx_qty_des = ($sub_qty_des/($sub_target_qty_des ?: 1))*100;
			$sub_idx_qty_q4 = ($sub_qty_q4/($sub_target_qty_q4 ?: 1))*100;
			
			$sub_idx_val_jan = ($sub_val_jan/($sub_target_val_jan ?: 1))*100;
			$sub_idx_val_feb = ($sub_val_feb/($sub_target_val_feb ?: 1))*100;
			$sub_idx_val_mar = ($sub_val_mar/($sub_target_val_mar ?: 1))*100;
			$sub_idx_val_q1 = ($sub_val_q1/($sub_target_val_q1 ?: 1))*100;

			$sub_idx_val_apr = ($sub_val_apr/($sub_target_val_apr ?: 1))*100;
			$sub_idx_val_mei = ($sub_val_mei/($sub_target_val_mei ?: 1))*100;
			$sub_idx_val_jun = ($sub_val_jun/($sub_target_val_jun ?: 1))*100;
			$sub_idx_val_q2 = ($sub_val_q2/($sub_target_val_q2 ?: 1))*100;

			$sub_idx_val_jul = ($sub_val_jul/($sub_target_val_jul ?: 1))*100;
			$sub_idx_val_agu = ($sub_val_agu/($sub_target_val_agu ?: 1))*100;
			$sub_idx_val_sep = ($sub_val_sep/($sub_target_val_sep ?: 1))*100;
			$sub_idx_val_q3 = ($sub_val_q3/($sub_target_val_q3 ?: 1))*100;

			$sub_idx_val_okt = ($sub_val_okt/($sub_target_val_okt ?: 1))*100;
			$sub_idx_val_nop = ($sub_val_nop/($sub_target_val_nop ?: 1))*100;
			$sub_idx_val_des = ($sub_val_des/($sub_target_val_des ?: 1))*100;
			$sub_idx_val_q4 = ($sub_val_q4/($sub_target_val_q4 ?: 1))*100;

			$sub_stok_qty_jan += $row['stok_qty_jan'];
			$sub_stok_qty_feb += $row['stok_qty_feb'];
			$sub_stok_qty_mar += $row['stok_qty_mar'];

			$sub_stok_qty_apr += $row['stok_qty_apr'];
			$sub_stok_qty_mei += $row['stok_qty_mei'];
			$sub_stok_qty_jun += $row['stok_qty_jun'];

			$sub_stok_qty_jul += $row['stok_qty_jul'];
			$sub_stok_qty_agu += $row['stok_qty_agu'];
			$sub_stok_qty_sep += $row['stok_qty_sep'];

			$sub_stok_qty_okt += $row['stok_qty_okt'];
			$sub_stok_qty_nop += $row['stok_qty_nop'];
			$sub_stok_qty_des += $row['stok_qty_des'];
			
			$sub_stok_val_jan += $row['stok_val_jan'];
			$sub_stok_val_feb += $row['stok_val_feb'];
			$sub_stok_val_mar += $row['stok_val_mar'];

			$sub_stok_val_apr += $row['stok_val_apr'];
			$sub_stok_val_mei += $row['stok_val_mei'];
			$sub_stok_val_jun += $row['stok_val_jun'];

			$sub_stok_val_jul += $row['stok_val_jul'];
			$sub_stok_val_agu += $row['stok_val_agu'];
			$sub_stok_val_sep += $row['stok_val_sep'];

			$sub_stok_val_okt += $row['stok_val_okt'];
			$sub_stok_val_nop += $row['stok_val_nop'];
			$sub_stok_val_des += $row['stok_val_des'];

			$total_qty_jan += $rows['qty_jan'];
			$total_qty_feb += $rows['qty_feb'];
			$total_qty_mar += $rows['qty_mar'];
			$total_qty_q1 += $rows['qty_q1'];

			$total_qty_apr += $rows['qty_apr'];
			$total_qty_mei += $rows['qty_mei'];
			$total_qty_jun += $rows['qty_jun'];
			$total_qty_q2 += $rows['qty_q2'];

			$total_qty_jul += $rows['qty_jul'];
			$total_qty_agu += $rows['qty_agu'];
			$total_qty_sep += $rows['qty_sep'];
			$total_qty_q3 += $rows['qty_q3'];

			$total_qty_okt += $rows['qty_okt'];
			$total_qty_nop += $rows['qty_nop'];
			$total_qty_des += $rows['qty_des'];
			$total_qty_q4 += $rows['qty_q4'];
			
			$total_val_jan += $rows['value_jan'];
			$total_val_feb += $rows['value_feb'];
			$total_val_mar += $rows['value_mar'];
			$total_val_q1 += $rows['value_q1'];

			$total_val_apr += $rows['value_apr'];
			$total_val_mei += $rows['value_mei'];
			$total_val_jun += $rows['value_jun'];
			$total_val_q2 += $rows['value_q2'];

			$total_val_jul += $rows['value_jul'];
			$total_val_agu += $rows['value_agu'];
			$total_val_sep += $rows['value_sep'];
			$total_val_q3 += $rows['value_q3'];

			$total_val_okt += $rows['value_okt'];
			$total_val_nop += $rows['value_nop'];
			$total_val_des += $rows['value_des'];
			$total_val_q4 += $rows['value_q4'];

			$total_target_qty_jan += $rows['target_qty_jan'];
			$total_target_qty_feb += $rows['target_qty_feb'];
			$total_target_qty_mar += $rows['target_qty_mar'];
			$total_target_qty_q1 += $rows['target_qty_q1'];

			$total_target_qty_apr += $rows['target_qty_apr'];
			$total_target_qty_mei += $rows['target_qty_mei'];
			$total_target_qty_jun += $rows['target_qty_jun'];
			$total_target_qty_q2 += $rows['target_qty_q2'];

			$total_target_qty_jul += $rows['target_qty_jul'];
			$total_target_qty_agu += $rows['target_qty_agu'];
			$total_target_qty_sep += $rows['target_qty_sep'];
			$total_target_qty_q3 += $rows['target_qty_q3'];

			$total_target_qty_okt += $rows['target_qty_okt'];
			$total_target_qty_nop += $rows['target_qty_nop'];
			$total_target_qty_des += $rows['target_qty_des'];
			$total_target_qty_q4 += $rows['target_qty_q4'];
			
			$total_target_val_jan += $rows['target_val_jan'];
			$total_target_val_feb += $rows['target_val_feb'];
			$total_target_val_mar += $rows['target_val_mar'];
			$total_target_val_q1 += $rows['target_value_q1'];

			$total_target_val_apr += $rows['target_val_apr'];
			$total_target_val_mei += $rows['target_val_mei'];
			$total_target_val_jun += $rows['target_val_jun'];
			$total_target_val_q2 += $rows['target_value_q2'];

			$total_target_val_jul += $rows['target_val_jul'];
			$total_target_val_agu += $rows['target_val_agu'];
			$total_target_val_sep += $rows['target_val_sep'];
			$total_target_val_q3 += $rows['target_value_q3'];

			$total_target_val_okt += $rows['target_val_okt'];
			$total_target_val_nop += $rows['target_val_nop'];
			$total_target_val_des += $rows['target_val_des'];
			$total_target_val_q4 += $rows['target_value_q4'];

			$total_idx_qty_jan = ($total_qty_jan/($total_target_qty_jan ?: 1))*100;
			$total_idx_qty_feb = ($total_qty_feb/($total_target_qty_feb ?: 1))*100;
			$total_idx_qty_mar = ($total_qty_mar/($total_target_qty_mar ?: 1))*100;
			$total_idx_qty_q1 = ($total_qty_q1/($total_target_qty_q1 ?: 1))*100;

			$total_idx_qty_apr = ($total_qty_apr/($total_target_qty_apr ?: 1))*100;
			$total_idx_qty_mei = ($total_qty_mei/($total_target_qty_mei ?: 1))*100;
			$total_idx_qty_jun = ($total_qty_jun/($total_target_qty_jun ?: 1))*100;
			$total_idx_qty_q2 = ($total_qty_q2/($total_target_qty_q2 ?: 1))*100;

			$total_idx_qty_jul = ($total_qty_jul/($total_target_qty_jul ?: 1))*100;
			$total_idx_qty_agu = ($total_qty_agu/($total_target_qty_agu ?: 1))*100;
			$total_idx_qty_sep = ($total_qty_sep/($total_target_qty_sep ?: 1))*100;
			$total_idx_qty_q3 = ($total_qty_q3/($total_target_qty_q3 ?: 1))*100;

			$total_idx_qty_okt = ($total_qty_okt/($total_target_qty_okt ?: 1))*100;
			$total_idx_qty_nop = ($total_qty_nop/($total_target_qty_nop ?: 1))*100;
			$total_idx_qty_des = ($total_qty_des/($total_target_qty_des ?: 1))*100;
			$total_idx_qty_q4 = ($total_qty_q4/($total_target_qty_q4 ?: 1))*100;
			
			$total_idx_val_jan = ($total_val_jan/($total_target_val_jan ?: 1))*100;
			$total_idx_val_feb = ($total_val_feb/($total_target_val_feb ?: 1))*100;
			$total_idx_val_mar = ($total_val_mar/($total_target_val_mar ?: 1))*100;
			$total_idx_val_q1 = ($total_val_q1/($total_target_val_q1 ?: 1))*100;

			$total_idx_val_apr = ($total_val_apr/($total_target_val_apr ?: 1))*100;
			$total_idx_val_mei = ($total_val_mei/($total_target_val_mei ?: 1))*100;
			$total_idx_val_jun = ($total_val_jun/($total_target_val_jun ?: 1))*100;
			$total_idx_val_q2 = ($total_val_q2/($total_target_val_q2 ?: 1))*100;

			$total_idx_val_jul = ($total_val_jul/($total_target_val_jul ?: 1))*100;
			$total_idx_val_agu = ($total_val_agu/($total_target_val_agu ?: 1))*100;
			$total_idx_val_sep = ($total_val_sep/($total_target_val_sep ?: 1))*100;
			$total_idx_val_q3 = ($total_val_q3/($total_target_val_q3 ?: 1))*100;

			$total_idx_val_okt = ($total_val_okt/($total_target_val_okt ?: 1))*100;
			$total_idx_val_nop = ($total_val_nop/($total_target_val_nop ?: 1))*100;
			$total_idx_val_des = ($total_val_des/($total_target_val_des ?: 1))*100;
			$total_idx_val_q4 = ($total_val_q4/($total_target_val_q4 ?: 1))*100;

			$total_stok_qty_jan += $row['stok_qty_jan'];
			$total_stok_qty_feb += $row['stok_qty_feb'];
			$total_stok_qty_mar += $row['stok_qty_mar'];

			$total_stok_qty_apr += $row['stok_qty_apr'];
			$total_stok_qty_mei += $row['stok_qty_mei'];
			$total_stok_qty_jun += $row['stok_qty_jun'];

			$total_stok_qty_jul += $row['stok_qty_jul'];
			$total_stok_qty_agu += $row['stok_qty_agu'];
			$total_stok_qty_sep += $row['stok_qty_sep'];

			$total_stok_qty_okt += $row['stok_qty_okt'];
			$total_stok_qty_nop += $row['stok_qty_nop'];
			$total_stok_qty_des += $row['stok_qty_des'];
			
			$total_stok_val_jan += $row['stok_val_jan'];
			$total_stok_val_feb += $row['stok_val_feb'];
			$total_stok_val_mar += $row['stok_val_mar'];

			$total_stok_val_apr += $row['stok_val_apr'];
			$total_stok_val_mei += $row['stok_val_mei'];
			$total_stok_val_jun += $row['stok_val_jun'];

			$total_stok_val_jul += $row['stok_val_jul'];
			$total_stok_val_agu += $row['stok_val_agu'];
			$total_stok_val_sep += $row['stok_val_sep'];

			$total_stok_val_okt += $row['stok_val_okt'];
			$total_stok_val_nop += $row['stok_val_nop'];
			$total_stok_val_des += $row['stok_val_des'];

			$no++; // Tambah 1 setiap kali looping
    		$row++; // Tambah 1 setiap kali looping
		endforeach;

		$sub_qty_year = $sub_qty_jan + $sub_qty_feb + $sub_qty_mar + $sub_qty_apr + $sub_qty_mei + $sub_qty_jun + $sub_qty_jul + $sub_qty_agu + $sub_qty_sep + $sub_qty_okt + $sub_qty_nop + $sub_qty_des;
		$sub_val_year = $sub_val_jan + $sub_val_feb + $sub_val_mar + $sub_val_apr + $sub_val_mei + $sub_val_jun + $sub_val_jul + $sub_val_agu + $sub_val_sep + $sub_val_okt + $sub_val_nop + $sub_val_des;
		$sub_target_qty_year = $sub_target_qty_jan + $sub_target_qty_feb + $sub_target_qty_mar + $sub_target_qty_apr + $sub_target_qty_mei + $sub_target_qty_jun + $sub_target_qty_jul + $sub_target_qty_agu + $sub_target_qty_sep + $sub_target_qty_okt + $sub_target_qty_nop + $sub_target_qty_des; 
		$sub_target_val_year = $sub_target_val_jan + $sub_target_val_feb + $sub_target_val_mar + $sub_target_val_apr + $sub_target_val_mei + $sub_target_val_jun + $sub_target_val_jul + $sub_target_val_agu + $sub_target_val_sep + $sub_target_val_okt + $sub_target_val_nop + $sub_target_val_des;
		$sub_idx_qty_year = ($sub_qty_year/($sub_target_qty_year ?: 1))*100; 
		$sub_idx_val_year = ($sub_val_year/($sub_target_val_year ?: 1))*100; 
		$sub_qty_avg = $sub_qty_year/12;
		$sub_val_avg = $sub_val_year/12;
		$sub_target_qty_avg = $sub_target_qty_year/12;
		$sub_target_val_avg = $sub_target_val_year/12;
		$sub_idx_qty_avg = ($sub_qty_avg/($sub_target_qty_avg ?: 1))*100;
		$sub_idx_val_avg = ($sub_val_avg/($sub_target_val_avg ?: 1))*100;

		//item_group end
		//$row = $row + 1;
		$sheet->setCellValue('A' . $row, '');
		$sheet->setCellValue('B' . $row, $principal);
		$sheet->setCellValue('C' . $row, $item_group);
		$sheet->setCellValue('D' . $row, '');
		$sheet->setCellValue('E' . $row, 'Sub Total ' . $item_group);
		$sheet->setCellValue('F' . $row, '');
		$sheet->setCellValue('G' . $row, $qty_jan);
		$sheet->setCellValue('H' . $row, $val_jan);
		$sheet->setCellValue('I' . $row, $target_qty_jan);
		$sheet->setCellValue('J' . $row, $target_val_jan);
		$sheet->setCellValue('K' . $row, $idx_qty_jan);
		$sheet->setCellValue('L' . $row, $idx_val_jan);
		$sheet->setCellValue('M' . $row, $stok_qty_jan);
		$sheet->setCellValue('N' . $row, $stok_val_jan);
		$sheet->setCellValue('O' . $row, $qty_feb);
		$sheet->setCellValue('P' . $row, $val_feb);
		$sheet->setCellValue('Q' . $row, $target_qty_feb);
		$sheet->setCellValue('R' . $row, $target_val_feb);
		$sheet->setCellValue('S' . $row, $idx_qty_feb);
		$sheet->setCellValue('T' . $row, $idx_val_feb);
		$sheet->setCellValue('U' . $row, $stok_qty_feb);
		$sheet->setCellValue('V' . $row, $stok_val_feb);
		$sheet->setCellValue('W' . $row, $qty_mar);
		$sheet->setCellValue('X' . $row, $val_mar);
		$sheet->setCellValue('Y' . $row, $target_qty_mar);
		$sheet->setCellValue('Z' . $row, $target_val_mar);
		$sheet->setCellValue('AA' . $row, $idx_qty_mar);
		$sheet->setCellValue('AB' . $row, $idx_val_mar);
		$sheet->setCellValue('AC' . $row, $stok_qty_mar);
		$sheet->setCellValue('AD' . $row, $stok_val_mar);
		$sheet->setCellValue('AE' . $row, $qty_q1);
		$sheet->setCellValue('AF' . $row, $val_q1);
		$sheet->setCellValue('AG' . $row, $target_qty_q1);
		$sheet->setCellValue('AH' . $row, $target_val_q1);
		$sheet->setCellValue('AI' . $row, $idx_qty_q1);
		$sheet->setCellValue('AJ' . $row, $idx_val_q1);

		$sheet->setCellValue('AK' . $row, $qty_apr);
		$sheet->setCellValue('AL' . $row, $val_apr);
		$sheet->setCellValue('AM' . $row, $target_qty_apr);
		$sheet->setCellValue('AN' . $row, $target_val_apr);
		$sheet->setCellValue('AO' . $row, $idx_qty_apr);
		$sheet->setCellValue('AP' . $row, $idx_val_apr);
		$sheet->setCellValue('AQ' . $row, $stok_qty_apr);
		$sheet->setCellValue('AR' . $row, $stok_val_apr);
		$sheet->setCellValue('AS' . $row, $qty_mei);
		$sheet->setCellValue('AT' . $row, $val_mei);
		$sheet->setCellValue('AU' . $row, $target_qty_mei);
		$sheet->setCellValue('AV' . $row, $target_val_mei);
		$sheet->setCellValue('AW' . $row, $idx_qty_mei);
		$sheet->setCellValue('AX' . $row, $idx_val_mei);
		$sheet->setCellValue('AY' . $row, $stok_qty_mei);
		$sheet->setCellValue('AZ' . $row, $stok_val_mei);
		$sheet->setCellValue('BA' . $row, $qty_jun);
		$sheet->setCellValue('BB' . $row, $val_jun);
		$sheet->setCellValue('BC' . $row, $target_qty_jun);
		$sheet->setCellValue('BD' . $row, $target_val_jun);
		$sheet->setCellValue('BE' . $row, $idx_qty_jun);
		$sheet->setCellValue('BF' . $row, $idx_val_jun);
		$sheet->setCellValue('BG' . $row, $stok_qty_jun);
		$sheet->setCellValue('BH' . $row, $stok_val_jun);
		$sheet->setCellValue('BI' . $row, $qty_q2);
		$sheet->setCellValue('BJ' . $row, $val_q2);
		$sheet->setCellValue('BK' . $row, $target_qty_q2);
		$sheet->setCellValue('BL' . $row, $target_val_q2);
		$sheet->setCellValue('BM' . $row, $idx_qty_q2);
		$sheet->setCellValue('BN' . $row, $idx_val_q2);

		$sheet->setCellValue('BO' . $row, $qty_jul);
		$sheet->setCellValue('BP' . $row, $val_jul);
		$sheet->setCellValue('BQ' . $row, $target_qty_jul);
		$sheet->setCellValue('BR' . $row, $target_val_jul);
		$sheet->setCellValue('BS' . $row, $idx_qty_jul);
		$sheet->setCellValue('BT' . $row, $idx_val_jul);
		$sheet->setCellValue('BU' . $row, $stok_qty_jul);
		$sheet->setCellValue('BV' . $row, $stok_val_jul);
		$sheet->setCellValue('BW' . $row, $qty_agu);
		$sheet->setCellValue('BX' . $row, $val_agu);
		$sheet->setCellValue('BY' . $row, $target_qty_agu);
		$sheet->setCellValue('BZ' . $row, $target_val_agu);
		$sheet->setCellValue('CA' . $row, $idx_qty_agu);
		$sheet->setCellValue('CB' . $row, $idx_val_agu);
		$sheet->setCellValue('CC' . $row, $stok_qty_agu);
		$sheet->setCellValue('CD' . $row, $stok_val_agu);
		$sheet->setCellValue('CE' . $row, $qty_sep);
		$sheet->setCellValue('CF' . $row, $val_sep);
		$sheet->setCellValue('CG' . $row, $target_qty_sep);
		$sheet->setCellValue('CH' . $row, $target_val_sep);
		$sheet->setCellValue('CI' . $row, $idx_qty_sep);
		$sheet->setCellValue('CJ' . $row, $idx_val_sep);
		$sheet->setCellValue('CK' . $row, $stok_qty_sep);
		$sheet->setCellValue('CL' . $row, $stok_val_sep);
		$sheet->setCellValue('CM' . $row, $qty_q3);
		$sheet->setCellValue('CN' . $row, $val_q3);
		$sheet->setCellValue('CO' . $row, $target_qty_q3);
		$sheet->setCellValue('CP' . $row, $target_val_q3);
		$sheet->setCellValue('CQ' . $row, $idx_qty_q3);
		$sheet->setCellValue('CR' . $row, $idx_val_q3);

		$sheet->setCellValue('CS' . $row, $qty_okt);
		$sheet->setCellValue('CT' . $row, $val_okt);
		$sheet->setCellValue('CU' . $row, $target_qty_okt);
		$sheet->setCellValue('CV' . $row, $target_val_okt);
		$sheet->setCellValue('CW' . $row, $idx_qty_okt);
		$sheet->setCellValue('CX' . $row, $idx_val_okt);
		$sheet->setCellValue('CY' . $row, $stok_qty_okt);
		$sheet->setCellValue('CZ' . $row, $stok_val_okt);
		$sheet->setCellValue('DA' . $row, $qty_nop);
		$sheet->setCellValue('DB' . $row, $val_nop);
		$sheet->setCellValue('DC' . $row, $target_qty_nop);
		$sheet->setCellValue('DD' . $row, $target_val_nop);
		$sheet->setCellValue('DE' . $row, $idx_qty_nop);
		$sheet->setCellValue('DF' . $row, $idx_val_nop);
		$sheet->setCellValue('DG' . $row, $stok_qty_nop);
		$sheet->setCellValue('DH' . $row, $stok_val_nop);
		$sheet->setCellValue('DI' . $row, $qty_des);
		$sheet->setCellValue('DJ' . $row, $val_des);
		$sheet->setCellValue('DK' . $row, $target_qty_des);
		$sheet->setCellValue('DL' . $row, $target_val_des);
		$sheet->setCellValue('DM' . $row, $idx_qty_des);
		$sheet->setCellValue('DN' . $row, $idx_val_des);
		$sheet->setCellValue('DO' . $row, $stok_qty_des);
		$sheet->setCellValue('DP' . $row, $stok_val_des);
		$sheet->setCellValue('DQ' . $row, $qty_q4);
		$sheet->setCellValue('DR' . $row, $val_q4);
		$sheet->setCellValue('DS' . $row, $target_qty_q4);
		$sheet->setCellValue('DT' . $row, $target_val_q4);
		$sheet->setCellValue('DU' . $row, $idx_qty_q4);
		$sheet->setCellValue('DV' . $row, $idx_val_q4);

		$qty_year = $qty_jan + $qty_feb + $qty_mar + $qty_apr + $qty_mei + $qty_jun + $qty_jul + $qty_agu + $qty_sep + $qty_okt + $qty_nop + $qty_des;
		$target_qty_year = $target_qty_jan + $target_qty_feb + $target_qty_mar + $target_qty_apr + $target_qty_mei + $target_qty_jun + $target_qty_jul + $target_qty_agu + $target_qty_sep + $target_qty_okt + $target_qty_nop + $target_qty_des;
		$idx_qty_year = ($qty_year/($target_qty_year ?: 1))*100;
		$val_year = $val_jan + $val_feb + $val_mar + $val_apr + $val_mei + $val_jun + $val_jul + $val_agu + $val_sep + $val_okt + $val_nop + $val_des;
		$target_val_year = $target_val_jan + $target_val_feb + $target_val_mar + $target_val_apr + $target_val_mei + $target_val_jun + $target_val_jul + $target_val_agu + $target_val_sep + $target_val_okt + $target_val_nop + $target_val_des;
		$idx_val_year = ($val_year/($target_val_year ?: 1))*100;
		$qty_avg = $qty_year / 12;
		$target_qty_avg = $target_qty_year / 12;
		$idx_qty_avg = ($qty_avg/($target_qty_avg ?: 1))*100;
		$val_avg = $val_year / 12;
		$target_val_avg = $target_val_year / 12;
		$idx_val_avg = ($val_avg/($target_val_avg ?: 1))*100;

		$sheet->setCellValue('DW' . $row, $qty_year);
		$sheet->setCellValue('DX' . $row, $val_year);
		$sheet->setCellValue('DY' . $row, $target_qty_year);
		$sheet->setCellValue('DZ' . $row, $target_val_year);
		$sheet->setCellValue('EA' . $row, $idx_qty_year);
		$sheet->setCellValue('EB' . $row, $idx_val_year);
		$sheet->setCellValue('EC' . $row, $qty_avg);
		$sheet->setCellValue('ED' . $row, $val_avg);
		$sheet->setCellValue('EE' . $row, $target_qty_avg);
		$sheet->setCellValue('EF' . $row, $target_val_avg);
		$sheet->setCellValue('EG' . $row, $idx_qty_avg);
		$sheet->setCellValue('EH' . $row, $idx_val_avg);

		// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
		$sheet->getStyle('A' . $row)->applyFromArray($style_row);
		$sheet->getStyle('B' . $row)->applyFromArray($style_row);
		$sheet->getStyle('C' . $row)->applyFromArray($style_row);
		$sheet->getStyle('D' . $row)->applyFromArray($style_row);
		$sheet->getStyle('E' . $row)->applyFromArray($style_row);
		$sheet->getStyle('F' . $row)->applyFromArray($style_row);
		$sheet->getStyle('G' . $row)->applyFromArray($style_row);
		$sheet->getStyle('H' . $row)->applyFromArray($style_row);
		$sheet->getStyle('I' . $row)->applyFromArray($style_row);
		$sheet->getStyle('J' . $row)->applyFromArray($style_row);
		$sheet->getStyle('K' . $row)->applyFromArray($style_row);
		$sheet->getStyle('L' . $row)->applyFromArray($style_row);
		$sheet->getStyle('M' . $row)->applyFromArray($style_row);
		$sheet->getStyle('N' . $row)->applyFromArray($style_row);
		$sheet->getStyle('O' . $row)->applyFromArray($style_row);
		$sheet->getStyle('P' . $row)->applyFromArray($style_row);
		$sheet->getStyle('Q' . $row)->applyFromArray($style_row);
		$sheet->getStyle('R' . $row)->applyFromArray($style_row);
		$sheet->getStyle('S' . $row)->applyFromArray($style_row);
		$sheet->getStyle('T' . $row)->applyFromArray($style_row);
		$sheet->getStyle('U' . $row)->applyFromArray($style_row);
		$sheet->getStyle('V' . $row)->applyFromArray($style_row);
		$sheet->getStyle('W' . $row)->applyFromArray($style_row);
		$sheet->getStyle('X' . $row)->applyFromArray($style_row);
		$sheet->getStyle('Y' . $row)->applyFromArray($style_row);
		$sheet->getStyle('Z' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AA' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AB' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AC' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AD' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AE' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AF' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AG' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AH' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AI' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AJ' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AK' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AL' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AM' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AN' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AO' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AP' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AQ' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AR' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AS' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AT' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AU' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AV' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AW' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AX' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AY' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AZ' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BA' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BB' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BC' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BD' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BE' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BF' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BG' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BH' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BI' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BJ' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BK' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BL' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BM' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BN' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BO' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BP' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BQ' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BR' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BS' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BT' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BU' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BV' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BW' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BX' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BY' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BZ' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CA' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CB' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CC' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CD' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CE' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CF' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CG' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CH' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CI' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CJ' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CK' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CL' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CM' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CN' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CO' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CP' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CQ' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CR' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CS' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CT' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CU' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CV' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CW' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CX' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CY' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CZ' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DA' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DB' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DC' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DD' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DE' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DF' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DG' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DH' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DI' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DJ' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DK' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DL' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DM' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DN' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DO' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DP' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DQ' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DR' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DS' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DT' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DU' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DV' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DW' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DX' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DY' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DZ' . $row)->applyFromArray($style_row);
		$sheet->getStyle('EA' . $row)->applyFromArray($style_row);
		$sheet->getStyle('EB' . $row)->applyFromArray($style_row);
		$sheet->getStyle('EC' . $row)->applyFromArray($style_row);
		$sheet->getStyle('ED' . $row)->applyFromArray($style_row);
		$sheet->getStyle('EE' . $row)->applyFromArray($style_row);
		$sheet->getStyle('EF' . $row)->applyFromArray($style_row);
		$sheet->getStyle('EG' . $row)->applyFromArray($style_row);
		$sheet->getStyle('EH' . $row)->applyFromArray($style_row);


		$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('I' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('J' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('K' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('L' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('M' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('N' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('O' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('P' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('Q' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('R' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('S' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('T' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('U' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('V' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('W' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('X' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('Y' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('Z' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AA' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AB' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AC' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AD' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AE' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AF' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AG' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AH' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AI' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AJ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AK' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AL' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AM' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AN' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AO' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AP' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AQ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AR' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AS' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AT' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AU' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AV' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AX' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AY' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AZ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BA' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BB' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BC' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BD' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BE' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BF' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BG' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BH' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BI' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BJ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BK' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BL' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BM' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BN' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BO' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BQ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BR' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BS' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BT' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BU' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BV' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BW' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BX' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BY' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BZ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CA' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CB' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CC' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CD' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CE' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CF' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CG' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CH' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CI' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CJ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CK' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CL' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CM' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CN' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CO' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CP' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CQ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CR' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CS' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CT' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CU' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CV' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CW' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CX' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CY' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CZ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DA' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DB' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DC' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DD' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DE' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DF' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DG' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DH' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DI' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DJ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DK' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DL' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DM' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DN' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DO' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DP' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DQ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DR' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DS' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DT' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DU' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DV' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DW' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DX' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DY' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DZ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('EA' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('EB' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('EC' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('ED' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('EE' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('EF' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('EG' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('EH' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

		$sheet->getStyle('G' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('H' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('I' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('J' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('K' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('L' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('M' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('N' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('O' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('P' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('Q' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('R' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('S' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('T' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('U' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('V' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('W' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('X' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('Y' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('Z' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('AA' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('AB' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('AC' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AD' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('AE' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AF' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('AG' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AH' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('AI' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('AJ' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('AK' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AL' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('AM' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AN' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('AO' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('AP' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('AQ' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AR' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('AS' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AT' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('AU' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AV' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('AW' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('AX' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('AY' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AZ' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('AB' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('BB' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('BC' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('BD' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('BE' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('BF' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('BG' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('BH' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('BI' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('BJ' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('BK' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('BL' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('BM' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('BN' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('BO' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('BP' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('BQ' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('BR' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('BS' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('BT' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('BU' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('BV' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('BW' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('BX' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('BY' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('BZ' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('CA' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('CB' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('CC' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('CD' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('CE' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('CF' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('CG' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('CH' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('CI' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('CJ' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('CK' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('CL' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('CM' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('CN' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('CO' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('CP' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('CQ' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('CR' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('CS' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('CT' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('CU' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('CV' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('CW' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('CX' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('CY' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('CZ' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('DA' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('DB' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('DC' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('DD' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('DE' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('DF' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('DG' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('DH' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('DI' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('DJ' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('DK' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('DL' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('DM' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('DN' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('DO' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('DP' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('DQ' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('DR' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('DS' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('DT' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('DU' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('DW' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('DW' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('DX' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('DY' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('DZ' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('EA' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('EB' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('EC' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('ED' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('EE' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('EF' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('EG' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('EH' . $row)->getNumberFormat()->setFormatCode('#.00');

		$sheet->getStyle('A' . $row . ':EH' . $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');
		$sheet->getStyle('A' . $row . ':EH' . $row)->getFont()->setBold(true);

		//principal end
		$row = $row + 1;
		$sheet->setCellValue('A' . $row, '');
		$sheet->setCellValue('B' . $row, $principal);
		$sheet->setCellValue('C' . $row, '');
		$sheet->setCellValue('D' . $row, '');
		$sheet->setCellValue('E' . $row, 'TOTAL ' . $principal);
		$sheet->setCellValue('F' . $row, '');
		$sheet->setCellValue('G' . $row, $sub_qty_jan);
		$sheet->setCellValue('H' . $row, $sub_val_jan);
		$sheet->setCellValue('I' . $row, $sub_target_qty_jan);
		$sheet->setCellValue('J' . $row, $sub_target_val_jan);
		$sheet->setCellValue('K' . $row, $sub_idx_qty_jan);
		$sheet->setCellValue('L' . $row, $sub_idx_val_jan);
		$sheet->setCellValue('M' . $row, $sub_stok_qty_jan);
		$sheet->setCellValue('N' . $row, $sub_stok_val_jan);
		$sheet->setCellValue('O' . $row, $sub_qty_feb);
		$sheet->setCellValue('P' . $row, $sub_val_feb);
		$sheet->setCellValue('Q' . $row, $sub_target_qty_feb);
		$sheet->setCellValue('R' . $row, $sub_target_val_feb);
		$sheet->setCellValue('S' . $row, $sub_idx_qty_feb);
		$sheet->setCellValue('T' . $row, $sub_idx_val_feb);
		$sheet->setCellValue('U' . $row, $sub_stok_qty_feb);
		$sheet->setCellValue('V' . $row, $sub_stok_val_feb);
		$sheet->setCellValue('W' . $row, $sub_qty_mar);
		$sheet->setCellValue('X' . $row, $sub_val_mar);
		$sheet->setCellValue('Y' . $row, $sub_target_qty_mar);
		$sheet->setCellValue('Z' . $row, $sub_target_val_mar);
		$sheet->setCellValue('AA' . $row, $sub_idx_qty_mar);
		$sheet->setCellValue('AB' . $row, $sub_idx_val_mar);
		$sheet->setCellValue('AC' . $row, $sub_stok_qty_mar);
		$sheet->setCellValue('AD' . $row, $sub_stok_val_mar);
		$sheet->setCellValue('AE' . $row, $sub_qty_q1);
		$sheet->setCellValue('AF' . $row, $sub_val_q1);
		$sheet->setCellValue('AG' . $row, $sub_target_qty_q1);
		$sheet->setCellValue('AH' . $row, $sub_target_val_q1);
		$sheet->setCellValue('AI' . $row, $sub_idx_qty_q1);
		$sheet->setCellValue('AJ' . $row, $sub_idx_val_q1);

		$sheet->setCellValue('AK' . $row, $sub_qty_apr);
		$sheet->setCellValue('AL' . $row, $sub_val_apr);
		$sheet->setCellValue('AM' . $row, $sub_target_qty_apr);
		$sheet->setCellValue('AN' . $row, $sub_target_val_apr);
		$sheet->setCellValue('AO' . $row, $sub_idx_qty_apr);
		$sheet->setCellValue('AP' . $row, $sub_idx_val_apr);
		$sheet->setCellValue('AQ' . $row, $sub_stok_qty_apr);
		$sheet->setCellValue('AR' . $row, $sub_stok_val_apr);
		$sheet->setCellValue('AS' . $row, $sub_qty_mei);
		$sheet->setCellValue('AT' . $row, $sub_val_mei);
		$sheet->setCellValue('AU' . $row, $sub_target_qty_mei);
		$sheet->setCellValue('AV' . $row, $sub_target_val_mei);
		$sheet->setCellValue('AW' . $row, $sub_idx_qty_mei);
		$sheet->setCellValue('AX' . $row, $sub_idx_val_mei);
		$sheet->setCellValue('AY' . $row, $sub_stok_qty_mei);
		$sheet->setCellValue('AZ' . $row, $sub_stok_val_mei);
		$sheet->setCellValue('BA' . $row, $sub_qty_jun);
		$sheet->setCellValue('BB' . $row, $sub_val_jun);
		$sheet->setCellValue('BC' . $row, $sub_target_qty_jun);
		$sheet->setCellValue('BD' . $row, $sub_target_val_jun);
		$sheet->setCellValue('BE' . $row, $sub_idx_qty_jun);
		$sheet->setCellValue('BF' . $row, $sub_idx_val_jun);
		$sheet->setCellValue('BG' . $row, $sub_stok_qty_jun);
		$sheet->setCellValue('BH' . $row, $sub_stok_val_jun);
		$sheet->setCellValue('BI' . $row, $sub_qty_q2);
		$sheet->setCellValue('BJ' . $row, $sub_val_q2);
		$sheet->setCellValue('BK' . $row, $sub_target_qty_q2);
		$sheet->setCellValue('BL' . $row, $sub_target_val_q2);
		$sheet->setCellValue('BM' . $row, $sub_idx_qty_q2);
		$sheet->setCellValue('BN' . $row, $sub_idx_val_q2);

		$sheet->setCellValue('BO' . $row, $sub_qty_jul);
		$sheet->setCellValue('BP' . $row, $sub_val_jul);
		$sheet->setCellValue('BQ' . $row, $sub_target_qty_jul);
		$sheet->setCellValue('BR' . $row, $sub_target_val_jul);
		$sheet->setCellValue('BS' . $row, $sub_idx_qty_jul);
		$sheet->setCellValue('BT' . $row, $sub_idx_val_jul);
		$sheet->setCellValue('BU' . $row, $sub_stok_qty_jul);
		$sheet->setCellValue('BV' . $row, $sub_stok_val_jul);
		$sheet->setCellValue('BW' . $row, $sub_qty_agu);
		$sheet->setCellValue('BX' . $row, $sub_val_agu);
		$sheet->setCellValue('BY' . $row, $sub_target_qty_agu);
		$sheet->setCellValue('BZ' . $row, $sub_target_val_agu);
		$sheet->setCellValue('CA' . $row, $sub_idx_qty_agu);
		$sheet->setCellValue('CB' . $row, $sub_idx_val_agu);
		$sheet->setCellValue('CC' . $row, $sub_stok_qty_agu);
		$sheet->setCellValue('CD' . $row, $sub_stok_val_agu);
		$sheet->setCellValue('CE' . $row, $sub_qty_sep);
		$sheet->setCellValue('CF' . $row, $sub_val_sep);
		$sheet->setCellValue('CG' . $row, $sub_target_qty_sep);
		$sheet->setCellValue('CH' . $row, $sub_target_val_sep);
		$sheet->setCellValue('CI' . $row, $sub_idx_qty_sep);
		$sheet->setCellValue('CJ' . $row, $sub_idx_val_sep);
		$sheet->setCellValue('CK' . $row, $sub_stok_qty_sep);
		$sheet->setCellValue('CL' . $row, $sub_stok_val_sep);
		$sheet->setCellValue('CM' . $row, $sub_qty_q3);
		$sheet->setCellValue('CN' . $row, $sub_val_q3);
		$sheet->setCellValue('CO' . $row, $sub_target_qty_q3);
		$sheet->setCellValue('CP' . $row, $sub_target_val_q3);
		$sheet->setCellValue('CQ' . $row, $sub_idx_qty_q3);
		$sheet->setCellValue('CR' . $row, $sub_idx_val_q3);

		$sheet->setCellValue('CS' . $row, $sub_qty_okt);
		$sheet->setCellValue('CT' . $row, $sub_val_okt);
		$sheet->setCellValue('CU' . $row, $sub_target_qty_okt);
		$sheet->setCellValue('CV' . $row, $sub_target_val_okt);
		$sheet->setCellValue('CW' . $row, $sub_idx_qty_okt);
		$sheet->setCellValue('CX' . $row, $sub_idx_val_okt);
		$sheet->setCellValue('CY' . $row, $sub_stok_qty_okt);
		$sheet->setCellValue('CZ' . $row, $sub_stok_val_okt);
		$sheet->setCellValue('DA' . $row, $sub_qty_nop);
		$sheet->setCellValue('DB' . $row, $sub_val_nop);
		$sheet->setCellValue('DC' . $row, $sub_target_qty_nop);
		$sheet->setCellValue('DD' . $row, $sub_target_val_nop);
		$sheet->setCellValue('DE' . $row, $sub_idx_qty_nop);
		$sheet->setCellValue('DF' . $row, $sub_idx_val_nop);
		$sheet->setCellValue('DG' . $row, $sub_stok_qty_nop);
		$sheet->setCellValue('DH' . $row, $sub_stok_val_nop);
		$sheet->setCellValue('DI' . $row, $sub_qty_des);
		$sheet->setCellValue('DJ' . $row, $sub_val_des);
		$sheet->setCellValue('DK' . $row, $sub_target_qty_des);
		$sheet->setCellValue('DL' . $row, $sub_target_val_des);
		$sheet->setCellValue('DM' . $row, $sub_idx_qty_des);
		$sheet->setCellValue('DN' . $row, $sub_idx_val_des);
		$sheet->setCellValue('DO' . $row, $sub_stok_qty_des);
		$sheet->setCellValue('DP' . $row, $sub_stok_val_des);
		$sheet->setCellValue('DQ' . $row, $sub_qty_q4);
		$sheet->setCellValue('DR' . $row, $sub_val_q4);
		$sheet->setCellValue('DS' . $row, $sub_target_qty_q4);
		$sheet->setCellValue('DT' . $row, $sub_target_val_q4);
		$sheet->setCellValue('DU' . $row, $sub_idx_qty_q4);
		$sheet->setCellValue('DV' . $row, $sub_idx_val_q4);

		$sub_qty_year = $sub_qty_jan + $sub_qty_feb + $sub_qty_mar + $sub_qty_apr + $sub_qty_mei + $sub_qty_jun + $sub_qty_jul + $sub_qty_agu + $sub_qty_sep + $sub_qty_okt + $sub_qty_nop + $sub_qty_des;
		$sub_target_qty_year = $sub_target_qty_jan + $sub_target_qty_feb + $sub_target_qty_mar + $sub_target_qty_apr + $sub_target_qty_mei + $sub_target_qty_jun + $sub_target_qty_jul + $sub_target_qty_agu + $sub_target_qty_sep + $sub_target_qty_okt + $sub_target_qty_nop + $sub_target_qty_des;
		$sub_idx_qty_year = ($sub_qty_year/($sub_target_qty_year ?: 1))*100;
		$sub_val_year = $sub_val_jan + $sub_val_feb + $sub_val_mar + $sub_val_apr + $sub_val_mei + $sub_val_jun + $sub_val_jul + $sub_val_agu + $sub_val_sep + $sub_val_okt + $sub_val_nop + $sub_val_des;
		$sub_target_val_year = $sub_target_val_jan + $sub_target_val_feb + $sub_target_val_mar + $sub_target_val_apr + $sub_target_val_mei + $sub_target_val_jun + $sub_target_val_jul + $sub_target_val_agu + $sub_target_val_sep + $sub_target_val_okt + $sub_target_val_nop + $sub_target_val_des;
		$sub_idx_val_year = ($sub_val_year/($sub_target_val_year ?: 1))*100;
		$sub_qty_avg = $sub_qty_year / 12;
		$sub_target_qty_avg = $sub_target_qty_year / 12;
		$sub_idx_qty_avg = ($sub_qty_avg/($sub_target_qty_avg ?: 1))*100;
		$sub_val_avg = $sub_val_year / 12;
		$sub_target_val_avg = $sub_target_val_year / 12;
		$sub_idx_val_avg = ($sub_val_avg/($sub_target_val_avg ?: 1))*100;

		$sheet->setCellValue('DW' . $row, $sub_qty_year);
		$sheet->setCellValue('DX' . $row, $sub_val_year);
		$sheet->setCellValue('DY' . $row, $sub_target_qty_year);
		$sheet->setCellValue('DZ' . $row, $sub_target_val_year);
		$sheet->setCellValue('EA' . $row, $sub_idx_qty_year);
		$sheet->setCellValue('EB' . $row, $sub_idx_val_year);
		$sheet->setCellValue('EC' . $row, $sub_qty_avg);
		$sheet->setCellValue('ED' . $row, $sub_val_avg);
		$sheet->setCellValue('EE' . $row, $sub_target_qty_avg);
		$sheet->setCellValue('EF' . $row, $sub_target_val_avg);
		$sheet->setCellValue('EG' . $row, $sub_idx_qty_avg);
		$sheet->setCellValue('EH' . $row, $sub_idx_val_avg);

		// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
		$sheet->getStyle('A' . $row)->applyFromArray($style_row);
		$sheet->getStyle('B' . $row)->applyFromArray($style_row);
		$sheet->getStyle('C' . $row)->applyFromArray($style_row);
		$sheet->getStyle('D' . $row)->applyFromArray($style_row);
		$sheet->getStyle('E' . $row)->applyFromArray($style_row);
		$sheet->getStyle('F' . $row)->applyFromArray($style_row);
		$sheet->getStyle('G' . $row)->applyFromArray($style_row);
		$sheet->getStyle('H' . $row)->applyFromArray($style_row);
		$sheet->getStyle('I' . $row)->applyFromArray($style_row);
		$sheet->getStyle('J' . $row)->applyFromArray($style_row);
		$sheet->getStyle('K' . $row)->applyFromArray($style_row);
		$sheet->getStyle('L' . $row)->applyFromArray($style_row);
		$sheet->getStyle('M' . $row)->applyFromArray($style_row);
		$sheet->getStyle('N' . $row)->applyFromArray($style_row);
		$sheet->getStyle('O' . $row)->applyFromArray($style_row);
		$sheet->getStyle('P' . $row)->applyFromArray($style_row);
		$sheet->getStyle('Q' . $row)->applyFromArray($style_row);
		$sheet->getStyle('R' . $row)->applyFromArray($style_row);
		$sheet->getStyle('S' . $row)->applyFromArray($style_row);
		$sheet->getStyle('T' . $row)->applyFromArray($style_row);
		$sheet->getStyle('U' . $row)->applyFromArray($style_row);
		$sheet->getStyle('V' . $row)->applyFromArray($style_row);
		$sheet->getStyle('W' . $row)->applyFromArray($style_row);
		$sheet->getStyle('X' . $row)->applyFromArray($style_row);
		$sheet->getStyle('Y' . $row)->applyFromArray($style_row);
		$sheet->getStyle('Z' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AA' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AB' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AC' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AD' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AE' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AF' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AG' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AH' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AI' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AJ' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AK' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AL' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AM' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AN' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AO' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AP' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AQ' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AR' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AS' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AT' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AU' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AV' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AW' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AX' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AY' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AZ' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BA' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BB' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BC' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BD' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BE' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BF' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BG' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BH' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BI' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BJ' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BK' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BL' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BM' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BN' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BO' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BP' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BQ' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BR' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BS' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BT' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BU' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BV' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BW' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BX' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BY' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BZ' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CA' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CB' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CC' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CD' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CE' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CF' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CG' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CH' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CI' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CJ' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CK' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CL' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CM' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CN' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CO' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CP' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CQ' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CR' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CS' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CT' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CU' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CV' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CW' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CX' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CY' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CZ' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DA' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DB' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DC' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DD' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DE' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DF' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DG' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DH' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DI' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DJ' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DK' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DL' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DM' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DN' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DO' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DP' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DQ' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DR' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DS' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DT' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DU' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DV' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DW' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DX' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DY' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DZ' . $row)->applyFromArray($style_row);
		$sheet->getStyle('EA' . $row)->applyFromArray($style_row);
		$sheet->getStyle('EB' . $row)->applyFromArray($style_row);
		$sheet->getStyle('EC' . $row)->applyFromArray($style_row);
		$sheet->getStyle('ED' . $row)->applyFromArray($style_row);
		$sheet->getStyle('EE' . $row)->applyFromArray($style_row);
		$sheet->getStyle('EF' . $row)->applyFromArray($style_row);
		$sheet->getStyle('EG' . $row)->applyFromArray($style_row);
		$sheet->getStyle('EH' . $row)->applyFromArray($style_row);


		$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('I' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('J' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('K' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('L' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('M' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('N' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('O' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('P' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('Q' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('R' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('S' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('T' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('U' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('V' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('W' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('X' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('Y' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('Z' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AA' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AB' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AC' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AD' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AE' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AF' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AG' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AH' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AI' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AJ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AK' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AL' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AM' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AN' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AO' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AP' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AQ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AR' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AS' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AT' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AU' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AV' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AX' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AY' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AZ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BA' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BB' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BC' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BD' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BE' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BF' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BG' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BH' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BI' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BJ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BK' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BL' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BM' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BN' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BO' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BQ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BR' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BS' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BT' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BU' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BV' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BW' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BX' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BY' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BZ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CA' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CB' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CC' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CD' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CE' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CF' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CG' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CH' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CI' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CJ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CK' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CL' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CM' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CN' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CO' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CP' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CQ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CR' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CS' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CT' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CU' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CV' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CW' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CX' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CY' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CZ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DA' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DB' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DC' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DD' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DE' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DF' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DG' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DH' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DI' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DJ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DK' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DL' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DM' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DN' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DO' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DP' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DQ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DR' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DS' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DT' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DU' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DV' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DW' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DX' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DY' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DZ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('EA' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('EB' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('EC' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('ED' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('EE' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('EF' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('EG' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('EH' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

		$sheet->getStyle('G' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('H' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('I' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('J' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('K' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('L' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('M' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('N' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('O' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('P' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('Q' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('R' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('S' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('T' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('U' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('V' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('W' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('X' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('Y' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('Z' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('AA' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('AB' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('AC' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AD' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('AE' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AF' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('AG' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AH' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('AI' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('AJ' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('AK' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AL' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('AM' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AN' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('AO' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('AP' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('AQ' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AR' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('AS' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AT' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('AU' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AV' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('AW' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('AX' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('AY' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AZ' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('AB' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('BB' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('BC' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('BD' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('BE' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('BF' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('BG' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('BH' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('BI' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('BJ' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('BK' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('BL' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('BM' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('BN' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('BO' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('BP' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('BQ' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('BR' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('BS' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('BT' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('BU' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('BV' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('BW' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('BX' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('BY' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('BZ' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('CA' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('CB' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('CC' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('CD' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('CE' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('CF' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('CG' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('CH' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('CI' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('CJ' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('CK' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('CL' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('CM' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('CN' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('CO' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('CP' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('CQ' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('CR' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('CS' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('CT' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('CU' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('CV' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('CW' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('CX' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('CY' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('CZ' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('DA' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('DB' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('DC' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('DD' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('DE' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('DF' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('DG' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('DH' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('DI' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('DJ' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('DK' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('DL' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('DM' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('DN' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('DO' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('DP' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('DQ' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('DR' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('DS' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('DT' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('DU' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('DW' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('DW' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('DX' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('DY' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('DZ' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('EA' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('EB' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('EC' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('ED' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('EE' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('EF' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('EG' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('EH' . $row)->getNumberFormat()->setFormatCode('#.00');

		$sheet->getStyle('A' . $row . ':EH' . $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFA07A');
		$sheet->getStyle('A' . $row . ':EH' . $row)->getFont()->setBold(true);

		//grand total
		$row = $row + 1;
		$sheet->setCellValue('A' . $row, '');
		$sheet->setCellValue('B' . $row, '');
		$sheet->setCellValue('C' . $row, '');
		$sheet->setCellValue('D' . $row, '');
		$sheet->setCellValue('E' . $row, 'GRAND TOTAL');
		$sheet->setCellValue('F' . $row, '');
		$sheet->setCellValue('G' . $row, $total_qty_jan);
		$sheet->setCellValue('H' . $row, $total_val_jan);
		$sheet->setCellValue('I' . $row, $total_target_qty_jan);
		$sheet->setCellValue('J' . $row, $total_target_val_jan);
		$sheet->setCellValue('K' . $row, $total_idx_qty_jan);
		$sheet->setCellValue('L' . $row, $total_idx_val_jan);
		$sheet->setCellValue('M' . $row, $total_stok_qty_jan);
		$sheet->setCellValue('N' . $row, $total_stok_val_jan);
		$sheet->setCellValue('O' . $row, $total_qty_feb);
		$sheet->setCellValue('P' . $row, $total_val_feb);
		$sheet->setCellValue('Q' . $row, $total_target_qty_feb);
		$sheet->setCellValue('R' . $row, $total_target_val_feb);
		$sheet->setCellValue('S' . $row, $total_idx_qty_feb);
		$sheet->setCellValue('T' . $row, $total_idx_val_feb);
		$sheet->setCellValue('U' . $row, $total_stok_qty_feb);
		$sheet->setCellValue('V' . $row, $total_stok_val_feb);
		$sheet->setCellValue('W' . $row, $total_qty_mar);
		$sheet->setCellValue('X' . $row, $total_val_mar);
		$sheet->setCellValue('Y' . $row, $total_target_qty_mar);
		$sheet->setCellValue('Z' . $row, $total_target_val_mar);
		$sheet->setCellValue('AA' . $row, $total_idx_qty_mar);
		$sheet->setCellValue('AB' . $row, $total_idx_val_mar);
		$sheet->setCellValue('AC' . $row, $total_stok_qty_mar);
		$sheet->setCellValue('AD' . $row, $total_stok_val_mar);
		$sheet->setCellValue('AE' . $row, $total_qty_q1);
		$sheet->setCellValue('AF' . $row, $total_val_q1);
		$sheet->setCellValue('AG' . $row, $total_target_qty_q1);
		$sheet->setCellValue('AH' . $row, $total_target_val_q1);
		$sheet->setCellValue('AI' . $row, $total_idx_qty_q1);
		$sheet->setCellValue('AJ' . $row, $total_idx_val_q1);

		$sheet->setCellValue('AK' . $row, $total_qty_apr);
		$sheet->setCellValue('AL' . $row, $total_val_apr);
		$sheet->setCellValue('AM' . $row, $total_target_qty_apr);
		$sheet->setCellValue('AN' . $row, $total_target_val_apr);
		$sheet->setCellValue('AO' . $row, $total_idx_qty_apr);
		$sheet->setCellValue('AP' . $row, $total_idx_val_apr);
		$sheet->setCellValue('AQ' . $row, $total_stok_qty_apr);
		$sheet->setCellValue('AR' . $row, $total_stok_val_apr);
		$sheet->setCellValue('AS' . $row, $total_qty_mei);
		$sheet->setCellValue('AT' . $row, $total_val_mei);
		$sheet->setCellValue('AU' . $row, $total_target_qty_mei);
		$sheet->setCellValue('AV' . $row, $total_target_val_mei);
		$sheet->setCellValue('AW' . $row, $total_idx_qty_mei);
		$sheet->setCellValue('AX' . $row, $total_idx_val_mei);
		$sheet->setCellValue('AY' . $row, $total_stok_qty_mei);
		$sheet->setCellValue('AZ' . $row, $total_stok_val_mei);
		$sheet->setCellValue('BA' . $row, $total_qty_jun);
		$sheet->setCellValue('BB' . $row, $total_val_jun);
		$sheet->setCellValue('BC' . $row, $total_target_qty_jun);
		$sheet->setCellValue('BD' . $row, $total_target_val_jun);
		$sheet->setCellValue('BE' . $row, $total_idx_qty_jun);
		$sheet->setCellValue('BF' . $row, $total_idx_val_jun);
		$sheet->setCellValue('BG' . $row, $total_stok_qty_jun);
		$sheet->setCellValue('BH' . $row, $total_stok_val_jun);
		$sheet->setCellValue('BI' . $row, $total_qty_q2);
		$sheet->setCellValue('BJ' . $row, $total_val_q2);
		$sheet->setCellValue('BK' . $row, $total_target_qty_q2);
		$sheet->setCellValue('BL' . $row, $total_target_val_q2);
		$sheet->setCellValue('BM' . $row, $total_idx_qty_q2);
		$sheet->setCellValue('BN' . $row, $total_idx_val_q2);

		$sheet->setCellValue('BO' . $row, $total_qty_jul);
		$sheet->setCellValue('BP' . $row, $total_val_jul);
		$sheet->setCellValue('BQ' . $row, $total_target_qty_jul);
		$sheet->setCellValue('BR' . $row, $total_target_val_jul);
		$sheet->setCellValue('BS' . $row, $total_idx_qty_jul);
		$sheet->setCellValue('BT' . $row, $total_idx_val_jul);
		$sheet->setCellValue('BU' . $row, $total_stok_qty_jul);
		$sheet->setCellValue('BV' . $row, $total_stok_val_jul);
		$sheet->setCellValue('BW' . $row, $total_qty_agu);
		$sheet->setCellValue('BX' . $row, $total_val_agu);
		$sheet->setCellValue('BY' . $row, $total_target_qty_agu);
		$sheet->setCellValue('BZ' . $row, $total_target_val_agu);
		$sheet->setCellValue('CA' . $row, $total_idx_qty_agu);
		$sheet->setCellValue('CB' . $row, $total_idx_val_agu);
		$sheet->setCellValue('CC' . $row, $total_stok_qty_agu);
		$sheet->setCellValue('CD' . $row, $total_stok_val_agu);
		$sheet->setCellValue('CE' . $row, $total_qty_sep);
		$sheet->setCellValue('CF' . $row, $total_val_sep);
		$sheet->setCellValue('CG' . $row, $total_target_qty_sep);
		$sheet->setCellValue('CH' . $row, $total_target_val_sep);
		$sheet->setCellValue('CI' . $row, $total_idx_qty_sep);
		$sheet->setCellValue('CJ' . $row, $total_idx_val_sep);
		$sheet->setCellValue('CK' . $row, $total_stok_qty_sep);
		$sheet->setCellValue('CL' . $row, $total_stok_val_sep);
		$sheet->setCellValue('CM' . $row, $total_qty_q3);
		$sheet->setCellValue('CN' . $row, $total_val_q3);
		$sheet->setCellValue('CO' . $row, $total_target_qty_q3);
		$sheet->setCellValue('CP' . $row, $total_target_val_q3);
		$sheet->setCellValue('CQ' . $row, $total_idx_qty_q3);
		$sheet->setCellValue('CR' . $row, $total_idx_val_q3);

		$sheet->setCellValue('CS' . $row, $total_qty_okt);
		$sheet->setCellValue('CT' . $row, $total_val_okt);
		$sheet->setCellValue('CU' . $row, $total_target_qty_okt);
		$sheet->setCellValue('CV' . $row, $total_target_val_okt);
		$sheet->setCellValue('CW' . $row, $total_idx_qty_okt);
		$sheet->setCellValue('CX' . $row, $total_idx_val_okt);
		$sheet->setCellValue('CY' . $row, $total_stok_qty_okt);
		$sheet->setCellValue('CZ' . $row, $total_stok_val_okt);
		$sheet->setCellValue('DA' . $row, $total_qty_nop);
		$sheet->setCellValue('DB' . $row, $total_val_nop);
		$sheet->setCellValue('DC' . $row, $total_target_qty_nop);
		$sheet->setCellValue('DD' . $row, $total_target_val_nop);
		$sheet->setCellValue('DE' . $row, $total_idx_qty_nop);
		$sheet->setCellValue('DF' . $row, $total_idx_val_nop);
		$sheet->setCellValue('DG' . $row, $total_stok_qty_nop);
		$sheet->setCellValue('DH' . $row, $total_stok_val_nop);
		$sheet->setCellValue('DI' . $row, $total_qty_des);
		$sheet->setCellValue('DJ' . $row, $total_val_des);
		$sheet->setCellValue('DK' . $row, $total_target_qty_des);
		$sheet->setCellValue('DL' . $row, $total_target_val_des);
		$sheet->setCellValue('DM' . $row, $total_idx_qty_des);
		$sheet->setCellValue('DN' . $row, $total_idx_val_des);
		$sheet->setCellValue('DO' . $row, $total_stok_qty_des);
		$sheet->setCellValue('DP' . $row, $total_stok_val_des);
		$sheet->setCellValue('DQ' . $row, $total_qty_q4);
		$sheet->setCellValue('DR' . $row, $total_val_q4);
		$sheet->setCellValue('DS' . $row, $total_target_qty_q4);
		$sheet->setCellValue('DT' . $row, $total_target_val_q4);
		$sheet->setCellValue('DU' . $row, $total_idx_qty_q4);
		$sheet->setCellValue('DV' . $row, $total_idx_val_q4);

		$total_qty_year = $total_qty_jan + $total_qty_feb + $total_qty_mar + $total_qty_apr + $total_qty_mei + $total_qty_jun + $total_qty_jul + $total_qty_agu + $total_qty_sep + $total_qty_okt + $total_qty_nop + $total_qty_des;
		$total_target_qty_year = $total_target_qty_jan + $total_target_qty_feb + $total_target_qty_mar + $total_target_qty_apr + $total_target_qty_mei + $total_target_qty_jun + $total_target_qty_jul + $total_target_qty_agu + $total_target_qty_sep + $total_target_qty_okt + $total_target_qty_nop + $total_target_qty_des;
		$total_idx_qty_year = ($total_qty_year/($total_target_qty_year ?: 1))*100;
		$total_val_year = $total_val_jan + $total_val_feb + $total_val_mar + $total_val_apr + $total_val_mei + $total_val_jun + $total_val_jul + $total_val_agu + $total_val_sep + $total_val_okt + $total_val_nop + $total_val_des;
		$total_target_val_year = $total_target_val_jan + $total_target_val_feb + $total_target_val_mar + $total_target_val_apr + $total_target_val_mei + $total_target_val_jun + $total_target_val_jul + $total_target_val_agu + $total_target_val_sep + $total_target_val_okt + $total_target_val_nop + $total_target_val_des;
		$total_idx_val_year = ($total_val_year/($total_target_val_year ?: 1))*100;
		$total_qty_avg = $total_qty_year / 12;
		$total_target_qty_avg = $total_target_qty_year / 12;
		$total_idx_qty_avg = ($total_qty_avg/($total_target_qty_avg ?: 1))*100;
		$total_val_avg = $total_val_year / 12;
		$total_target_val_avg = $total_target_val_year / 12;
		$total_idx_val_avg = ($total_val_avg/($total_target_val_avg ?: 1))*100;

		$sheet->setCellValue('DW' . $row, $total_qty_year);
		$sheet->setCellValue('DX' . $row, $total_val_year);
		$sheet->setCellValue('DY' . $row, $total_target_qty_year);
		$sheet->setCellValue('DZ' . $row, $total_target_val_year);
		$sheet->setCellValue('EA' . $row, $total_idx_qty_year);
		$sheet->setCellValue('EB' . $row, $total_idx_val_year);
		$sheet->setCellValue('EC' . $row, $total_qty_avg);
		$sheet->setCellValue('ED' . $row, $total_val_avg);
		$sheet->setCellValue('EE' . $row, $total_target_qty_avg);
		$sheet->setCellValue('EF' . $row, $total_target_val_avg);
		$sheet->setCellValue('EG' . $row, $total_idx_qty_avg);
		$sheet->setCellValue('EH' . $row, $total_idx_val_avg);

		// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
		$sheet->getStyle('A' . $row)->applyFromArray($style_row);
		$sheet->getStyle('B' . $row)->applyFromArray($style_row);
		$sheet->getStyle('C' . $row)->applyFromArray($style_row);
		$sheet->getStyle('D' . $row)->applyFromArray($style_row);
		$sheet->getStyle('E' . $row)->applyFromArray($style_row);
		$sheet->getStyle('F' . $row)->applyFromArray($style_row);
		$sheet->getStyle('G' . $row)->applyFromArray($style_row);
		$sheet->getStyle('H' . $row)->applyFromArray($style_row);
		$sheet->getStyle('I' . $row)->applyFromArray($style_row);
		$sheet->getStyle('J' . $row)->applyFromArray($style_row);
		$sheet->getStyle('K' . $row)->applyFromArray($style_row);
		$sheet->getStyle('L' . $row)->applyFromArray($style_row);
		$sheet->getStyle('M' . $row)->applyFromArray($style_row);
		$sheet->getStyle('N' . $row)->applyFromArray($style_row);
		$sheet->getStyle('O' . $row)->applyFromArray($style_row);
		$sheet->getStyle('P' . $row)->applyFromArray($style_row);
		$sheet->getStyle('Q' . $row)->applyFromArray($style_row);
		$sheet->getStyle('R' . $row)->applyFromArray($style_row);
		$sheet->getStyle('S' . $row)->applyFromArray($style_row);
		$sheet->getStyle('T' . $row)->applyFromArray($style_row);
		$sheet->getStyle('U' . $row)->applyFromArray($style_row);
		$sheet->getStyle('V' . $row)->applyFromArray($style_row);
		$sheet->getStyle('W' . $row)->applyFromArray($style_row);
		$sheet->getStyle('X' . $row)->applyFromArray($style_row);
		$sheet->getStyle('Y' . $row)->applyFromArray($style_row);
		$sheet->getStyle('Z' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AA' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AB' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AC' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AD' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AE' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AF' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AG' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AH' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AI' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AJ' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AK' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AL' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AM' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AN' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AO' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AP' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AQ' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AR' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AS' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AT' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AU' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AV' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AW' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AX' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AY' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AZ' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BA' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BB' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BC' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BD' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BE' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BF' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BG' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BH' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BI' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BJ' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BK' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BL' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BM' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BN' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BO' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BP' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BQ' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BR' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BS' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BT' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BU' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BV' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BW' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BX' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BY' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BZ' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CA' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CB' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CC' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CD' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CE' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CF' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CG' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CH' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CI' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CJ' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CK' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CL' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CM' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CN' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CO' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CP' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CQ' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CR' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CS' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CT' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CU' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CV' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CW' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CX' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CY' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CZ' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DA' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DB' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DC' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DD' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DE' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DF' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DG' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DH' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DI' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DJ' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DK' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DL' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DM' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DN' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DO' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DP' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DQ' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DR' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DS' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DT' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DU' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DV' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DW' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DX' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DY' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DZ' . $row)->applyFromArray($style_row);
		$sheet->getStyle('EA' . $row)->applyFromArray($style_row);
		$sheet->getStyle('EB' . $row)->applyFromArray($style_row);
		$sheet->getStyle('EC' . $row)->applyFromArray($style_row);
		$sheet->getStyle('ED' . $row)->applyFromArray($style_row);
		$sheet->getStyle('EE' . $row)->applyFromArray($style_row);
		$sheet->getStyle('EF' . $row)->applyFromArray($style_row);
		$sheet->getStyle('EG' . $row)->applyFromArray($style_row);
		$sheet->getStyle('EH' . $row)->applyFromArray($style_row);


		$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('I' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('J' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('K' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('L' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('M' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('N' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('O' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('P' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('Q' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('R' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('S' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('T' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('U' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('V' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('W' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('X' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('Y' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('Z' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AA' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AB' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AC' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AD' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AE' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AF' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AG' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AH' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AI' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AJ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AK' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AL' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AM' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AN' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AO' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AP' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AQ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AR' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AS' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AT' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AU' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AV' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AX' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AY' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AZ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BA' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BB' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BC' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BD' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BE' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BF' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BG' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BH' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BI' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BJ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BK' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BL' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BM' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BN' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BO' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BQ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BR' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BS' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BT' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BU' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BV' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BW' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BX' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BY' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BZ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CA' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CB' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CC' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CD' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CE' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CF' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CG' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CH' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CI' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CJ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CK' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CL' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CM' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CN' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CO' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CP' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CQ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CR' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CS' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CT' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CU' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CV' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CW' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CX' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CY' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CZ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DA' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DB' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DC' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DD' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DE' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DF' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DG' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DH' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DI' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DJ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DK' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DL' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DM' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DN' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DO' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DP' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DQ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DR' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DS' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DT' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DU' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DV' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DW' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DX' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DY' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DZ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('EA' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('EB' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('EC' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('ED' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('EE' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('EF' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('EG' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('EH' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

		$sheet->getStyle('G' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('H' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('I' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('J' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('K' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('L' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('M' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('N' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('O' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('P' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('Q' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('R' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('S' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('T' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('U' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('V' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('W' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('X' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('Y' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('Z' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('AA' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('AB' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('AC' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AD' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('AE' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AF' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('AG' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AH' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('AI' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('AJ' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('AK' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AL' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('AM' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AN' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('AO' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('AP' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('AQ' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AR' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('AS' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AT' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('AU' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AV' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('AW' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('AX' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('AY' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AZ' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('AB' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('BB' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('BC' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('BD' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('BE' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('BF' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('BG' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('BH' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('BI' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('BJ' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('BK' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('BL' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('BM' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('BN' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('BO' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('BP' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('BQ' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('BR' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('BS' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('BT' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('BU' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('BV' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('BW' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('BX' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('BY' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('BZ' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('CA' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('CB' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('CC' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('CD' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('CE' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('CF' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('CG' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('CH' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('CI' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('CJ' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('CK' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('CL' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('CM' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('CN' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('CO' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('CP' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('CQ' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('CR' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('CS' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('CT' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('CU' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('CV' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('CW' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('CX' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('CY' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('CZ' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('DA' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('DB' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('DC' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('DD' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('DE' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('DF' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('DG' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('DH' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('DI' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('DJ' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('DK' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('DL' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('DM' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('DN' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('DO' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('DP' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('DQ' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('DR' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('DS' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('DT' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('DU' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('DW' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('DW' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('DX' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('DY' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('DZ' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('EA' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('EB' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('EC' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('ED' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('EE' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('EF' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('EG' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('EH' . $row)->getNumberFormat()->setFormatCode('#.00');

		$sheet->getStyle('A' . $row . ':EH' . $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFA07A');
		$sheet->getStyle('A' . $row . ':EH' . $row)->getFont()->setBold(true);


		//set columns width
		$sheet->getColumnDimension('A')->setWidth(5); 
		$sheet->getColumnDimension('B')->setWidth(11); 
		$sheet->getColumnDimension('C')->setWidth(22);
		$sheet->getColumnDimension('D')->setWidth(12);
		$sheet->getColumnDimension('E')->setWidth(53);
		$sheet->getColumnDimension('F')->setWidth(6);
		$sheet->getColumnDimension('G')->setWidth(10);
		$sheet->getColumnDimension('H')->setWidth(16);
		$sheet->getColumnDimension('I')->setWidth(10);
		$sheet->getColumnDimension('J')->setWidth(16);
		$sheet->getColumnDimension('K')->setWidth(8);//Index(%)
		$sheet->getColumnDimension('L')->setWidth(8);//Index(%)
		$sheet->getColumnDimension('M')->setWidth(10);
		$sheet->getColumnDimension('N')->setWidth(16);
		$sheet->getColumnDimension('O')->setWidth(10);
		$sheet->getColumnDimension('P')->setWidth(16);
		$sheet->getColumnDimension('Q')->setWidth(10);
		$sheet->getColumnDimension('R')->setWidth(16);
		$sheet->getColumnDimension('S')->setWidth(8);//Index(%)
		$sheet->getColumnDimension('T')->setWidth(8);//Index(%)
		$sheet->getColumnDimension('U')->setWidth(10);
		$sheet->getColumnDimension('V')->setWidth(16);
		$sheet->getColumnDimension('W')->setWidth(10);
		$sheet->getColumnDimension('X')->setWidth(16);
		$sheet->getColumnDimension('Y')->setWidth(10);
		$sheet->getColumnDimension('Z')->setWidth(16);
		$sheet->getColumnDimension('AA')->setWidth(8);//Index(%)
		$sheet->getColumnDimension('AB')->setWidth(8);//Index(%)
		$sheet->getColumnDimension('AC')->setWidth(10);
		$sheet->getColumnDimension('AD')->setWidth(16);
		$sheet->getColumnDimension('AE')->setWidth(10);
		$sheet->getColumnDimension('AF')->setWidth(16);
		$sheet->getColumnDimension('AG')->setWidth(10);
		$sheet->getColumnDimension('AH')->setWidth(16);
		$sheet->getColumnDimension('AI')->setWidth(8);//Index(%)
		$sheet->getColumnDimension('AJ')->setWidth(8);//Index(%)
		$sheet->getColumnDimension('AK')->setWidth(10);
		$sheet->getColumnDimension('AL')->setWidth(16);
		$sheet->getColumnDimension('AM')->setWidth(10);
		$sheet->getColumnDimension('AN')->setWidth(16);
		$sheet->getColumnDimension('AO')->setWidth(8);//Index(%)
		$sheet->getColumnDimension('AP')->setWidth(8);//Index(%)
		$sheet->getColumnDimension('AQ')->setWidth(10);
		$sheet->getColumnDimension('AR')->setWidth(16);
		$sheet->getColumnDimension('AS')->setWidth(10);
		$sheet->getColumnDimension('AT')->setWidth(16);
		$sheet->getColumnDimension('AU')->setWidth(10);
		$sheet->getColumnDimension('AV')->setWidth(16);
		$sheet->getColumnDimension('AW')->setWidth(8);//Index(%)
		$sheet->getColumnDimension('AX')->setWidth(8);//Index(%)
		$sheet->getColumnDimension('AY')->setWidth(10);
		$sheet->getColumnDimension('AZ')->setWidth(16);
		$sheet->getColumnDimension('BA')->setWidth(10);
		$sheet->getColumnDimension('BB')->setWidth(16);
		$sheet->getColumnDimension('BC')->setWidth(10);
		$sheet->getColumnDimension('BD')->setWidth(16);
		$sheet->getColumnDimension('BE')->setWidth(8);//Index(%)
		$sheet->getColumnDimension('BF')->setWidth(8);//Index(%)
		$sheet->getColumnDimension('BG')->setWidth(10);
		$sheet->getColumnDimension('BH')->setWidth(16);
		$sheet->getColumnDimension('BI')->setWidth(10);
		$sheet->getColumnDimension('BJ')->setWidth(16);
		$sheet->getColumnDimension('BK')->setWidth(10);
		$sheet->getColumnDimension('BL')->setWidth(16);
		$sheet->getColumnDimension('BM')->setWidth(8);//Index(%)
		$sheet->getColumnDimension('BN')->setWidth(8);//Index(%)
		$sheet->getColumnDimension('BO')->setWidth(10);
		$sheet->getColumnDimension('BP')->setWidth(16);
		$sheet->getColumnDimension('BQ')->setWidth(10);
		$sheet->getColumnDimension('BR')->setWidth(16);
		$sheet->getColumnDimension('BS')->setWidth(8);//Index(%)
		$sheet->getColumnDimension('BT')->setWidth(8);//Index(%)
		$sheet->getColumnDimension('BU')->setWidth(10);
		$sheet->getColumnDimension('BV')->setWidth(16);
		$sheet->getColumnDimension('BW')->setWidth(10);
		$sheet->getColumnDimension('BX')->setWidth(16);
		$sheet->getColumnDimension('BY')->setWidth(10);
		$sheet->getColumnDimension('BZ')->setWidth(16);
		$sheet->getColumnDimension('CA')->setWidth(8);//Index(%)
		$sheet->getColumnDimension('CB')->setWidth(8);//Index(%)
		$sheet->getColumnDimension('CC')->setWidth(10);
		$sheet->getColumnDimension('CD')->setWidth(16);
		$sheet->getColumnDimension('CE')->setWidth(10);
		$sheet->getColumnDimension('CF')->setWidth(16);
		$sheet->getColumnDimension('CG')->setWidth(10);
		$sheet->getColumnDimension('CH')->setWidth(16);
		$sheet->getColumnDimension('CI')->setWidth(8);//Index(%)
		$sheet->getColumnDimension('CJ')->setWidth(8);//Index(%)
		$sheet->getColumnDimension('CK')->setWidth(10);
		$sheet->getColumnDimension('CL')->setWidth(16);
		$sheet->getColumnDimension('CM')->setWidth(10);
		$sheet->getColumnDimension('CN')->setWidth(16);
		$sheet->getColumnDimension('CO')->setWidth(10);
		$sheet->getColumnDimension('CP')->setWidth(16);
		$sheet->getColumnDimension('CQ')->setWidth(8);//Index(%)
		$sheet->getColumnDimension('CR')->setWidth(8);//Index(%)
		$sheet->getColumnDimension('CS')->setWidth(10);
		$sheet->getColumnDimension('CT')->setWidth(16);
		$sheet->getColumnDimension('CU')->setWidth(10);
		$sheet->getColumnDimension('CV')->setWidth(16);
		$sheet->getColumnDimension('CW')->setWidth(8);//Index(%)
		$sheet->getColumnDimension('CX')->setWidth(8);//Index(%)
		$sheet->getColumnDimension('CY')->setWidth(10);
		$sheet->getColumnDimension('CZ')->setWidth(16);
		$sheet->getColumnDimension('DA')->setWidth(10);
		$sheet->getColumnDimension('DB')->setWidth(16);
		$sheet->getColumnDimension('DC')->setWidth(10);
		$sheet->getColumnDimension('DC')->setWidth(16);
		$sheet->getColumnDimension('DE')->setWidth(8);//Index(%)
		$sheet->getColumnDimension('DF')->setWidth(8);//Index(%)
		$sheet->getColumnDimension('DG')->setWidth(10);
		$sheet->getColumnDimension('DH')->setWidth(16);
		$sheet->getColumnDimension('DI')->setWidth(10);
		$sheet->getColumnDimension('DJ')->setWidth(16);
		$sheet->getColumnDimension('DK')->setWidth(10);
		$sheet->getColumnDimension('DL')->setWidth(16);
		$sheet->getColumnDimension('DM')->setWidth(8);//Index(%)
		$sheet->getColumnDimension('DN')->setWidth(8);//Index(%)
		$sheet->getColumnDimension('DO')->setWidth(10);
		$sheet->getColumnDimension('DP')->setWidth(16);
		$sheet->getColumnDimension('DQ')->setWidth(10);
		$sheet->getColumnDimension('DR')->setWidth(16);
		$sheet->getColumnDimension('DS')->setWidth(10);
		$sheet->getColumnDimension('DT')->setWidth(16);
		$sheet->getColumnDimension('DU')->setWidth(8);//Index(%)
		$sheet->getColumnDimension('DV')->setWidth(8);//Index(%)
		$sheet->getColumnDimension('DW')->setWidth(10);
		$sheet->getColumnDimension('DX')->setWidth(16);
		$sheet->getColumnDimension('DY')->setWidth(10);
		$sheet->getColumnDimension('DZ')->setWidth(16);
		$sheet->getColumnDimension('DS')->setWidth(10);
		$sheet->getColumnDimension('DT')->setWidth(16);
		$sheet->getColumnDimension('EA')->setWidth(8);//Index(%)
		$sheet->getColumnDimension('EB')->setWidth(8);//Index(%)
		$sheet->getColumnDimension('EC')->setWidth(10);
		$sheet->getColumnDimension('ED')->setWidth(16);
		$sheet->getColumnDimension('EE')->setWidth(10);
		$sheet->getColumnDimension('EF')->setWidth(16);
		$sheet->getColumnDimension('EG')->setWidth(8);//Index(%)
		$sheet->getColumnDimension('EH')->setWidth(8);//Index(%)
		

		// Set orientasi kertas jadi LANDSCAPE
		$sheet->getPageSetup()->setOrientation(\PhpOffice\PhpSpreadsheet\Worksheet\PageSetup::ORIENTATION_LANDSCAPE);
		// Set judul file excel nya
		$sheet->setTitle("Report Selling In - Performance");
		// Proses file excel
		header('Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet');
		header('Content-Disposition: attachment; filename="Report Selling In - Performance ("' . $year . '").xlsx"'); // Set nama file excel nya
		header('Cache-Control: max-age=0');

		$writer = new Xlsx($spreadsheet);
		$writer->save('php://output');

	}

	public function export_sellingout_performance()
	{
		$spreadsheet = new Spreadsheet();
		$sheet = $spreadsheet->getActiveSheet();
		// Buat sebuah variabel untuk menampung pengaturan style dari header tabel
		$style_col = [
			'font' => ['bold' => true], // Set font nya jadi bold
			'alignment' => [
				'horizontal' => \PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER, // Set text jadi ditengah secara horizontal (center)
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'top' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border top dengan garis tipis
				'right' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN],  // Set border right dengan garis tipis
				'bottom' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border bottom dengan garis tipis
				'left' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN] // Set border left dengan garis tipis
			]
		];
		// Buat sebuah variabel untuk menampung pengaturan style dari isi tabel
		$style_row = [
			'alignment' => [
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'top' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border top dengan garis tipis
				'right' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN],  // Set border right dengan garis tipis
				'bottom' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border bottom dengan garis tipis
				'left' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN] // Set border left dengan garis tipis
			]
		];


		if (isset($_POST['by_island']))
		{
			$island = $_POST['by_island'];
		}
		else
		{
			$island = "";
		}

		if (isset($_POST['by_region']))
		{
			$region = $_POST['by_region'];
		}
		else
		{
			$region = "";
		}

		if (isset($_POST['by_area']))
		{
			$area = implode(',', $_POST['by_area']);
			$area = str_replace(",", "','", $area);;
		}
		else
		{
			$area = "";
		}

		if (isset($_POST['by_year']))
		{
			$year = $_POST['by_year'];
		}
		else
		{
			$year = date('Y');
		}


		$sheet->setCellValue('A1', "Report Selling Out - Performance (" . $year . ")"); // Set kolom A1 dengan tulisan 
		$sheet->setCellValue('A2', "Island : " . $island);
		$sheet->setCellValue('A3', "Region : " . $region); 
		$sheet->setCellValue('A4', "Area : " . $area); 
		//$sheet->mergeCells('A1:F1'); // Set Merge Cell pada kolom A1 sampai F1
		$sheet->getStyle('A1')->getFont()->setBold(true); // Set bold kolom A1
		$sheet->getStyle('A2')->getFont()->setBold(true);
		$sheet->getStyle('A3')->getFont()->setBold(true);
		$sheet->getStyle('A4')->getFont()->setBold(true);
		$sheet->getStyle('A1')->getFont()->setSize(20); // Set font size 15 untuk kolom A1
		// Buat header tabel nya pada baris ke 6
		$sheet->setCellValue('A6', "#"); // Set kolom A6 dengan tulisan "#"
		$sheet->mergeCells('A6:A8');//Set Merge Cell
		$sheet->setCellValue('B6', "Principal");
		$sheet->mergeCells('B6:B8');
		$sheet->setCellValue('C6', "Group SKU");
		$sheet->mergeCells('C6:C8'); 
		$sheet->setCellValue('D6', "Kode Item");
		$sheet->mergeCells('D6:D8'); 
		$sheet->setCellValue('E6', "SKU");
		$sheet->mergeCells('E6:E8');
		$sheet->setCellValue('F6', "Unit");
		$sheet->mergeCells('F6:F8');
		//Header Month
		$sheet->setCellValue('G6', "January");
		$sheet->mergeCells('G6:N6');
		$sheet->setCellValue('O6', "February");
		$sheet->mergeCells('O6:V6');
		$sheet->setCellValue('W6', "March");
		$sheet->mergeCells('W6:AD6');
		$sheet->setCellValue('AE6', "Quarter 1");
		$sheet->mergeCells('AE6:AJ6');
		$sheet->setCellValue('AK6', "April");
		$sheet->mergeCells('AK6:AR6');
		$sheet->setCellValue('AS6', "May");
		$sheet->mergeCells('AS6:AZ6');
		$sheet->setCellValue('BA6', "June");
		$sheet->mergeCells('BA6:BH6');
		$sheet->setCellValue('BI6', "Quarter 2");
		$sheet->mergeCells('BI6:BN6');
		$sheet->setCellValue('BO6', "July");
		$sheet->mergeCells('BO6:BV6');
		$sheet->setCellValue('BW6', "August");
		$sheet->mergeCells('BW6:CD6');
		$sheet->setCellValue('CE6', "September");
		$sheet->mergeCells('CE6:CL6');
		$sheet->setCellValue('CM6', "Quarter 3");
		$sheet->mergeCells('CM6:CR6');
		$sheet->setCellValue('CS6', "October");
		$sheet->mergeCells('CS6:CZ6');
		$sheet->setCellValue('DA6', "November");
		$sheet->mergeCells('DA6:DH6');
		$sheet->setCellValue('DI6', "December");
		$sheet->mergeCells('DI6:DP6');
		$sheet->setCellValue('DQ6', "Quarter 4");
		$sheet->mergeCells('DQ6:DV6');
		$sheet->setCellValue('DW6', "Total");
		$sheet->mergeCells('DW6:EB6');
		$sheet->setCellValue('EC6', "Average");
		$sheet->mergeCells('EC6:EH6');

		//Header Actual, Target, Index
		$sheet->setCellValue('G7', "Actual");
		$sheet->mergeCells('G7:H7');
		$sheet->setCellValue('I7', "Target");
		$sheet->mergeCells('I7:J7');
		$sheet->setCellValue('K7', "Index(%)");
		$sheet->mergeCells('K7:L7');
		$sheet->setCellValue('M7', "STOCK");
		$sheet->mergeCells('M7:N7');
		$sheet->setCellValue('O7', "Actual");
		$sheet->mergeCells('O7:P7');
		$sheet->setCellValue('Q7', "Target");
		$sheet->mergeCells('Q7:R7');
		$sheet->setCellValue('S7', "Index(%)");
		$sheet->mergeCells('S7:T7');
		$sheet->setCellValue('U7', "STOCK");
		$sheet->mergeCells('U7:V7');
		$sheet->setCellValue('W7', "Actual");
		$sheet->mergeCells('W7:X7');
		$sheet->setCellValue('Y7', "Target");
		$sheet->mergeCells('Y7:Z7');
		$sheet->setCellValue('AA7', "Index(%)");
		$sheet->mergeCells('AA7:AB7');
		$sheet->setCellValue('AC7', "STOCK");
		$sheet->mergeCells('AC7:AD7');
		$sheet->setCellValue('AE7', "Actual");//Q1
		$sheet->mergeCells('AE7:AF7');
		$sheet->setCellValue('AG7', "Target");
		$sheet->mergeCells('AG7:AH7');
		$sheet->setCellValue('AI7', "Index(%)");//Q1
		$sheet->mergeCells('AI7:AJ7');
		$sheet->setCellValue('AK7', "Actual");
		$sheet->mergeCells('AK7:AL7');
		$sheet->setCellValue('AM7', "Target");
		$sheet->mergeCells('AM7:AN7');
		$sheet->setCellValue('AO7', "Index(%)");
		$sheet->mergeCells('AO7:AP7');
		$sheet->setCellValue('AQ7', "STOCK");
		$sheet->mergeCells('AQ7:AR7');
		$sheet->setCellValue('AS7', "Actual");
		$sheet->mergeCells('AS7:AT7');
		$sheet->setCellValue('AU7', "Target");
		$sheet->mergeCells('AU7:AV7');
		$sheet->setCellValue('AW7', "Index(%)");
		$sheet->mergeCells('AW7:AX7');
		$sheet->setCellValue('AY7', "STOCK");
		$sheet->mergeCells('AY7:AZ7');
		$sheet->setCellValue('BA7', "Actual");
		$sheet->mergeCells('BA7:BB7');
		$sheet->setCellValue('BC7', "Target");
		$sheet->mergeCells('BC7:BD7');
		$sheet->setCellValue('BE7', "Index(%)");
		$sheet->mergeCells('BE7:BF7');
		$sheet->setCellValue('BG7', "STOCK");
		$sheet->mergeCells('BG7:BH7');
		$sheet->setCellValue('BI7', "Actual");//Q2
		$sheet->mergeCells('BI7:BJ7');
		$sheet->setCellValue('BK7', "Target");
		$sheet->mergeCells('BK7:BL7');
		$sheet->setCellValue('BM7', "Index(%)");//Q2
		$sheet->mergeCells('BM7:BN7');
		$sheet->setCellValue('BO7', "Actual");
		$sheet->mergeCells('BO7:BP7');
		$sheet->setCellValue('BQ7', "Target");
		$sheet->mergeCells('BQ7:BR7');
		$sheet->setCellValue('BS7', "Index(%)");
		$sheet->mergeCells('BS7:BT7');
		$sheet->setCellValue('BU7', "STOCK");
		$sheet->mergeCells('BU7:BV7');
		$sheet->setCellValue('BW7', "Actual");
		$sheet->mergeCells('BW7:BX7');
		$sheet->setCellValue('BY7', "Target");
		$sheet->mergeCells('BY7:BZ7');
		$sheet->setCellValue('CA7', "Index(%)");
		$sheet->mergeCells('CA7:CB7');
		$sheet->setCellValue('CC7', "STOCK");
		$sheet->mergeCells('CC7:CD7');
		$sheet->setCellValue('CE7', "Actual");
		$sheet->mergeCells('CE7:CF7');
		$sheet->setCellValue('CG7', "Target");
		$sheet->mergeCells('CG7:CH7');
		$sheet->setCellValue('CI7', "Index(%)");
		$sheet->mergeCells('CI7:CJ7');
		$sheet->setCellValue('CK7', "STOCK");
		$sheet->mergeCells('CK7:CL7');
		$sheet->setCellValue('CM7', "Actual");//Q3
		$sheet->mergeCells('CM7:CN7');
		$sheet->setCellValue('CO7', "Target");
		$sheet->mergeCells('CO7:CP7');
		$sheet->setCellValue('CQ7', "Index(%)");//Q3
		$sheet->mergeCells('CQ7:CR7');
		$sheet->setCellValue('CS7', "Actual");
		$sheet->mergeCells('CS7:CT7');
		$sheet->setCellValue('CU7', "Target");
		$sheet->mergeCells('CU7:CV7');
		$sheet->setCellValue('CW7', "Index(%)");
		$sheet->mergeCells('CW7:CX7');
		$sheet->setCellValue('CY7', "STOCK");
		$sheet->mergeCells('CY7:CZ7');
		$sheet->setCellValue('DA7', "Actual");
		$sheet->mergeCells('DA7:DB7');
		$sheet->setCellValue('DC7', "Target");
		$sheet->mergeCells('DC7:DD7');
		$sheet->setCellValue('DE7', "Index(%)");
		$sheet->mergeCells('DE7:DF7');
		$sheet->setCellValue('DG7', "STOCK");
		$sheet->mergeCells('DG7:DH7');
		$sheet->setCellValue('DI7', "Actual");
		$sheet->mergeCells('DI7:DJ7');
		$sheet->setCellValue('DK7', "Target");
		$sheet->mergeCells('DK7:DL7');
		$sheet->setCellValue('DM7', "Index(%)");
		$sheet->mergeCells('DM7:DN7');
		$sheet->setCellValue('DO7', "STOCK");
		$sheet->mergeCells('DO7:DP7');
		$sheet->setCellValue('DQ7', "Actual");//Q4
		$sheet->mergeCells('DQ7:DR7');
		$sheet->setCellValue('DS7', "Target");
		$sheet->mergeCells('DS7:DT7');
		$sheet->setCellValue('DU7', "Index(%)");//4
		$sheet->mergeCells('DU7:DV7');
		$sheet->setCellValue('DW7', "Actual");//TOTAL
		$sheet->mergeCells('DW7:DX7');
		$sheet->setCellValue('DY7', "Target");
		$sheet->mergeCells('DY7:DZ7');
		$sheet->setCellValue('EA7', "Index(%)");//TOTAL
		$sheet->mergeCells('EA7:EB7');
		$sheet->setCellValue('EC7', "Actual");//AVG
		$sheet->mergeCells('EC7:ED7');
		$sheet->setCellValue('EE7', "Target");
		$sheet->mergeCells('EE7:EF7');
		$sheet->setCellValue('EG7', "Index(%)");//AVG
		$sheet->mergeCells('EG7:EH7');


		//Header QTY, VALUE
		$sheet->setCellValue('G8', "Qty");
		$sheet->setCellValue('H8', "Value");
		$sheet->setCellValue('I8', "Qty");
		$sheet->setCellValue('J8', "Value");
		$sheet->setCellValue('K8', "Qty");
		$sheet->setCellValue('L8', "Value");
		$sheet->setCellValue('M8', "Qty");
		$sheet->setCellValue('N8', "Value");
		$sheet->setCellValue('O8', "Qty");
		$sheet->setCellValue('P8', "Value");
		$sheet->setCellValue('Q8', "Qty");
		$sheet->setCellValue('R8', "Value");
		$sheet->setCellValue('S8', "Qty");
		$sheet->setCellValue('T8', "Value");
		$sheet->setCellValue('U8', "Qty");
		$sheet->setCellValue('V8', "Value");
		$sheet->setCellValue('W8', "Qty");
		$sheet->setCellValue('X8', "Value");
		$sheet->setCellValue('Y8', "Qty");
		$sheet->setCellValue('Z8', "Value");
		$sheet->setCellValue('AA8', "Qty");
		$sheet->setCellValue('AB8', "Value");
		$sheet->setCellValue('AC8', "Qty");
		$sheet->setCellValue('AD8', "Value");
		$sheet->setCellValue('AE8', "Qty");
		$sheet->setCellValue('AF8', "Value");
		$sheet->setCellValue('AG8', "Qty");
		$sheet->setCellValue('AH8', "Value");
		$sheet->setCellValue('AI8', "Qty");
		$sheet->setCellValue('AJ8', "Value");
		$sheet->setCellValue('AK8', "Qty");
		$sheet->setCellValue('AL8', "Value");
		$sheet->setCellValue('AM8', "Qty");
		$sheet->setCellValue('AN8', "Value");
		$sheet->setCellValue('AO8', "Qty");
		$sheet->setCellValue('AP8', "Value");
		$sheet->setCellValue('AQ8', "Qty");
		$sheet->setCellValue('AR8', "Value");
		$sheet->setCellValue('AS8', "Qty");
		$sheet->setCellValue('AT8', "Value");
		$sheet->setCellValue('AU8', "Qty");
		$sheet->setCellValue('AV8', "Value");
		$sheet->setCellValue('AW8', "Qty");
		$sheet->setCellValue('AX8', "Value");
		$sheet->setCellValue('AY8', "Qty");
		$sheet->setCellValue('AZ8', "Value");
		$sheet->setCellValue('BA8', "Qty");
		$sheet->setCellValue('BB8', "Value");
		$sheet->setCellValue('BC8', "Qty");
		$sheet->setCellValue('BD8', "Value");
		$sheet->setCellValue('BE8', "Qty");
		$sheet->setCellValue('BF8', "Value");
		$sheet->setCellValue('BG8', "Qty");
		$sheet->setCellValue('BH8', "Value");
		$sheet->setCellValue('BI8', "Qty");
		$sheet->setCellValue('BJ8', "Value");
		$sheet->setCellValue('BK8', "Qty");
		$sheet->setCellValue('BL8', "Value");
		$sheet->setCellValue('BM8', "Qty");
		$sheet->setCellValue('BN8', "Value");
		$sheet->setCellValue('BO8', "Qty");
		$sheet->setCellValue('BP8', "Value");
		$sheet->setCellValue('BQ8', "Qty");
		$sheet->setCellValue('BR8', "Value");
		$sheet->setCellValue('BS8', "Qty");
		$sheet->setCellValue('BT8', "Value");
		$sheet->setCellValue('BU8', "Qty");
		$sheet->setCellValue('BV8', "Value");
		$sheet->setCellValue('BW8', "Qty");
		$sheet->setCellValue('BX8', "Value");
		$sheet->setCellValue('BY8', "Qty");
		$sheet->setCellValue('BZ8', "Value");
		$sheet->setCellValue('CA8', "Qty");
		$sheet->setCellValue('CB8', "Value");
		$sheet->setCellValue('CC8', "Qty");
		$sheet->setCellValue('CD8', "Value");
		$sheet->setCellValue('CE8', "Qty");
		$sheet->setCellValue('CF8', "Value");
		$sheet->setCellValue('CG8', "Qty");
		$sheet->setCellValue('CH8', "Value");
		$sheet->setCellValue('CI8', "Qty");
		$sheet->setCellValue('CJ8', "Value");
		$sheet->setCellValue('CK8', "Qty");
		$sheet->setCellValue('CL8', "Value");
		$sheet->setCellValue('CM8', "Qty");
		$sheet->setCellValue('CN8', "Value");
		$sheet->setCellValue('CO8', "Qty");
		$sheet->setCellValue('CP8', "Value");
		$sheet->setCellValue('CQ8', "Qty");
		$sheet->setCellValue('CR8', "Value");
		$sheet->setCellValue('CS8', "Qty");
		$sheet->setCellValue('CT8', "Value");
		$sheet->setCellValue('CU8', "Qty");
		$sheet->setCellValue('CV8', "Value");
		$sheet->setCellValue('CW8', "Qty");
		$sheet->setCellValue('CX8', "Value");
		$sheet->setCellValue('CY8', "Qty");
		$sheet->setCellValue('CZ8', "Value");
		$sheet->setCellValue('DA8', "Qty");
		$sheet->setCellValue('DB8', "Value");
		$sheet->setCellValue('DC8', "Qty");
		$sheet->setCellValue('DD8', "Value");
		$sheet->setCellValue('DE8', "Qty");
		$sheet->setCellValue('DF8', "Value");
		$sheet->setCellValue('DG8', "Qty");
		$sheet->setCellValue('DH8', "Value");
		$sheet->setCellValue('DI8', "Qty");
		$sheet->setCellValue('DJ8', "Value");
		$sheet->setCellValue('DK8', "Qty");
		$sheet->setCellValue('DL8', "Value");
		$sheet->setCellValue('DM8', "Qty");
		$sheet->setCellValue('DN8', "Value");
		$sheet->setCellValue('DO8', "Qty");
		$sheet->setCellValue('DP8', "Value");
		$sheet->setCellValue('DQ8', "Qty");
		$sheet->setCellValue('DR8', "Value");
		$sheet->setCellValue('DS8', "Qty");
		$sheet->setCellValue('DT8', "Value");
		$sheet->setCellValue('DU8', "Qty");
		$sheet->setCellValue('DV8', "Value");
		$sheet->setCellValue('DW8', "Qty");
		$sheet->setCellValue('DX8', "Value");
		$sheet->setCellValue('DY8', "Qty");
		$sheet->setCellValue('DZ8', "Value");
		$sheet->setCellValue('EA8', "Qty");
		$sheet->setCellValue('EB8', "Value");
		$sheet->setCellValue('EC8', "Qty");
		$sheet->setCellValue('ED8', "Value");
		$sheet->setCellValue('EE8', "Qty");
		$sheet->setCellValue('EF8', "Value");
		$sheet->setCellValue('EG8', "Qty");
		$sheet->setCellValue('EH8', "Value");
		
		
		// Apply style header yang telah kita buat tadi ke masing-masing kolom header
		$sheet->getStyle('A6')->applyFromArray($style_col);
		$sheet->getStyle('B6')->applyFromArray($style_col);
		$sheet->getStyle('C6')->applyFromArray($style_col);
		$sheet->getStyle('D6')->applyFromArray($style_col);
		$sheet->getStyle('E6')->applyFromArray($style_col);
		$sheet->getStyle('F6')->applyFromArray($style_col);
		$sheet->getStyle('G6')->applyFromArray($style_col);
		$sheet->getStyle('H6')->applyFromArray($style_col);
		$sheet->getStyle('I6')->applyFromArray($style_col);
		$sheet->getStyle('J6')->applyFromArray($style_col);
		$sheet->getStyle('K6')->applyFromArray($style_col);
		$sheet->getStyle('L6')->applyFromArray($style_col);
		$sheet->getStyle('M6')->applyFromArray($style_col);
		$sheet->getStyle('N6')->applyFromArray($style_col);
		$sheet->getStyle('O6')->applyFromArray($style_col);
		$sheet->getStyle('P6')->applyFromArray($style_col);
		$sheet->getStyle('Q6')->applyFromArray($style_col);
		$sheet->getStyle('R6')->applyFromArray($style_col);
		$sheet->getStyle('S6')->applyFromArray($style_col);
		$sheet->getStyle('T6')->applyFromArray($style_col);
		$sheet->getStyle('U6')->applyFromArray($style_col);
		$sheet->getStyle('V6')->applyFromArray($style_col);
		$sheet->getStyle('W6')->applyFromArray($style_col);
		$sheet->getStyle('X6')->applyFromArray($style_col);
		$sheet->getStyle('Y6')->applyFromArray($style_col);
		$sheet->getStyle('Z6')->applyFromArray($style_col);
		$sheet->getStyle('AA6')->applyFromArray($style_col);
		$sheet->getStyle('AB6')->applyFromArray($style_col);
		$sheet->getStyle('AC6')->applyFromArray($style_col);
		$sheet->getStyle('AD6')->applyFromArray($style_col);
		$sheet->getStyle('AE6')->applyFromArray($style_col);
		$sheet->getStyle('AF6')->applyFromArray($style_col);
		$sheet->getStyle('AG6')->applyFromArray($style_col);
		$sheet->getStyle('AH6')->applyFromArray($style_col);
		$sheet->getStyle('AI6')->applyFromArray($style_col);
		$sheet->getStyle('AJ6')->applyFromArray($style_col);
		$sheet->getStyle('AK6')->applyFromArray($style_col);
		$sheet->getStyle('AL6')->applyFromArray($style_col);
		$sheet->getStyle('AM6')->applyFromArray($style_col);
		$sheet->getStyle('AN6')->applyFromArray($style_col);
		$sheet->getStyle('AO6')->applyFromArray($style_col);
		$sheet->getStyle('AP6')->applyFromArray($style_col);
		$sheet->getStyle('AQ6')->applyFromArray($style_col);
		$sheet->getStyle('AR6')->applyFromArray($style_col);
		$sheet->getStyle('AS6')->applyFromArray($style_col);
		$sheet->getStyle('AT6')->applyFromArray($style_col);
		$sheet->getStyle('AU6')->applyFromArray($style_col);
		$sheet->getStyle('AV6')->applyFromArray($style_col);
		$sheet->getStyle('AW6')->applyFromArray($style_col);
		$sheet->getStyle('AX6')->applyFromArray($style_col);
		$sheet->getStyle('AY6')->applyFromArray($style_col);
		$sheet->getStyle('AZ6')->applyFromArray($style_col);
		$sheet->getStyle('BA6')->applyFromArray($style_col);
		$sheet->getStyle('BB6')->applyFromArray($style_col);
		$sheet->getStyle('BC6')->applyFromArray($style_col);
		$sheet->getStyle('BD6')->applyFromArray($style_col);
		$sheet->getStyle('BE6')->applyFromArray($style_col);
		$sheet->getStyle('BF6')->applyFromArray($style_col);
		$sheet->getStyle('BG6')->applyFromArray($style_col);
		$sheet->getStyle('BH6')->applyFromArray($style_col);
		$sheet->getStyle('BI6')->applyFromArray($style_col);
		$sheet->getStyle('BJ6')->applyFromArray($style_col);
		$sheet->getStyle('BK6')->applyFromArray($style_col);
		$sheet->getStyle('BL6')->applyFromArray($style_col);
		$sheet->getStyle('BM6')->applyFromArray($style_col);
		$sheet->getStyle('BN6')->applyFromArray($style_col);
		$sheet->getStyle('BO6')->applyFromArray($style_col);
		$sheet->getStyle('BP6')->applyFromArray($style_col);
		$sheet->getStyle('BQ6')->applyFromArray($style_col);
		$sheet->getStyle('BR6')->applyFromArray($style_col);
		$sheet->getStyle('BS6')->applyFromArray($style_col);
		$sheet->getStyle('BT6')->applyFromArray($style_col);
		$sheet->getStyle('BU6')->applyFromArray($style_col);
		$sheet->getStyle('BV6')->applyFromArray($style_col);
		$sheet->getStyle('BW6')->applyFromArray($style_col);
		$sheet->getStyle('BX6')->applyFromArray($style_col);
		$sheet->getStyle('BY6')->applyFromArray($style_col);
		$sheet->getStyle('BZ6')->applyFromArray($style_col);
		$sheet->getStyle('CA6')->applyFromArray($style_col);
		$sheet->getStyle('CB6')->applyFromArray($style_col);
		$sheet->getStyle('CC6')->applyFromArray($style_col);
		$sheet->getStyle('CD6')->applyFromArray($style_col);
		$sheet->getStyle('CE6')->applyFromArray($style_col);
		$sheet->getStyle('CF6')->applyFromArray($style_col);
		$sheet->getStyle('CG6')->applyFromArray($style_col);
		$sheet->getStyle('CH6')->applyFromArray($style_col);
		$sheet->getStyle('CI6')->applyFromArray($style_col);
		$sheet->getStyle('CJ6')->applyFromArray($style_col);
		$sheet->getStyle('CK6')->applyFromArray($style_col);
		$sheet->getStyle('CL6')->applyFromArray($style_col);
		$sheet->getStyle('CM6')->applyFromArray($style_col);
		$sheet->getStyle('CN6')->applyFromArray($style_col);
		$sheet->getStyle('CO6')->applyFromArray($style_col);
		$sheet->getStyle('CP6')->applyFromArray($style_col);
		$sheet->getStyle('CQ6')->applyFromArray($style_col);
		$sheet->getStyle('CR6')->applyFromArray($style_col);
		$sheet->getStyle('CS6')->applyFromArray($style_col);
		$sheet->getStyle('CT6')->applyFromArray($style_col);
		$sheet->getStyle('CU6')->applyFromArray($style_col);
		$sheet->getStyle('CV6')->applyFromArray($style_col);
		$sheet->getStyle('CW6')->applyFromArray($style_col);
		$sheet->getStyle('CX6')->applyFromArray($style_col);
		$sheet->getStyle('CY6')->applyFromArray($style_col);
		$sheet->getStyle('CZ6')->applyFromArray($style_col);
		$sheet->getStyle('DA6')->applyFromArray($style_col);
		$sheet->getStyle('DB6')->applyFromArray($style_col);
		$sheet->getStyle('DC6')->applyFromArray($style_col);
		$sheet->getStyle('DD6')->applyFromArray($style_col);
		$sheet->getStyle('DE6')->applyFromArray($style_col);
		$sheet->getStyle('DF6')->applyFromArray($style_col);
		$sheet->getStyle('DG6')->applyFromArray($style_col);
		$sheet->getStyle('DH6')->applyFromArray($style_col);
		$sheet->getStyle('DI6')->applyFromArray($style_col);
		$sheet->getStyle('DJ6')->applyFromArray($style_col);
		$sheet->getStyle('DK6')->applyFromArray($style_col);
		$sheet->getStyle('DL6')->applyFromArray($style_col);
		$sheet->getStyle('DM6')->applyFromArray($style_col);
		$sheet->getStyle('DN6')->applyFromArray($style_col);
		$sheet->getStyle('DO6')->applyFromArray($style_col);
		$sheet->getStyle('DP6')->applyFromArray($style_col);
		$sheet->getStyle('DQ6')->applyFromArray($style_col);
		$sheet->getStyle('DR6')->applyFromArray($style_col);
		$sheet->getStyle('DS6')->applyFromArray($style_col);
		$sheet->getStyle('DT6')->applyFromArray($style_col);
		$sheet->getStyle('DU6')->applyFromArray($style_col);
		$sheet->getStyle('DV6')->applyFromArray($style_col);
		$sheet->getStyle('DW6')->applyFromArray($style_col);
		$sheet->getStyle('DX6')->applyFromArray($style_col);
		$sheet->getStyle('DY6')->applyFromArray($style_col);
		$sheet->getStyle('DZ6')->applyFromArray($style_col);
		$sheet->getStyle('EA6')->applyFromArray($style_col);
		$sheet->getStyle('EB6')->applyFromArray($style_col);
		$sheet->getStyle('EC6')->applyFromArray($style_col);
		$sheet->getStyle('ED6')->applyFromArray($style_col);
		$sheet->getStyle('EE6')->applyFromArray($style_col);
		$sheet->getStyle('EF6')->applyFromArray($style_col);
		$sheet->getStyle('EG6')->applyFromArray($style_col);
		$sheet->getStyle('EH6')->applyFromArray($style_col);

		$sheet->getStyle('A7')->applyFromArray($style_col);
		$sheet->getStyle('B7')->applyFromArray($style_col);
		$sheet->getStyle('C7')->applyFromArray($style_col);
		$sheet->getStyle('D7')->applyFromArray($style_col);
		$sheet->getStyle('E7')->applyFromArray($style_col);
		$sheet->getStyle('F7')->applyFromArray($style_col);
		$sheet->getStyle('G7')->applyFromArray($style_col);
		$sheet->getStyle('H7')->applyFromArray($style_col);
		$sheet->getStyle('I7')->applyFromArray($style_col);
		$sheet->getStyle('J7')->applyFromArray($style_col);
		$sheet->getStyle('K7')->applyFromArray($style_col);
		$sheet->getStyle('L7')->applyFromArray($style_col);
		$sheet->getStyle('M7')->applyFromArray($style_col);
		$sheet->getStyle('N7')->applyFromArray($style_col);
		$sheet->getStyle('O7')->applyFromArray($style_col);
		$sheet->getStyle('P7')->applyFromArray($style_col);
		$sheet->getStyle('Q7')->applyFromArray($style_col);
		$sheet->getStyle('R7')->applyFromArray($style_col);
		$sheet->getStyle('S7')->applyFromArray($style_col);
		$sheet->getStyle('T7')->applyFromArray($style_col);
		$sheet->getStyle('U7')->applyFromArray($style_col);
		$sheet->getStyle('V7')->applyFromArray($style_col);
		$sheet->getStyle('W7')->applyFromArray($style_col);
		$sheet->getStyle('X7')->applyFromArray($style_col);
		$sheet->getStyle('Y7')->applyFromArray($style_col);
		$sheet->getStyle('Z7')->applyFromArray($style_col);
		$sheet->getStyle('AA7')->applyFromArray($style_col);
		$sheet->getStyle('AB7')->applyFromArray($style_col);
		$sheet->getStyle('AC7')->applyFromArray($style_col);
		$sheet->getStyle('AD7')->applyFromArray($style_col);
		$sheet->getStyle('AE7')->applyFromArray($style_col);
		$sheet->getStyle('AF7')->applyFromArray($style_col);
		$sheet->getStyle('AG7')->applyFromArray($style_col);
		$sheet->getStyle('AH7')->applyFromArray($style_col);
		$sheet->getStyle('AI7')->applyFromArray($style_col);
		$sheet->getStyle('AJ7')->applyFromArray($style_col);
		$sheet->getStyle('AK7')->applyFromArray($style_col);
		$sheet->getStyle('AL7')->applyFromArray($style_col);
		$sheet->getStyle('AM7')->applyFromArray($style_col);
		$sheet->getStyle('AN7')->applyFromArray($style_col);
		$sheet->getStyle('AO7')->applyFromArray($style_col);
		$sheet->getStyle('AP7')->applyFromArray($style_col);
		$sheet->getStyle('AQ7')->applyFromArray($style_col);
		$sheet->getStyle('AR7')->applyFromArray($style_col);
		$sheet->getStyle('AS7')->applyFromArray($style_col);
		$sheet->getStyle('AT7')->applyFromArray($style_col);
		$sheet->getStyle('AU7')->applyFromArray($style_col);
		$sheet->getStyle('AV7')->applyFromArray($style_col);
		$sheet->getStyle('AW7')->applyFromArray($style_col);
		$sheet->getStyle('AX7')->applyFromArray($style_col);
		$sheet->getStyle('AY7')->applyFromArray($style_col);
		$sheet->getStyle('AZ7')->applyFromArray($style_col);
		$sheet->getStyle('BA7')->applyFromArray($style_col);
		$sheet->getStyle('BB7')->applyFromArray($style_col);
		$sheet->getStyle('BC7')->applyFromArray($style_col);
		$sheet->getStyle('BD7')->applyFromArray($style_col);
		$sheet->getStyle('BE7')->applyFromArray($style_col);
		$sheet->getStyle('BF7')->applyFromArray($style_col);
		$sheet->getStyle('BG7')->applyFromArray($style_col);
		$sheet->getStyle('BH7')->applyFromArray($style_col);
		$sheet->getStyle('BI7')->applyFromArray($style_col);
		$sheet->getStyle('BJ7')->applyFromArray($style_col);
		$sheet->getStyle('BK7')->applyFromArray($style_col);
		$sheet->getStyle('BL7')->applyFromArray($style_col);
		$sheet->getStyle('BM7')->applyFromArray($style_col);
		$sheet->getStyle('BN7')->applyFromArray($style_col);
		$sheet->getStyle('BO7')->applyFromArray($style_col);
		$sheet->getStyle('BP7')->applyFromArray($style_col);
		$sheet->getStyle('BQ7')->applyFromArray($style_col);
		$sheet->getStyle('BR7')->applyFromArray($style_col);
		$sheet->getStyle('BS7')->applyFromArray($style_col);
		$sheet->getStyle('BT7')->applyFromArray($style_col);
		$sheet->getStyle('BU7')->applyFromArray($style_col);
		$sheet->getStyle('BV7')->applyFromArray($style_col);
		$sheet->getStyle('BW7')->applyFromArray($style_col);
		$sheet->getStyle('BX7')->applyFromArray($style_col);
		$sheet->getStyle('BY7')->applyFromArray($style_col);
		$sheet->getStyle('BZ7')->applyFromArray($style_col);
		$sheet->getStyle('CA7')->applyFromArray($style_col);
		$sheet->getStyle('CB7')->applyFromArray($style_col);
		$sheet->getStyle('CC7')->applyFromArray($style_col);
		$sheet->getStyle('CD7')->applyFromArray($style_col);
		$sheet->getStyle('CE7')->applyFromArray($style_col);
		$sheet->getStyle('CF7')->applyFromArray($style_col);
		$sheet->getStyle('CG7')->applyFromArray($style_col);
		$sheet->getStyle('CH7')->applyFromArray($style_col);
		$sheet->getStyle('CI7')->applyFromArray($style_col);
		$sheet->getStyle('CJ7')->applyFromArray($style_col);
		$sheet->getStyle('CK7')->applyFromArray($style_col);
		$sheet->getStyle('CL7')->applyFromArray($style_col);
		$sheet->getStyle('CM7')->applyFromArray($style_col);
		$sheet->getStyle('CN7')->applyFromArray($style_col);
		$sheet->getStyle('CO7')->applyFromArray($style_col);
		$sheet->getStyle('CP7')->applyFromArray($style_col);
		$sheet->getStyle('CQ7')->applyFromArray($style_col);
		$sheet->getStyle('CR7')->applyFromArray($style_col);
		$sheet->getStyle('CS7')->applyFromArray($style_col);
		$sheet->getStyle('CT7')->applyFromArray($style_col);
		$sheet->getStyle('CU7')->applyFromArray($style_col);
		$sheet->getStyle('CV7')->applyFromArray($style_col);
		$sheet->getStyle('CW7')->applyFromArray($style_col);
		$sheet->getStyle('CX7')->applyFromArray($style_col);
		$sheet->getStyle('CY7')->applyFromArray($style_col);
		$sheet->getStyle('CZ7')->applyFromArray($style_col);
		$sheet->getStyle('DA7')->applyFromArray($style_col);
		$sheet->getStyle('DB7')->applyFromArray($style_col);
		$sheet->getStyle('DC7')->applyFromArray($style_col);
		$sheet->getStyle('DD7')->applyFromArray($style_col);
		$sheet->getStyle('DE7')->applyFromArray($style_col);
		$sheet->getStyle('DF7')->applyFromArray($style_col);
		$sheet->getStyle('DG7')->applyFromArray($style_col);
		$sheet->getStyle('DH7')->applyFromArray($style_col);
		$sheet->getStyle('DI7')->applyFromArray($style_col);
		$sheet->getStyle('DJ7')->applyFromArray($style_col);
		$sheet->getStyle('DK7')->applyFromArray($style_col);
		$sheet->getStyle('DL7')->applyFromArray($style_col);
		$sheet->getStyle('DM7')->applyFromArray($style_col);
		$sheet->getStyle('DN7')->applyFromArray($style_col);
		$sheet->getStyle('DO7')->applyFromArray($style_col);
		$sheet->getStyle('DP7')->applyFromArray($style_col);
		$sheet->getStyle('DQ7')->applyFromArray($style_col);
		$sheet->getStyle('DR7')->applyFromArray($style_col);
		$sheet->getStyle('DS7')->applyFromArray($style_col);
		$sheet->getStyle('DT7')->applyFromArray($style_col);
		$sheet->getStyle('DU7')->applyFromArray($style_col);
		$sheet->getStyle('DV7')->applyFromArray($style_col);
		$sheet->getStyle('DW7')->applyFromArray($style_col);
		$sheet->getStyle('DX7')->applyFromArray($style_col);
		$sheet->getStyle('DY7')->applyFromArray($style_col);
		$sheet->getStyle('DZ7')->applyFromArray($style_col);
		$sheet->getStyle('EA7')->applyFromArray($style_col);
		$sheet->getStyle('EB7')->applyFromArray($style_col);
		$sheet->getStyle('EC7')->applyFromArray($style_col);
		$sheet->getStyle('ED7')->applyFromArray($style_col);
		$sheet->getStyle('EE7')->applyFromArray($style_col);
		$sheet->getStyle('EF7')->applyFromArray($style_col);
		$sheet->getStyle('EG7')->applyFromArray($style_col);
		$sheet->getStyle('EH7')->applyFromArray($style_col);

		$sheet->getStyle('A8')->applyFromArray($style_col);
		$sheet->getStyle('B8')->applyFromArray($style_col);
		$sheet->getStyle('C8')->applyFromArray($style_col);
		$sheet->getStyle('D8')->applyFromArray($style_col);
		$sheet->getStyle('E8')->applyFromArray($style_col);
		$sheet->getStyle('F8')->applyFromArray($style_col);
		$sheet->getStyle('G8')->applyFromArray($style_col);
		$sheet->getStyle('H8')->applyFromArray($style_col);
		$sheet->getStyle('I8')->applyFromArray($style_col);
		$sheet->getStyle('J8')->applyFromArray($style_col);
		$sheet->getStyle('K8')->applyFromArray($style_col);
		$sheet->getStyle('L8')->applyFromArray($style_col);
		$sheet->getStyle('M8')->applyFromArray($style_col);
		$sheet->getStyle('N8')->applyFromArray($style_col);
		$sheet->getStyle('O8')->applyFromArray($style_col);
		$sheet->getStyle('P8')->applyFromArray($style_col);
		$sheet->getStyle('Q8')->applyFromArray($style_col);
		$sheet->getStyle('R8')->applyFromArray($style_col);
		$sheet->getStyle('S8')->applyFromArray($style_col);
		$sheet->getStyle('T8')->applyFromArray($style_col);
		$sheet->getStyle('U8')->applyFromArray($style_col);
		$sheet->getStyle('V8')->applyFromArray($style_col);
		$sheet->getStyle('W8')->applyFromArray($style_col);
		$sheet->getStyle('X8')->applyFromArray($style_col);
		$sheet->getStyle('Y8')->applyFromArray($style_col);
		$sheet->getStyle('Z8')->applyFromArray($style_col);
		$sheet->getStyle('AA8')->applyFromArray($style_col);
		$sheet->getStyle('AB8')->applyFromArray($style_col);
		$sheet->getStyle('AC8')->applyFromArray($style_col);
		$sheet->getStyle('AD8')->applyFromArray($style_col);
		$sheet->getStyle('AE8')->applyFromArray($style_col);
		$sheet->getStyle('AF8')->applyFromArray($style_col);
		$sheet->getStyle('AG8')->applyFromArray($style_col);
		$sheet->getStyle('AH8')->applyFromArray($style_col);
		$sheet->getStyle('AI8')->applyFromArray($style_col);
		$sheet->getStyle('AJ8')->applyFromArray($style_col);
		$sheet->getStyle('AK8')->applyFromArray($style_col);
		$sheet->getStyle('AL8')->applyFromArray($style_col);
		$sheet->getStyle('AM8')->applyFromArray($style_col);
		$sheet->getStyle('AN8')->applyFromArray($style_col);
		$sheet->getStyle('AO8')->applyFromArray($style_col);
		$sheet->getStyle('AP8')->applyFromArray($style_col);
		$sheet->getStyle('AQ8')->applyFromArray($style_col);
		$sheet->getStyle('AR8')->applyFromArray($style_col);
		$sheet->getStyle('AS8')->applyFromArray($style_col);
		$sheet->getStyle('AT8')->applyFromArray($style_col);
		$sheet->getStyle('AU8')->applyFromArray($style_col);
		$sheet->getStyle('AV8')->applyFromArray($style_col);
		$sheet->getStyle('AW8')->applyFromArray($style_col);
		$sheet->getStyle('AX8')->applyFromArray($style_col);
		$sheet->getStyle('AY8')->applyFromArray($style_col);
		$sheet->getStyle('AZ8')->applyFromArray($style_col);
		$sheet->getStyle('BA8')->applyFromArray($style_col);
		$sheet->getStyle('BB8')->applyFromArray($style_col);
		$sheet->getStyle('BC8')->applyFromArray($style_col);
		$sheet->getStyle('BD8')->applyFromArray($style_col);
		$sheet->getStyle('BE8')->applyFromArray($style_col);
		$sheet->getStyle('BF8')->applyFromArray($style_col);
		$sheet->getStyle('BG8')->applyFromArray($style_col);
		$sheet->getStyle('BH8')->applyFromArray($style_col);
		$sheet->getStyle('BI8')->applyFromArray($style_col);
		$sheet->getStyle('BJ8')->applyFromArray($style_col);
		$sheet->getStyle('BK8')->applyFromArray($style_col);
		$sheet->getStyle('BL8')->applyFromArray($style_col);
		$sheet->getStyle('BM8')->applyFromArray($style_col);
		$sheet->getStyle('BN8')->applyFromArray($style_col);
		$sheet->getStyle('BO8')->applyFromArray($style_col);
		$sheet->getStyle('BP8')->applyFromArray($style_col);
		$sheet->getStyle('BQ8')->applyFromArray($style_col);
		$sheet->getStyle('BR8')->applyFromArray($style_col);
		$sheet->getStyle('BS8')->applyFromArray($style_col);
		$sheet->getStyle('BT8')->applyFromArray($style_col);
		$sheet->getStyle('BU8')->applyFromArray($style_col);
		$sheet->getStyle('BV8')->applyFromArray($style_col);
		$sheet->getStyle('BW8')->applyFromArray($style_col);
		$sheet->getStyle('BX8')->applyFromArray($style_col);
		$sheet->getStyle('BY8')->applyFromArray($style_col);
		$sheet->getStyle('BZ8')->applyFromArray($style_col);
		$sheet->getStyle('CA8')->applyFromArray($style_col);
		$sheet->getStyle('CB8')->applyFromArray($style_col);
		$sheet->getStyle('CC8')->applyFromArray($style_col);
		$sheet->getStyle('CD8')->applyFromArray($style_col);
		$sheet->getStyle('CE8')->applyFromArray($style_col);
		$sheet->getStyle('CF8')->applyFromArray($style_col);
		$sheet->getStyle('CG8')->applyFromArray($style_col);
		$sheet->getStyle('CH8')->applyFromArray($style_col);
		$sheet->getStyle('CI8')->applyFromArray($style_col);
		$sheet->getStyle('CJ8')->applyFromArray($style_col);
		$sheet->getStyle('CK8')->applyFromArray($style_col);
		$sheet->getStyle('CL8')->applyFromArray($style_col);
		$sheet->getStyle('CM8')->applyFromArray($style_col);
		$sheet->getStyle('CN8')->applyFromArray($style_col);
		$sheet->getStyle('CO8')->applyFromArray($style_col);
		$sheet->getStyle('CP8')->applyFromArray($style_col);
		$sheet->getStyle('CQ8')->applyFromArray($style_col);
		$sheet->getStyle('CR8')->applyFromArray($style_col);
		$sheet->getStyle('CS8')->applyFromArray($style_col);
		$sheet->getStyle('CT8')->applyFromArray($style_col);
		$sheet->getStyle('CU8')->applyFromArray($style_col);
		$sheet->getStyle('CV8')->applyFromArray($style_col);
		$sheet->getStyle('CW8')->applyFromArray($style_col);
		$sheet->getStyle('CX8')->applyFromArray($style_col);
		$sheet->getStyle('CY8')->applyFromArray($style_col);
		$sheet->getStyle('CZ8')->applyFromArray($style_col);
		$sheet->getStyle('DA8')->applyFromArray($style_col);
		$sheet->getStyle('DB8')->applyFromArray($style_col);
		$sheet->getStyle('DC8')->applyFromArray($style_col);
		$sheet->getStyle('DD8')->applyFromArray($style_col);
		$sheet->getStyle('DE8')->applyFromArray($style_col);
		$sheet->getStyle('DF8')->applyFromArray($style_col);
		$sheet->getStyle('DG8')->applyFromArray($style_col);
		$sheet->getStyle('DH8')->applyFromArray($style_col);
		$sheet->getStyle('DI8')->applyFromArray($style_col);
		$sheet->getStyle('DJ8')->applyFromArray($style_col);
		$sheet->getStyle('DK8')->applyFromArray($style_col);
		$sheet->getStyle('DL8')->applyFromArray($style_col);
		$sheet->getStyle('DM8')->applyFromArray($style_col);
		$sheet->getStyle('DN8')->applyFromArray($style_col);
		$sheet->getStyle('DO8')->applyFromArray($style_col);
		$sheet->getStyle('DP8')->applyFromArray($style_col);
		$sheet->getStyle('DQ8')->applyFromArray($style_col);
		$sheet->getStyle('DR8')->applyFromArray($style_col);
		$sheet->getStyle('DS8')->applyFromArray($style_col);
		$sheet->getStyle('DT8')->applyFromArray($style_col);
		$sheet->getStyle('DU8')->applyFromArray($style_col);
		$sheet->getStyle('DV8')->applyFromArray($style_col);
		$sheet->getStyle('DW8')->applyFromArray($style_col);
		$sheet->getStyle('DX8')->applyFromArray($style_col);
		$sheet->getStyle('DY8')->applyFromArray($style_col);
		$sheet->getStyle('DZ8')->applyFromArray($style_col);
		$sheet->getStyle('EA8')->applyFromArray($style_col);
		$sheet->getStyle('EB8')->applyFromArray($style_col);
		$sheet->getStyle('EC8')->applyFromArray($style_col);
		$sheet->getStyle('ED8')->applyFromArray($style_col);
		$sheet->getStyle('EE8')->applyFromArray($style_col);
		$sheet->getStyle('EF8')->applyFromArray($style_col);
		$sheet->getStyle('EG8')->applyFromArray($style_col);
		$sheet->getStyle('EH8')->applyFromArray($style_col);

		$sheet->getStyle('A6:AD8')->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');
		$sheet->getStyle('AE6:AJ8')->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFFF00');//Q1
		$sheet->getStyle('AK6:BH8')->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');
		$sheet->getStyle('BI6:BN8')->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFFF00');//Q2
		$sheet->getStyle('BO6:CL8')->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');
		$sheet->getStyle('CM6:CR8')->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFFF00');//Q3
		$sheet->getStyle('CS6:DP8')->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');
		$sheet->getStyle('DQ6:DV8')->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFFF00');//Q4
		$sheet->getStyle('DW6:EB8')->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFA07A');//TOTAL
		$sheet->getStyle('EC6:EH8')->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('98FB98');//AVG

		// Set height baris ke 1 dan 2
		$sheet->getRowDimension('1')->setRowHeight(40);
		$sheet->getRowDimension('2')->setRowHeight(20);
		$sheet->getRowDimension('3')->setRowHeight(20);
		$sheet->getRowDimension('4')->setRowHeight(20);


		$item_group = '';
        $principal = '';

        $qty_jan = 0;
		$qty_feb = 0;
		$qty_mar = 0;
		$qty_q1 = 0;
		$qty_apr = 0;
		$qty_mei = 0;
		$qty_jun = 0;
		$qty_q2 = 0;
		$qty_jul = 0;
		$qty_agu = 0;
		$qty_sep = 0;
		$qty_q3 = 0;
		$qty_okt = 0;
		$qty_nop = 0;
		$qty_des = 0;
		$qty_q4 = 0;
		$qty_year = 0;
		$qty_avg = 0;

		$val_jan = 0;
		$val_feb = 0;
		$val_mar = 0;
		$val_q1 = 0;
		$val_apr = 0;
		$val_mei = 0;
		$val_jun = 0;
		$val_q2 = 0;
		$val_jul = 0;
		$val_agu = 0;
		$val_sep = 0;
		$val_q3 = 0;
		$val_okt = 0;
		$val_nop = 0;
		$val_des = 0;
		$val_q4 = 0;
		$val_year = 0;
		$val_avg = 0;

		$target_qty_jan = 0;
		$target_qty_feb = 0;
		$target_qty_mar = 0;
		$target_qty_q1 = 0;
		$target_qty_apr = 0;
		$target_qty_mei = 0;
		$target_qty_jun = 0;
		$target_qty_q2 = 0;
		$target_qty_jul = 0;
		$target_qty_agu = 0;
		$target_qty_sep = 0;
		$target_qty_q3 = 0;
		$target_qty_okt = 0;
		$target_qty_nop = 0;
		$target_qty_des = 0;
		$target_qty_q4 = 0;
		$target_qty_year = 0;
		$target_qty_avg = 0;

		$target_val_jan = 0;
		$target_val_feb = 0;
		$target_val_mar = 0;
		$target_val_q1 = 0;
		$target_val_apr = 0;
		$target_val_mei = 0;
		$target_val_jun = 0;
		$target_val_q2 = 0;
		$target_val_jul = 0;
		$target_val_agu = 0;
		$target_val_sep = 0;
		$target_val_q3 = 0;
		$target_val_okt = 0;
		$target_val_nop = 0;
		$target_val_des = 0;
		$target_val_q4 = 0;
		$target_val_year = 0;
		$target_val_avg = 0;

		$idx_qty_jan = 0;
		$idx_qty_feb = 0;
		$idx_qty_mar = 0;
		$idx_qty_q1 = 0;
		$idx_qty_apr = 0;
		$idx_qty_mei = 0;
		$idx_qty_jun = 0;
		$idx_qty_q2 = 0;
		$idx_qty_jul = 0;
		$idx_qty_agu = 0;
		$idx_qty_sep = 0;
		$idx_qty_q3 = 0;
		$idx_qty_okt = 0;
		$idx_qty_nop = 0;
		$idx_qty_des = 0;
		$idx_qty_q4 = 0;
		$idx_qty_year = 0;
		$idx_qty_avg = 0;

		$idx_val_jan = 0;
		$idx_val_feb = 0;
		$idx_val_mar = 0;
		$idx_val_q1 = 0;
		$idx_val_apr = 0;
		$idx_val_mei = 0;
		$idx_val_jun = 0;
		$idx_val_q2 = 0;
		$idx_val_jul = 0;
		$idx_val_agu = 0;
		$idx_val_sep = 0;
		$idx_val_q3 = 0;
		$idx_val_okt = 0;
		$idx_val_nop = 0;
		$idx_val_des = 0;
		$idx_val_q4 = 0;
		$idx_val_year = 0;
		$idx_val_avg = 0;

		$stok_qty_jan = 0;
		$stok_qty_feb = 0;
		$stok_qty_mar = 0;
		$stok_qty_q1 = 0;
		$stok_qty_apr = 0;
		$stok_qty_mei = 0;
		$stok_qty_jun = 0;
		$stok_qty_q2 = 0;
		$stok_qty_jul = 0;
		$stok_qty_agu = 0;
		$stok_qty_sep = 0;
		$stok_qty_q3 = 0;
		$stok_qty_okt = 0;
		$stok_qty_nop = 0;
		$stok_qty_des = 0;
		$stok_qty_q4 = 0;
		$stok_qty_year = 0;
		$stok_qty_avg = 0;

		$stok_val_jan = 0;
		$stok_val_feb = 0;
		$stok_val_mar = 0;
		$stok_val_q1 = 0;
		$stok_val_apr = 0;
		$stok_val_mei = 0;
		$stok_val_jun = 0;
		$stok_val_q2 = 0;
		$stok_val_jul = 0;
		$stok_val_agu = 0;
		$stok_val_sep = 0;
		$stok_val_q3 = 0;
		$stok_val_okt = 0;
		$stok_val_nop = 0;
		$stok_val_des = 0;
		$stok_val_q4 = 0;
		$stok_val_year = 0;
		$stok_val_avg = 0;

		$sub_qty_jan = 0;
		$sub_qty_feb = 0;
		$sub_qty_mar = 0;
		$sub_qty_q1 = 0;
		$sub_qty_apr = 0;
		$sub_qty_mei = 0;
		$sub_qty_jun = 0;
		$sub_qty_q2 = 0;
		$sub_qty_jul = 0;
		$sub_qty_agu = 0;
		$sub_qty_sep = 0;
		$sub_qty_q3 = 0;
		$sub_qty_okt = 0;
		$sub_qty_nop = 0;
		$sub_qty_des = 0;
		$sub_qty_q4 = 0;
		$sub_qty_year = 0;
		$sub_qty_avg = 0;

		$sub_val_jan = 0;
		$sub_val_feb = 0;
		$sub_val_mar = 0;
		$sub_val_q1 = 0;
		$sub_val_apr = 0;
		$sub_val_mei = 0;
		$sub_val_jun = 0;
		$sub_val_q2 = 0;
		$sub_val_jul = 0;
		$sub_val_agu = 0;
		$sub_val_sep = 0;
		$sub_val_q3 = 0;
		$sub_val_okt = 0;
		$sub_val_nop = 0;
		$sub_val_des = 0;
		$sub_val_q4 = 0;
		$sub_val_year = 0;
		$sub_val_avg = 0;

		$sub_target_qty_jan = 0;
		$sub_target_qty_feb = 0;
		$sub_target_qty_mar = 0;
		$sub_target_qty_q1 = 0;
		$sub_target_qty_apr = 0;
		$sub_target_qty_mei = 0;
		$sub_target_qty_jun = 0;
		$sub_target_qty_q2 = 0;
		$sub_target_qty_jul = 0;
		$sub_target_qty_agu = 0;
		$sub_target_qty_sep = 0;
		$sub_target_qty_q3 = 0;
		$sub_target_qty_okt = 0;
		$sub_target_qty_nop = 0;
		$sub_target_qty_des = 0;
		$sub_target_qty_q4 = 0;
		$sub_target_qty_year = 0;
		$sub_target_qty_avg = 0;

		$sub_target_val_jan = 0;
		$sub_target_val_feb = 0;
		$sub_target_val_mar = 0;
		$sub_target_val_q1 = 0;
		$sub_target_val_apr = 0;
		$sub_target_val_mei = 0;
		$sub_target_val_jun = 0;
		$sub_target_val_q2 = 0;
		$sub_target_val_jul = 0;
		$sub_target_val_agu = 0;
		$sub_target_val_sep = 0;
		$sub_target_val_q3 = 0;
		$sub_target_val_okt = 0;
		$sub_target_val_nop = 0;
		$sub_target_val_des = 0;
		$sub_target_val_q4 = 0;
		$sub_target_val_year = 0;
		$sub_target_val_avg = 0;

		$sub_idx_qty_jan = 0;
		$sub_idx_qty_feb = 0;
		$sub_idx_qty_mar = 0;
		$sub_idx_qty_q1 = 0;
		$sub_idx_qty_apr = 0;
		$sub_idx_qty_mei = 0;
		$sub_idx_qty_jun = 0;
		$sub_idx_qty_q2 = 0;
		$sub_idx_qty_jul = 0;
		$sub_idx_qty_agu = 0;
		$sub_idx_qty_sep = 0;
		$sub_idx_qty_q3 = 0;
		$sub_idx_qty_okt = 0;
		$sub_idx_qty_nop = 0;
		$sub_idx_qty_des = 0;
		$sub_idx_qty_q4 = 0;
		$sub_idx_qty_year = 0;
		$sub_idx_qty_avg = 0;

		$sub_idx_val_jan = 0;
		$sub_idx_val_feb = 0;
		$sub_idx_val_mar = 0;
		$sub_idx_val_q1 = 0;
		$sub_idx_val_apr = 0;
		$sub_idx_val_mei = 0;
		$sub_idx_val_jun = 0;
		$sub_idx_val_q2 = 0;
		$sub_idx_val_jul = 0;
		$sub_idx_val_agu = 0;
		$sub_idx_val_sep = 0;
		$sub_idx_val_q3 = 0;
		$sub_idx_val_okt = 0;
		$sub_idx_val_nop = 0;
		$sub_idx_val_des = 0;
		$sub_idx_val_q4 = 0;
		$sub_idx_val_year = 0;
		$sub_idx_val_avg = 0;

		$sub_stok_qty_jan = 0;
		$sub_stok_qty_feb = 0;
		$sub_stok_qty_mar = 0;
		$sub_stok_qty_q1 = 0;
		$sub_stok_qty_apr = 0;
		$sub_stok_qty_mei = 0;
		$sub_stok_qty_jun = 0;
		$sub_stok_qty_q2 = 0;
		$sub_stok_qty_jul = 0;
		$sub_stok_qty_agu = 0;
		$sub_stok_qty_sep = 0;
		$sub_stok_qty_q3 = 0;
		$sub_stok_qty_okt = 0;
		$sub_stok_qty_nop = 0;
		$sub_stok_qty_des = 0;
		$sub_stok_qty_q4 = 0;
		$sub_stok_qty_year = 0;
		$sub_stok_qty_avg = 0;

		$sub_stok_val_jan = 0;
		$sub_stok_val_feb = 0;
		$sub_stok_val_mar = 0;
		$sub_stok_val_q1 = 0;
		$sub_stok_val_apr = 0;
		$sub_stok_val_mei = 0;
		$sub_stok_val_jun = 0;
		$sub_stok_val_q2 = 0;
		$sub_stok_val_jul = 0;
		$sub_stok_val_agu = 0;
		$sub_stok_val_sep = 0;
		$sub_stok_val_q3 = 0;
		$sub_stok_val_okt = 0;
		$sub_stok_val_nop = 0;
		$sub_stok_val_des = 0;
		$sub_stok_val_q4 = 0;
		$sub_stok_val_year = 0;
		$sub_stok_val_avg = 0;

		$total_qty_jan = 0;
		$total_qty_feb = 0;
		$total_qty_mar = 0;
		$total_qty_q1 = 0;
		$total_qty_apr = 0;
		$total_qty_mei = 0;
		$total_qty_jun = 0;
		$total_qty_q2 = 0;
		$total_qty_jul = 0;
		$total_qty_agu = 0;
		$total_qty_sep = 0;
		$total_qty_q3 = 0;
		$total_qty_okt = 0;
		$total_qty_nop = 0;
		$total_qty_des = 0;
		$total_qty_q4 = 0;
		$total_qty_year = 0;
		$total_qty_avg = 0;

		$total_val_jan = 0;
		$total_val_feb = 0;
		$total_val_mar = 0;
		$total_val_q1 = 0;
		$total_val_apr = 0;
		$total_val_mei = 0;
		$total_val_jun = 0;
		$total_val_q2 = 0;
		$total_val_jul = 0;
		$total_val_agu = 0;
		$total_val_sep = 0;
		$total_val_q3 = 0;
		$total_val_okt = 0;
		$total_val_nop = 0;
		$total_val_des = 0;
		$total_val_q4 = 0;
		$total_val_year = 0;
		$total_val_avg = 0;

		$total_target_qty_jan = 0;
		$total_target_qty_feb = 0;
		$total_target_qty_mar = 0;
		$total_target_qty_q1 = 0;
		$total_target_qty_apr = 0;
		$total_target_qty_mei = 0;
		$total_target_qty_jun = 0;
		$total_target_qty_q2 = 0;
		$total_target_qty_jul = 0;
		$total_target_qty_agu = 0;
		$total_target_qty_sep = 0;
		$total_target_qty_q3 = 0;
		$total_target_qty_okt = 0;
		$total_target_qty_nop = 0;
		$total_target_qty_des = 0;
		$total_target_qty_q4 = 0;
		$total_target_qty_year = 0;
		$total_target_qty_avg = 0;

		$total_target_val_jan = 0;
		$total_target_val_feb = 0;
		$total_target_val_mar = 0;
		$total_target_val_q1 = 0;
		$total_target_val_apr = 0;
		$total_target_val_mei = 0;
		$total_target_val_jun = 0;
		$total_target_val_q2 = 0;
		$total_target_val_jul = 0;
		$total_target_val_agu = 0;
		$total_target_val_sep = 0;
		$total_target_val_q3 = 0;
		$total_target_val_okt = 0;
		$total_target_val_nop = 0;
		$total_target_val_des = 0;
		$total_target_val_q4 = 0;
		$total_target_val_year = 0;
		$total_target_val_avg = 0;

		$total_idx_qty_jan = 0;
		$total_idx_qty_feb = 0;
		$total_idx_qty_mar = 0;
		$total_idx_qty_q1 = 0;
		$total_idx_qty_apr = 0;
		$total_idx_qty_mei = 0;
		$total_idx_qty_jun = 0;
		$total_idx_qty_q2 = 0;
		$total_idx_qty_jul = 0;
		$total_idx_qty_agu = 0;
		$total_idx_qty_sep = 0;
		$total_idx_qty_q3 = 0;
		$total_idx_qty_okt = 0;
		$total_idx_qty_nop = 0;
		$total_idx_qty_des = 0;
		$total_idx_qty_q4 = 0;
		$total_idx_qty_year = 0;
		$total_idx_qty_avg = 0;

		$total_idx_val_jan = 0;
		$total_idx_val_feb = 0;
		$total_idx_val_mar = 0;
		$total_idx_val_q1 = 0;
		$total_idx_val_apr = 0;
		$total_idx_val_mei = 0;
		$total_idx_val_jun = 0;
		$total_idx_val_q2 = 0;
		$total_idx_val_jul = 0;
		$total_idx_val_agu = 0;
		$total_idx_val_sep = 0;
		$total_idx_val_q3 = 0;
		$total_idx_val_okt = 0;
		$total_idx_val_nop = 0;
		$total_idx_val_des = 0;
		$total_idx_val_q4 = 0;
		$total_idx_val_year = 0;
		$total_idx_val_avg = 0;

		$total_stok_qty_jan = 0;
		$total_stok_qty_feb = 0;
		$total_stok_qty_mar = 0;
		$total_stok_qty_q1 = 0;
		$total_stok_qty_apr = 0;
		$total_stok_qty_mei = 0;
		$total_stok_qty_jun = 0;
		$total_stok_qty_q2 = 0;
		$total_stok_qty_jul = 0;
		$total_stok_qty_agu = 0;
		$total_stok_qty_sep = 0;
		$total_stok_qty_q3 = 0;
		$total_stok_qty_okt = 0;
		$total_stok_qty_nop = 0;
		$total_stok_qty_des = 0;
		$total_stok_qty_q4 = 0;
		$total_stok_qty_year = 0;
		$total_stok_qty_avg = 0;

		$total_stok_val_jan = 0;
		$total_stok_val_feb = 0;
		$total_stok_val_mar = 0;
		$total_stok_val_q1 = 0;
		$total_stok_val_apr = 0;
		$total_stok_val_mei = 0;
		$total_stok_val_jun = 0;
		$total_stok_val_q2 = 0;
		$total_stok_val_jul = 0;
		$total_stok_val_agu = 0;
		$total_stok_val_sep = 0;
		$total_stok_val_q3 = 0;
		$total_stok_val_okt = 0;
		$total_stok_val_nop = 0;
		$total_stok_val_des = 0;
		$total_stok_val_q4 = 0;
		$total_stok_val_year = 0;
		$total_stok_val_avg = 0;


		$no = 1; // Untuk penomoran tabel, di awal set dengan 1
		$row = 9;

		$data1 = array(
			'island' => $island,
			'region' => $region,
			'area' => $area,
			'year' => $year
		);

		$data['sellingout'] = $this->model('ReportModel')->getSellingOut_Year2($data1);

		foreach ($data['sellingout'] as $rows) :

			if ($item_group != $rows['item_group'] and $item_group != '' )
            {
				
				$sheet->setCellValue('A' . $row, '');
				$sheet->setCellValue('B' . $row, $principal);
				$sheet->setCellValue('C' . $row, $item_group);
				$sheet->setCellValue('D' . $row, '');
				$sheet->setCellValue('E' . $row, 'Sub Total ' . $item_group);
				$sheet->setCellValue('F' . $row, '');
				$sheet->setCellValue('G' . $row, $qty_jan);
				$sheet->setCellValue('H' . $row, $val_jan);
				$sheet->setCellValue('I' . $row, $target_qty_jan);
				$sheet->setCellValue('J' . $row, $target_val_jan);
				$sheet->setCellValue('K' . $row, $idx_qty_jan);
				$sheet->setCellValue('L' . $row, $idx_val_jan);
				$sheet->setCellValue('M' . $row, $stok_qty_jan);
				$sheet->setCellValue('N' . $row, $stok_val_jan);
				$sheet->setCellValue('O' . $row, $qty_feb);
				$sheet->setCellValue('P' . $row, $val_feb);
				$sheet->setCellValue('Q' . $row, $target_qty_feb);
				$sheet->setCellValue('R' . $row, $target_val_feb);
				$sheet->setCellValue('S' . $row, $idx_qty_feb);
				$sheet->setCellValue('T' . $row, $idx_val_feb);
				$sheet->setCellValue('U' . $row, $stok_qty_feb);
				$sheet->setCellValue('V' . $row, $stok_val_feb);
				$sheet->setCellValue('W' . $row, $qty_mar);
				$sheet->setCellValue('X' . $row, $val_mar);
				$sheet->setCellValue('Y' . $row, $target_qty_mar);
				$sheet->setCellValue('Z' . $row, $target_val_mar);
				$sheet->setCellValue('AA' . $row, $idx_qty_mar);
				$sheet->setCellValue('AB' . $row, $idx_val_mar);
				$sheet->setCellValue('AC' . $row, $stok_qty_mar);
				$sheet->setCellValue('AD' . $row, $stok_val_mar);
				$sheet->setCellValue('AE' . $row, $qty_q1);
				$sheet->setCellValue('AF' . $row, $val_q1);
				$sheet->setCellValue('AG' . $row, $target_qty_q1);
				$sheet->setCellValue('AH' . $row, $target_val_q1);
				$sheet->setCellValue('AI' . $row, $idx_qty_q1);
				$sheet->setCellValue('AJ' . $row, $idx_val_q1);

				$sheet->setCellValue('AK' . $row, $qty_apr);
				$sheet->setCellValue('AL' . $row, $val_apr);
				$sheet->setCellValue('AM' . $row, $target_qty_apr);
				$sheet->setCellValue('AN' . $row, $target_val_apr);
				$sheet->setCellValue('AO' . $row, $idx_qty_apr);
				$sheet->setCellValue('AP' . $row, $idx_val_apr);
				$sheet->setCellValue('AQ' . $row, $stok_qty_apr);
				$sheet->setCellValue('AR' . $row, $stok_val_apr);
				$sheet->setCellValue('AS' . $row, $qty_mei);
				$sheet->setCellValue('AT' . $row, $val_mei);
				$sheet->setCellValue('AU' . $row, $target_qty_mei);
				$sheet->setCellValue('AV' . $row, $target_val_mei);
				$sheet->setCellValue('AW' . $row, $idx_qty_mei);
				$sheet->setCellValue('AX' . $row, $idx_val_mei);
				$sheet->setCellValue('AY' . $row, $stok_qty_mei);
				$sheet->setCellValue('AZ' . $row, $stok_val_mei);
				$sheet->setCellValue('BA' . $row, $qty_jun);
				$sheet->setCellValue('BB' . $row, $val_jun);
				$sheet->setCellValue('BC' . $row, $target_qty_jun);
				$sheet->setCellValue('BD' . $row, $target_val_jun);
				$sheet->setCellValue('BE' . $row, $idx_qty_jun);
				$sheet->setCellValue('BF' . $row, $idx_val_jun);
				$sheet->setCellValue('BG' . $row, $stok_qty_jun);
				$sheet->setCellValue('BH' . $row, $stok_val_jun);
				$sheet->setCellValue('BI' . $row, $qty_q2);
				$sheet->setCellValue('BJ' . $row, $val_q2);
				$sheet->setCellValue('BK' . $row, $target_qty_q2);
				$sheet->setCellValue('BL' . $row, $target_val_q2);
				$sheet->setCellValue('BM' . $row, $idx_qty_q2);
				$sheet->setCellValue('BN' . $row, $idx_val_q2);

				$sheet->setCellValue('BO' . $row, $qty_jul);
				$sheet->setCellValue('BP' . $row, $val_jul);
				$sheet->setCellValue('BQ' . $row, $target_qty_jul);
				$sheet->setCellValue('BR' . $row, $target_val_jul);
				$sheet->setCellValue('BS' . $row, $idx_qty_jul);
				$sheet->setCellValue('BT' . $row, $idx_val_jul);
				$sheet->setCellValue('BU' . $row, $stok_qty_jul);
				$sheet->setCellValue('BV' . $row, $stok_val_jul);
				$sheet->setCellValue('BW' . $row, $qty_agu);
				$sheet->setCellValue('BX' . $row, $val_agu);
				$sheet->setCellValue('BY' . $row, $target_qty_agu);
				$sheet->setCellValue('BZ' . $row, $target_val_agu);
				$sheet->setCellValue('CA' . $row, $idx_qty_agu);
				$sheet->setCellValue('CB' . $row, $idx_val_agu);
				$sheet->setCellValue('CC' . $row, $stok_qty_agu);
				$sheet->setCellValue('CD' . $row, $stok_val_agu);
				$sheet->setCellValue('CE' . $row, $qty_sep);
				$sheet->setCellValue('CF' . $row, $val_sep);
				$sheet->setCellValue('CG' . $row, $target_qty_sep);
				$sheet->setCellValue('CH' . $row, $target_val_sep);
				$sheet->setCellValue('CI' . $row, $idx_qty_sep);
				$sheet->setCellValue('CJ' . $row, $idx_val_sep);
				$sheet->setCellValue('CK' . $row, $stok_qty_sep);
				$sheet->setCellValue('CL' . $row, $stok_val_sep);
				$sheet->setCellValue('CM' . $row, $qty_q3);
				$sheet->setCellValue('CN' . $row, $val_q3);
				$sheet->setCellValue('CO' . $row, $target_qty_q3);
				$sheet->setCellValue('CP' . $row, $target_val_q3);
				$sheet->setCellValue('CQ' . $row, $idx_qty_q3);
				$sheet->setCellValue('CR' . $row, $idx_val_q3);

				$sheet->setCellValue('CS' . $row, $qty_okt);
				$sheet->setCellValue('CT' . $row, $val_okt);
				$sheet->setCellValue('CU' . $row, $target_qty_okt);
				$sheet->setCellValue('CV' . $row, $target_val_okt);
				$sheet->setCellValue('CW' . $row, $idx_qty_okt);
				$sheet->setCellValue('CX' . $row, $idx_val_okt);
				$sheet->setCellValue('CY' . $row, $stok_qty_okt);
				$sheet->setCellValue('CZ' . $row, $stok_val_okt);
				$sheet->setCellValue('DA' . $row, $qty_nop);
				$sheet->setCellValue('DB' . $row, $val_nop);
				$sheet->setCellValue('DC' . $row, $target_qty_nop);
				$sheet->setCellValue('DD' . $row, $target_val_nop);
				$sheet->setCellValue('DE' . $row, $idx_qty_nop);
				$sheet->setCellValue('DF' . $row, $idx_val_nop);
				$sheet->setCellValue('DG' . $row, $stok_qty_nop);
				$sheet->setCellValue('DH' . $row, $stok_val_nop);
				$sheet->setCellValue('DI' . $row, $qty_des);
				$sheet->setCellValue('DJ' . $row, $val_des);
				$sheet->setCellValue('DK' . $row, $target_qty_des);
				$sheet->setCellValue('DL' . $row, $target_val_des);
				$sheet->setCellValue('DM' . $row, $idx_qty_des);
				$sheet->setCellValue('DN' . $row, $idx_val_des);
				$sheet->setCellValue('DO' . $row, $stok_qty_des);
				$sheet->setCellValue('DP' . $row, $stok_val_des);
				$sheet->setCellValue('DQ' . $row, $qty_q4);
				$sheet->setCellValue('DR' . $row, $val_q4);
				$sheet->setCellValue('DS' . $row, $target_qty_q4);
				$sheet->setCellValue('DT' . $row, $target_val_q4);
				$sheet->setCellValue('DU' . $row, $idx_qty_q4);
				$sheet->setCellValue('DV' . $row, $idx_val_q4);

				$qty_year = $qty_jan + $qty_feb + $qty_mar + $qty_apr + $qty_mei + $qty_jun + $qty_jul + $qty_agu + $qty_sep + $qty_okt + $qty_nop + $qty_des;
				$target_qty_year = $target_qty_jan + $target_qty_feb + $target_qty_mar + $target_qty_apr + $target_qty_mei + $target_qty_jun + $target_qty_jul + $target_qty_agu + $target_qty_sep + $target_qty_okt + $target_qty_nop + $target_qty_des;
				$idx_qty_year = ($qty_year/($target_qty_year ?: 1))*100;
				$val_year = $val_jan + $val_feb + $val_mar + $val_apr + $val_mei + $val_jun + $val_jul + $val_agu + $val_sep + $val_okt + $val_nop + $val_des;
				$target_val_year = $target_val_jan + $target_val_feb + $target_val_mar + $target_val_apr + $target_val_mei + $target_val_jun + $target_val_jul + $target_val_agu + $target_val_sep + $target_val_okt + $target_val_nop + $target_val_des;
				$idx_val_year = ($val_year/($target_val_year ?: 1))*100;
				$qty_avg = $qty_year / 12;
				$target_qty_avg = $target_qty_year / 12;
				$idx_qty_avg = ($qty_avg/($target_qty_avg ?: 1))*100;
				$val_avg = $val_year / 12;
				$target_val_avg = $target_val_year / 12;
				$idx_val_avg = ($val_avg/($target_val_avg ?: 1))*100;

				$sheet->setCellValue('DW' . $row, $qty_year);
				$sheet->setCellValue('DX' . $row, $val_year);
				$sheet->setCellValue('DY' . $row, $target_qty_year);
				$sheet->setCellValue('DZ' . $row, $target_val_year);
				$sheet->setCellValue('EA' . $row, $idx_qty_year);
				$sheet->setCellValue('EB' . $row, $idx_val_year);
				$sheet->setCellValue('EC' . $row, $qty_avg);
				$sheet->setCellValue('ED' . $row, $val_avg);
				$sheet->setCellValue('EE' . $row, $target_qty_avg);
				$sheet->setCellValue('EF' . $row, $target_val_avg);
				$sheet->setCellValue('EG' . $row, $idx_qty_avg);
				$sheet->setCellValue('EH' . $row, $idx_val_avg);

				// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
				$sheet->getStyle('A' . $row)->applyFromArray($style_row);
				$sheet->getStyle('B' . $row)->applyFromArray($style_row);
				$sheet->getStyle('C' . $row)->applyFromArray($style_row);
				$sheet->getStyle('D' . $row)->applyFromArray($style_row);
				$sheet->getStyle('E' . $row)->applyFromArray($style_row);
				$sheet->getStyle('F' . $row)->applyFromArray($style_row);
				$sheet->getStyle('G' . $row)->applyFromArray($style_row);
				$sheet->getStyle('H' . $row)->applyFromArray($style_row);
				$sheet->getStyle('I' . $row)->applyFromArray($style_row);
				$sheet->getStyle('J' . $row)->applyFromArray($style_row);
				$sheet->getStyle('K' . $row)->applyFromArray($style_row);
				$sheet->getStyle('L' . $row)->applyFromArray($style_row);
				$sheet->getStyle('M' . $row)->applyFromArray($style_row);
				$sheet->getStyle('N' . $row)->applyFromArray($style_row);
				$sheet->getStyle('O' . $row)->applyFromArray($style_row);
				$sheet->getStyle('P' . $row)->applyFromArray($style_row);
				$sheet->getStyle('Q' . $row)->applyFromArray($style_row);
				$sheet->getStyle('R' . $row)->applyFromArray($style_row);
				$sheet->getStyle('S' . $row)->applyFromArray($style_row);
				$sheet->getStyle('T' . $row)->applyFromArray($style_row);
				$sheet->getStyle('U' . $row)->applyFromArray($style_row);
				$sheet->getStyle('V' . $row)->applyFromArray($style_row);
				$sheet->getStyle('W' . $row)->applyFromArray($style_row);
				$sheet->getStyle('X' . $row)->applyFromArray($style_row);
				$sheet->getStyle('Y' . $row)->applyFromArray($style_row);
				$sheet->getStyle('Z' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AA' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AB' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AC' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AD' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AE' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AF' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AG' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AH' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AI' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AJ' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AK' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AL' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AM' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AN' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AO' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AP' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AQ' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AR' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AS' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AT' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AU' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AV' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AW' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AX' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AY' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AZ' . $row)->applyFromArray($style_row);
				$sheet->getStyle('BA' . $row)->applyFromArray($style_row);
				$sheet->getStyle('BB' . $row)->applyFromArray($style_row);
				$sheet->getStyle('BC' . $row)->applyFromArray($style_row);
				$sheet->getStyle('BD' . $row)->applyFromArray($style_row);
				$sheet->getStyle('BE' . $row)->applyFromArray($style_row);
				$sheet->getStyle('BF' . $row)->applyFromArray($style_row);
				$sheet->getStyle('BG' . $row)->applyFromArray($style_row);
				$sheet->getStyle('BH' . $row)->applyFromArray($style_row);
				$sheet->getStyle('BI' . $row)->applyFromArray($style_row);
				$sheet->getStyle('BJ' . $row)->applyFromArray($style_row);
				$sheet->getStyle('BK' . $row)->applyFromArray($style_row);
				$sheet->getStyle('BL' . $row)->applyFromArray($style_row);
				$sheet->getStyle('BM' . $row)->applyFromArray($style_row);
				$sheet->getStyle('BN' . $row)->applyFromArray($style_row);
				$sheet->getStyle('BO' . $row)->applyFromArray($style_row);
				$sheet->getStyle('BP' . $row)->applyFromArray($style_row);
				$sheet->getStyle('BQ' . $row)->applyFromArray($style_row);
				$sheet->getStyle('BR' . $row)->applyFromArray($style_row);
				$sheet->getStyle('BS' . $row)->applyFromArray($style_row);
				$sheet->getStyle('BT' . $row)->applyFromArray($style_row);
				$sheet->getStyle('BU' . $row)->applyFromArray($style_row);
				$sheet->getStyle('BV' . $row)->applyFromArray($style_row);
				$sheet->getStyle('BW' . $row)->applyFromArray($style_row);
				$sheet->getStyle('BX' . $row)->applyFromArray($style_row);
				$sheet->getStyle('BY' . $row)->applyFromArray($style_row);
				$sheet->getStyle('BZ' . $row)->applyFromArray($style_row);
				$sheet->getStyle('CA' . $row)->applyFromArray($style_row);
				$sheet->getStyle('CB' . $row)->applyFromArray($style_row);
				$sheet->getStyle('CC' . $row)->applyFromArray($style_row);
				$sheet->getStyle('CD' . $row)->applyFromArray($style_row);
				$sheet->getStyle('CE' . $row)->applyFromArray($style_row);
				$sheet->getStyle('CF' . $row)->applyFromArray($style_row);
				$sheet->getStyle('CG' . $row)->applyFromArray($style_row);
				$sheet->getStyle('CH' . $row)->applyFromArray($style_row);
				$sheet->getStyle('CI' . $row)->applyFromArray($style_row);
				$sheet->getStyle('CJ' . $row)->applyFromArray($style_row);
				$sheet->getStyle('CK' . $row)->applyFromArray($style_row);
				$sheet->getStyle('CL' . $row)->applyFromArray($style_row);
				$sheet->getStyle('CM' . $row)->applyFromArray($style_row);
				$sheet->getStyle('CN' . $row)->applyFromArray($style_row);
				$sheet->getStyle('CO' . $row)->applyFromArray($style_row);
				$sheet->getStyle('CP' . $row)->applyFromArray($style_row);
				$sheet->getStyle('CQ' . $row)->applyFromArray($style_row);
				$sheet->getStyle('CR' . $row)->applyFromArray($style_row);
				$sheet->getStyle('CS' . $row)->applyFromArray($style_row);
				$sheet->getStyle('CT' . $row)->applyFromArray($style_row);
				$sheet->getStyle('CU' . $row)->applyFromArray($style_row);
				$sheet->getStyle('CV' . $row)->applyFromArray($style_row);
				$sheet->getStyle('CW' . $row)->applyFromArray($style_row);
				$sheet->getStyle('CX' . $row)->applyFromArray($style_row);
				$sheet->getStyle('CY' . $row)->applyFromArray($style_row);
				$sheet->getStyle('CZ' . $row)->applyFromArray($style_row);
				$sheet->getStyle('DA' . $row)->applyFromArray($style_row);
				$sheet->getStyle('DB' . $row)->applyFromArray($style_row);
				$sheet->getStyle('DC' . $row)->applyFromArray($style_row);
				$sheet->getStyle('DD' . $row)->applyFromArray($style_row);
				$sheet->getStyle('DE' . $row)->applyFromArray($style_row);
				$sheet->getStyle('DF' . $row)->applyFromArray($style_row);
				$sheet->getStyle('DG' . $row)->applyFromArray($style_row);
				$sheet->getStyle('DH' . $row)->applyFromArray($style_row);
				$sheet->getStyle('DI' . $row)->applyFromArray($style_row);
				$sheet->getStyle('DJ' . $row)->applyFromArray($style_row);
				$sheet->getStyle('DK' . $row)->applyFromArray($style_row);
				$sheet->getStyle('DL' . $row)->applyFromArray($style_row);
				$sheet->getStyle('DM' . $row)->applyFromArray($style_row);
				$sheet->getStyle('DN' . $row)->applyFromArray($style_row);
				$sheet->getStyle('DO' . $row)->applyFromArray($style_row);
				$sheet->getStyle('DP' . $row)->applyFromArray($style_row);
				$sheet->getStyle('DQ' . $row)->applyFromArray($style_row);
				$sheet->getStyle('DR' . $row)->applyFromArray($style_row);
				$sheet->getStyle('DS' . $row)->applyFromArray($style_row);
				$sheet->getStyle('DT' . $row)->applyFromArray($style_row);
				$sheet->getStyle('DU' . $row)->applyFromArray($style_row);
				$sheet->getStyle('DV' . $row)->applyFromArray($style_row);
				$sheet->getStyle('DW' . $row)->applyFromArray($style_row);
				$sheet->getStyle('DX' . $row)->applyFromArray($style_row);
				$sheet->getStyle('DY' . $row)->applyFromArray($style_row);
				$sheet->getStyle('DZ' . $row)->applyFromArray($style_row);
				$sheet->getStyle('EA' . $row)->applyFromArray($style_row);
				$sheet->getStyle('EB' . $row)->applyFromArray($style_row);
				$sheet->getStyle('EC' . $row)->applyFromArray($style_row);
				$sheet->getStyle('ED' . $row)->applyFromArray($style_row);
				$sheet->getStyle('EE' . $row)->applyFromArray($style_row);
				$sheet->getStyle('EF' . $row)->applyFromArray($style_row);
				$sheet->getStyle('EG' . $row)->applyFromArray($style_row);
				$sheet->getStyle('EH' . $row)->applyFromArray($style_row);


				$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
				$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
				$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
				$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
				$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
				$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
				$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('I' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('J' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('K' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('L' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('M' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('N' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('O' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('P' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('Q' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('R' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('S' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('T' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('U' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('V' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('W' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('X' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('Y' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('Z' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AA' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AB' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AC' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AD' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AE' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AF' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AG' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AH' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AI' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AJ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AK' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AL' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AM' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AN' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AO' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AP' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AQ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AR' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AS' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AT' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AU' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AV' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AX' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AY' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AZ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('BA' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('BB' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('BC' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('BD' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('BE' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('BF' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('BG' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('BH' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('BI' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('BJ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('BK' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('BL' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('BM' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('BN' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('BO' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('BQ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('BR' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('BS' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('BT' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('BU' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('BV' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('BW' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('BX' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('BY' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('BZ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('CA' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('CB' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('CC' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('CD' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('CE' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('CF' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('CG' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('CH' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('CI' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('CJ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('CK' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('CL' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('CM' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('CN' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('CO' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('CP' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('CQ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('CR' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('CS' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('CT' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('CU' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('CV' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('CW' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('CX' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('CY' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('CZ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('DA' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('DB' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('DC' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('DD' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('DE' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('DF' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('DG' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('DH' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('DI' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('DJ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('DK' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('DL' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('DM' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('DN' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('DO' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('DP' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('DQ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('DR' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('DS' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('DT' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('DU' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('DV' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('DW' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('DX' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('DY' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('DZ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('EA' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('EB' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('EC' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('ED' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('EE' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('EF' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('EG' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('EH' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

				$sheet->getStyle('G' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('H' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('I' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('J' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('K' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('L' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('M' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('N' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('O' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('P' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('Q' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('R' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('S' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('T' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('U' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('V' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('W' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('X' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('Y' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('Z' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('AA' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('AB' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('AC' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('AD' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('AE' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('AF' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('AG' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('AH' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('AI' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('AJ' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('AK' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('AL' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('AM' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('AN' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('AO' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('AP' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('AQ' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('AR' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('AS' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('AT' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('AU' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('AV' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('AW' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('AX' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('AY' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('AZ' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('AB' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('BB' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('BC' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('BD' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('BE' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('BF' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('BG' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('BH' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('BI' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('BJ' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('BK' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('BL' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('BM' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('BN' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('BO' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('BP' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('BQ' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('BR' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('BS' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('BT' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('BU' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('BV' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('BW' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('BX' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('BY' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('BZ' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('CA' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('CB' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('CC' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('CD' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('CE' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('CF' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('CG' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('CH' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('CI' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('CJ' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('CK' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('CL' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('CM' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('CN' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('CO' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('CP' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('CQ' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('CR' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('CS' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('CT' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('CU' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('CV' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('CW' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('CX' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('CY' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('CZ' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('DA' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('DB' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('DC' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('DD' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('DE' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('DF' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('DG' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('DH' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('DI' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('DJ' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('DK' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('DL' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('DM' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('DN' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('DO' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('DP' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('DQ' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('DR' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('DS' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('DT' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('DU' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('DW' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('DW' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('DX' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('DY' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('DZ' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('EA' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('EB' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('EC' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('ED' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('EE' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('EF' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('EG' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('EH' . $row)->getNumberFormat()->setFormatCode('#.00');
	

				$sheet->getStyle('A' . $row . ':EH' . $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');
				$sheet->getStyle('A' . $row . ':EH' . $row)->getFont()->setBold(true);

				$qty_jan = 0;
				$qty_feb = 0;
				$qty_mar = 0;
				$qty_q1 = 0;
				$qty_apr = 0;
				$qty_mei = 0;
				$qty_jun = 0;
				$qty_q2 = 0;
				$qty_jul = 0;
				$qty_agu = 0;
				$qty_sep = 0;
				$qty_q3 = 0;
				$qty_okt = 0;
				$qty_nop = 0;
				$qty_des = 0;
				$qty_q4 = 0;
				$qty_year = 0;
				$qty_avg = 0;

				$val_jan = 0;
				$val_feb = 0;
				$val_mar = 0;
				$val_q1 = 0;
				$val_apr = 0;
				$val_mei = 0;
				$val_jun = 0;
				$val_q2 = 0;
				$val_jul = 0;
				$val_agu = 0;
				$val_sep = 0;
				$val_q3 = 0;
				$val_okt = 0;
				$val_nop = 0;
				$val_des = 0;
				$val_q4 = 0;
				$val_year = 0;
				$val_avg = 0;

				$target_qty_jan = 0;
				$target_qty_feb = 0;
				$target_qty_mar = 0;
				$target_qty_q1 = 0;
				$target_qty_apr = 0;
				$target_qty_mei = 0;
				$target_qty_jun = 0;
				$target_qty_q2 = 0;
				$target_qty_jul = 0;
				$target_qty_agu = 0;
				$target_qty_sep = 0;
				$target_qty_q3 = 0;
				$target_qty_okt = 0;
				$target_qty_nop = 0;
				$target_qty_des = 0;
				$target_qty_q4 = 0;
				$target_qty_year = 0;
				$target_qty_avg = 0;

				$target_val_jan = 0;
				$target_val_feb = 0;
				$target_val_mar = 0;
				$target_val_q1 = 0;
				$target_val_apr = 0;
				$target_val_mei = 0;
				$target_val_jun = 0;
				$target_val_q2 = 0;
				$target_val_jul = 0;
				$target_val_agu = 0;
				$target_val_sep = 0;
				$target_val_q3 = 0;
				$target_val_okt = 0;
				$target_val_nop = 0;
				$target_val_des = 0;
				$target_val_q4 = 0;
				$target_val_year = 0;
				$target_val_avg = 0;

				$idx_qty_jan = 0;
				$idx_qty_feb = 0;
				$idx_qty_mar = 0;
				$idx_qty_q1 = 0;
				$idx_qty_apr = 0;
				$idx_qty_mei = 0;
				$idx_qty_jun = 0;
				$idx_qty_q2 = 0;
				$idx_qty_jul = 0;
				$idx_qty_agu = 0;
				$idx_qty_sep = 0;
				$idx_qty_q3 = 0;
				$idx_qty_okt = 0;
				$idx_qty_nop = 0;
				$idx_qty_des = 0;
				$idx_qty_q4 = 0;
				$idx_qty_year = 0;
				$idx_qty_avg = 0;

				$idx_val_jan = 0;
				$idx_val_feb = 0;
				$idx_val_mar = 0;
				$idx_val_q1 = 0;
				$idx_val_apr = 0;
				$idx_val_mei = 0;
				$idx_val_jun = 0;
				$idx_val_q2 = 0;
				$idx_val_jul = 0;
				$idx_val_agu = 0;
				$idx_val_sep = 0;
				$idx_val_q3 = 0;
				$idx_val_okt = 0;
				$idx_val_nop = 0;
				$idx_val_des = 0;
				$idx_val_q4 = 0;
				$idx_val_year = 0;
				$idx_val_avg = 0;

				$stok_qty_jan = 0;
				$stok_qty_feb = 0;
				$stok_qty_mar = 0;
				$stok_qty_q1 = 0;
				$stok_qty_apr = 0;
				$stok_qty_mei = 0;
				$stok_qty_jun = 0;
				$stok_qty_q2 = 0;
				$stok_qty_jul = 0;
				$stok_qty_agu = 0;
				$stok_qty_sep = 0;
				$stok_qty_q3 = 0;
				$stok_qty_okt = 0;
				$stok_qty_nop = 0;
				$stok_qty_des = 0;
				$stok_qty_q4 = 0;
				$stok_qty_year = 0;
				$stok_qty_avg = 0;

				$stok_val_jan = 0;
				$stok_val_feb = 0;
				$stok_val_mar = 0;
				$stok_val_q1 = 0;
				$stok_val_apr = 0;
				$stok_val_mei = 0;
				$stok_val_jun = 0;
				$stok_val_q2 = 0;
				$stok_val_jul = 0;
				$stok_val_agu = 0;
				$stok_val_sep = 0;
				$stok_val_q3 = 0;
				$stok_val_okt = 0;
				$stok_val_nop = 0;
				$stok_val_des = 0;
				$stok_val_q4 = 0;
				$stok_val_year = 0;
				$stok_val_avg = 0;

				$row++;
            }

			if ($principal != $rows['principal'] and $principal != '' )
            {
				
				$sheet->setCellValue('A' . $row, '');
				$sheet->setCellValue('B' . $row, $principal);
				$sheet->setCellValue('C' . $row, '');
				$sheet->setCellValue('D' . $row, '');
				$sheet->setCellValue('E' . $row, 'TOTAL ' . $principal);
				$sheet->setCellValue('F' . $row, '');
				$sheet->setCellValue('G' . $row, $sub_qty_jan);
				$sheet->setCellValue('H' . $row, $sub_val_jan);
				$sheet->setCellValue('I' . $row, $sub_target_qty_jan);
				$sheet->setCellValue('J' . $row, $sub_target_val_jan);
				$sheet->setCellValue('K' . $row, $sub_idx_qty_jan);
				$sheet->setCellValue('L' . $row, $sub_idx_val_jan);
				$sheet->setCellValue('M' . $row, $sub_stok_qty_jan);
				$sheet->setCellValue('N' . $row, $sub_stok_val_jan);
				$sheet->setCellValue('O' . $row, $sub_qty_feb);
				$sheet->setCellValue('P' . $row, $sub_val_feb);
				$sheet->setCellValue('Q' . $row, $sub_target_qty_feb);
				$sheet->setCellValue('R' . $row, $sub_target_val_feb);
				$sheet->setCellValue('S' . $row, $sub_idx_qty_feb);
				$sheet->setCellValue('T' . $row, $sub_idx_val_feb);
				$sheet->setCellValue('U' . $row, $sub_stok_qty_feb);
				$sheet->setCellValue('V' . $row, $sub_stok_val_feb);
				$sheet->setCellValue('W' . $row, $sub_qty_mar);
				$sheet->setCellValue('X' . $row, $sub_val_mar);
				$sheet->setCellValue('Y' . $row, $sub_target_qty_mar);
				$sheet->setCellValue('Z' . $row, $sub_target_val_mar);
				$sheet->setCellValue('AA' . $row, $sub_idx_qty_mar);
				$sheet->setCellValue('AB' . $row, $sub_idx_val_mar);
				$sheet->setCellValue('AC' . $row, $sub_stok_qty_mar);
				$sheet->setCellValue('AD' . $row, $sub_stok_val_mar);
				$sheet->setCellValue('AE' . $row, $sub_qty_q1);
				$sheet->setCellValue('AF' . $row, $sub_val_q1);
				$sheet->setCellValue('AG' . $row, $sub_target_qty_q1);
				$sheet->setCellValue('AH' . $row, $sub_target_val_q1);
				$sheet->setCellValue('AI' . $row, $sub_idx_qty_q1);
				$sheet->setCellValue('AJ' . $row, $sub_idx_val_q1);

				$sheet->setCellValue('AK' . $row, $sub_qty_apr);
				$sheet->setCellValue('AL' . $row, $sub_val_apr);
				$sheet->setCellValue('AM' . $row, $sub_target_qty_apr);
				$sheet->setCellValue('AN' . $row, $sub_target_val_apr);
				$sheet->setCellValue('AO' . $row, $sub_idx_qty_apr);
				$sheet->setCellValue('AP' . $row, $sub_idx_val_apr);
				$sheet->setCellValue('AQ' . $row, $sub_stok_qty_apr);
				$sheet->setCellValue('AR' . $row, $sub_stok_val_apr);
				$sheet->setCellValue('AS' . $row, $sub_qty_mei);
				$sheet->setCellValue('AT' . $row, $sub_val_mei);
				$sheet->setCellValue('AU' . $row, $sub_target_qty_mei);
				$sheet->setCellValue('AV' . $row, $sub_target_val_mei);
				$sheet->setCellValue('AW' . $row, $sub_idx_qty_mei);
				$sheet->setCellValue('AX' . $row, $sub_idx_val_mei);
				$sheet->setCellValue('AY' . $row, $sub_stok_qty_mei);
				$sheet->setCellValue('AZ' . $row, $sub_stok_val_mei);
				$sheet->setCellValue('BA' . $row, $sub_qty_jun);
				$sheet->setCellValue('BB' . $row, $sub_val_jun);
				$sheet->setCellValue('BC' . $row, $sub_target_qty_jun);
				$sheet->setCellValue('BD' . $row, $sub_target_val_jun);
				$sheet->setCellValue('BE' . $row, $sub_idx_qty_jun);
				$sheet->setCellValue('BF' . $row, $sub_idx_val_jun);
				$sheet->setCellValue('BG' . $row, $sub_stok_qty_jun);
				$sheet->setCellValue('BH' . $row, $sub_stok_val_jun);
				$sheet->setCellValue('BI' . $row, $sub_qty_q2);
				$sheet->setCellValue('BJ' . $row, $sub_val_q2);
				$sheet->setCellValue('BK' . $row, $sub_target_qty_q2);
				$sheet->setCellValue('BL' . $row, $sub_target_val_q2);
				$sheet->setCellValue('BM' . $row, $sub_idx_qty_q2);
				$sheet->setCellValue('BN' . $row, $sub_idx_val_q2);

				$sheet->setCellValue('BO' . $row, $sub_qty_jul);
				$sheet->setCellValue('BP' . $row, $sub_val_jul);
				$sheet->setCellValue('BQ' . $row, $sub_target_qty_jul);
				$sheet->setCellValue('BR' . $row, $sub_target_val_jul);
				$sheet->setCellValue('BS' . $row, $sub_idx_qty_jul);
				$sheet->setCellValue('BT' . $row, $sub_idx_val_jul);
				$sheet->setCellValue('BU' . $row, $sub_stok_qty_jul);
				$sheet->setCellValue('BV' . $row, $sub_stok_val_jul);
				$sheet->setCellValue('BW' . $row, $sub_qty_agu);
				$sheet->setCellValue('BX' . $row, $sub_val_agu);
				$sheet->setCellValue('BY' . $row, $sub_target_qty_agu);
				$sheet->setCellValue('BZ' . $row, $sub_target_val_agu);
				$sheet->setCellValue('CA' . $row, $sub_idx_qty_agu);
				$sheet->setCellValue('CB' . $row, $sub_idx_val_agu);
				$sheet->setCellValue('CC' . $row, $sub_stok_qty_agu);
				$sheet->setCellValue('CD' . $row, $sub_stok_val_agu);
				$sheet->setCellValue('CE' . $row, $sub_qty_sep);
				$sheet->setCellValue('CF' . $row, $sub_val_sep);
				$sheet->setCellValue('CG' . $row, $sub_target_qty_sep);
				$sheet->setCellValue('CH' . $row, $sub_target_val_sep);
				$sheet->setCellValue('CI' . $row, $sub_idx_qty_sep);
				$sheet->setCellValue('CJ' . $row, $sub_idx_val_sep);
				$sheet->setCellValue('CK' . $row, $sub_stok_qty_sep);
				$sheet->setCellValue('CL' . $row, $sub_stok_val_sep);
				$sheet->setCellValue('CM' . $row, $sub_qty_q3);
				$sheet->setCellValue('CN' . $row, $sub_val_q3);
				$sheet->setCellValue('CO' . $row, $sub_target_qty_q3);
				$sheet->setCellValue('CP' . $row, $sub_target_val_q3);
				$sheet->setCellValue('CQ' . $row, $sub_idx_qty_q3);
				$sheet->setCellValue('CR' . $row, $sub_idx_val_q3);

				$sheet->setCellValue('CS' . $row, $sub_qty_okt);
				$sheet->setCellValue('CT' . $row, $sub_val_okt);
				$sheet->setCellValue('CU' . $row, $sub_target_qty_okt);
				$sheet->setCellValue('CV' . $row, $sub_target_val_okt);
				$sheet->setCellValue('CW' . $row, $sub_idx_qty_okt);
				$sheet->setCellValue('CX' . $row, $sub_idx_val_okt);
				$sheet->setCellValue('CY' . $row, $sub_stok_qty_okt);
				$sheet->setCellValue('CZ' . $row, $sub_stok_val_okt);
				$sheet->setCellValue('DA' . $row, $sub_qty_nop);
				$sheet->setCellValue('DB' . $row, $sub_val_nop);
				$sheet->setCellValue('DC' . $row, $sub_target_qty_nop);
				$sheet->setCellValue('DD' . $row, $sub_target_val_nop);
				$sheet->setCellValue('DE' . $row, $sub_idx_qty_nop);
				$sheet->setCellValue('DF' . $row, $sub_idx_val_nop);
				$sheet->setCellValue('DG' . $row, $sub_stok_qty_nop);
				$sheet->setCellValue('DH' . $row, $sub_stok_val_nop);
				$sheet->setCellValue('DI' . $row, $sub_qty_des);
				$sheet->setCellValue('DJ' . $row, $sub_val_des);
				$sheet->setCellValue('DK' . $row, $sub_target_qty_des);
				$sheet->setCellValue('DL' . $row, $sub_target_val_des);
				$sheet->setCellValue('DM' . $row, $sub_idx_qty_des);
				$sheet->setCellValue('DN' . $row, $sub_idx_val_des);
				$sheet->setCellValue('DO' . $row, $sub_stok_qty_des);
				$sheet->setCellValue('DP' . $row, $sub_stok_val_des);
				$sheet->setCellValue('DQ' . $row, $sub_qty_q4);
				$sheet->setCellValue('DR' . $row, $sub_val_q4);
				$sheet->setCellValue('DS' . $row, $sub_target_qty_q4);
				$sheet->setCellValue('DT' . $row, $sub_target_val_q4);
				$sheet->setCellValue('DU' . $row, $sub_idx_qty_q4);
				$sheet->setCellValue('DV' . $row, $sub_idx_val_q4);

				$sub_qty_year = $sub_qty_jan + $sub_qty_feb + $sub_qty_mar + $sub_qty_apr + $sub_qty_mei + $sub_qty_jun + $sub_qty_jul + $sub_qty_agu + $sub_qty_sep + $sub_qty_okt + $sub_qty_nop + $sub_qty_des;
				$sub_target_qty_year = $sub_target_qty_jan + $sub_target_qty_feb + $sub_target_qty_mar + $sub_target_qty_apr + $sub_target_qty_mei + $sub_target_qty_jun + $sub_target_qty_jul + $sub_target_qty_agu + $sub_target_qty_sep + $sub_target_qty_okt + $sub_target_qty_nop + $sub_target_qty_des;
				$sub_idx_qty_year = ($sub_qty_year/($sub_target_qty_year ?: 1))*100;
				$sub_val_year = $sub_val_jan + $sub_val_feb + $sub_val_mar + $sub_val_apr + $sub_val_mei + $sub_val_jun + $sub_val_jul + $sub_val_agu + $sub_val_sep + $sub_val_okt + $sub_val_nop + $sub_val_des;
				$sub_target_val_year = $sub_target_val_jan + $sub_target_val_feb + $sub_target_val_mar + $sub_target_val_apr + $sub_target_val_mei + $sub_target_val_jun + $sub_target_val_jul + $sub_target_val_agu + $sub_target_val_sep + $sub_target_val_okt + $sub_target_val_nop + $sub_target_val_des;
				$sub_idx_val_year = ($sub_val_year/($sub_target_val_year ?: 1))*100;
				$sub_qty_avg = $sub_qty_year / 12;
				$sub_target_qty_avg = $sub_target_qty_year / 12;
				$sub_idx_qty_avg = ($sub_qty_avg/($sub_target_qty_avg ?: 1))*100;
				$sub_val_avg = $sub_val_year / 12;
				$sub_target_val_avg = $sub_target_val_year / 12;
				$sub_idx_val_avg = ($sub_val_avg/($sub_target_val_avg ?: 1))*100;

				$sheet->setCellValue('DW' . $row, $sub_qty_year);
				$sheet->setCellValue('DX' . $row, $sub_val_year);
				$sheet->setCellValue('DY' . $row, $sub_target_qty_year);
				$sheet->setCellValue('DZ' . $row, $sub_target_val_year);
				$sheet->setCellValue('EA' . $row, $sub_idx_qty_year);
				$sheet->setCellValue('EB' . $row, $sub_idx_val_year);
				$sheet->setCellValue('EC' . $row, $sub_qty_avg);
				$sheet->setCellValue('ED' . $row, $sub_val_avg);
				$sheet->setCellValue('EE' . $row, $sub_target_qty_avg);
				$sheet->setCellValue('EF' . $row, $sub_target_val_avg);
				$sheet->setCellValue('EG' . $row, $sub_idx_qty_avg);
				$sheet->setCellValue('EH' . $row, $sub_idx_val_avg);

				// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
				$sheet->getStyle('A' . $row)->applyFromArray($style_row);
				$sheet->getStyle('B' . $row)->applyFromArray($style_row);
				$sheet->getStyle('C' . $row)->applyFromArray($style_row);
				$sheet->getStyle('D' . $row)->applyFromArray($style_row);
				$sheet->getStyle('E' . $row)->applyFromArray($style_row);
				$sheet->getStyle('F' . $row)->applyFromArray($style_row);
				$sheet->getStyle('G' . $row)->applyFromArray($style_row);
				$sheet->getStyle('H' . $row)->applyFromArray($style_row);
				$sheet->getStyle('I' . $row)->applyFromArray($style_row);
				$sheet->getStyle('J' . $row)->applyFromArray($style_row);
				$sheet->getStyle('K' . $row)->applyFromArray($style_row);
				$sheet->getStyle('L' . $row)->applyFromArray($style_row);
				$sheet->getStyle('M' . $row)->applyFromArray($style_row);
				$sheet->getStyle('N' . $row)->applyFromArray($style_row);
				$sheet->getStyle('O' . $row)->applyFromArray($style_row);
				$sheet->getStyle('P' . $row)->applyFromArray($style_row);
				$sheet->getStyle('Q' . $row)->applyFromArray($style_row);
				$sheet->getStyle('R' . $row)->applyFromArray($style_row);
				$sheet->getStyle('S' . $row)->applyFromArray($style_row);
				$sheet->getStyle('T' . $row)->applyFromArray($style_row);
				$sheet->getStyle('U' . $row)->applyFromArray($style_row);
				$sheet->getStyle('V' . $row)->applyFromArray($style_row);
				$sheet->getStyle('W' . $row)->applyFromArray($style_row);
				$sheet->getStyle('X' . $row)->applyFromArray($style_row);
				$sheet->getStyle('Y' . $row)->applyFromArray($style_row);
				$sheet->getStyle('Z' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AA' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AB' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AC' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AD' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AE' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AF' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AG' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AH' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AI' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AJ' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AK' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AL' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AM' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AN' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AO' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AP' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AQ' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AR' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AS' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AT' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AU' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AV' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AW' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AX' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AY' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AZ' . $row)->applyFromArray($style_row);
				$sheet->getStyle('BA' . $row)->applyFromArray($style_row);
				$sheet->getStyle('BB' . $row)->applyFromArray($style_row);
				$sheet->getStyle('BC' . $row)->applyFromArray($style_row);
				$sheet->getStyle('BD' . $row)->applyFromArray($style_row);
				$sheet->getStyle('BE' . $row)->applyFromArray($style_row);
				$sheet->getStyle('BF' . $row)->applyFromArray($style_row);
				$sheet->getStyle('BG' . $row)->applyFromArray($style_row);
				$sheet->getStyle('BH' . $row)->applyFromArray($style_row);
				$sheet->getStyle('BI' . $row)->applyFromArray($style_row);
				$sheet->getStyle('BJ' . $row)->applyFromArray($style_row);
				$sheet->getStyle('BK' . $row)->applyFromArray($style_row);
				$sheet->getStyle('BL' . $row)->applyFromArray($style_row);
				$sheet->getStyle('BM' . $row)->applyFromArray($style_row);
				$sheet->getStyle('BN' . $row)->applyFromArray($style_row);
				$sheet->getStyle('BO' . $row)->applyFromArray($style_row);
				$sheet->getStyle('BP' . $row)->applyFromArray($style_row);
				$sheet->getStyle('BQ' . $row)->applyFromArray($style_row);
				$sheet->getStyle('BR' . $row)->applyFromArray($style_row);
				$sheet->getStyle('BS' . $row)->applyFromArray($style_row);
				$sheet->getStyle('BT' . $row)->applyFromArray($style_row);
				$sheet->getStyle('BU' . $row)->applyFromArray($style_row);
				$sheet->getStyle('BV' . $row)->applyFromArray($style_row);
				$sheet->getStyle('BW' . $row)->applyFromArray($style_row);
				$sheet->getStyle('BX' . $row)->applyFromArray($style_row);
				$sheet->getStyle('BY' . $row)->applyFromArray($style_row);
				$sheet->getStyle('BZ' . $row)->applyFromArray($style_row);
				$sheet->getStyle('CA' . $row)->applyFromArray($style_row);
				$sheet->getStyle('CB' . $row)->applyFromArray($style_row);
				$sheet->getStyle('CC' . $row)->applyFromArray($style_row);
				$sheet->getStyle('CD' . $row)->applyFromArray($style_row);
				$sheet->getStyle('CE' . $row)->applyFromArray($style_row);
				$sheet->getStyle('CF' . $row)->applyFromArray($style_row);
				$sheet->getStyle('CG' . $row)->applyFromArray($style_row);
				$sheet->getStyle('CH' . $row)->applyFromArray($style_row);
				$sheet->getStyle('CI' . $row)->applyFromArray($style_row);
				$sheet->getStyle('CJ' . $row)->applyFromArray($style_row);
				$sheet->getStyle('CK' . $row)->applyFromArray($style_row);
				$sheet->getStyle('CL' . $row)->applyFromArray($style_row);
				$sheet->getStyle('CM' . $row)->applyFromArray($style_row);
				$sheet->getStyle('CN' . $row)->applyFromArray($style_row);
				$sheet->getStyle('CO' . $row)->applyFromArray($style_row);
				$sheet->getStyle('CP' . $row)->applyFromArray($style_row);
				$sheet->getStyle('CQ' . $row)->applyFromArray($style_row);
				$sheet->getStyle('CR' . $row)->applyFromArray($style_row);
				$sheet->getStyle('CS' . $row)->applyFromArray($style_row);
				$sheet->getStyle('CT' . $row)->applyFromArray($style_row);
				$sheet->getStyle('CU' . $row)->applyFromArray($style_row);
				$sheet->getStyle('CV' . $row)->applyFromArray($style_row);
				$sheet->getStyle('CW' . $row)->applyFromArray($style_row);
				$sheet->getStyle('CX' . $row)->applyFromArray($style_row);
				$sheet->getStyle('CY' . $row)->applyFromArray($style_row);
				$sheet->getStyle('CZ' . $row)->applyFromArray($style_row);
				$sheet->getStyle('DA' . $row)->applyFromArray($style_row);
				$sheet->getStyle('DB' . $row)->applyFromArray($style_row);
				$sheet->getStyle('DC' . $row)->applyFromArray($style_row);
				$sheet->getStyle('DD' . $row)->applyFromArray($style_row);
				$sheet->getStyle('DE' . $row)->applyFromArray($style_row);
				$sheet->getStyle('DF' . $row)->applyFromArray($style_row);
				$sheet->getStyle('DG' . $row)->applyFromArray($style_row);
				$sheet->getStyle('DH' . $row)->applyFromArray($style_row);
				$sheet->getStyle('DI' . $row)->applyFromArray($style_row);
				$sheet->getStyle('DJ' . $row)->applyFromArray($style_row);
				$sheet->getStyle('DK' . $row)->applyFromArray($style_row);
				$sheet->getStyle('DL' . $row)->applyFromArray($style_row);
				$sheet->getStyle('DM' . $row)->applyFromArray($style_row);
				$sheet->getStyle('DN' . $row)->applyFromArray($style_row);
				$sheet->getStyle('DO' . $row)->applyFromArray($style_row);
				$sheet->getStyle('DP' . $row)->applyFromArray($style_row);
				$sheet->getStyle('DQ' . $row)->applyFromArray($style_row);
				$sheet->getStyle('DR' . $row)->applyFromArray($style_row);
				$sheet->getStyle('DS' . $row)->applyFromArray($style_row);
				$sheet->getStyle('DT' . $row)->applyFromArray($style_row);
				$sheet->getStyle('DU' . $row)->applyFromArray($style_row);
				$sheet->getStyle('DV' . $row)->applyFromArray($style_row);
				$sheet->getStyle('DW' . $row)->applyFromArray($style_row);
				$sheet->getStyle('DX' . $row)->applyFromArray($style_row);
				$sheet->getStyle('DY' . $row)->applyFromArray($style_row);
				$sheet->getStyle('DZ' . $row)->applyFromArray($style_row);
				$sheet->getStyle('EA' . $row)->applyFromArray($style_row);
				$sheet->getStyle('EB' . $row)->applyFromArray($style_row);
				$sheet->getStyle('EC' . $row)->applyFromArray($style_row);
				$sheet->getStyle('ED' . $row)->applyFromArray($style_row);
				$sheet->getStyle('EE' . $row)->applyFromArray($style_row);
				$sheet->getStyle('EF' . $row)->applyFromArray($style_row);
				$sheet->getStyle('EG' . $row)->applyFromArray($style_row);
				$sheet->getStyle('EH' . $row)->applyFromArray($style_row);


				$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
				$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
				$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
				$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
				$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
				$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
				$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('I' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('J' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('K' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('L' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('M' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('N' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('O' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('P' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('Q' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('R' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('S' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('T' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('U' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('V' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('W' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('X' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('Y' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('Z' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AA' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AB' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AC' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AD' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AE' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AF' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AG' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AH' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AI' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AJ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AK' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AL' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AM' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AN' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AO' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AP' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AQ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AR' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AS' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AT' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AU' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AV' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AX' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AY' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AZ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('BA' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('BB' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('BC' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('BD' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('BE' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('BF' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('BG' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('BH' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('BI' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('BJ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('BK' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('BL' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('BM' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('BN' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('BO' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('BQ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('BR' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('BS' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('BT' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('BU' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('BV' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('BW' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('BX' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('BY' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('BZ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('CA' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('CB' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('CC' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('CD' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('CE' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('CF' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('CG' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('CH' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('CI' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('CJ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('CK' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('CL' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('CM' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('CN' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('CO' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('CP' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('CQ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('CR' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('CS' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('CT' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('CU' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('CV' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('CW' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('CX' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('CY' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('CZ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('DA' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('DB' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('DC' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('DD' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('DE' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('DF' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('DG' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('DH' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('DI' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('DJ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('DK' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('DL' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('DM' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('DN' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('DO' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('DP' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('DQ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('DR' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('DS' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('DT' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('DU' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('DV' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('DW' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('DX' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('DY' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('DZ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('EA' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('EB' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('EC' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('ED' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('EE' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('EF' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('EG' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('EH' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

				$sheet->getStyle('G' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('H' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('I' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('J' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('K' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('L' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('M' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('N' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('O' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('P' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('Q' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('R' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('S' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('T' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('U' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('V' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('W' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('X' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('Y' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('Z' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('AA' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('AB' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('AC' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('AD' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('AE' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('AF' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('AG' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('AH' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('AI' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('AJ' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('AK' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('AL' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('AM' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('AN' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('AO' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('AP' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('AQ' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('AR' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('AS' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('AT' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('AU' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('AV' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('AW' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('AX' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('AY' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('AZ' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('AB' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('BB' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('BC' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('BD' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('BE' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('BF' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('BG' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('BH' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('BI' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('BJ' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('BK' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('BL' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('BM' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('BN' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('BO' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('BP' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('BQ' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('BR' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('BS' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('BT' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('BU' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('BV' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('BW' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('BX' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('BY' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('BZ' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('CA' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('CB' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('CC' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('CD' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('CE' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('CF' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('CG' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('CH' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('CI' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('CJ' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('CK' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('CL' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('CM' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('CN' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('CO' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('CP' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('CQ' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('CR' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('CS' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('CT' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('CU' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('CV' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('CW' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('CX' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('CY' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('CZ' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('DA' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('DB' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('DC' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('DD' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('DE' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('DF' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('DG' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('DH' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('DI' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('DJ' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('DK' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('DL' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('DM' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('DN' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('DO' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('DP' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('DQ' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('DR' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('DS' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('DT' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('DU' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('DW' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('DW' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('DX' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('DY' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('DZ' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('EA' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('EB' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('EC' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('ED' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('EE' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('EF' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
				$sheet->getStyle('EG' . $row)->getNumberFormat()->setFormatCode('#.00');
				$sheet->getStyle('EH' . $row)->getNumberFormat()->setFormatCode('#.00');

				$sheet->getStyle('A' . $row . ':EH' . $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFA07A');
				$sheet->getStyle('A' . $row . ':EH' . $row)->getFont()->setBold(true);

				$sub_qty_jan = 0;
				$sub_qty_feb = 0;
				$sub_qty_mar = 0;
				$sub_qty_q1 = 0;
				$sub_qty_apr = 0;
				$sub_qty_mei = 0;
				$sub_qty_jun = 0;
				$sub_qty_q2 = 0;
				$sub_qty_jul = 0;
				$sub_qty_agu = 0;
				$sub_qty_sep = 0;
				$sub_qty_q3 = 0;
				$sub_qty_okt = 0;
				$sub_qty_nop = 0;
				$sub_qty_des = 0;
				$sub_qty_q4 = 0;
				$sub_qty_year = 0;
				$sub_qty_avg = 0;

				$sub_val_jan = 0;
				$sub_val_feb = 0;
				$sub_val_mar = 0;
				$sub_val_q1 = 0;
				$sub_val_apr = 0;
				$sub_val_mei = 0;
				$sub_val_jun = 0;
				$sub_val_q2 = 0;
				$sub_val_jul = 0;
				$sub_val_agu = 0;
				$sub_val_sep = 0;
				$sub_val_q3 = 0;
				$sub_val_okt = 0;
				$sub_val_nop = 0;
				$sub_val_des = 0;
				$sub_val_q4 = 0;
				$sub_val_year = 0;
				$sub_val_avg = 0;

				$sub_target_qty_jan = 0;
				$sub_target_qty_feb = 0;
				$sub_target_qty_mar = 0;
				$sub_target_qty_q1 = 0;
				$sub_target_qty_apr = 0;
				$sub_target_qty_mei = 0;
				$sub_target_qty_jun = 0;
				$sub_target_qty_q2 = 0;
				$sub_target_qty_jul = 0;
				$sub_target_qty_agu = 0;
				$sub_target_qty_sep = 0;
				$sub_target_qty_q3 = 0;
				$sub_target_qty_okt = 0;
				$sub_target_qty_nop = 0;
				$sub_target_qty_des = 0;
				$sub_target_qty_q4 = 0;
				$sub_target_qty_year = 0;
				$sub_target_qty_avg = 0;

				$sub_target_val_jan = 0;
				$sub_target_val_feb = 0;
				$sub_target_val_mar = 0;
				$sub_target_val_q1 = 0;
				$sub_target_val_apr = 0;
				$sub_target_val_mei = 0;
				$sub_target_val_jun = 0;
				$sub_target_val_q2 = 0;
				$sub_target_val_jul = 0;
				$sub_target_val_agu = 0;
				$sub_target_val_sep = 0;
				$sub_target_val_q3 = 0;
				$sub_target_val_okt = 0;
				$sub_target_val_nop = 0;
				$sub_target_val_des = 0;
				$sub_target_val_q4 = 0;
				$sub_target_val_year = 0;
				$sub_target_val_avg = 0;

				$sub_idx_qty_jan = 0;
				$sub_idx_qty_feb = 0;
				$sub_idx_qty_mar = 0;
				$sub_idx_qty_q1 = 0;
				$sub_idx_qty_apr = 0;
				$sub_idx_qty_mei = 0;
				$sub_idx_qty_jun = 0;
				$sub_idx_qty_q2 = 0;
				$sub_idx_qty_jul = 0;
				$sub_idx_qty_agu = 0;
				$sub_idx_qty_sep = 0;
				$sub_idx_qty_q3 = 0;
				$sub_idx_qty_okt = 0;
				$sub_idx_qty_nop = 0;
				$sub_idx_qty_des = 0;
				$sub_idx_qty_q4 = 0;
				$sub_idx_qty_year = 0;
				$sub_idx_qty_avg = 0;

				$sub_idx_val_jan = 0;
				$sub_idx_val_feb = 0;
				$sub_idx_val_mar = 0;
				$sub_idx_val_q1 = 0;
				$sub_idx_val_apr = 0;
				$sub_idx_val_mei = 0;
				$sub_idx_val_jun = 0;
				$sub_idx_val_q2 = 0;
				$sub_idx_val_jul = 0;
				$sub_idx_val_agu = 0;
				$sub_idx_val_sep = 0;
				$sub_idx_val_q3 = 0;
				$sub_idx_val_okt = 0;
				$sub_idx_val_nop = 0;
				$sub_idx_val_des = 0;
				$sub_idx_val_q4 = 0;
				$sub_idx_val_year = 0;
				$sub_idx_val_avg = 0;

				$sub_stok_qty_jan = 0;
				$sub_stok_qty_feb = 0;
				$sub_stok_qty_mar = 0;
				$sub_stok_qty_q1 = 0;
				$sub_stok_qty_apr = 0;
				$sub_stok_qty_mei = 0;
				$sub_stok_qty_jun = 0;
				$sub_stok_qty_q2 = 0;
				$sub_stok_qty_jul = 0;
				$sub_stok_qty_agu = 0;
				$sub_stok_qty_sep = 0;
				$sub_stok_qty_q3 = 0;
				$sub_stok_qty_okt = 0;
				$sub_stok_qty_nop = 0;
				$sub_stok_qty_des = 0;
				$sub_stok_qty_q4 = 0;
				$sub_stok_qty_year = 0;
				$sub_stok_qty_avg = 0;

				$sub_stok_val_jan = 0;
				$sub_stok_val_feb = 0;
				$sub_stok_val_mar = 0;
				$sub_stok_val_q1 = 0;
				$sub_stok_val_apr = 0;
				$sub_stok_val_mei = 0;
				$sub_stok_val_jun = 0;
				$sub_stok_val_q2 = 0;
				$sub_stok_val_jul = 0;
				$sub_stok_val_agu = 0;
				$sub_stok_val_sep = 0;
				$sub_stok_val_q3 = 0;
				$sub_stok_val_okt = 0;
				$sub_stok_val_nop = 0;
				$sub_stok_val_des = 0;
				$sub_stok_val_q4 = 0;
				$sub_stok_val_year = 0;
				$sub_stok_val_avg = 0;

				$row++;
            }

			$sheet->setCellValue('A' . $row, $no);
    		$sheet->setCellValue('B' . $row, $rows['principal']);
			$sheet->setCellValue('C' . $row, $rows['item_group']);
			$sheet->setCellValue('D' . $row, $rows['item_code']);
			$sheet->setCellValue('E' . $row, $rows['item_name']);
			$sheet->setCellValue('F' . $row, $rows['unit']);

			$sheet->setCellValue('G' . $row, $rows['qty_jan'], 0);
			$sheet->setCellValue('H' . $row, $rows['value_jan'], 2);
			$sheet->setCellValue('I' . $row, $rows['target_qty_jan']);
			$sheet->setCellValue('J' . $row, $rows['target_val_jan']);
			$sheet->setCellValue('K' . $row, $rows['idx_qty_jan']);
			$sheet->setCellValue('L' . $row, $rows['idx_val_jan']);
			$sheet->setCellValue('M' . $row, $rows['stok_qty_jan']);
			$sheet->setCellValue('N' . $row, $rows['stok_val_jan']);
			$sheet->setCellValue('O' . $row, $rows['qty_feb']);
			$sheet->setCellValue('P' . $row, $rows['value_feb']);
			$sheet->setCellValue('Q' . $row, $rows['target_qty_feb']);
			$sheet->setCellValue('R' . $row, $rows['target_val_feb']);
			$sheet->setCellValue('S' . $row, $rows['idx_qty_feb']);
			$sheet->setCellValue('T' . $row, $rows['idx_val_feb']);
			$sheet->setCellValue('U' . $row, $rows['stok_qty_feb']);
			$sheet->setCellValue('V' . $row, $rows['stok_val_feb']);
			$sheet->setCellValue('W' . $row, $rows['qty_mar']);
			$sheet->setCellValue('X' . $row, $rows['value_mar']);
			$sheet->setCellValue('Y' . $row, $rows['target_qty_mar']);
			$sheet->setCellValue('Z' . $row, $rows['target_val_mar']);
			$sheet->setCellValue('AA' . $row, $rows['idx_qty_mar']);
			$sheet->setCellValue('AB' . $row, $rows['idx_val_mar']);
			$sheet->setCellValue('AC' . $row, $rows['stok_qty_mar']);
			$sheet->setCellValue('AD' . $row, $rows['stok_val_mar']);
			$sheet->setCellValue('AE' . $row, $rows['qty_q1']);
			$sheet->setCellValue('AF' . $row, $rows['value_q1']);
			$sheet->setCellValue('AG' . $row, $rows['target_qty_q1']);
			$sheet->setCellValue('AH' . $row, $rows['target_value_q1']);
			$sheet->setCellValue('AI' . $row, $rows['idx_qty_q1']);
			$sheet->setCellValue('AJ' . $row, $rows['idx_val_q1']);

			$sheet->setCellValue('AK' . $row, $rows['qty_apr']);
			$sheet->setCellValue('AL' . $row, $rows['value_apr']);
			$sheet->setCellValue('AM' . $row, $rows['target_qty_apr']);
			$sheet->setCellValue('AN' . $row, $rows['target_val_apr']);
			$sheet->setCellValue('AO' . $row, $rows['idx_qty_apr']);
			$sheet->setCellValue('AP' . $row, $rows['idx_val_apr']);
			$sheet->setCellValue('AQ' . $row, $rows['stok_qty_apr']);
			$sheet->setCellValue('AR' . $row, $rows['stok_val_apr']);
			$sheet->setCellValue('AS' . $row, $rows['qty_mei']);
			$sheet->setCellValue('AT' . $row, $rows['value_mei']);
			$sheet->setCellValue('AU' . $row, $rows['target_qty_mei']);
			$sheet->setCellValue('AV' . $row, $rows['target_val_mei']);
			$sheet->setCellValue('AW' . $row, $rows['idx_qty_mei']);
			$sheet->setCellValue('AX' . $row, $rows['idx_val_mei']);
			$sheet->setCellValue('AY' . $row, $rows['stok_qty_mei']);
			$sheet->setCellValue('AZ' . $row, $rows['stok_val_mei']);
			$sheet->setCellValue('BA' . $row, $rows['qty_jun']);
			$sheet->setCellValue('BB' . $row, $rows['value_jun']);
			$sheet->setCellValue('BC' . $row, $rows['target_qty_jun']);
			$sheet->setCellValue('BD' . $row, $rows['target_val_jun']);
			$sheet->setCellValue('BE' . $row, $rows['idx_qty_jun']);
			$sheet->setCellValue('BF' . $row, $rows['idx_val_jun']);
			$sheet->setCellValue('BG' . $row, $rows['stok_qty_jun']);
			$sheet->setCellValue('BH' . $row, $rows['stok_val_jun']);
			$sheet->setCellValue('BI' . $row, $rows['qty_q2']);
			$sheet->setCellValue('BJ' . $row, $rows['value_q2']);
			$sheet->setCellValue('BK' . $row, $rows['target_qty_q2']);
			$sheet->setCellValue('BL' . $row, $rows['target_value_q2']);
			$sheet->setCellValue('BM' . $row, $rows['idx_qty_q2']);
			$sheet->setCellValue('BN' . $row, $rows['idx_val_q2']);

			$sheet->setCellValue('BO' . $row, $rows['qty_jul']);
			$sheet->setCellValue('BP' . $row, $rows['value_jul']);
			$sheet->setCellValue('BQ' . $row, $rows['target_qty_jul']);
			$sheet->setCellValue('BR' . $row, $rows['target_val_jul']);
			$sheet->setCellValue('BS' . $row, $rows['idx_qty_jul']);
			$sheet->setCellValue('BT' . $row, $rows['idx_val_jul']);
			$sheet->setCellValue('BU' . $row, $rows['stok_qty_jul']);
			$sheet->setCellValue('BV' . $row, $rows['stok_val_jul']);
			$sheet->setCellValue('BW' . $row, $rows['qty_agu']);
			$sheet->setCellValue('BX' . $row, $rows['value_agu']);
			$sheet->setCellValue('BY' . $row, $rows['target_qty_agu']);
			$sheet->setCellValue('BZ' . $row, $rows['target_val_agu']);
			$sheet->setCellValue('CA' . $row, $rows['idx_qty_agu']);
			$sheet->setCellValue('CB' . $row, $rows['idx_val_agu']);
			$sheet->setCellValue('CC' . $row, $rows['stok_qty_agu']);
			$sheet->setCellValue('CD' . $row, $rows['stok_val_agu']);
			$sheet->setCellValue('CE' . $row, $rows['qty_sep']);
			$sheet->setCellValue('CF' . $row, $rows['value_sep']);
			$sheet->setCellValue('CG' . $row, $rows['target_qty_sep']);
			$sheet->setCellValue('CH' . $row, $rows['target_val_sep']);
			$sheet->setCellValue('CI' . $row, $rows['idx_qty_sep']);
			$sheet->setCellValue('CJ' . $row, $rows['idx_val_sep']);
			$sheet->setCellValue('CK' . $row, $rows['stok_qty_sep']);
			$sheet->setCellValue('CL' . $row, $rows['stok_val_sep']);
			$sheet->setCellValue('CM' . $row, $rows['qty_q3']);
			$sheet->setCellValue('CN' . $row, $rows['value_q3']);
			$sheet->setCellValue('CO' . $row, $rows['target_qty_q3']);
			$sheet->setCellValue('CP' . $row, $rows['target_value_q3']);
			$sheet->setCellValue('CQ' . $row, $rows['idx_qty_q3']);
			$sheet->setCellValue('CR' . $row, $rows['idx_val_q3']);

			$sheet->setCellValue('CS' . $row, $rows['qty_okt']);
			$sheet->setCellValue('CT' . $row, $rows['value_okt']);
			$sheet->setCellValue('CU' . $row, $rows['target_qty_okt']);
			$sheet->setCellValue('CV' . $row, $rows['target_val_okt']);
			$sheet->setCellValue('CW' . $row, $rows['idx_qty_okt']);
			$sheet->setCellValue('CX' . $row, $rows['idx_val_okt']);
			$sheet->setCellValue('CY' . $row, $rows['stok_qty_okt']);
			$sheet->setCellValue('CZ' . $row, $rows['stok_val_okt']);
			$sheet->setCellValue('DA' . $row, $rows['qty_nop']);
			$sheet->setCellValue('DB' . $row, $rows['value_nop']);
			$sheet->setCellValue('DC' . $row, $rows['target_qty_nop']);
			$sheet->setCellValue('DD' . $row, $rows['target_val_nop']);
			$sheet->setCellValue('DE' . $row, $rows['idx_qty_nop']);
			$sheet->setCellValue('DF' . $row, $rows['idx_val_nop']);
			$sheet->setCellValue('DG' . $row, $rows['stok_qty_nop']);
			$sheet->setCellValue('DH' . $row, $rows['stok_val_nop']);
			$sheet->setCellValue('DI' . $row, $rows['qty_des']);
			$sheet->setCellValue('DJ' . $row, $rows['value_des']);
			$sheet->setCellValue('DK' . $row, $rows['target_qty_des']);
			$sheet->setCellValue('DL' . $row, $rows['target_val_des']);
			$sheet->setCellValue('DM' . $row, $rows['idx_qty_des']);
			$sheet->setCellValue('DN' . $row, $rows['idx_val_des']);
			$sheet->setCellValue('DO' . $row, $rows['stok_qty_des']);
			$sheet->setCellValue('DP' . $row, $rows['stok_val_des']);
			$sheet->setCellValue('DQ' . $row, $rows['qty_q4']);
			$sheet->setCellValue('DR' . $row, $rows['value_q4']);
			$sheet->setCellValue('DS' . $row, $rows['target_qty_q4']);
			$sheet->setCellValue('DT' . $row, $rows['target_value_q4']);
			$sheet->setCellValue('DU' . $row, $rows['idx_qty_q4']);
			$sheet->setCellValue('DV' . $row, $rows['idx_val_q4']);

			$qty_year = $rows['qty_jan'] + $rows['qty_feb'] + $rows['qty_mar'] + $rows['qty_apr'] + $rows['qty_mei'] + $rows['qty_jun'] + $rows['qty_jul'] + $rows['qty_agu'] + $rows['qty_sep'] + $rows['qty_okt'] + $rows['qty_nop'] + $rows['qty_des'];
			$target_qty_year = $rows['target_qty_jan'] + $rows['target_qty_feb'] + $rows['target_qty_mar'] + $rows['target_qty_apr'] + $rows['target_qty_mei'] + $rows['target_qty_jun'] + $rows['target_qty_jul'] + $rows['target_qty_agu'] + $rows['target_qty_sep'] + $rows['target_qty_okt'] + $rows['target_qty_nop'] + $rows['target_qty_des'];
			$idx_qty_year = ($qty_year/($target_qty_year ?: 1))*100;
			$val_year = $rows['value_jan'] + $rows['value_feb'] + $rows['value_mar'] + $rows['value_apr'] + $rows['value_mei'] + $rows['value_jun'] + $rows['value_jul'] + $rows['value_agu'] + $rows['value_sep'] + $rows['value_okt'] + $rows['value_nop'] + $rows['value_des'];
			$target_val_year = $rows['target_val_jan'] + $rows['target_val_feb'] + $rows['target_val_mar'] + $rows['target_val_apr'] + $rows['target_val_mei'] + $rows['target_val_jun'] + $rows['target_val_jul'] + $rows['target_val_agu'] + $rows['target_val_sep'] + $rows['target_val_okt'] + $rows['target_val_nop'] + $rows['target_val_des'];
			$idx_val_year = ($val_year/($target_val_year ?: 1))*100;
			$qty_avg = $qty_year / 12;
			$target_qty_avg = $target_qty_year / 12;
			$idx_qty_avg = ($qty_avg/($target_qty_avg ?: 1))*100;
			$val_avg = $val_year / 12;
			$target_val_avg = $target_val_year / 12;
			$idx_val_avg = ($val_avg/($target_val_avg ?: 1))*100;

			/* $qty_year = $qty_jan + $qty_feb + $qty_mar + $qty_apr + $qty_mei + $qty_jun + $qty_jul + $qty_agu + $qty_sep + $qty_okt + $qty_nop + $qty_des;
			$target_qty_year = $target_qty_jan + $target_qty_feb + $target_qty_mar + $target_qty_apr + $target_qty_mei + $target_qty_jun + $target_qty_jul + $target_qty_agu + $target_qty_sep + $target_qty_okt + $target_qty_nop + $target_qty_des;
			$idx_qty_year = ($qty_year/($target_qty_year ?: 1))*100;
			$val_year = $val_jan + $val_feb + $val_mar + $val_apr + $val_mei + $val_jun + $val_jul + $val_agu + $val_sep + $val_okt + $val_nop + $val_des;
			$target_val_year = $target_val_jan + $target_val_feb + $target_val_mar + $target_val_apr + $target_val_mei + $target_val_jun + $target_val_jul + $target_val_agu + $target_val_sep + $target_val_okt + $target_val_nop + $target_val_des;
			$idx_val_year = ($val_year/($target_val_year ?: 1))*100;
			$qty_avg = $qty_year / 12;
			$target_qty_avg = $target_qty_year / 12;
			$idx_qty_avg = ($qty_avg/($target_qty_avg ?: 1))*100;
			$val_avg = $val_year / 12;
			$target_val_avg = $target_val_year / 12;
			$idx_val_avg = ($val_avg/($target_val_avg ?: 1))*100; */

			$sheet->setCellValue('DW' . $row, $qty_year);
			$sheet->setCellValue('DX' . $row, $val_year);
			$sheet->setCellValue('DY' . $row, $target_qty_year);
			$sheet->setCellValue('DZ' . $row, $target_val_year);
			$sheet->setCellValue('EA' . $row, $idx_qty_year);
			$sheet->setCellValue('EB' . $row, $idx_val_year);
			$sheet->setCellValue('EC' . $row, $qty_avg);
			$sheet->setCellValue('ED' . $row, $val_avg);
			$sheet->setCellValue('EE' . $row, $target_qty_avg);
			$sheet->setCellValue('EF' . $row, $target_val_avg);
			$sheet->setCellValue('EG' . $row, $idx_qty_avg);
			$sheet->setCellValue('EH' . $row, $idx_val_avg);

			// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
			$sheet->getStyle('A' . $row)->applyFromArray($style_row);
			$sheet->getStyle('B' . $row)->applyFromArray($style_row);
			$sheet->getStyle('C' . $row)->applyFromArray($style_row);
			$sheet->getStyle('D' . $row)->applyFromArray($style_row);
			$sheet->getStyle('E' . $row)->applyFromArray($style_row);
			$sheet->getStyle('F' . $row)->applyFromArray($style_row);
			$sheet->getStyle('G' . $row)->applyFromArray($style_row);
			$sheet->getStyle('H' . $row)->applyFromArray($style_row);
			$sheet->getStyle('I' . $row)->applyFromArray($style_row);
			$sheet->getStyle('J' . $row)->applyFromArray($style_row);
			$sheet->getStyle('K' . $row)->applyFromArray($style_row);
			$sheet->getStyle('L' . $row)->applyFromArray($style_row);
			$sheet->getStyle('M' . $row)->applyFromArray($style_row);
			$sheet->getStyle('N' . $row)->applyFromArray($style_row);
			$sheet->getStyle('O' . $row)->applyFromArray($style_row);
			$sheet->getStyle('P' . $row)->applyFromArray($style_row);
			$sheet->getStyle('Q' . $row)->applyFromArray($style_row);
			$sheet->getStyle('R' . $row)->applyFromArray($style_row);
			$sheet->getStyle('S' . $row)->applyFromArray($style_row);
			$sheet->getStyle('T' . $row)->applyFromArray($style_row);
			$sheet->getStyle('U' . $row)->applyFromArray($style_row);
			$sheet->getStyle('V' . $row)->applyFromArray($style_row);
			$sheet->getStyle('W' . $row)->applyFromArray($style_row);
			$sheet->getStyle('X' . $row)->applyFromArray($style_row);
			$sheet->getStyle('Y' . $row)->applyFromArray($style_row);
			$sheet->getStyle('Z' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AA' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AB' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AC' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AD' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AE' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AF' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AG' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AH' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AI' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AJ' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AK' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AL' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AM' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AN' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AO' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AP' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AQ' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AR' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AS' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AT' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AU' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AV' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AW' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AX' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AY' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AZ' . $row)->applyFromArray($style_row);
			$sheet->getStyle('BA' . $row)->applyFromArray($style_row);
			$sheet->getStyle('BB' . $row)->applyFromArray($style_row);
			$sheet->getStyle('BC' . $row)->applyFromArray($style_row);
			$sheet->getStyle('BD' . $row)->applyFromArray($style_row);
			$sheet->getStyle('BE' . $row)->applyFromArray($style_row);
			$sheet->getStyle('BF' . $row)->applyFromArray($style_row);
			$sheet->getStyle('BG' . $row)->applyFromArray($style_row);
			$sheet->getStyle('BH' . $row)->applyFromArray($style_row);
			$sheet->getStyle('BI' . $row)->applyFromArray($style_row);
			$sheet->getStyle('BJ' . $row)->applyFromArray($style_row);
			$sheet->getStyle('BK' . $row)->applyFromArray($style_row);
			$sheet->getStyle('BL' . $row)->applyFromArray($style_row);
			$sheet->getStyle('BM' . $row)->applyFromArray($style_row);
			$sheet->getStyle('BN' . $row)->applyFromArray($style_row);
			$sheet->getStyle('BO' . $row)->applyFromArray($style_row);
			$sheet->getStyle('BP' . $row)->applyFromArray($style_row);
			$sheet->getStyle('BQ' . $row)->applyFromArray($style_row);
			$sheet->getStyle('BR' . $row)->applyFromArray($style_row);
			$sheet->getStyle('BS' . $row)->applyFromArray($style_row);
			$sheet->getStyle('BT' . $row)->applyFromArray($style_row);
			$sheet->getStyle('BU' . $row)->applyFromArray($style_row);
			$sheet->getStyle('BV' . $row)->applyFromArray($style_row);
			$sheet->getStyle('BW' . $row)->applyFromArray($style_row);
			$sheet->getStyle('BX' . $row)->applyFromArray($style_row);
			$sheet->getStyle('BY' . $row)->applyFromArray($style_row);
			$sheet->getStyle('BZ' . $row)->applyFromArray($style_row);
			$sheet->getStyle('CA' . $row)->applyFromArray($style_row);
			$sheet->getStyle('CB' . $row)->applyFromArray($style_row);
			$sheet->getStyle('CC' . $row)->applyFromArray($style_row);
			$sheet->getStyle('CD' . $row)->applyFromArray($style_row);
			$sheet->getStyle('CE' . $row)->applyFromArray($style_row);
			$sheet->getStyle('CF' . $row)->applyFromArray($style_row);
			$sheet->getStyle('CG' . $row)->applyFromArray($style_row);
			$sheet->getStyle('CH' . $row)->applyFromArray($style_row);
			$sheet->getStyle('CI' . $row)->applyFromArray($style_row);
			$sheet->getStyle('CJ' . $row)->applyFromArray($style_row);
			$sheet->getStyle('CK' . $row)->applyFromArray($style_row);
			$sheet->getStyle('CL' . $row)->applyFromArray($style_row);
			$sheet->getStyle('CM' . $row)->applyFromArray($style_row);
			$sheet->getStyle('CN' . $row)->applyFromArray($style_row);
			$sheet->getStyle('CO' . $row)->applyFromArray($style_row);
			$sheet->getStyle('CP' . $row)->applyFromArray($style_row);
			$sheet->getStyle('CQ' . $row)->applyFromArray($style_row);
			$sheet->getStyle('CR' . $row)->applyFromArray($style_row);
			$sheet->getStyle('CS' . $row)->applyFromArray($style_row);
			$sheet->getStyle('CT' . $row)->applyFromArray($style_row);
			$sheet->getStyle('CU' . $row)->applyFromArray($style_row);
			$sheet->getStyle('CV' . $row)->applyFromArray($style_row);
			$sheet->getStyle('CW' . $row)->applyFromArray($style_row);
			$sheet->getStyle('CX' . $row)->applyFromArray($style_row);
			$sheet->getStyle('CY' . $row)->applyFromArray($style_row);
			$sheet->getStyle('CZ' . $row)->applyFromArray($style_row);
			$sheet->getStyle('DA' . $row)->applyFromArray($style_row);
			$sheet->getStyle('DB' . $row)->applyFromArray($style_row);
			$sheet->getStyle('DC' . $row)->applyFromArray($style_row);
			$sheet->getStyle('DD' . $row)->applyFromArray($style_row);
			$sheet->getStyle('DE' . $row)->applyFromArray($style_row);
			$sheet->getStyle('DF' . $row)->applyFromArray($style_row);
			$sheet->getStyle('DG' . $row)->applyFromArray($style_row);
			$sheet->getStyle('DH' . $row)->applyFromArray($style_row);
			$sheet->getStyle('DI' . $row)->applyFromArray($style_row);
			$sheet->getStyle('DJ' . $row)->applyFromArray($style_row);
			$sheet->getStyle('DK' . $row)->applyFromArray($style_row);
			$sheet->getStyle('DL' . $row)->applyFromArray($style_row);
			$sheet->getStyle('DM' . $row)->applyFromArray($style_row);
			$sheet->getStyle('DN' . $row)->applyFromArray($style_row);
			$sheet->getStyle('DO' . $row)->applyFromArray($style_row);
			$sheet->getStyle('DP' . $row)->applyFromArray($style_row);
			$sheet->getStyle('DQ' . $row)->applyFromArray($style_row);
			$sheet->getStyle('DR' . $row)->applyFromArray($style_row);
			$sheet->getStyle('DS' . $row)->applyFromArray($style_row);
			$sheet->getStyle('DT' . $row)->applyFromArray($style_row);
			$sheet->getStyle('DU' . $row)->applyFromArray($style_row);
			$sheet->getStyle('DV' . $row)->applyFromArray($style_row);
			$sheet->getStyle('DW' . $row)->applyFromArray($style_row);
			$sheet->getStyle('DX' . $row)->applyFromArray($style_row);
			$sheet->getStyle('DY' . $row)->applyFromArray($style_row);
			$sheet->getStyle('DZ' . $row)->applyFromArray($style_row);
			$sheet->getStyle('EA' . $row)->applyFromArray($style_row);
			$sheet->getStyle('EB' . $row)->applyFromArray($style_row);
			$sheet->getStyle('EC' . $row)->applyFromArray($style_row);
			$sheet->getStyle('ED' . $row)->applyFromArray($style_row);
			$sheet->getStyle('EE' . $row)->applyFromArray($style_row);
			$sheet->getStyle('EF' . $row)->applyFromArray($style_row);
			$sheet->getStyle('EG' . $row)->applyFromArray($style_row);
			$sheet->getStyle('EH' . $row)->applyFromArray($style_row);


			$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('I' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('J' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('K' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('L' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('M' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('N' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('O' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('P' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('Q' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('R' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('S' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('T' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('U' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('V' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('W' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('X' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('Y' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('Z' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AA' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AB' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AC' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AD' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AE' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AF' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AG' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AH' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AI' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AJ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AK' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AL' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AM' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AN' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AO' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AP' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AQ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AR' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AS' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AT' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AU' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AV' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AX' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AY' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AZ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('BA' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('BB' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('BC' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('BD' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('BE' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('BF' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('BG' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('BH' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('BI' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('BJ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('BK' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('BL' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('BM' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('BN' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('BO' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('BQ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('BR' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('BS' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('BT' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('BU' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('BV' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('BW' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('BX' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('BY' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('BZ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('CA' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('CB' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('CC' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('CD' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('CE' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('CF' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('CG' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('CH' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('CI' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('CJ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('CK' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('CL' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('CM' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('CN' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('CO' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('CP' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('CQ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('CR' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('CS' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('CT' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('CU' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('CV' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('CW' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('CX' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('CY' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('CZ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('DA' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('DB' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('DC' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('DD' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('DE' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('DF' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('DG' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('DH' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('DI' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('DJ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('DK' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('DL' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('DM' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('DN' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('DO' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('DP' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('DQ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('DR' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('DS' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('DT' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('DU' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('DV' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('DW' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('DX' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('DY' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('DZ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('EA' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('EB' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('EC' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('ED' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('EE' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('EF' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('EG' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('EH' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

			$sheet->getStyle('G' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('H' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
			$sheet->getStyle('I' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('J' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
			$sheet->getStyle('K' . $row)->getNumberFormat()->setFormatCode('#.00');
			$sheet->getStyle('L' . $row)->getNumberFormat()->setFormatCode('#.00');
			$sheet->getStyle('M' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('N' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
			$sheet->getStyle('O' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('P' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
			$sheet->getStyle('Q' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('R' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
			$sheet->getStyle('S' . $row)->getNumberFormat()->setFormatCode('#.00');
			$sheet->getStyle('T' . $row)->getNumberFormat()->setFormatCode('#.00');
			$sheet->getStyle('U' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('V' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
			$sheet->getStyle('W' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('X' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
			$sheet->getStyle('Y' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('Z' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
			$sheet->getStyle('AA' . $row)->getNumberFormat()->setFormatCode('#.00');
			$sheet->getStyle('AB' . $row)->getNumberFormat()->setFormatCode('#.00');
			$sheet->getStyle('AC' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('AD' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
			$sheet->getStyle('AE' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('AF' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
			$sheet->getStyle('AG' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('AH' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
			$sheet->getStyle('AI' . $row)->getNumberFormat()->setFormatCode('#.00');
			$sheet->getStyle('AJ' . $row)->getNumberFormat()->setFormatCode('#.00');
			$sheet->getStyle('AK' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('AL' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
			$sheet->getStyle('AM' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('AN' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
			$sheet->getStyle('AO' . $row)->getNumberFormat()->setFormatCode('#.00');
			$sheet->getStyle('AP' . $row)->getNumberFormat()->setFormatCode('#.00');
			$sheet->getStyle('AQ' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('AR' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
			$sheet->getStyle('AS' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('AT' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
			$sheet->getStyle('AU' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('AV' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
			$sheet->getStyle('AW' . $row)->getNumberFormat()->setFormatCode('#.00');
			$sheet->getStyle('AX' . $row)->getNumberFormat()->setFormatCode('#.00');
			$sheet->getStyle('AY' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('AZ' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
			$sheet->getStyle('AB' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('BB' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
			$sheet->getStyle('BC' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('BD' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
			$sheet->getStyle('BE' . $row)->getNumberFormat()->setFormatCode('#.00');
			$sheet->getStyle('BF' . $row)->getNumberFormat()->setFormatCode('#.00');
			$sheet->getStyle('BG' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('BH' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
			$sheet->getStyle('BI' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('BJ' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
			$sheet->getStyle('BK' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('BL' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
			$sheet->getStyle('BM' . $row)->getNumberFormat()->setFormatCode('#.00');
			$sheet->getStyle('BN' . $row)->getNumberFormat()->setFormatCode('#.00');
			$sheet->getStyle('BO' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('BP' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
			$sheet->getStyle('BQ' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('BR' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
			$sheet->getStyle('BS' . $row)->getNumberFormat()->setFormatCode('#.00');
			$sheet->getStyle('BT' . $row)->getNumberFormat()->setFormatCode('#.00');
			$sheet->getStyle('BU' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('BV' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
			$sheet->getStyle('BW' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('BX' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
			$sheet->getStyle('BY' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('BZ' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
			$sheet->getStyle('CA' . $row)->getNumberFormat()->setFormatCode('#.00');
			$sheet->getStyle('CB' . $row)->getNumberFormat()->setFormatCode('#.00');
			$sheet->getStyle('CC' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('CD' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
			$sheet->getStyle('CE' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('CF' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
			$sheet->getStyle('CG' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('CH' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
			$sheet->getStyle('CI' . $row)->getNumberFormat()->setFormatCode('#.00');
			$sheet->getStyle('CJ' . $row)->getNumberFormat()->setFormatCode('#.00');
			$sheet->getStyle('CK' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('CL' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
			$sheet->getStyle('CM' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('CN' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
			$sheet->getStyle('CO' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('CP' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
			$sheet->getStyle('CQ' . $row)->getNumberFormat()->setFormatCode('#.00');
			$sheet->getStyle('CR' . $row)->getNumberFormat()->setFormatCode('#.00');
			$sheet->getStyle('CS' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('CT' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
			$sheet->getStyle('CU' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('CV' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
			$sheet->getStyle('CW' . $row)->getNumberFormat()->setFormatCode('#.00');
			$sheet->getStyle('CX' . $row)->getNumberFormat()->setFormatCode('#.00');
			$sheet->getStyle('CY' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('CZ' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
			$sheet->getStyle('DA' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('DB' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
			$sheet->getStyle('DC' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('DD' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
			$sheet->getStyle('DE' . $row)->getNumberFormat()->setFormatCode('#.00');
			$sheet->getStyle('DF' . $row)->getNumberFormat()->setFormatCode('#.00');
			$sheet->getStyle('DG' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('DH' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
			$sheet->getStyle('DI' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('DJ' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
			$sheet->getStyle('DK' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('DL' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
			$sheet->getStyle('DM' . $row)->getNumberFormat()->setFormatCode('#.00');
			$sheet->getStyle('DN' . $row)->getNumberFormat()->setFormatCode('#.00');
			$sheet->getStyle('DO' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('DP' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
			$sheet->getStyle('DQ' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('DR' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
			$sheet->getStyle('DS' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('DT' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
			$sheet->getStyle('DU' . $row)->getNumberFormat()->setFormatCode('#.00');
			$sheet->getStyle('DW' . $row)->getNumberFormat()->setFormatCode('#.00');
			$sheet->getStyle('DW' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('DX' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
			$sheet->getStyle('DY' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('DZ' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
			$sheet->getStyle('EA' . $row)->getNumberFormat()->setFormatCode('#.00');
			$sheet->getStyle('EB' . $row)->getNumberFormat()->setFormatCode('#.00');
			$sheet->getStyle('EC' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('ED' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
			$sheet->getStyle('EE' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('EF' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
			$sheet->getStyle('EG' . $row)->getNumberFormat()->setFormatCode('#.00');
			$sheet->getStyle('EH' . $row)->getNumberFormat()->setFormatCode('#.00');

			$item_group = $rows['item_group'];
			$principal = $rows['principal'];

			$qty_jan += $rows['qty_jan'];
			$qty_feb += $rows['qty_feb'];
			$qty_mar += $rows['qty_mar'];
			$qty_q1 += $rows['qty_q1'];

			$qty_apr += $rows['qty_apr'];
			$qty_mei += $rows['qty_mei'];
			$qty_jun += $rows['qty_jun'];
			$qty_q2 += $rows['qty_q2'];

			$qty_jul += $rows['qty_jul'];
			$qty_agu += $rows['qty_agu'];
			$qty_sep += $rows['qty_sep'];
			$qty_q3 += $rows['qty_q3'];

			$qty_okt += $rows['qty_okt'];
			$qty_nop += $rows['qty_nop'];
			$qty_des += $rows['qty_des'];
			$qty_q4 += $rows['qty_q4'];
			
			$val_jan += $rows['value_jan'];
			$val_feb += $rows['value_feb'];
			$val_mar += $rows['value_mar'];
			$val_q1 += $rows['value_q1'];

			$val_apr += $rows['value_apr'];
			$val_mei += $rows['value_mei'];
			$val_jun += $rows['value_jun'];
			$val_q2 += $rows['value_q2'];

			$val_jul += $rows['value_jul'];
			$val_agu += $rows['value_agu'];
			$val_sep += $rows['value_sep'];
			$val_q3 += $rows['value_q3'];

			$val_okt += $rows['value_okt'];
			$val_nop += $rows['value_nop'];
			$val_des += $rows['value_des'];
			$val_q4 += $rows['value_q4'];

			$target_qty_jan += $rows['target_qty_jan'];
			$target_qty_feb += $rows['target_qty_feb'];
			$target_qty_mar += $rows['target_qty_mar'];
			$target_qty_q1 += $rows['target_qty_q1'];

			$target_qty_apr += $rows['target_qty_apr'];
			$target_qty_mei += $rows['target_qty_mei'];
			$target_qty_jun += $rows['target_qty_jun'];
			$target_qty_q2 += $rows['target_qty_q2'];

			$target_qty_jul += $rows['target_qty_jul'];
			$target_qty_agu += $rows['target_qty_agu'];
			$target_qty_sep += $rows['target_qty_sep'];
			$target_qty_q3 += $rows['target_qty_q3'];

			$target_qty_okt += $rows['target_qty_okt'];
			$target_qty_nop += $rows['target_qty_nop'];
			$target_qty_des += $rows['target_qty_des'];
			$target_qty_q4 += $rows['target_qty_q4'];
			
			$target_val_jan += $rows['target_val_jan'];
			$target_val_feb += $rows['target_val_feb'];
			$target_val_mar += $rows['target_val_mar'];
			$target_val_q1 += $rows['target_value_q1'];

			$target_val_apr += $rows['target_val_apr'];
			$target_val_mei += $rows['target_val_mei'];
			$target_val_jun += $rows['target_val_jun'];
			$target_val_q2 += $rows['target_value_q2'];

			$target_val_jul += $rows['target_val_jul'];
			$target_val_agu += $rows['target_val_agu'];
			$target_val_sep += $rows['target_val_sep'];
			$target_val_q3 += $rows['target_value_q3'];

			$target_val_okt += $rows['target_val_okt'];
			$target_val_nop += $rows['target_val_nop'];
			$target_val_des += $rows['target_val_des'];
			$target_val_q4 += $rows['target_value_q4'];

			$idx_qty_jan = ($qty_jan/($target_qty_jan ?: 1))*100;
			$idx_qty_feb = ($qty_feb/($target_qty_feb ?: 1))*100;
			$idx_qty_mar = ($qty_mar/($target_qty_mar ?: 1))*100;
			$idx_qty_q1 = ($qty_q1/($target_qty_q1 ?: 1))*100;

			$idx_qty_apr = ($qty_apr/($target_qty_apr ?: 1))*100;
			$idx_qty_mei = ($qty_mei/($target_qty_mei ?: 1))*100;
			$idx_qty_jun = ($qty_jun/($target_qty_jun ?: 1))*100;
			$idx_qty_q2 = ($qty_q2/($target_qty_q2 ?: 1))*100;

			$idx_qty_jul = ($qty_jul/($target_qty_jul ?: 1))*100;
			$idx_qty_agu = ($qty_agu/($target_qty_agu ?: 1))*100;
			$idx_qty_sep = ($qty_sep/($target_qty_sep ?: 1))*100;
			$idx_qty_q3 = ($qty_q3/($target_qty_q3 ?: 1))*100;

			$idx_qty_okt = ($qty_okt/($target_qty_okt ?: 1))*100;
			$idx_qty_nop = ($qty_nop/($target_qty_nop ?: 1))*100;
			$idx_qty_des = ($qty_des/($target_qty_des ?: 1))*100;
			$idx_qty_q4 = ($qty_q4/($target_qty_q4 ?: 1))*100;
			
			$idx_val_jan = ($val_jan/($target_val_jan ?: 1))*100;
			$idx_val_feb = ($val_feb/($target_val_feb ?: 1))*100;
			$idx_val_mar = ($val_mar/($target_val_mar ?: 1))*100;
			$idx_val_q1 = ($val_q1/($target_val_q1 ?: 1))*100;

			$idx_val_apr = ($val_apr/($target_val_apr ?: 1))*100;
			$idx_val_mei = ($val_mei/($target_val_mei ?: 1))*100;
			$idx_val_jun = ($val_jun/($target_val_jun ?: 1))*100;
			$idx_val_q2 = ($val_q2/($target_val_q2 ?: 1))*100;

			$idx_val_jul = ($val_jul/($target_val_jul ?: 1))*100;
			$idx_val_agu = ($val_agu/($target_val_agu ?: 1))*100;
			$idx_val_sep = ($val_sep/($target_val_sep ?: 1))*100;
			$idx_val_q3 = ($val_q3/($target_val_q3 ?: 1))*100;

			$idx_val_okt = ($val_okt/($target_val_okt ?: 1))*100;
			$idx_val_nop = ($val_nop/($target_val_nop ?: 1))*100;
			$idx_val_des = ($val_des/($target_val_des ?: 1))*100;
			$idx_val_q4 = ($val_q4/($target_val_q4 ?: 1))*100;

			$stok_qty_jan += $row['stok_qty_jan'];
			$stok_qty_feb += $row['stok_qty_feb'];
			$stok_qty_mar += $row['stok_qty_mar'];
			
			$stok_qty_apr += $row['stok_qty_apr'];
			$stok_qty_mei += $row['stok_qty_mei'];
			$stok_qty_jun += $row['stok_qty_jun'];
			
			$stok_qty_jul += $row['stok_qty_jul'];
			$stok_qty_agu += $row['stok_qty_agu'];
			$stok_qty_sep += $row['stok_qty_sep'];
			
			$stok_qty_okt += $row['stok_qty_okt'];
			$stok_qty_nop += $row['stok_qty_nop'];
			$stok_qty_des += $row['stok_qty_des'];
			
			$stok_val_jan += $row['stok_val_jan'];
			$stok_val_feb += $row['stok_val_feb'];
			$stok_val_mar += $row['stok_val_mar'];
			
			$stok_val_apr += $row['stok_val_apr'];
			$stok_val_mei += $row['stok_val_mei'];
			$stok_val_jun += $row['stok_val_jun'];
			
			$stok_val_jul += $row['stok_val_jul'];
			$stok_val_agu += $row['stok_val_agu'];
			$stok_val_sep += $row['stok_val_sep'];
			
			$stok_val_okt += $row['stok_val_okt'];
			$stok_val_nop += $row['stok_val_nop'];
			$stok_val_des += $row['stok_val_des'];

			
			$sub_qty_jan += $rows['qty_jan'];
			$sub_qty_feb += $rows['qty_feb'];
			$sub_qty_mar += $rows['qty_mar'];
			$sub_qty_q1 += $rows['qty_q1'];

			$sub_qty_apr += $rows['qty_apr'];
			$sub_qty_mei += $rows['qty_mei'];
			$sub_qty_jun += $rows['qty_jun'];
			$sub_qty_q2 += $rows['qty_q2'];

			$sub_qty_jul += $rows['qty_jul'];
			$sub_qty_agu += $rows['qty_agu'];
			$sub_qty_sep += $rows['qty_sep'];
			$sub_qty_q3 += $rows['qty_q3'];

			$sub_qty_okt += $rows['qty_okt'];
			$sub_qty_nop += $rows['qty_nop'];
			$sub_qty_des += $rows['qty_des'];
			$sub_qty_q4 += $rows['qty_q4'];
			
			$sub_val_jan += $rows['value_jan'];
			$sub_val_feb += $rows['value_feb'];
			$sub_val_mar += $rows['value_mar'];
			$sub_val_q1 += $rows['value_q1'];

			$sub_val_apr += $rows['value_apr'];
			$sub_val_mei += $rows['value_mei'];
			$sub_val_jun += $rows['value_jun'];
			$sub_val_q2 += $rows['value_q2'];

			$sub_val_jul += $rows['value_jul'];
			$sub_val_agu += $rows['value_agu'];
			$sub_val_sep += $rows['value_sep'];
			$sub_val_q3 += $rows['value_q3'];

			$sub_val_okt += $rows['value_okt'];
			$sub_val_nop += $rows['value_nop'];
			$sub_val_des += $rows['value_des'];
			$sub_val_q4 += $rows['value_q4'];

			$sub_target_qty_jan += $rows['target_qty_jan'];
			$sub_target_qty_feb += $rows['target_qty_feb'];
			$sub_target_qty_mar += $rows['target_qty_mar'];
			$sub_target_qty_q1 += $rows['target_qty_q1'];

			$sub_target_qty_apr += $rows['target_qty_apr'];
			$sub_target_qty_mei += $rows['target_qty_mei'];
			$sub_target_qty_jun += $rows['target_qty_jun'];
			$sub_target_qty_q2 += $rows['target_qty_q2'];

			$sub_target_qty_jul += $rows['target_qty_jul'];
			$sub_target_qty_agu += $rows['target_qty_agu'];
			$sub_target_qty_sep += $rows['target_qty_sep'];
			$sub_target_qty_q3 += $rows['target_qty_q3'];

			$sub_target_qty_okt += $rows['target_qty_okt'];
			$sub_target_qty_nop += $rows['target_qty_nop'];
			$sub_target_qty_des += $rows['target_qty_des'];
			$sub_target_qty_q4 += $rows['target_qty_q4'];
			
			$sub_target_val_jan += $rows['target_val_jan'];
			$sub_target_val_feb += $rows['target_val_feb'];
			$sub_target_val_mar += $rows['target_val_mar'];
			$sub_target_val_q1 += $rows['target_value_q1'];

			$sub_target_val_apr += $rows['target_val_apr'];
			$sub_target_val_mei += $rows['target_val_mei'];
			$sub_target_val_jun += $rows['target_val_jun'];
			$sub_target_val_q2 += $rows['target_value_q2'];

			$sub_target_val_jul += $rows['target_val_jul'];
			$sub_target_val_agu += $rows['target_val_agu'];
			$sub_target_val_sep += $rows['target_val_sep'];
			$sub_target_val_q3 += $rows['target_value_q3'];

			$sub_target_val_okt += $rows['target_val_okt'];
			$sub_target_val_nop += $rows['target_val_nop'];
			$sub_target_val_des += $rows['target_val_des'];
			$sub_target_val_q4 += $rows['target_value_q4'];

			$sub_idx_qty_jan = ($sub_qty_jan/($sub_target_qty_jan ?: 1))*100;
			$sub_idx_qty_feb = ($sub_qty_feb/($sub_target_qty_feb ?: 1))*100;
			$sub_idx_qty_mar = ($sub_qty_mar/($sub_target_qty_mar ?: 1))*100;
			$sub_idx_qty_q1 = ($sub_qty_q1/($sub_target_qty_q1 ?: 1))*100;

			$sub_idx_qty_apr = ($sub_qty_apr/($sub_target_qty_apr ?: 1))*100;
			$sub_idx_qty_mei = ($sub_qty_mei/($sub_target_qty_mei ?: 1))*100;
			$sub_idx_qty_jun = ($sub_qty_jun/($sub_target_qty_jun ?: 1))*100;
			$sub_idx_qty_q2 = ($sub_qty_q2/($sub_target_qty_q2 ?: 1))*100;

			$sub_idx_qty_jul = ($sub_qty_jul/($sub_target_qty_jul ?: 1))*100;
			$sub_idx_qty_agu = ($sub_qty_agu/($sub_target_qty_agu ?: 1))*100;
			$sub_idx_qty_sep = ($sub_qty_sep/($sub_target_qty_sep ?: 1))*100;
			$sub_idx_qty_q3 = ($sub_qty_q3/($sub_target_qty_q3 ?: 1))*100;

			$sub_idx_qty_okt = ($sub_qty_okt/($sub_target_qty_okt ?: 1))*100;
			$sub_idx_qty_nop = ($sub_qty_nop/($sub_target_qty_nop ?: 1))*100;
			$sub_idx_qty_des = ($sub_qty_des/($sub_target_qty_des ?: 1))*100;
			$sub_idx_qty_q4 = ($sub_qty_q4/($sub_target_qty_q4 ?: 1))*100;
			
			$sub_idx_val_jan = ($sub_val_jan/($sub_target_val_jan ?: 1))*100;
			$sub_idx_val_feb = ($sub_val_feb/($sub_target_val_feb ?: 1))*100;
			$sub_idx_val_mar = ($sub_val_mar/($sub_target_val_mar ?: 1))*100;
			$sub_idx_val_q1 = ($sub_val_q1/($sub_target_val_q1 ?: 1))*100;

			$sub_idx_val_apr = ($sub_val_apr/($sub_target_val_apr ?: 1))*100;
			$sub_idx_val_mei = ($sub_val_mei/($sub_target_val_mei ?: 1))*100;
			$sub_idx_val_jun = ($sub_val_jun/($sub_target_val_jun ?: 1))*100;
			$sub_idx_val_q2 = ($sub_val_q2/($sub_target_val_q2 ?: 1))*100;

			$sub_idx_val_jul = ($sub_val_jul/($sub_target_val_jul ?: 1))*100;
			$sub_idx_val_agu = ($sub_val_agu/($sub_target_val_agu ?: 1))*100;
			$sub_idx_val_sep = ($sub_val_sep/($sub_target_val_sep ?: 1))*100;
			$sub_idx_val_q3 = ($sub_val_q3/($sub_target_val_q3 ?: 1))*100;

			$sub_idx_val_okt = ($sub_val_okt/($sub_target_val_okt ?: 1))*100;
			$sub_idx_val_nop = ($sub_val_nop/($sub_target_val_nop ?: 1))*100;
			$sub_idx_val_des = ($sub_val_des/($sub_target_val_des ?: 1))*100;
			$sub_idx_val_q4 = ($sub_val_q4/($sub_target_val_q4 ?: 1))*100;

			$sub_stok_qty_jan += $row['stok_qty_jan'];
			$sub_stok_qty_feb += $row['stok_qty_feb'];
			$sub_stok_qty_mar += $row['stok_qty_mar'];

			$sub_stok_qty_apr += $row['stok_qty_apr'];
			$sub_stok_qty_mei += $row['stok_qty_mei'];
			$sub_stok_qty_jun += $row['stok_qty_jun'];

			$sub_stok_qty_jul += $row['stok_qty_jul'];
			$sub_stok_qty_agu += $row['stok_qty_agu'];
			$sub_stok_qty_sep += $row['stok_qty_sep'];

			$sub_stok_qty_okt += $row['stok_qty_okt'];
			$sub_stok_qty_nop += $row['stok_qty_nop'];
			$sub_stok_qty_des += $row['stok_qty_des'];
			
			$sub_stok_val_jan += $row['stok_val_jan'];
			$sub_stok_val_feb += $row['stok_val_feb'];
			$sub_stok_val_mar += $row['stok_val_mar'];

			$sub_stok_val_apr += $row['stok_val_apr'];
			$sub_stok_val_mei += $row['stok_val_mei'];
			$sub_stok_val_jun += $row['stok_val_jun'];

			$sub_stok_val_jul += $row['stok_val_jul'];
			$sub_stok_val_agu += $row['stok_val_agu'];
			$sub_stok_val_sep += $row['stok_val_sep'];

			$sub_stok_val_okt += $row['stok_val_okt'];
			$sub_stok_val_nop += $row['stok_val_nop'];
			$sub_stok_val_des += $row['stok_val_des'];

			$total_qty_jan += $rows['qty_jan'];
			$total_qty_feb += $rows['qty_feb'];
			$total_qty_mar += $rows['qty_mar'];
			$total_qty_q1 += $rows['qty_q1'];

			$total_qty_apr += $rows['qty_apr'];
			$total_qty_mei += $rows['qty_mei'];
			$total_qty_jun += $rows['qty_jun'];
			$total_qty_q2 += $rows['qty_q2'];

			$total_qty_jul += $rows['qty_jul'];
			$total_qty_agu += $rows['qty_agu'];
			$total_qty_sep += $rows['qty_sep'];
			$total_qty_q3 += $rows['qty_q3'];

			$total_qty_okt += $rows['qty_okt'];
			$total_qty_nop += $rows['qty_nop'];
			$total_qty_des += $rows['qty_des'];
			$total_qty_q4 += $rows['qty_q4'];
			
			$total_val_jan += $rows['value_jan'];
			$total_val_feb += $rows['value_feb'];
			$total_val_mar += $rows['value_mar'];
			$total_val_q1 += $rows['value_q1'];

			$total_val_apr += $rows['value_apr'];
			$total_val_mei += $rows['value_mei'];
			$total_val_jun += $rows['value_jun'];
			$total_val_q2 += $rows['value_q2'];

			$total_val_jul += $rows['value_jul'];
			$total_val_agu += $rows['value_agu'];
			$total_val_sep += $rows['value_sep'];
			$total_val_q3 += $rows['value_q3'];

			$total_val_okt += $rows['value_okt'];
			$total_val_nop += $rows['value_nop'];
			$total_val_des += $rows['value_des'];
			$total_val_q4 += $rows['value_q4'];

			$total_target_qty_jan += $rows['target_qty_jan'];
			$total_target_qty_feb += $rows['target_qty_feb'];
			$total_target_qty_mar += $rows['target_qty_mar'];
			$total_target_qty_q1 += $rows['target_qty_q1'];

			$total_target_qty_apr += $rows['target_qty_apr'];
			$total_target_qty_mei += $rows['target_qty_mei'];
			$total_target_qty_jun += $rows['target_qty_jun'];
			$total_target_qty_q2 += $rows['target_qty_q2'];

			$total_target_qty_jul += $rows['target_qty_jul'];
			$total_target_qty_agu += $rows['target_qty_agu'];
			$total_target_qty_sep += $rows['target_qty_sep'];
			$total_target_qty_q3 += $rows['target_qty_q3'];

			$total_target_qty_okt += $rows['target_qty_okt'];
			$total_target_qty_nop += $rows['target_qty_nop'];
			$total_target_qty_des += $rows['target_qty_des'];
			$total_target_qty_q4 += $rows['target_qty_q4'];
			
			$total_target_val_jan += $rows['target_val_jan'];
			$total_target_val_feb += $rows['target_val_feb'];
			$total_target_val_mar += $rows['target_val_mar'];
			$total_target_val_q1 += $rows['target_value_q1'];

			$total_target_val_apr += $rows['target_val_apr'];
			$total_target_val_mei += $rows['target_val_mei'];
			$total_target_val_jun += $rows['target_val_jun'];
			$total_target_val_q2 += $rows['target_value_q2'];

			$total_target_val_jul += $rows['target_val_jul'];
			$total_target_val_agu += $rows['target_val_agu'];
			$total_target_val_sep += $rows['target_val_sep'];
			$total_target_val_q3 += $rows['target_value_q3'];

			$total_target_val_okt += $rows['target_val_okt'];
			$total_target_val_nop += $rows['target_val_nop'];
			$total_target_val_des += $rows['target_val_des'];
			$total_target_val_q4 += $rows['target_value_q4'];

			$total_idx_qty_jan = ($total_qty_jan/($total_target_qty_jan ?: 1))*100;
			$total_idx_qty_feb = ($total_qty_feb/($total_target_qty_feb ?: 1))*100;
			$total_idx_qty_mar = ($total_qty_mar/($total_target_qty_mar ?: 1))*100;
			$total_idx_qty_q1 = ($total_qty_q1/($total_target_qty_q1 ?: 1))*100;

			$total_idx_qty_apr = ($total_qty_apr/($total_target_qty_apr ?: 1))*100;
			$total_idx_qty_mei = ($total_qty_mei/($total_target_qty_mei ?: 1))*100;
			$total_idx_qty_jun = ($total_qty_jun/($total_target_qty_jun ?: 1))*100;
			$total_idx_qty_q2 = ($total_qty_q2/($total_target_qty_q2 ?: 1))*100;

			$total_idx_qty_jul = ($total_qty_jul/($total_target_qty_jul ?: 1))*100;
			$total_idx_qty_agu = ($total_qty_agu/($total_target_qty_agu ?: 1))*100;
			$total_idx_qty_sep = ($total_qty_sep/($total_target_qty_sep ?: 1))*100;
			$total_idx_qty_q3 = ($total_qty_q3/($total_target_qty_q3 ?: 1))*100;

			$total_idx_qty_okt = ($total_qty_okt/($total_target_qty_okt ?: 1))*100;
			$total_idx_qty_nop = ($total_qty_nop/($total_target_qty_nop ?: 1))*100;
			$total_idx_qty_des = ($total_qty_des/($total_target_qty_des ?: 1))*100;
			$total_idx_qty_q4 = ($total_qty_q4/($total_target_qty_q4 ?: 1))*100;
			
			$total_idx_val_jan = ($total_val_jan/($total_target_val_jan ?: 1))*100;
			$total_idx_val_feb = ($total_val_feb/($total_target_val_feb ?: 1))*100;
			$total_idx_val_mar = ($total_val_mar/($total_target_val_mar ?: 1))*100;
			$total_idx_val_q1 = ($total_val_q1/($total_target_val_q1 ?: 1))*100;

			$total_idx_val_apr = ($total_val_apr/($total_target_val_apr ?: 1))*100;
			$total_idx_val_mei = ($total_val_mei/($total_target_val_mei ?: 1))*100;
			$total_idx_val_jun = ($total_val_jun/($total_target_val_jun ?: 1))*100;
			$total_idx_val_q2 = ($total_val_q2/($total_target_val_q2 ?: 1))*100;

			$total_idx_val_jul = ($total_val_jul/($total_target_val_jul ?: 1))*100;
			$total_idx_val_agu = ($total_val_agu/($total_target_val_agu ?: 1))*100;
			$total_idx_val_sep = ($total_val_sep/($total_target_val_sep ?: 1))*100;
			$total_idx_val_q3 = ($total_val_q3/($total_target_val_q3 ?: 1))*100;

			$total_idx_val_okt = ($total_val_okt/($total_target_val_okt ?: 1))*100;
			$total_idx_val_nop = ($total_val_nop/($total_target_val_nop ?: 1))*100;
			$total_idx_val_des = ($total_val_des/($total_target_val_des ?: 1))*100;
			$total_idx_val_q4 = ($total_val_q4/($total_target_val_q4 ?: 1))*100;

			$total_stok_qty_jan += $row['stok_qty_jan'];
			$total_stok_qty_feb += $row['stok_qty_feb'];
			$total_stok_qty_mar += $row['stok_qty_mar'];

			$total_stok_qty_apr += $row['stok_qty_apr'];
			$total_stok_qty_mei += $row['stok_qty_mei'];
			$total_stok_qty_jun += $row['stok_qty_jun'];

			$total_stok_qty_jul += $row['stok_qty_jul'];
			$total_stok_qty_agu += $row['stok_qty_agu'];
			$total_stok_qty_sep += $row['stok_qty_sep'];

			$total_stok_qty_okt += $row['stok_qty_okt'];
			$total_stok_qty_nop += $row['stok_qty_nop'];
			$total_stok_qty_des += $row['stok_qty_des'];
			
			$total_stok_val_jan += $row['stok_val_jan'];
			$total_stok_val_feb += $row['stok_val_feb'];
			$total_stok_val_mar += $row['stok_val_mar'];

			$total_stok_val_apr += $row['stok_val_apr'];
			$total_stok_val_mei += $row['stok_val_mei'];
			$total_stok_val_jun += $row['stok_val_jun'];

			$total_stok_val_jul += $row['stok_val_jul'];
			$total_stok_val_agu += $row['stok_val_agu'];
			$total_stok_val_sep += $row['stok_val_sep'];

			$total_stok_val_okt += $row['stok_val_okt'];
			$total_stok_val_nop += $row['stok_val_nop'];
			$total_stok_val_des += $row['stok_val_des'];

			$no++; // Tambah 1 setiap kali looping
    		$row++; // Tambah 1 setiap kali looping
		endforeach;

		$sub_qty_year = $sub_qty_jan + $sub_qty_feb + $sub_qty_mar + $sub_qty_apr + $sub_qty_mei + $sub_qty_jun + $sub_qty_jul + $sub_qty_agu + $sub_qty_sep + $sub_qty_okt + $sub_qty_nop + $sub_qty_des;
		$sub_val_year = $sub_val_jan + $sub_val_feb + $sub_val_mar + $sub_val_apr + $sub_val_mei + $sub_val_jun + $sub_val_jul + $sub_val_agu + $sub_val_sep + $sub_val_okt + $sub_val_nop + $sub_val_des;
		$sub_target_qty_year = $sub_target_qty_jan + $sub_target_qty_feb + $sub_target_qty_mar + $sub_target_qty_apr + $sub_target_qty_mei + $sub_target_qty_jun + $sub_target_qty_jul + $sub_target_qty_agu + $sub_target_qty_sep + $sub_target_qty_okt + $sub_target_qty_nop + $sub_target_qty_des; 
		$sub_target_val_year = $sub_target_val_jan + $sub_target_val_feb + $sub_target_val_mar + $sub_target_val_apr + $sub_target_val_mei + $sub_target_val_jun + $sub_target_val_jul + $sub_target_val_agu + $sub_target_val_sep + $sub_target_val_okt + $sub_target_val_nop + $sub_target_val_des;
		$sub_idx_qty_year = ($sub_qty_year/($sub_target_qty_year ?: 1))*100; 
		$sub_idx_val_year = ($sub_val_year/($sub_target_val_year ?: 1))*100; 
		$sub_qty_avg = $sub_qty_year/12;
		$sub_val_avg = $sub_val_year/12;
		$sub_target_qty_avg = $sub_target_qty_year/12;
		$sub_target_val_avg = $sub_target_val_year/12;
		$sub_idx_qty_avg = ($sub_qty_avg/($sub_target_qty_avg ?: 1))*100;
		$sub_idx_val_avg = ($sub_val_avg/($sub_target_val_avg ?: 1))*100;

		//item_group end
		//$row = $row + 1;
		$sheet->setCellValue('A' . $row, '');
		$sheet->setCellValue('B' . $row, $principal);
		$sheet->setCellValue('C' . $row, $item_group);
		$sheet->setCellValue('D' . $row, '');
		$sheet->setCellValue('E' . $row, 'Sub Total ' . $item_group);
		$sheet->setCellValue('F' . $row, '');
		$sheet->setCellValue('G' . $row, $qty_jan);
		$sheet->setCellValue('H' . $row, $val_jan);
		$sheet->setCellValue('I' . $row, $target_qty_jan);
		$sheet->setCellValue('J' . $row, $target_val_jan);
		$sheet->setCellValue('K' . $row, $idx_qty_jan);
		$sheet->setCellValue('L' . $row, $idx_val_jan);
		$sheet->setCellValue('M' . $row, $stok_qty_jan);
		$sheet->setCellValue('N' . $row, $stok_val_jan);
		$sheet->setCellValue('O' . $row, $qty_feb);
		$sheet->setCellValue('P' . $row, $val_feb);
		$sheet->setCellValue('Q' . $row, $target_qty_feb);
		$sheet->setCellValue('R' . $row, $target_val_feb);
		$sheet->setCellValue('S' . $row, $idx_qty_feb);
		$sheet->setCellValue('T' . $row, $idx_val_feb);
		$sheet->setCellValue('U' . $row, $stok_qty_feb);
		$sheet->setCellValue('V' . $row, $stok_val_feb);
		$sheet->setCellValue('W' . $row, $qty_mar);
		$sheet->setCellValue('X' . $row, $val_mar);
		$sheet->setCellValue('Y' . $row, $target_qty_mar);
		$sheet->setCellValue('Z' . $row, $target_val_mar);
		$sheet->setCellValue('AA' . $row, $idx_qty_mar);
		$sheet->setCellValue('AB' . $row, $idx_val_mar);
		$sheet->setCellValue('AC' . $row, $stok_qty_mar);
		$sheet->setCellValue('AD' . $row, $stok_val_mar);
		$sheet->setCellValue('AE' . $row, $qty_q1);
		$sheet->setCellValue('AF' . $row, $val_q1);
		$sheet->setCellValue('AG' . $row, $target_qty_q1);
		$sheet->setCellValue('AH' . $row, $target_val_q1);
		$sheet->setCellValue('AI' . $row, $idx_qty_q1);
		$sheet->setCellValue('AJ' . $row, $idx_val_q1);

		$sheet->setCellValue('AK' . $row, $qty_apr);
		$sheet->setCellValue('AL' . $row, $val_apr);
		$sheet->setCellValue('AM' . $row, $target_qty_apr);
		$sheet->setCellValue('AN' . $row, $target_val_apr);
		$sheet->setCellValue('AO' . $row, $idx_qty_apr);
		$sheet->setCellValue('AP' . $row, $idx_val_apr);
		$sheet->setCellValue('AQ' . $row, $stok_qty_apr);
		$sheet->setCellValue('AR' . $row, $stok_val_apr);
		$sheet->setCellValue('AS' . $row, $qty_mei);
		$sheet->setCellValue('AT' . $row, $val_mei);
		$sheet->setCellValue('AU' . $row, $target_qty_mei);
		$sheet->setCellValue('AV' . $row, $target_val_mei);
		$sheet->setCellValue('AW' . $row, $idx_qty_mei);
		$sheet->setCellValue('AX' . $row, $idx_val_mei);
		$sheet->setCellValue('AY' . $row, $stok_qty_mei);
		$sheet->setCellValue('AZ' . $row, $stok_val_mei);
		$sheet->setCellValue('BA' . $row, $qty_jun);
		$sheet->setCellValue('BB' . $row, $val_jun);
		$sheet->setCellValue('BC' . $row, $target_qty_jun);
		$sheet->setCellValue('BD' . $row, $target_val_jun);
		$sheet->setCellValue('BE' . $row, $idx_qty_jun);
		$sheet->setCellValue('BF' . $row, $idx_val_jun);
		$sheet->setCellValue('BG' . $row, $stok_qty_jun);
		$sheet->setCellValue('BH' . $row, $stok_val_jun);
		$sheet->setCellValue('BI' . $row, $qty_q2);
		$sheet->setCellValue('BJ' . $row, $val_q2);
		$sheet->setCellValue('BK' . $row, $target_qty_q2);
		$sheet->setCellValue('BL' . $row, $target_val_q2);
		$sheet->setCellValue('BM' . $row, $idx_qty_q2);
		$sheet->setCellValue('BN' . $row, $idx_val_q2);

		$sheet->setCellValue('BO' . $row, $qty_jul);
		$sheet->setCellValue('BP' . $row, $val_jul);
		$sheet->setCellValue('BQ' . $row, $target_qty_jul);
		$sheet->setCellValue('BR' . $row, $target_val_jul);
		$sheet->setCellValue('BS' . $row, $idx_qty_jul);
		$sheet->setCellValue('BT' . $row, $idx_val_jul);
		$sheet->setCellValue('BU' . $row, $stok_qty_jul);
		$sheet->setCellValue('BV' . $row, $stok_val_jul);
		$sheet->setCellValue('BW' . $row, $qty_agu);
		$sheet->setCellValue('BX' . $row, $val_agu);
		$sheet->setCellValue('BY' . $row, $target_qty_agu);
		$sheet->setCellValue('BZ' . $row, $target_val_agu);
		$sheet->setCellValue('CA' . $row, $idx_qty_agu);
		$sheet->setCellValue('CB' . $row, $idx_val_agu);
		$sheet->setCellValue('CC' . $row, $stok_qty_agu);
		$sheet->setCellValue('CD' . $row, $stok_val_agu);
		$sheet->setCellValue('CE' . $row, $qty_sep);
		$sheet->setCellValue('CF' . $row, $val_sep);
		$sheet->setCellValue('CG' . $row, $target_qty_sep);
		$sheet->setCellValue('CH' . $row, $target_val_sep);
		$sheet->setCellValue('CI' . $row, $idx_qty_sep);
		$sheet->setCellValue('CJ' . $row, $idx_val_sep);
		$sheet->setCellValue('CK' . $row, $stok_qty_sep);
		$sheet->setCellValue('CL' . $row, $stok_val_sep);
		$sheet->setCellValue('CM' . $row, $qty_q3);
		$sheet->setCellValue('CN' . $row, $val_q3);
		$sheet->setCellValue('CO' . $row, $target_qty_q3);
		$sheet->setCellValue('CP' . $row, $target_val_q3);
		$sheet->setCellValue('CQ' . $row, $idx_qty_q3);
		$sheet->setCellValue('CR' . $row, $idx_val_q3);

		$sheet->setCellValue('CS' . $row, $qty_okt);
		$sheet->setCellValue('CT' . $row, $val_okt);
		$sheet->setCellValue('CU' . $row, $target_qty_okt);
		$sheet->setCellValue('CV' . $row, $target_val_okt);
		$sheet->setCellValue('CW' . $row, $idx_qty_okt);
		$sheet->setCellValue('CX' . $row, $idx_val_okt);
		$sheet->setCellValue('CY' . $row, $stok_qty_okt);
		$sheet->setCellValue('CZ' . $row, $stok_val_okt);
		$sheet->setCellValue('DA' . $row, $qty_nop);
		$sheet->setCellValue('DB' . $row, $val_nop);
		$sheet->setCellValue('DC' . $row, $target_qty_nop);
		$sheet->setCellValue('DD' . $row, $target_val_nop);
		$sheet->setCellValue('DE' . $row, $idx_qty_nop);
		$sheet->setCellValue('DF' . $row, $idx_val_nop);
		$sheet->setCellValue('DG' . $row, $stok_qty_nop);
		$sheet->setCellValue('DH' . $row, $stok_val_nop);
		$sheet->setCellValue('DI' . $row, $qty_des);
		$sheet->setCellValue('DJ' . $row, $val_des);
		$sheet->setCellValue('DK' . $row, $target_qty_des);
		$sheet->setCellValue('DL' . $row, $target_val_des);
		$sheet->setCellValue('DM' . $row, $idx_qty_des);
		$sheet->setCellValue('DN' . $row, $idx_val_des);
		$sheet->setCellValue('DO' . $row, $stok_qty_des);
		$sheet->setCellValue('DP' . $row, $stok_val_des);
		$sheet->setCellValue('DQ' . $row, $qty_q4);
		$sheet->setCellValue('DR' . $row, $val_q4);
		$sheet->setCellValue('DS' . $row, $target_qty_q4);
		$sheet->setCellValue('DT' . $row, $target_val_q4);
		$sheet->setCellValue('DU' . $row, $idx_qty_q4);
		$sheet->setCellValue('DV' . $row, $idx_val_q4);

		$qty_year = $qty_jan + $qty_feb + $qty_mar + $qty_apr + $qty_mei + $qty_jun + $qty_jul + $qty_agu + $qty_sep + $qty_okt + $qty_nop + $qty_des;
		$target_qty_year = $target_qty_jan + $target_qty_feb + $target_qty_mar + $target_qty_apr + $target_qty_mei + $target_qty_jun + $target_qty_jul + $target_qty_agu + $target_qty_sep + $target_qty_okt + $target_qty_nop + $target_qty_des;
		$idx_qty_year = ($qty_year/($target_qty_year ?: 1))*100;
		$val_year = $val_jan + $val_feb + $val_mar + $val_apr + $val_mei + $val_jun + $val_jul + $val_agu + $val_sep + $val_okt + $val_nop + $val_des;
		$target_val_year = $target_val_jan + $target_val_feb + $target_val_mar + $target_val_apr + $target_val_mei + $target_val_jun + $target_val_jul + $target_val_agu + $target_val_sep + $target_val_okt + $target_val_nop + $target_val_des;
		$idx_val_year = ($val_year/($target_val_year ?: 1))*100;
		$qty_avg = $qty_year / 12;
		$target_qty_avg = $target_qty_year / 12;
		$idx_qty_avg = ($qty_avg/($target_qty_avg ?: 1))*100;
		$val_avg = $val_year / 12;
		$target_val_avg = $target_val_year / 12;
		$idx_val_avg = ($val_avg/($target_val_avg ?: 1))*100;

		$sheet->setCellValue('DW' . $row, $qty_year);
		$sheet->setCellValue('DX' . $row, $val_year);
		$sheet->setCellValue('DY' . $row, $target_qty_year);
		$sheet->setCellValue('DZ' . $row, $target_val_year);
		$sheet->setCellValue('EA' . $row, $idx_qty_year);
		$sheet->setCellValue('EB' . $row, $idx_val_year);
		$sheet->setCellValue('EC' . $row, $qty_avg);
		$sheet->setCellValue('ED' . $row, $val_avg);
		$sheet->setCellValue('EE' . $row, $target_qty_avg);
		$sheet->setCellValue('EF' . $row, $target_val_avg);
		$sheet->setCellValue('EG' . $row, $idx_qty_avg);
		$sheet->setCellValue('EH' . $row, $idx_val_avg);

		// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
		$sheet->getStyle('A' . $row)->applyFromArray($style_row);
		$sheet->getStyle('B' . $row)->applyFromArray($style_row);
		$sheet->getStyle('C' . $row)->applyFromArray($style_row);
		$sheet->getStyle('D' . $row)->applyFromArray($style_row);
		$sheet->getStyle('E' . $row)->applyFromArray($style_row);
		$sheet->getStyle('F' . $row)->applyFromArray($style_row);
		$sheet->getStyle('G' . $row)->applyFromArray($style_row);
		$sheet->getStyle('H' . $row)->applyFromArray($style_row);
		$sheet->getStyle('I' . $row)->applyFromArray($style_row);
		$sheet->getStyle('J' . $row)->applyFromArray($style_row);
		$sheet->getStyle('K' . $row)->applyFromArray($style_row);
		$sheet->getStyle('L' . $row)->applyFromArray($style_row);
		$sheet->getStyle('M' . $row)->applyFromArray($style_row);
		$sheet->getStyle('N' . $row)->applyFromArray($style_row);
		$sheet->getStyle('O' . $row)->applyFromArray($style_row);
		$sheet->getStyle('P' . $row)->applyFromArray($style_row);
		$sheet->getStyle('Q' . $row)->applyFromArray($style_row);
		$sheet->getStyle('R' . $row)->applyFromArray($style_row);
		$sheet->getStyle('S' . $row)->applyFromArray($style_row);
		$sheet->getStyle('T' . $row)->applyFromArray($style_row);
		$sheet->getStyle('U' . $row)->applyFromArray($style_row);
		$sheet->getStyle('V' . $row)->applyFromArray($style_row);
		$sheet->getStyle('W' . $row)->applyFromArray($style_row);
		$sheet->getStyle('X' . $row)->applyFromArray($style_row);
		$sheet->getStyle('Y' . $row)->applyFromArray($style_row);
		$sheet->getStyle('Z' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AA' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AB' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AC' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AD' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AE' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AF' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AG' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AH' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AI' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AJ' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AK' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AL' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AM' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AN' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AO' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AP' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AQ' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AR' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AS' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AT' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AU' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AV' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AW' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AX' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AY' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AZ' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BA' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BB' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BC' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BD' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BE' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BF' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BG' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BH' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BI' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BJ' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BK' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BL' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BM' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BN' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BO' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BP' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BQ' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BR' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BS' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BT' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BU' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BV' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BW' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BX' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BY' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BZ' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CA' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CB' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CC' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CD' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CE' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CF' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CG' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CH' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CI' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CJ' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CK' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CL' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CM' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CN' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CO' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CP' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CQ' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CR' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CS' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CT' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CU' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CV' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CW' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CX' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CY' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CZ' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DA' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DB' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DC' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DD' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DE' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DF' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DG' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DH' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DI' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DJ' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DK' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DL' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DM' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DN' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DO' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DP' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DQ' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DR' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DS' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DT' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DU' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DV' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DW' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DX' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DY' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DZ' . $row)->applyFromArray($style_row);
		$sheet->getStyle('EA' . $row)->applyFromArray($style_row);
		$sheet->getStyle('EB' . $row)->applyFromArray($style_row);
		$sheet->getStyle('EC' . $row)->applyFromArray($style_row);
		$sheet->getStyle('ED' . $row)->applyFromArray($style_row);
		$sheet->getStyle('EE' . $row)->applyFromArray($style_row);
		$sheet->getStyle('EF' . $row)->applyFromArray($style_row);
		$sheet->getStyle('EG' . $row)->applyFromArray($style_row);
		$sheet->getStyle('EH' . $row)->applyFromArray($style_row);


		$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('I' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('J' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('K' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('L' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('M' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('N' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('O' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('P' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('Q' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('R' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('S' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('T' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('U' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('V' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('W' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('X' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('Y' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('Z' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AA' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AB' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AC' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AD' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AE' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AF' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AG' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AH' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AI' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AJ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AK' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AL' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AM' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AN' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AO' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AP' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AQ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AR' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AS' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AT' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AU' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AV' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AX' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AY' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AZ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BA' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BB' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BC' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BD' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BE' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BF' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BG' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BH' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BI' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BJ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BK' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BL' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BM' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BN' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BO' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BQ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BR' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BS' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BT' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BU' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BV' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BW' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BX' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BY' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BZ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CA' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CB' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CC' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CD' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CE' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CF' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CG' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CH' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CI' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CJ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CK' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CL' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CM' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CN' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CO' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CP' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CQ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CR' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CS' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CT' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CU' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CV' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CW' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CX' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CY' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CZ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DA' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DB' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DC' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DD' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DE' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DF' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DG' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DH' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DI' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DJ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DK' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DL' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DM' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DN' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DO' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DP' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DQ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DR' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DS' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DT' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DU' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DV' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DW' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DX' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DY' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DZ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('EA' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('EB' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('EC' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('ED' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('EE' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('EF' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('EG' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('EH' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

		$sheet->getStyle('G' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('H' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('I' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('J' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('K' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('L' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('M' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('N' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('O' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('P' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('Q' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('R' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('S' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('T' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('U' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('V' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('W' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('X' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('Y' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('Z' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('AA' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('AB' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('AC' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AD' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('AE' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AF' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('AG' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AH' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('AI' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('AJ' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('AK' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AL' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('AM' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AN' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('AO' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('AP' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('AQ' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AR' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('AS' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AT' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('AU' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AV' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('AW' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('AX' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('AY' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AZ' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('AB' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('BB' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('BC' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('BD' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('BE' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('BF' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('BG' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('BH' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('BI' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('BJ' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('BK' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('BL' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('BM' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('BN' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('BO' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('BP' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('BQ' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('BR' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('BS' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('BT' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('BU' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('BV' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('BW' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('BX' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('BY' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('BZ' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('CA' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('CB' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('CC' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('CD' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('CE' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('CF' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('CG' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('CH' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('CI' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('CJ' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('CK' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('CL' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('CM' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('CN' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('CO' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('CP' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('CQ' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('CR' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('CS' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('CT' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('CU' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('CV' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('CW' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('CX' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('CY' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('CZ' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('DA' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('DB' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('DC' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('DD' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('DE' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('DF' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('DG' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('DH' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('DI' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('DJ' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('DK' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('DL' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('DM' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('DN' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('DO' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('DP' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('DQ' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('DR' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('DS' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('DT' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('DU' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('DW' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('DW' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('DX' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('DY' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('DZ' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('EA' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('EB' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('EC' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('ED' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('EE' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('EF' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('EG' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('EH' . $row)->getNumberFormat()->setFormatCode('#.00');

		$sheet->getStyle('A' . $row . ':EH' . $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');
		$sheet->getStyle('A' . $row . ':EH' . $row)->getFont()->setBold(true);

		//principal end
		$row = $row + 1;
		$sheet->setCellValue('A' . $row, '');
		$sheet->setCellValue('B' . $row, $principal);
		$sheet->setCellValue('C' . $row, '');
		$sheet->setCellValue('D' . $row, '');
		$sheet->setCellValue('E' . $row, 'TOTAL ' . $principal);
		$sheet->setCellValue('F' . $row, '');
		$sheet->setCellValue('G' . $row, $sub_qty_jan);
		$sheet->setCellValue('H' . $row, $sub_val_jan);
		$sheet->setCellValue('I' . $row, $sub_target_qty_jan);
		$sheet->setCellValue('J' . $row, $sub_target_val_jan);
		$sheet->setCellValue('K' . $row, $sub_idx_qty_jan);
		$sheet->setCellValue('L' . $row, $sub_idx_val_jan);
		$sheet->setCellValue('M' . $row, $sub_stok_qty_jan);
		$sheet->setCellValue('N' . $row, $sub_stok_val_jan);
		$sheet->setCellValue('O' . $row, $sub_qty_feb);
		$sheet->setCellValue('P' . $row, $sub_val_feb);
		$sheet->setCellValue('Q' . $row, $sub_target_qty_feb);
		$sheet->setCellValue('R' . $row, $sub_target_val_feb);
		$sheet->setCellValue('S' . $row, $sub_idx_qty_feb);
		$sheet->setCellValue('T' . $row, $sub_idx_val_feb);
		$sheet->setCellValue('U' . $row, $sub_stok_qty_feb);
		$sheet->setCellValue('V' . $row, $sub_stok_val_feb);
		$sheet->setCellValue('W' . $row, $sub_qty_mar);
		$sheet->setCellValue('X' . $row, $sub_val_mar);
		$sheet->setCellValue('Y' . $row, $sub_target_qty_mar);
		$sheet->setCellValue('Z' . $row, $sub_target_val_mar);
		$sheet->setCellValue('AA' . $row, $sub_idx_qty_mar);
		$sheet->setCellValue('AB' . $row, $sub_idx_val_mar);
		$sheet->setCellValue('AC' . $row, $sub_stok_qty_mar);
		$sheet->setCellValue('AD' . $row, $sub_stok_val_mar);
		$sheet->setCellValue('AE' . $row, $sub_qty_q1);
		$sheet->setCellValue('AF' . $row, $sub_val_q1);
		$sheet->setCellValue('AG' . $row, $sub_target_qty_q1);
		$sheet->setCellValue('AH' . $row, $sub_target_val_q1);
		$sheet->setCellValue('AI' . $row, $sub_idx_qty_q1);
		$sheet->setCellValue('AJ' . $row, $sub_idx_val_q1);

		$sheet->setCellValue('AK' . $row, $sub_qty_apr);
		$sheet->setCellValue('AL' . $row, $sub_val_apr);
		$sheet->setCellValue('AM' . $row, $sub_target_qty_apr);
		$sheet->setCellValue('AN' . $row, $sub_target_val_apr);
		$sheet->setCellValue('AO' . $row, $sub_idx_qty_apr);
		$sheet->setCellValue('AP' . $row, $sub_idx_val_apr);
		$sheet->setCellValue('AQ' . $row, $sub_stok_qty_apr);
		$sheet->setCellValue('AR' . $row, $sub_stok_val_apr);
		$sheet->setCellValue('AS' . $row, $sub_qty_mei);
		$sheet->setCellValue('AT' . $row, $sub_val_mei);
		$sheet->setCellValue('AU' . $row, $sub_target_qty_mei);
		$sheet->setCellValue('AV' . $row, $sub_target_val_mei);
		$sheet->setCellValue('AW' . $row, $sub_idx_qty_mei);
		$sheet->setCellValue('AX' . $row, $sub_idx_val_mei);
		$sheet->setCellValue('AY' . $row, $sub_stok_qty_mei);
		$sheet->setCellValue('AZ' . $row, $sub_stok_val_mei);
		$sheet->setCellValue('BA' . $row, $sub_qty_jun);
		$sheet->setCellValue('BB' . $row, $sub_val_jun);
		$sheet->setCellValue('BC' . $row, $sub_target_qty_jun);
		$sheet->setCellValue('BD' . $row, $sub_target_val_jun);
		$sheet->setCellValue('BE' . $row, $sub_idx_qty_jun);
		$sheet->setCellValue('BF' . $row, $sub_idx_val_jun);
		$sheet->setCellValue('BG' . $row, $sub_stok_qty_jun);
		$sheet->setCellValue('BH' . $row, $sub_stok_val_jun);
		$sheet->setCellValue('BI' . $row, $sub_qty_q2);
		$sheet->setCellValue('BJ' . $row, $sub_val_q2);
		$sheet->setCellValue('BK' . $row, $sub_target_qty_q2);
		$sheet->setCellValue('BL' . $row, $sub_target_val_q2);
		$sheet->setCellValue('BM' . $row, $sub_idx_qty_q2);
		$sheet->setCellValue('BN' . $row, $sub_idx_val_q2);

		$sheet->setCellValue('BO' . $row, $sub_qty_jul);
		$sheet->setCellValue('BP' . $row, $sub_val_jul);
		$sheet->setCellValue('BQ' . $row, $sub_target_qty_jul);
		$sheet->setCellValue('BR' . $row, $sub_target_val_jul);
		$sheet->setCellValue('BS' . $row, $sub_idx_qty_jul);
		$sheet->setCellValue('BT' . $row, $sub_idx_val_jul);
		$sheet->setCellValue('BU' . $row, $sub_stok_qty_jul);
		$sheet->setCellValue('BV' . $row, $sub_stok_val_jul);
		$sheet->setCellValue('BW' . $row, $sub_qty_agu);
		$sheet->setCellValue('BX' . $row, $sub_val_agu);
		$sheet->setCellValue('BY' . $row, $sub_target_qty_agu);
		$sheet->setCellValue('BZ' . $row, $sub_target_val_agu);
		$sheet->setCellValue('CA' . $row, $sub_idx_qty_agu);
		$sheet->setCellValue('CB' . $row, $sub_idx_val_agu);
		$sheet->setCellValue('CC' . $row, $sub_stok_qty_agu);
		$sheet->setCellValue('CD' . $row, $sub_stok_val_agu);
		$sheet->setCellValue('CE' . $row, $sub_qty_sep);
		$sheet->setCellValue('CF' . $row, $sub_val_sep);
		$sheet->setCellValue('CG' . $row, $sub_target_qty_sep);
		$sheet->setCellValue('CH' . $row, $sub_target_val_sep);
		$sheet->setCellValue('CI' . $row, $sub_idx_qty_sep);
		$sheet->setCellValue('CJ' . $row, $sub_idx_val_sep);
		$sheet->setCellValue('CK' . $row, $sub_stok_qty_sep);
		$sheet->setCellValue('CL' . $row, $sub_stok_val_sep);
		$sheet->setCellValue('CM' . $row, $sub_qty_q3);
		$sheet->setCellValue('CN' . $row, $sub_val_q3);
		$sheet->setCellValue('CO' . $row, $sub_target_qty_q3);
		$sheet->setCellValue('CP' . $row, $sub_target_val_q3);
		$sheet->setCellValue('CQ' . $row, $sub_idx_qty_q3);
		$sheet->setCellValue('CR' . $row, $sub_idx_val_q3);

		$sheet->setCellValue('CS' . $row, $sub_qty_okt);
		$sheet->setCellValue('CT' . $row, $sub_val_okt);
		$sheet->setCellValue('CU' . $row, $sub_target_qty_okt);
		$sheet->setCellValue('CV' . $row, $sub_target_val_okt);
		$sheet->setCellValue('CW' . $row, $sub_idx_qty_okt);
		$sheet->setCellValue('CX' . $row, $sub_idx_val_okt);
		$sheet->setCellValue('CY' . $row, $sub_stok_qty_okt);
		$sheet->setCellValue('CZ' . $row, $sub_stok_val_okt);
		$sheet->setCellValue('DA' . $row, $sub_qty_nop);
		$sheet->setCellValue('DB' . $row, $sub_val_nop);
		$sheet->setCellValue('DC' . $row, $sub_target_qty_nop);
		$sheet->setCellValue('DD' . $row, $sub_target_val_nop);
		$sheet->setCellValue('DE' . $row, $sub_idx_qty_nop);
		$sheet->setCellValue('DF' . $row, $sub_idx_val_nop);
		$sheet->setCellValue('DG' . $row, $sub_stok_qty_nop);
		$sheet->setCellValue('DH' . $row, $sub_stok_val_nop);
		$sheet->setCellValue('DI' . $row, $sub_qty_des);
		$sheet->setCellValue('DJ' . $row, $sub_val_des);
		$sheet->setCellValue('DK' . $row, $sub_target_qty_des);
		$sheet->setCellValue('DL' . $row, $sub_target_val_des);
		$sheet->setCellValue('DM' . $row, $sub_idx_qty_des);
		$sheet->setCellValue('DN' . $row, $sub_idx_val_des);
		$sheet->setCellValue('DO' . $row, $sub_stok_qty_des);
		$sheet->setCellValue('DP' . $row, $sub_stok_val_des);
		$sheet->setCellValue('DQ' . $row, $sub_qty_q4);
		$sheet->setCellValue('DR' . $row, $sub_val_q4);
		$sheet->setCellValue('DS' . $row, $sub_target_qty_q4);
		$sheet->setCellValue('DT' . $row, $sub_target_val_q4);
		$sheet->setCellValue('DU' . $row, $sub_idx_qty_q4);
		$sheet->setCellValue('DV' . $row, $sub_idx_val_q4);

		$sub_qty_year = $sub_qty_jan + $sub_qty_feb + $sub_qty_mar + $sub_qty_apr + $sub_qty_mei + $sub_qty_jun + $sub_qty_jul + $sub_qty_agu + $sub_qty_sep + $sub_qty_okt + $sub_qty_nop + $sub_qty_des;
		$sub_target_qty_year = $sub_target_qty_jan + $sub_target_qty_feb + $sub_target_qty_mar + $sub_target_qty_apr + $sub_target_qty_mei + $sub_target_qty_jun + $sub_target_qty_jul + $sub_target_qty_agu + $sub_target_qty_sep + $sub_target_qty_okt + $sub_target_qty_nop + $sub_target_qty_des;
		$sub_idx_qty_year = ($sub_qty_year/($sub_target_qty_year ?: 1))*100;
		$sub_val_year = $sub_val_jan + $sub_val_feb + $sub_val_mar + $sub_val_apr + $sub_val_mei + $sub_val_jun + $sub_val_jul + $sub_val_agu + $sub_val_sep + $sub_val_okt + $sub_val_nop + $sub_val_des;
		$sub_target_val_year = $sub_target_val_jan + $sub_target_val_feb + $sub_target_val_mar + $sub_target_val_apr + $sub_target_val_mei + $sub_target_val_jun + $sub_target_val_jul + $sub_target_val_agu + $sub_target_val_sep + $sub_target_val_okt + $sub_target_val_nop + $sub_target_val_des;
		$sub_idx_val_year = ($sub_val_year/($sub_target_val_year ?: 1))*100;
		$sub_qty_avg = $sub_qty_year / 12;
		$sub_target_qty_avg = $sub_target_qty_year / 12;
		$sub_idx_qty_avg = ($sub_qty_avg/($sub_target_qty_avg ?: 1))*100;
		$sub_val_avg = $sub_val_year / 12;
		$sub_target_val_avg = $sub_target_val_year / 12;
		$sub_idx_val_avg = ($sub_val_avg/($sub_target_val_avg ?: 1))*100;

		$sheet->setCellValue('DW' . $row, $sub_qty_year);
		$sheet->setCellValue('DX' . $row, $sub_val_year);
		$sheet->setCellValue('DY' . $row, $sub_target_qty_year);
		$sheet->setCellValue('DZ' . $row, $sub_target_val_year);
		$sheet->setCellValue('EA' . $row, $sub_idx_qty_year);
		$sheet->setCellValue('EB' . $row, $sub_idx_val_year);
		$sheet->setCellValue('EC' . $row, $sub_qty_avg);
		$sheet->setCellValue('ED' . $row, $sub_val_avg);
		$sheet->setCellValue('EE' . $row, $sub_target_qty_avg);
		$sheet->setCellValue('EF' . $row, $sub_target_val_avg);
		$sheet->setCellValue('EG' . $row, $sub_idx_qty_avg);
		$sheet->setCellValue('EH' . $row, $sub_idx_val_avg);

		// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
		$sheet->getStyle('A' . $row)->applyFromArray($style_row);
		$sheet->getStyle('B' . $row)->applyFromArray($style_row);
		$sheet->getStyle('C' . $row)->applyFromArray($style_row);
		$sheet->getStyle('D' . $row)->applyFromArray($style_row);
		$sheet->getStyle('E' . $row)->applyFromArray($style_row);
		$sheet->getStyle('F' . $row)->applyFromArray($style_row);
		$sheet->getStyle('G' . $row)->applyFromArray($style_row);
		$sheet->getStyle('H' . $row)->applyFromArray($style_row);
		$sheet->getStyle('I' . $row)->applyFromArray($style_row);
		$sheet->getStyle('J' . $row)->applyFromArray($style_row);
		$sheet->getStyle('K' . $row)->applyFromArray($style_row);
		$sheet->getStyle('L' . $row)->applyFromArray($style_row);
		$sheet->getStyle('M' . $row)->applyFromArray($style_row);
		$sheet->getStyle('N' . $row)->applyFromArray($style_row);
		$sheet->getStyle('O' . $row)->applyFromArray($style_row);
		$sheet->getStyle('P' . $row)->applyFromArray($style_row);
		$sheet->getStyle('Q' . $row)->applyFromArray($style_row);
		$sheet->getStyle('R' . $row)->applyFromArray($style_row);
		$sheet->getStyle('S' . $row)->applyFromArray($style_row);
		$sheet->getStyle('T' . $row)->applyFromArray($style_row);
		$sheet->getStyle('U' . $row)->applyFromArray($style_row);
		$sheet->getStyle('V' . $row)->applyFromArray($style_row);
		$sheet->getStyle('W' . $row)->applyFromArray($style_row);
		$sheet->getStyle('X' . $row)->applyFromArray($style_row);
		$sheet->getStyle('Y' . $row)->applyFromArray($style_row);
		$sheet->getStyle('Z' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AA' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AB' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AC' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AD' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AE' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AF' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AG' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AH' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AI' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AJ' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AK' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AL' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AM' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AN' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AO' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AP' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AQ' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AR' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AS' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AT' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AU' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AV' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AW' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AX' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AY' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AZ' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BA' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BB' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BC' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BD' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BE' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BF' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BG' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BH' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BI' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BJ' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BK' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BL' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BM' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BN' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BO' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BP' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BQ' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BR' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BS' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BT' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BU' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BV' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BW' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BX' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BY' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BZ' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CA' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CB' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CC' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CD' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CE' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CF' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CG' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CH' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CI' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CJ' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CK' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CL' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CM' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CN' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CO' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CP' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CQ' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CR' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CS' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CT' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CU' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CV' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CW' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CX' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CY' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CZ' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DA' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DB' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DC' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DD' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DE' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DF' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DG' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DH' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DI' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DJ' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DK' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DL' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DM' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DN' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DO' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DP' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DQ' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DR' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DS' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DT' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DU' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DV' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DW' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DX' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DY' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DZ' . $row)->applyFromArray($style_row);
		$sheet->getStyle('EA' . $row)->applyFromArray($style_row);
		$sheet->getStyle('EB' . $row)->applyFromArray($style_row);
		$sheet->getStyle('EC' . $row)->applyFromArray($style_row);
		$sheet->getStyle('ED' . $row)->applyFromArray($style_row);
		$sheet->getStyle('EE' . $row)->applyFromArray($style_row);
		$sheet->getStyle('EF' . $row)->applyFromArray($style_row);
		$sheet->getStyle('EG' . $row)->applyFromArray($style_row);
		$sheet->getStyle('EH' . $row)->applyFromArray($style_row);


		$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('I' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('J' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('K' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('L' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('M' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('N' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('O' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('P' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('Q' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('R' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('S' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('T' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('U' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('V' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('W' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('X' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('Y' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('Z' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AA' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AB' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AC' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AD' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AE' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AF' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AG' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AH' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AI' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AJ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AK' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AL' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AM' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AN' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AO' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AP' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AQ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AR' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AS' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AT' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AU' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AV' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AX' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AY' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AZ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BA' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BB' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BC' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BD' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BE' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BF' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BG' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BH' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BI' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BJ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BK' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BL' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BM' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BN' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BO' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BQ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BR' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BS' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BT' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BU' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BV' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BW' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BX' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BY' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BZ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CA' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CB' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CC' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CD' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CE' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CF' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CG' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CH' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CI' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CJ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CK' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CL' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CM' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CN' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CO' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CP' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CQ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CR' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CS' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CT' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CU' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CV' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CW' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CX' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CY' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CZ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DA' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DB' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DC' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DD' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DE' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DF' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DG' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DH' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DI' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DJ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DK' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DL' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DM' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DN' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DO' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DP' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DQ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DR' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DS' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DT' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DU' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DV' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DW' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DX' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DY' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DZ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('EA' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('EB' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('EC' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('ED' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('EE' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('EF' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('EG' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('EH' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

		$sheet->getStyle('G' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('H' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('I' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('J' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('K' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('L' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('M' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('N' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('O' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('P' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('Q' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('R' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('S' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('T' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('U' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('V' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('W' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('X' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('Y' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('Z' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('AA' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('AB' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('AC' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AD' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('AE' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AF' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('AG' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AH' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('AI' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('AJ' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('AK' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AL' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('AM' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AN' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('AO' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('AP' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('AQ' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AR' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('AS' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AT' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('AU' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AV' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('AW' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('AX' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('AY' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AZ' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('AB' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('BB' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('BC' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('BD' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('BE' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('BF' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('BG' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('BH' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('BI' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('BJ' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('BK' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('BL' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('BM' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('BN' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('BO' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('BP' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('BQ' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('BR' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('BS' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('BT' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('BU' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('BV' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('BW' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('BX' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('BY' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('BZ' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('CA' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('CB' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('CC' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('CD' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('CE' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('CF' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('CG' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('CH' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('CI' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('CJ' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('CK' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('CL' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('CM' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('CN' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('CO' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('CP' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('CQ' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('CR' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('CS' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('CT' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('CU' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('CV' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('CW' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('CX' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('CY' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('CZ' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('DA' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('DB' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('DC' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('DD' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('DE' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('DF' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('DG' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('DH' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('DI' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('DJ' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('DK' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('DL' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('DM' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('DN' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('DO' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('DP' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('DQ' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('DR' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('DS' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('DT' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('DU' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('DW' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('DW' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('DX' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('DY' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('DZ' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('EA' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('EB' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('EC' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('ED' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('EE' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('EF' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('EG' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('EH' . $row)->getNumberFormat()->setFormatCode('#.00');

		$sheet->getStyle('A' . $row . ':EH' . $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFA07A');
		$sheet->getStyle('A' . $row . ':EH' . $row)->getFont()->setBold(true);

		//grand total
		$row = $row + 1;
		$sheet->setCellValue('A' . $row, '');
		$sheet->setCellValue('B' . $row, '');
		$sheet->setCellValue('C' . $row, '');
		$sheet->setCellValue('D' . $row, '');
		$sheet->setCellValue('E' . $row, 'GRAND TOTAL');
		$sheet->setCellValue('F' . $row, '');
		$sheet->setCellValue('G' . $row, $total_qty_jan);
		$sheet->setCellValue('H' . $row, $total_val_jan);
		$sheet->setCellValue('I' . $row, $total_target_qty_jan);
		$sheet->setCellValue('J' . $row, $total_target_val_jan);
		$sheet->setCellValue('K' . $row, $total_idx_qty_jan);
		$sheet->setCellValue('L' . $row, $total_idx_val_jan);
		$sheet->setCellValue('M' . $row, $total_stok_qty_jan);
		$sheet->setCellValue('N' . $row, $total_stok_val_jan);
		$sheet->setCellValue('O' . $row, $total_qty_feb);
		$sheet->setCellValue('P' . $row, $total_val_feb);
		$sheet->setCellValue('Q' . $row, $total_target_qty_feb);
		$sheet->setCellValue('R' . $row, $total_target_val_feb);
		$sheet->setCellValue('S' . $row, $total_idx_qty_feb);
		$sheet->setCellValue('T' . $row, $total_idx_val_feb);
		$sheet->setCellValue('U' . $row, $total_stok_qty_feb);
		$sheet->setCellValue('V' . $row, $total_stok_val_feb);
		$sheet->setCellValue('W' . $row, $total_qty_mar);
		$sheet->setCellValue('X' . $row, $total_val_mar);
		$sheet->setCellValue('Y' . $row, $total_target_qty_mar);
		$sheet->setCellValue('Z' . $row, $total_target_val_mar);
		$sheet->setCellValue('AA' . $row, $total_idx_qty_mar);
		$sheet->setCellValue('AB' . $row, $total_idx_val_mar);
		$sheet->setCellValue('AC' . $row, $total_stok_qty_mar);
		$sheet->setCellValue('AD' . $row, $total_stok_val_mar);
		$sheet->setCellValue('AE' . $row, $total_qty_q1);
		$sheet->setCellValue('AF' . $row, $total_val_q1);
		$sheet->setCellValue('AG' . $row, $total_target_qty_q1);
		$sheet->setCellValue('AH' . $row, $total_target_val_q1);
		$sheet->setCellValue('AI' . $row, $total_idx_qty_q1);
		$sheet->setCellValue('AJ' . $row, $total_idx_val_q1);

		$sheet->setCellValue('AK' . $row, $total_qty_apr);
		$sheet->setCellValue('AL' . $row, $total_val_apr);
		$sheet->setCellValue('AM' . $row, $total_target_qty_apr);
		$sheet->setCellValue('AN' . $row, $total_target_val_apr);
		$sheet->setCellValue('AO' . $row, $total_idx_qty_apr);
		$sheet->setCellValue('AP' . $row, $total_idx_val_apr);
		$sheet->setCellValue('AQ' . $row, $total_stok_qty_apr);
		$sheet->setCellValue('AR' . $row, $total_stok_val_apr);
		$sheet->setCellValue('AS' . $row, $total_qty_mei);
		$sheet->setCellValue('AT' . $row, $total_val_mei);
		$sheet->setCellValue('AU' . $row, $total_target_qty_mei);
		$sheet->setCellValue('AV' . $row, $total_target_val_mei);
		$sheet->setCellValue('AW' . $row, $total_idx_qty_mei);
		$sheet->setCellValue('AX' . $row, $total_idx_val_mei);
		$sheet->setCellValue('AY' . $row, $total_stok_qty_mei);
		$sheet->setCellValue('AZ' . $row, $total_stok_val_mei);
		$sheet->setCellValue('BA' . $row, $total_qty_jun);
		$sheet->setCellValue('BB' . $row, $total_val_jun);
		$sheet->setCellValue('BC' . $row, $total_target_qty_jun);
		$sheet->setCellValue('BD' . $row, $total_target_val_jun);
		$sheet->setCellValue('BE' . $row, $total_idx_qty_jun);
		$sheet->setCellValue('BF' . $row, $total_idx_val_jun);
		$sheet->setCellValue('BG' . $row, $total_stok_qty_jun);
		$sheet->setCellValue('BH' . $row, $total_stok_val_jun);
		$sheet->setCellValue('BI' . $row, $total_qty_q2);
		$sheet->setCellValue('BJ' . $row, $total_val_q2);
		$sheet->setCellValue('BK' . $row, $total_target_qty_q2);
		$sheet->setCellValue('BL' . $row, $total_target_val_q2);
		$sheet->setCellValue('BM' . $row, $total_idx_qty_q2);
		$sheet->setCellValue('BN' . $row, $total_idx_val_q2);

		$sheet->setCellValue('BO' . $row, $total_qty_jul);
		$sheet->setCellValue('BP' . $row, $total_val_jul);
		$sheet->setCellValue('BQ' . $row, $total_target_qty_jul);
		$sheet->setCellValue('BR' . $row, $total_target_val_jul);
		$sheet->setCellValue('BS' . $row, $total_idx_qty_jul);
		$sheet->setCellValue('BT' . $row, $total_idx_val_jul);
		$sheet->setCellValue('BU' . $row, $total_stok_qty_jul);
		$sheet->setCellValue('BV' . $row, $total_stok_val_jul);
		$sheet->setCellValue('BW' . $row, $total_qty_agu);
		$sheet->setCellValue('BX' . $row, $total_val_agu);
		$sheet->setCellValue('BY' . $row, $total_target_qty_agu);
		$sheet->setCellValue('BZ' . $row, $total_target_val_agu);
		$sheet->setCellValue('CA' . $row, $total_idx_qty_agu);
		$sheet->setCellValue('CB' . $row, $total_idx_val_agu);
		$sheet->setCellValue('CC' . $row, $total_stok_qty_agu);
		$sheet->setCellValue('CD' . $row, $total_stok_val_agu);
		$sheet->setCellValue('CE' . $row, $total_qty_sep);
		$sheet->setCellValue('CF' . $row, $total_val_sep);
		$sheet->setCellValue('CG' . $row, $total_target_qty_sep);
		$sheet->setCellValue('CH' . $row, $total_target_val_sep);
		$sheet->setCellValue('CI' . $row, $total_idx_qty_sep);
		$sheet->setCellValue('CJ' . $row, $total_idx_val_sep);
		$sheet->setCellValue('CK' . $row, $total_stok_qty_sep);
		$sheet->setCellValue('CL' . $row, $total_stok_val_sep);
		$sheet->setCellValue('CM' . $row, $total_qty_q3);
		$sheet->setCellValue('CN' . $row, $total_val_q3);
		$sheet->setCellValue('CO' . $row, $total_target_qty_q3);
		$sheet->setCellValue('CP' . $row, $total_target_val_q3);
		$sheet->setCellValue('CQ' . $row, $total_idx_qty_q3);
		$sheet->setCellValue('CR' . $row, $total_idx_val_q3);

		$sheet->setCellValue('CS' . $row, $total_qty_okt);
		$sheet->setCellValue('CT' . $row, $total_val_okt);
		$sheet->setCellValue('CU' . $row, $total_target_qty_okt);
		$sheet->setCellValue('CV' . $row, $total_target_val_okt);
		$sheet->setCellValue('CW' . $row, $total_idx_qty_okt);
		$sheet->setCellValue('CX' . $row, $total_idx_val_okt);
		$sheet->setCellValue('CY' . $row, $total_stok_qty_okt);
		$sheet->setCellValue('CZ' . $row, $total_stok_val_okt);
		$sheet->setCellValue('DA' . $row, $total_qty_nop);
		$sheet->setCellValue('DB' . $row, $total_val_nop);
		$sheet->setCellValue('DC' . $row, $total_target_qty_nop);
		$sheet->setCellValue('DD' . $row, $total_target_val_nop);
		$sheet->setCellValue('DE' . $row, $total_idx_qty_nop);
		$sheet->setCellValue('DF' . $row, $total_idx_val_nop);
		$sheet->setCellValue('DG' . $row, $total_stok_qty_nop);
		$sheet->setCellValue('DH' . $row, $total_stok_val_nop);
		$sheet->setCellValue('DI' . $row, $total_qty_des);
		$sheet->setCellValue('DJ' . $row, $total_val_des);
		$sheet->setCellValue('DK' . $row, $total_target_qty_des);
		$sheet->setCellValue('DL' . $row, $total_target_val_des);
		$sheet->setCellValue('DM' . $row, $total_idx_qty_des);
		$sheet->setCellValue('DN' . $row, $total_idx_val_des);
		$sheet->setCellValue('DO' . $row, $total_stok_qty_des);
		$sheet->setCellValue('DP' . $row, $total_stok_val_des);
		$sheet->setCellValue('DQ' . $row, $total_qty_q4);
		$sheet->setCellValue('DR' . $row, $total_val_q4);
		$sheet->setCellValue('DS' . $row, $total_target_qty_q4);
		$sheet->setCellValue('DT' . $row, $total_target_val_q4);
		$sheet->setCellValue('DU' . $row, $total_idx_qty_q4);
		$sheet->setCellValue('DV' . $row, $total_idx_val_q4);

		$total_qty_year = $total_qty_jan + $total_qty_feb + $total_qty_mar + $total_qty_apr + $total_qty_mei + $total_qty_jun + $total_qty_jul + $total_qty_agu + $total_qty_sep + $total_qty_okt + $total_qty_nop + $total_qty_des;
		$total_target_qty_year = $total_target_qty_jan + $total_target_qty_feb + $total_target_qty_mar + $total_target_qty_apr + $total_target_qty_mei + $total_target_qty_jun + $total_target_qty_jul + $total_target_qty_agu + $total_target_qty_sep + $total_target_qty_okt + $total_target_qty_nop + $total_target_qty_des;
		$total_idx_qty_year = ($total_qty_year/($total_target_qty_year ?: 1))*100;
		$total_val_year = $total_val_jan + $total_val_feb + $total_val_mar + $total_val_apr + $total_val_mei + $total_val_jun + $total_val_jul + $total_val_agu + $total_val_sep + $total_val_okt + $total_val_nop + $total_val_des;
		$total_target_val_year = $total_target_val_jan + $total_target_val_feb + $total_target_val_mar + $total_target_val_apr + $total_target_val_mei + $total_target_val_jun + $total_target_val_jul + $total_target_val_agu + $total_target_val_sep + $total_target_val_okt + $total_target_val_nop + $total_target_val_des;
		$total_idx_val_year = ($total_val_year/($total_target_val_year ?: 1))*100;
		$total_qty_avg = $total_qty_year / 12;
		$total_target_qty_avg = $total_target_qty_year / 12;
		$total_idx_qty_avg = ($total_qty_avg/($total_target_qty_avg ?: 1))*100;
		$total_val_avg = $total_val_year / 12;
		$total_target_val_avg = $total_target_val_year / 12;
		$total_idx_val_avg = ($total_val_avg/($total_target_val_avg ?: 1))*100;

		$sheet->setCellValue('DW' . $row, $total_qty_year);
		$sheet->setCellValue('DX' . $row, $total_val_year);
		$sheet->setCellValue('DY' . $row, $total_target_qty_year);
		$sheet->setCellValue('DZ' . $row, $total_target_val_year);
		$sheet->setCellValue('EA' . $row, $total_idx_qty_year);
		$sheet->setCellValue('EB' . $row, $total_idx_val_year);
		$sheet->setCellValue('EC' . $row, $total_qty_avg);
		$sheet->setCellValue('ED' . $row, $total_val_avg);
		$sheet->setCellValue('EE' . $row, $total_target_qty_avg);
		$sheet->setCellValue('EF' . $row, $total_target_val_avg);
		$sheet->setCellValue('EG' . $row, $total_idx_qty_avg);
		$sheet->setCellValue('EH' . $row, $total_idx_val_avg);

		// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
		$sheet->getStyle('A' . $row)->applyFromArray($style_row);
		$sheet->getStyle('B' . $row)->applyFromArray($style_row);
		$sheet->getStyle('C' . $row)->applyFromArray($style_row);
		$sheet->getStyle('D' . $row)->applyFromArray($style_row);
		$sheet->getStyle('E' . $row)->applyFromArray($style_row);
		$sheet->getStyle('F' . $row)->applyFromArray($style_row);
		$sheet->getStyle('G' . $row)->applyFromArray($style_row);
		$sheet->getStyle('H' . $row)->applyFromArray($style_row);
		$sheet->getStyle('I' . $row)->applyFromArray($style_row);
		$sheet->getStyle('J' . $row)->applyFromArray($style_row);
		$sheet->getStyle('K' . $row)->applyFromArray($style_row);
		$sheet->getStyle('L' . $row)->applyFromArray($style_row);
		$sheet->getStyle('M' . $row)->applyFromArray($style_row);
		$sheet->getStyle('N' . $row)->applyFromArray($style_row);
		$sheet->getStyle('O' . $row)->applyFromArray($style_row);
		$sheet->getStyle('P' . $row)->applyFromArray($style_row);
		$sheet->getStyle('Q' . $row)->applyFromArray($style_row);
		$sheet->getStyle('R' . $row)->applyFromArray($style_row);
		$sheet->getStyle('S' . $row)->applyFromArray($style_row);
		$sheet->getStyle('T' . $row)->applyFromArray($style_row);
		$sheet->getStyle('U' . $row)->applyFromArray($style_row);
		$sheet->getStyle('V' . $row)->applyFromArray($style_row);
		$sheet->getStyle('W' . $row)->applyFromArray($style_row);
		$sheet->getStyle('X' . $row)->applyFromArray($style_row);
		$sheet->getStyle('Y' . $row)->applyFromArray($style_row);
		$sheet->getStyle('Z' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AA' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AB' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AC' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AD' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AE' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AF' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AG' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AH' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AI' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AJ' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AK' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AL' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AM' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AN' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AO' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AP' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AQ' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AR' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AS' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AT' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AU' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AV' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AW' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AX' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AY' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AZ' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BA' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BB' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BC' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BD' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BE' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BF' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BG' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BH' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BI' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BJ' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BK' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BL' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BM' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BN' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BO' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BP' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BQ' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BR' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BS' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BT' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BU' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BV' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BW' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BX' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BY' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BZ' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CA' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CB' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CC' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CD' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CE' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CF' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CG' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CH' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CI' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CJ' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CK' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CL' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CM' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CN' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CO' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CP' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CQ' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CR' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CS' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CT' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CU' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CV' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CW' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CX' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CY' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CZ' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DA' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DB' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DC' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DD' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DE' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DF' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DG' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DH' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DI' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DJ' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DK' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DL' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DM' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DN' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DO' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DP' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DQ' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DR' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DS' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DT' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DU' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DV' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DW' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DX' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DY' . $row)->applyFromArray($style_row);
		$sheet->getStyle('DZ' . $row)->applyFromArray($style_row);
		$sheet->getStyle('EA' . $row)->applyFromArray($style_row);
		$sheet->getStyle('EB' . $row)->applyFromArray($style_row);
		$sheet->getStyle('EC' . $row)->applyFromArray($style_row);
		$sheet->getStyle('ED' . $row)->applyFromArray($style_row);
		$sheet->getStyle('EE' . $row)->applyFromArray($style_row);
		$sheet->getStyle('EF' . $row)->applyFromArray($style_row);
		$sheet->getStyle('EG' . $row)->applyFromArray($style_row);
		$sheet->getStyle('EH' . $row)->applyFromArray($style_row);


		$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('I' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('J' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('K' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('L' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('M' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('N' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('O' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('P' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('Q' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('R' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('S' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('T' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('U' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('V' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('W' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('X' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('Y' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('Z' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AA' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AB' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AC' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AD' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AE' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AF' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AG' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AH' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AI' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AJ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AK' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AL' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AM' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AN' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AO' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AP' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AQ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AR' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AS' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AT' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AU' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AV' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AX' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AY' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AZ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BA' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BB' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BC' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BD' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BE' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BF' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BG' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BH' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BI' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BJ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BK' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BL' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BM' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BN' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BO' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BQ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BR' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BS' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BT' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BU' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BV' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BW' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BX' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BY' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BZ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CA' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CB' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CC' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CD' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CE' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CF' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CG' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CH' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CI' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CJ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CK' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CL' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CM' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CN' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CO' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CP' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CQ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CR' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CS' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CT' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CU' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CV' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CW' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CX' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CY' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CZ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DA' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DB' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DC' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DD' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DE' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DF' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DG' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DH' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DI' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DJ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DK' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DL' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DM' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DN' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DO' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DP' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DQ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DR' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DS' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DT' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DU' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DV' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DW' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DX' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DY' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('DZ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('EA' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('EB' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('EC' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('ED' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('EE' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('EF' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('EG' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('EH' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

		$sheet->getStyle('G' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('H' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('I' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('J' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('K' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('L' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('M' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('N' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('O' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('P' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('Q' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('R' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('S' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('T' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('U' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('V' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('W' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('X' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('Y' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('Z' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('AA' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('AB' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('AC' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AD' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('AE' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AF' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('AG' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AH' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('AI' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('AJ' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('AK' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AL' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('AM' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AN' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('AO' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('AP' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('AQ' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AR' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('AS' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AT' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('AU' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AV' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('AW' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('AX' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('AY' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AZ' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('AB' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('BB' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('BC' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('BD' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('BE' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('BF' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('BG' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('BH' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('BI' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('BJ' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('BK' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('BL' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('BM' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('BN' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('BO' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('BP' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('BQ' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('BR' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('BS' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('BT' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('BU' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('BV' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('BW' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('BX' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('BY' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('BZ' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('CA' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('CB' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('CC' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('CD' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('CE' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('CF' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('CG' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('CH' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('CI' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('CJ' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('CK' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('CL' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('CM' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('CN' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('CO' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('CP' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('CQ' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('CR' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('CS' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('CT' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('CU' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('CV' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('CW' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('CX' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('CY' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('CZ' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('DA' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('DB' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('DC' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('DD' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('DE' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('DF' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('DG' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('DH' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('DI' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('DJ' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('DK' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('DL' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('DM' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('DN' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('DO' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('DP' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('DQ' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('DR' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('DS' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('DT' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('DU' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('DW' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('DW' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('DX' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('DY' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('DZ' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('EA' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('EB' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('EC' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('ED' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('EE' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('EF' . $row)->getNumberFormat()->setFormatCode('#,##0.00');
		$sheet->getStyle('EG' . $row)->getNumberFormat()->setFormatCode('#.00');
		$sheet->getStyle('EH' . $row)->getNumberFormat()->setFormatCode('#.00');

		$sheet->getStyle('A' . $row . ':EH' . $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFA07A');
		$sheet->getStyle('A' . $row . ':EH' . $row)->getFont()->setBold(true);


		//set columns width
		$sheet->getColumnDimension('A')->setWidth(5); 
		$sheet->getColumnDimension('B')->setWidth(11); 
		$sheet->getColumnDimension('C')->setWidth(22);
		$sheet->getColumnDimension('D')->setWidth(12);
		$sheet->getColumnDimension('E')->setWidth(53);
		$sheet->getColumnDimension('F')->setWidth(6);
		$sheet->getColumnDimension('G')->setWidth(10);
		$sheet->getColumnDimension('H')->setWidth(20);
		$sheet->getColumnDimension('I')->setWidth(10);
		$sheet->getColumnDimension('J')->setWidth(20);
		$sheet->getColumnDimension('K')->setWidth(8);//Index(%)
		$sheet->getColumnDimension('L')->setWidth(8);//Index(%)
		$sheet->getColumnDimension('M')->setWidth(10);
		$sheet->getColumnDimension('N')->setWidth(20);
		$sheet->getColumnDimension('O')->setWidth(10);
		$sheet->getColumnDimension('P')->setWidth(20);
		$sheet->getColumnDimension('Q')->setWidth(10);
		$sheet->getColumnDimension('R')->setWidth(20);
		$sheet->getColumnDimension('S')->setWidth(8);//Index(%)
		$sheet->getColumnDimension('T')->setWidth(8);//Index(%)
		$sheet->getColumnDimension('U')->setWidth(10);
		$sheet->getColumnDimension('V')->setWidth(20);
		$sheet->getColumnDimension('W')->setWidth(10);
		$sheet->getColumnDimension('X')->setWidth(20);
		$sheet->getColumnDimension('Y')->setWidth(10);
		$sheet->getColumnDimension('Z')->setWidth(20);
		$sheet->getColumnDimension('AA')->setWidth(8);//Index(%)
		$sheet->getColumnDimension('AB')->setWidth(8);//Index(%)
		$sheet->getColumnDimension('AC')->setWidth(10);
		$sheet->getColumnDimension('AD')->setWidth(20);
		$sheet->getColumnDimension('AE')->setWidth(10);
		$sheet->getColumnDimension('AF')->setWidth(20);
		$sheet->getColumnDimension('AG')->setWidth(10);
		$sheet->getColumnDimension('AH')->setWidth(20);
		$sheet->getColumnDimension('AI')->setWidth(8);//Index(%)
		$sheet->getColumnDimension('AJ')->setWidth(8);//Index(%)
		$sheet->getColumnDimension('AK')->setWidth(10);
		$sheet->getColumnDimension('AL')->setWidth(20);
		$sheet->getColumnDimension('AM')->setWidth(10);
		$sheet->getColumnDimension('AN')->setWidth(20);
		$sheet->getColumnDimension('AO')->setWidth(8);//Index(%)
		$sheet->getColumnDimension('AP')->setWidth(8);//Index(%)
		$sheet->getColumnDimension('AQ')->setWidth(10);
		$sheet->getColumnDimension('AR')->setWidth(20);
		$sheet->getColumnDimension('AS')->setWidth(10);
		$sheet->getColumnDimension('AT')->setWidth(20);
		$sheet->getColumnDimension('AU')->setWidth(10);
		$sheet->getColumnDimension('AV')->setWidth(20);
		$sheet->getColumnDimension('AW')->setWidth(8);//Index(%)
		$sheet->getColumnDimension('AX')->setWidth(8);//Index(%)
		$sheet->getColumnDimension('AY')->setWidth(10);
		$sheet->getColumnDimension('AZ')->setWidth(20);
		$sheet->getColumnDimension('BA')->setWidth(10);
		$sheet->getColumnDimension('BB')->setWidth(20);
		$sheet->getColumnDimension('BC')->setWidth(10);
		$sheet->getColumnDimension('BD')->setWidth(20);
		$sheet->getColumnDimension('BE')->setWidth(8);//Index(%)
		$sheet->getColumnDimension('BF')->setWidth(8);//Index(%)
		$sheet->getColumnDimension('BG')->setWidth(10);
		$sheet->getColumnDimension('BH')->setWidth(20);
		$sheet->getColumnDimension('BI')->setWidth(10);
		$sheet->getColumnDimension('BJ')->setWidth(20);
		$sheet->getColumnDimension('BK')->setWidth(10);
		$sheet->getColumnDimension('BL')->setWidth(20);
		$sheet->getColumnDimension('BM')->setWidth(8);//Index(%)
		$sheet->getColumnDimension('BN')->setWidth(8);//Index(%)
		$sheet->getColumnDimension('BO')->setWidth(10);
		$sheet->getColumnDimension('BP')->setWidth(20);
		$sheet->getColumnDimension('BQ')->setWidth(10);
		$sheet->getColumnDimension('BR')->setWidth(20);
		$sheet->getColumnDimension('BS')->setWidth(8);//Index(%)
		$sheet->getColumnDimension('BT')->setWidth(8);//Index(%)
		$sheet->getColumnDimension('BU')->setWidth(10);
		$sheet->getColumnDimension('BV')->setWidth(20);
		$sheet->getColumnDimension('BW')->setWidth(10);
		$sheet->getColumnDimension('BX')->setWidth(20);
		$sheet->getColumnDimension('BY')->setWidth(10);
		$sheet->getColumnDimension('BZ')->setWidth(20);
		$sheet->getColumnDimension('CA')->setWidth(8);//Index(%)
		$sheet->getColumnDimension('CB')->setWidth(8);//Index(%)
		$sheet->getColumnDimension('CC')->setWidth(10);
		$sheet->getColumnDimension('CD')->setWidth(20);
		$sheet->getColumnDimension('CE')->setWidth(10);
		$sheet->getColumnDimension('CF')->setWidth(20);
		$sheet->getColumnDimension('CG')->setWidth(10);
		$sheet->getColumnDimension('CH')->setWidth(20);
		$sheet->getColumnDimension('CI')->setWidth(8);//Index(%)
		$sheet->getColumnDimension('CJ')->setWidth(8);//Index(%)
		$sheet->getColumnDimension('CK')->setWidth(10);
		$sheet->getColumnDimension('CL')->setWidth(20);
		$sheet->getColumnDimension('CM')->setWidth(10);
		$sheet->getColumnDimension('CN')->setWidth(20);
		$sheet->getColumnDimension('CO')->setWidth(10);
		$sheet->getColumnDimension('CP')->setWidth(20);
		$sheet->getColumnDimension('CQ')->setWidth(8);//Index(%)
		$sheet->getColumnDimension('CR')->setWidth(8);//Index(%)
		$sheet->getColumnDimension('CS')->setWidth(10);
		$sheet->getColumnDimension('CT')->setWidth(20);
		$sheet->getColumnDimension('CU')->setWidth(10);
		$sheet->getColumnDimension('CV')->setWidth(20);
		$sheet->getColumnDimension('CW')->setWidth(8);//Index(%)
		$sheet->getColumnDimension('CX')->setWidth(8);//Index(%)
		$sheet->getColumnDimension('CY')->setWidth(10);
		$sheet->getColumnDimension('CZ')->setWidth(20);
		$sheet->getColumnDimension('DA')->setWidth(10);
		$sheet->getColumnDimension('DB')->setWidth(20);
		$sheet->getColumnDimension('DC')->setWidth(10);
		$sheet->getColumnDimension('DC')->setWidth(20);
		$sheet->getColumnDimension('DE')->setWidth(8);//Index(%)
		$sheet->getColumnDimension('DF')->setWidth(8);//Index(%)
		$sheet->getColumnDimension('DG')->setWidth(10);
		$sheet->getColumnDimension('DH')->setWidth(20);
		$sheet->getColumnDimension('DI')->setWidth(10);
		$sheet->getColumnDimension('DJ')->setWidth(20);
		$sheet->getColumnDimension('DK')->setWidth(10);
		$sheet->getColumnDimension('DL')->setWidth(20);
		$sheet->getColumnDimension('DM')->setWidth(8);//Index(%)
		$sheet->getColumnDimension('DN')->setWidth(8);//Index(%)
		$sheet->getColumnDimension('DO')->setWidth(10);
		$sheet->getColumnDimension('DP')->setWidth(20);
		$sheet->getColumnDimension('DQ')->setWidth(10);
		$sheet->getColumnDimension('DR')->setWidth(20);
		$sheet->getColumnDimension('DS')->setWidth(10);
		$sheet->getColumnDimension('DT')->setWidth(20);
		$sheet->getColumnDimension('DU')->setWidth(8);//Index(%)
		$sheet->getColumnDimension('DV')->setWidth(8);//Index(%)
		$sheet->getColumnDimension('DW')->setWidth(10);
		$sheet->getColumnDimension('DX')->setWidth(20);
		$sheet->getColumnDimension('DY')->setWidth(10);
		$sheet->getColumnDimension('DZ')->setWidth(20);
		$sheet->getColumnDimension('DS')->setWidth(10);
		$sheet->getColumnDimension('DT')->setWidth(20);
		$sheet->getColumnDimension('EA')->setWidth(8);//Index(%)
		$sheet->getColumnDimension('EB')->setWidth(8);//Index(%)
		$sheet->getColumnDimension('EC')->setWidth(10);
		$sheet->getColumnDimension('ED')->setWidth(20);
		$sheet->getColumnDimension('EE')->setWidth(10);
		$sheet->getColumnDimension('EF')->setWidth(20);
		$sheet->getColumnDimension('EG')->setWidth(8);//Index(%)
		$sheet->getColumnDimension('EH')->setWidth(8);//Index(%)
		

		// Set orientasi kertas jadi LANDSCAPE
		$sheet->getPageSetup()->setOrientation(\PhpOffice\PhpSpreadsheet\Worksheet\PageSetup::ORIENTATION_LANDSCAPE);
		// Set judul file excel nya
		$sheet->setTitle("Selling Out - Performance");
		// Proses file excel
		header('Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet');
		header('Content-Disposition: attachment; filename="Report Selling Out - Performance ("' . $year . '").xlsx"'); // Set nama file excel nya
		header('Cache-Control: max-age=0');

		$writer = new Xlsx($spreadsheet);
		$writer->save('php://output');

	}

	public function export_sellingout_weekly()
	{
		$spreadsheet = new Spreadsheet();
		$sheet = $spreadsheet->getActiveSheet();
		// Buat sebuah variabel untuk menampung pengaturan style dari header tabel
		$style_col = [
			'font' => ['bold' => true], // Set font nya jadi bold
			'alignment' => [
				'horizontal' => \PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER, // Set text jadi ditengah secara horizontal (center)
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'top' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border top dengan garis tipis
				'right' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN],  // Set border right dengan garis tipis
				'bottom' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border bottom dengan garis tipis
				'left' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN] // Set border left dengan garis tipis
			]
		];
		// Buat sebuah variabel untuk menampung pengaturan style dari isi tabel
		$style_row = [
			'alignment' => [
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'top' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border top dengan garis tipis
				'right' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN],  // Set border right dengan garis tipis
				'bottom' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border bottom dengan garis tipis
				'left' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN] // Set border left dengan garis tipis
			]
		];


		if(isset($_POST['by_dist']))
		{
			$kode_dist = $_POST['by_dist'];
		}
		else
		{
			$kode_dist = "";
		}

		if (isset($_POST['by_year']))
		{
			$year = $_POST['by_year'];
		}
		else
		{
			$year = date('Y');
		}

		if(isset($_POST['by_month']))
		{
			$month = $_POST['by_month'];
		}
		else
		{
			$month = date('m');
		}

		$dateObj   = DateTime::createFromFormat('!m', $month);
		$monthName = $dateObj->format('F'); // March

		$data['distributor'] = $this->model('DistributorModel')->getDistByCode($kode_dist);


		$sheet->setCellValue('A1', "Report Selling Out - Weekly (" . $year . ")"); // Set kolom A1 dengan tulisan 
		$sheet->setCellValue('A2', "Distributor : " . $data['distributor']['distributor']);
		$sheet->setCellValue('A3', "Area : " . $data['distributor']['area']); 
		$sheet->setCellValue('A4', "Month : " . $monthName . " - " . $year); 
		//$sheet->mergeCells('A1:F1'); // Set Merge Cell pada kolom A1 sampai F1
		$sheet->getStyle('A1')->getFont()->setBold(true); // Set bold kolom A1
		$sheet->getStyle('A2')->getFont()->setBold(true);
		$sheet->getStyle('A3')->getFont()->setBold(true);
		$sheet->getStyle('A4')->getFont()->setBold(true);
		$sheet->getStyle('A1')->getFont()->setSize(20); // Set font size 15 untuk kolom A1
		// Buat header tabel nya pada baris ke 6
		$sheet->setCellValue('A6', "#"); // Set kolom A6 dengan tulisan "#"
		$sheet->mergeCells('A6:A8');//Set Merge Cell
		$sheet->setCellValue('B6', "Principal");
		$sheet->mergeCells('B6:B8');
		$sheet->setCellValue('C6', "Group SKU");
		$sheet->mergeCells('C6:C8'); 
		$sheet->setCellValue('D6', "Kode Item");
		$sheet->mergeCells('D6:D8'); 
		$sheet->setCellValue('E6', "SKU");
		$sheet->mergeCells('E6:E8');
		$sheet->setCellValue('F6', "Unit");
		$sheet->mergeCells('F6:F8');
		//Header 1
		$sheet->setCellValue('G6', "Selling Out");
		$sheet->mergeCells('G6:X6');
		$sheet->setCellValue('Y6', "STOCK");
		$sheet->mergeCells('Y6:AD6');

		$sheet->setCellValue('AF6', "W 1");
		$sheet->mergeCells('AF6:AF8');
		$sheet->setCellValue('AG6', "W 1 s/d W 2");
		$sheet->mergeCells('AG6:AG8');
		$sheet->setCellValue('AH6', "W 1 s/d W 3");
		$sheet->mergeCells('AH6:AH8');
		$sheet->setCellValue('AI6', "W 1 s/d W 4");
		$sheet->mergeCells('AI6:AI8');
		$sheet->setCellValue('AJ6', "W 1 s/d W 5");
		$sheet->mergeCells('AJ6:AJ8');
		$sheet->setCellValue('AK6', "W 1 s/d W 6");
		$sheet->mergeCells('AK6:AK8');

		//Header 2
		$sheet->setCellValue('G7', "Week I");
		$sheet->mergeCells('G7:H7');
		$sheet->setCellValue('I7', "Week II");
		$sheet->mergeCells('I7:J7');
		$sheet->setCellValue('K7', "Week III");
		$sheet->mergeCells('K7:L7');
		$sheet->setCellValue('M7', "Week IV");
		$sheet->mergeCells('M7:N7');
		$sheet->setCellValue('O7', "Week V");
		$sheet->mergeCells('O7:P7');
		$sheet->setCellValue('Q7', "Week VI");
		$sheet->mergeCells('Q7:R7');
		$sheet->setCellValue('S7', "Total");
		$sheet->mergeCells('S7:T7');
		$sheet->setCellValue('U7', "Target");
		$sheet->mergeCells('U7:V7');
		$sheet->setCellValue('W7', "Index(%)");
		$sheet->mergeCells('W7:X7');
		$sheet->setCellValue('Y7', "ENDING STOCK");
		$sheet->mergeCells('Y7:Z7');
		$sheet->setCellValue('AA7', "GOODS IN TRANSIT");
		$sheet->mergeCells('AA7:AB7');
		$sheet->setCellValue('AC7', "TOTAL ENDING STOCK");
		$sheet->mergeCells('AC7:AD7');

		//Header QTY, VALUE
		$sheet->setCellValue('G8', "Qty");
		$sheet->setCellValue('H8', "Value");
		$sheet->setCellValue('I8', "Qty");
		$sheet->setCellValue('J8', "Value");
		$sheet->setCellValue('K8', "Qty");
		$sheet->setCellValue('L8', "Value");
		$sheet->setCellValue('M8', "Qty");
		$sheet->setCellValue('N8', "Value");
		$sheet->setCellValue('O8', "Qty");
		$sheet->setCellValue('P8', "Value");
		$sheet->setCellValue('Q8', "Qty");
		$sheet->setCellValue('R8', "Value");
		$sheet->setCellValue('S8', "Qty");
		$sheet->setCellValue('T8', "Value");
		$sheet->setCellValue('U8', "Qty");
		$sheet->setCellValue('V8', "Value");
		$sheet->setCellValue('W8', "Qty");
		$sheet->setCellValue('X8', "Value");
		$sheet->setCellValue('Y8', "Qty");
		$sheet->setCellValue('Z8', "Value");
		$sheet->setCellValue('AA8', "Qty");
		$sheet->setCellValue('AB8', "Value");
		$sheet->setCellValue('AC8', "Qty");
		$sheet->setCellValue('AD8', "Value");
		
		// Apply style header yang telah kita buat tadi ke masing-masing kolom header
		$sheet->getStyle('A6')->applyFromArray($style_col);
		$sheet->getStyle('B6')->applyFromArray($style_col);
		$sheet->getStyle('C6')->applyFromArray($style_col);
		$sheet->getStyle('D6')->applyFromArray($style_col);
		$sheet->getStyle('E6')->applyFromArray($style_col);
		$sheet->getStyle('F6')->applyFromArray($style_col);
		$sheet->getStyle('G6')->applyFromArray($style_col);
		$sheet->getStyle('H6')->applyFromArray($style_col);
		$sheet->getStyle('I6')->applyFromArray($style_col);
		$sheet->getStyle('J6')->applyFromArray($style_col);
		$sheet->getStyle('K6')->applyFromArray($style_col);
		$sheet->getStyle('L6')->applyFromArray($style_col);
		$sheet->getStyle('M6')->applyFromArray($style_col);
		$sheet->getStyle('N6')->applyFromArray($style_col);
		$sheet->getStyle('O6')->applyFromArray($style_col);
		$sheet->getStyle('P6')->applyFromArray($style_col);
		$sheet->getStyle('Q6')->applyFromArray($style_col);
		$sheet->getStyle('R6')->applyFromArray($style_col);
		$sheet->getStyle('S6')->applyFromArray($style_col);
		$sheet->getStyle('T6')->applyFromArray($style_col);
		$sheet->getStyle('U6')->applyFromArray($style_col);
		$sheet->getStyle('V6')->applyFromArray($style_col);
		$sheet->getStyle('W6')->applyFromArray($style_col);
		$sheet->getStyle('X6')->applyFromArray($style_col);
		$sheet->getStyle('Y6')->applyFromArray($style_col);
		$sheet->getStyle('Z6')->applyFromArray($style_col);
		$sheet->getStyle('AA6')->applyFromArray($style_col);
		$sheet->getStyle('AB6')->applyFromArray($style_col);
		$sheet->getStyle('AC6')->applyFromArray($style_col);
		$sheet->getStyle('AD6')->applyFromArray($style_col);

		$sheet->getStyle('AF6')->applyFromArray($style_col);
		$sheet->getStyle('AG6')->applyFromArray($style_col);
		$sheet->getStyle('AH6')->applyFromArray($style_col);
		$sheet->getStyle('AI6')->applyFromArray($style_col);
		$sheet->getStyle('AJ6')->applyFromArray($style_col);
		$sheet->getStyle('AK6')->applyFromArray($style_col);

		$sheet->getStyle('A7')->applyFromArray($style_col);
		$sheet->getStyle('B7')->applyFromArray($style_col);
		$sheet->getStyle('C7')->applyFromArray($style_col);
		$sheet->getStyle('D7')->applyFromArray($style_col);
		$sheet->getStyle('E7')->applyFromArray($style_col);
		$sheet->getStyle('F7')->applyFromArray($style_col);
		$sheet->getStyle('G7')->applyFromArray($style_col);
		$sheet->getStyle('H7')->applyFromArray($style_col);
		$sheet->getStyle('I7')->applyFromArray($style_col);
		$sheet->getStyle('J7')->applyFromArray($style_col);
		$sheet->getStyle('K7')->applyFromArray($style_col);
		$sheet->getStyle('L7')->applyFromArray($style_col);
		$sheet->getStyle('M7')->applyFromArray($style_col);
		$sheet->getStyle('N7')->applyFromArray($style_col);
		$sheet->getStyle('O7')->applyFromArray($style_col);
		$sheet->getStyle('P7')->applyFromArray($style_col);
		$sheet->getStyle('Q7')->applyFromArray($style_col);
		$sheet->getStyle('R7')->applyFromArray($style_col);
		$sheet->getStyle('S7')->applyFromArray($style_col);
		$sheet->getStyle('T7')->applyFromArray($style_col);
		$sheet->getStyle('U7')->applyFromArray($style_col);
		$sheet->getStyle('V7')->applyFromArray($style_col);
		$sheet->getStyle('W7')->applyFromArray($style_col);
		$sheet->getStyle('X7')->applyFromArray($style_col);
		$sheet->getStyle('Y7')->applyFromArray($style_col);
		$sheet->getStyle('Z7')->applyFromArray($style_col);
		$sheet->getStyle('AA7')->applyFromArray($style_col);
		$sheet->getStyle('AB7')->applyFromArray($style_col);
		$sheet->getStyle('AC7')->applyFromArray($style_col);
		$sheet->getStyle('AD7')->applyFromArray($style_col);

		$sheet->getStyle('AF7')->applyFromArray($style_col);
		$sheet->getStyle('AG7')->applyFromArray($style_col);
		$sheet->getStyle('AH7')->applyFromArray($style_col);
		$sheet->getStyle('AI7')->applyFromArray($style_col);
		$sheet->getStyle('AJ7')->applyFromArray($style_col);
		$sheet->getStyle('AK7')->applyFromArray($style_col);

		$sheet->getStyle('A8')->applyFromArray($style_col);
		$sheet->getStyle('B8')->applyFromArray($style_col);
		$sheet->getStyle('C8')->applyFromArray($style_col);
		$sheet->getStyle('D8')->applyFromArray($style_col);
		$sheet->getStyle('E8')->applyFromArray($style_col);
		$sheet->getStyle('F8')->applyFromArray($style_col);
		$sheet->getStyle('G8')->applyFromArray($style_col);
		$sheet->getStyle('H8')->applyFromArray($style_col);
		$sheet->getStyle('I8')->applyFromArray($style_col);
		$sheet->getStyle('J8')->applyFromArray($style_col);
		$sheet->getStyle('K8')->applyFromArray($style_col);
		$sheet->getStyle('L8')->applyFromArray($style_col);
		$sheet->getStyle('M8')->applyFromArray($style_col);
		$sheet->getStyle('N8')->applyFromArray($style_col);
		$sheet->getStyle('O8')->applyFromArray($style_col);
		$sheet->getStyle('P8')->applyFromArray($style_col);
		$sheet->getStyle('Q8')->applyFromArray($style_col);
		$sheet->getStyle('R8')->applyFromArray($style_col);
		$sheet->getStyle('S8')->applyFromArray($style_col);
		$sheet->getStyle('T8')->applyFromArray($style_col);
		$sheet->getStyle('U8')->applyFromArray($style_col);
		$sheet->getStyle('V8')->applyFromArray($style_col);
		$sheet->getStyle('W8')->applyFromArray($style_col);
		$sheet->getStyle('X8')->applyFromArray($style_col);
		$sheet->getStyle('Y8')->applyFromArray($style_col);
		$sheet->getStyle('Z8')->applyFromArray($style_col);
		$sheet->getStyle('AA8')->applyFromArray($style_col);
		$sheet->getStyle('AB8')->applyFromArray($style_col);
		$sheet->getStyle('AC8')->applyFromArray($style_col);
		$sheet->getStyle('AD8')->applyFromArray($style_col);

		$sheet->getStyle('AF8')->applyFromArray($style_col);
		$sheet->getStyle('AG8')->applyFromArray($style_col);
		$sheet->getStyle('AH8')->applyFromArray($style_col);
		$sheet->getStyle('AI8')->applyFromArray($style_col);
		$sheet->getStyle('AJ8')->applyFromArray($style_col);
		$sheet->getStyle('AK8')->applyFromArray($style_col);

		$sheet->getStyle('A6:AD8')->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');
		$sheet->getStyle('AF6:AK8')->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');

		// Set height baris ke 1 dan 2
		$sheet->getRowDimension('1')->setRowHeight(40);
		$sheet->getRowDimension('2')->setRowHeight(20);
		$sheet->getRowDimension('3')->setRowHeight(20);
		$sheet->getRowDimension('4')->setRowHeight(20);


		$item_group = '';
        $principal = '';

        $qty_w1 = 0;
		$qty_w2 = 0;
		$qty_w3 = 0;
		$qty_w4 = 0;
		$qty_w5 = 0;
		$qty_w6 = 0;
		$qty_total = 0;
		$qty_target = 0;
		$qty_ending = 0;
		$qty_transit = 0;

		$value_w1 = 0;
		$value_w2 = 0;
		$value_w3 = 0;
		$value_w4 = 0;
		$value_w5 = 0;
		$value_w6 = 0;
		$value_total = 0;
		$value_target = 0;
		$value_ending = 0;
		$value_transit = 0;

		$sub_qty_w1 = 0;
		$sub_qty_w2 = 0;
		$sub_qty_w3 = 0;
		$sub_qty_w4 = 0;
		$sub_qty_w5 = 0;
		$sub_qty_w6 = 0;
		$sub_qty_total = 0;
		$sub_qty_target = 0;
		$sub_qty_ending = 0;
		$sub_qty_transit = 0;

		$sub_value_w1 = 0;
		$sub_value_w2 = 0;
		$sub_value_w3 = 0;
		$sub_value_w4 = 0;
		$sub_value_w5 = 0;
		$sub_value_w6 = 0;
		$sub_value_total = 0;
		$sub_value_target = 0;
		$sub_value_ending = 0;
		$sub_value_transit = 0;

		$total_qty_w1 = 0;
		$total_qty_w2 = 0;
		$total_qty_w3 = 0;
		$total_qty_w4 = 0;
		$total_qty_w5 = 0;
		$total_qty_w6 = 0;
		$total_qty_total = 0;
		$total_qty_target = 0;
		$total_qty_ending = 0;
		$total_qty_transit = 0;

		$total_value_w1 = 0;
		$total_value_w2 = 0;
		$total_value_w3 = 0;
		$total_value_w4 = 0;
		$total_value_w5 = 0;
		$total_value_w6 = 0;
		$total_value_total = 0;
		$total_value_target = 0;
		$total_value_ending = 0;
		$total_value_transit = 0;


		$no = 1; // Untuk penomoran tabel, di awal set dengan 1
		$row = 9;

		$data['sellingout'] = $this->model('ReportModel')->getSellingOut_Month();

		foreach ($data['sellingout'] as $rows) :

			if ($item_group != $rows['item_group'] and $item_group != '' )
            {
				
				$sheet->setCellValue('A' . $row, '');
				$sheet->setCellValue('B' . $row, $principal);
				$sheet->setCellValue('C' . $row, $item_group);
				$sheet->setCellValue('D' . $row, '');
				$sheet->setCellValue('E' . $row, 'Sub Total ' . $item_group);
				$sheet->setCellValue('F' . $row, '');
				$sheet->setCellValue('G' . $row, number_format($qty_w1, 0));
				$sheet->setCellValue('H' . $row, number_format($value_w1, 2));
				$sheet->setCellValue('I' . $row, number_format($qty_w2, 0));
				$sheet->setCellValue('J' . $row, number_format($value_w2, 2));
				$sheet->setCellValue('K' . $row, number_format($qty_w3, 0));
				$sheet->setCellValue('L' . $row, number_format($value_w3, 2));
				$sheet->setCellValue('M' . $row, number_format($qty_w4, 0));
				$sheet->setCellValue('N' . $row, number_format($value_w4, 2));
				$sheet->setCellValue('O' . $row, number_format($qty_w5, 0));
				$sheet->setCellValue('P' . $row, number_format($value_w5, 2));
				$sheet->setCellValue('Q' . $row, number_format($qty_w6, 0));
				$sheet->setCellValue('R' . $row, number_format($value_w6, 2));
				$sheet->setCellValue('S' . $row, number_format($qty_total, 0));
				$sheet->setCellValue('T' . $row, number_format($value_total, 2));
				$sheet->setCellValue('U' . $row, number_format($qty_target, 0));
				$sheet->setCellValue('V' . $row, number_format($value_target, 2));

				if(qty_target != 0 and value_index != 0)
				{
					$qty_index = ($qty_total/($qty_target) ?: 0)*100;
					$value_index = ($value_total/($value_target) ?: 0)*100;
				}
				else
				{
					$qty_index = 0;
					$value_index = 0;
				}

				$sheet->setCellValue('W' . $row, number_format($qty_index, 0));
				$sheet->setCellValue('X' . $row, number_format($value_index, 0));
				$sheet->setCellValue('Y' . $row, number_format($qty_ending, 0));
				$sheet->setCellValue('Z' . $row, number_format($value_ending, 2));
				$sheet->setCellValue('AA' . $row, number_format($qty_transit, 0));
				$sheet->setCellValue('AB' . $row, number_format($value_transit, 2));

				$qty_total_ending = $qty_ending + $qty_transit;
				$value_total_ending = $value_ending + $value_transit;

				$sheet->setCellValue('AC' . $row, number_format($qty_total_ending, 0));
				$sheet->setCellValue('AD' . $row, number_format($value_total_ending, 2));

				$sheet->setCellValue('AF' . $row, number_format($qty_w1, 0));
				$sheet->setCellValue('AG' . $row, number_format($qty_w1 + $qty_w2, 0));
				$sheet->setCellValue('AH' . $row, number_format($qty_w1 + $qty_w2 + $qty_w3, 0));
				$sheet->setCellValue('AI' . $row, number_format($qty_w1 + $qty_w2 + $qty_w3 + $qty_w4, 0));
				$sheet->setCellValue('AJ' . $row, number_format($qty_w1 + $qty_w2 + $qty_w3 + $qty_w4 + $qty_w5, 0));
				$sheet->setCellValue('AK' . $row, number_format($qty_w1 + $qty_w2 + $qty_w3 + $qty_w4 + $qty_w5 + $qty_w6, 0));

				// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
				$sheet->getStyle('A' . $row)->applyFromArray($style_row);
				$sheet->getStyle('B' . $row)->applyFromArray($style_row);
				$sheet->getStyle('C' . $row)->applyFromArray($style_row);
				$sheet->getStyle('D' . $row)->applyFromArray($style_row);
				$sheet->getStyle('E' . $row)->applyFromArray($style_row);
				$sheet->getStyle('F' . $row)->applyFromArray($style_row);
				$sheet->getStyle('G' . $row)->applyFromArray($style_row);
				$sheet->getStyle('H' . $row)->applyFromArray($style_row);
				$sheet->getStyle('I' . $row)->applyFromArray($style_row);
				$sheet->getStyle('J' . $row)->applyFromArray($style_row);
				$sheet->getStyle('K' . $row)->applyFromArray($style_row);
				$sheet->getStyle('L' . $row)->applyFromArray($style_row);
				$sheet->getStyle('M' . $row)->applyFromArray($style_row);
				$sheet->getStyle('N' . $row)->applyFromArray($style_row);
				$sheet->getStyle('O' . $row)->applyFromArray($style_row);
				$sheet->getStyle('P' . $row)->applyFromArray($style_row);
				$sheet->getStyle('Q' . $row)->applyFromArray($style_row);
				$sheet->getStyle('R' . $row)->applyFromArray($style_row);
				$sheet->getStyle('S' . $row)->applyFromArray($style_row);
				$sheet->getStyle('T' . $row)->applyFromArray($style_row);
				$sheet->getStyle('U' . $row)->applyFromArray($style_row);
				$sheet->getStyle('V' . $row)->applyFromArray($style_row);
				$sheet->getStyle('W' . $row)->applyFromArray($style_row);
				$sheet->getStyle('X' . $row)->applyFromArray($style_row);
				$sheet->getStyle('Y' . $row)->applyFromArray($style_row);
				$sheet->getStyle('Z' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AA' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AB' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AC' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AD' . $row)->applyFromArray($style_row);

				$sheet->getStyle('AF' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AG' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AH' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AI' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AJ' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AK' . $row)->applyFromArray($style_row);

				$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
				$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
				$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
				$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
				$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
				$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
				$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('I' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('J' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('K' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('L' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('M' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('N' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('O' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('P' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('Q' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('R' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('S' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('T' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('U' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('V' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('W' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('X' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('Y' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('Z' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AA' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AB' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AC' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AD' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

				$sheet->getStyle('AF' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AG' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AH' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AI' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AJ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AK' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
	
				$sheet->getStyle('A' . $row . ':AD' . $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');
				$sheet->getStyle('A' . $row . ':AD' . $row)->getFont()->setBold(true);

				$sheet->getStyle('AF' . $row . ':AK' . $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');
				$sheet->getStyle('AF' . $row . ':AK' . $row)->getFont()->setBold(true);

				$qty_w1 = 0;
				$qty_w2 = 0;
				$qty_w3 = 0;
				$qty_w4 = 0;
				$qty_w5 = 0;
				$qty_w6 = 0;
				$qty_total = 0;
				$qty_target = 0;
				$qty_ending = 0;
				$qty_transit = 0;

				$value_w1 = 0;
				$value_w2 = 0;
				$value_w3 = 0;
				$value_w4 = 0;
				$value_w5 = 0;
				$value_w6 = 0;
				$value_total = 0;
				$value_target = 0;
				$value_ending = 0;
				$value_transit = 0;

				$row++;
            }

			if ($principal != $rows['principal'] and $principal != '' )
            {
				
				$sheet->setCellValue('A' . $row, '');
				$sheet->setCellValue('B' . $row, $principal);
				$sheet->setCellValue('C' . $row, '');
				$sheet->setCellValue('D' . $row, '');
				$sheet->setCellValue('E' . $row, 'TOTAL ' . $principal);
				$sheet->setCellValue('F' . $row, '');
				$sheet->setCellValue('G' . $row, number_format($sub_qty_w1, 0));
				$sheet->setCellValue('H' . $row, number_format($sub_value_w1, 2));
				$sheet->setCellValue('I' . $row, number_format($sub_qty_w2, 0));
				$sheet->setCellValue('J' . $row, number_format($sub_value_w2, 2));
				$sheet->setCellValue('K' . $row, number_format($sub_qty_w3, 0));
				$sheet->setCellValue('L' . $row, number_format($sub_value_w3, 2));
				$sheet->setCellValue('M' . $row, number_format($sub_qty_w4, 0));
				$sheet->setCellValue('N' . $row, number_format($sub_value_w4, 2));
				$sheet->setCellValue('O' . $row, number_format($sub_qty_w5, 0));
				$sheet->setCellValue('P' . $row, number_format($sub_value_w5, 2));
				$sheet->setCellValue('Q' . $row, number_format($sub_qty_w6, 0));
				$sheet->setCellValue('R' . $row, number_format($sub_value_w6, 2));
				$sheet->setCellValue('S' . $row, number_format($sub_qty_total, 0));
				$sheet->setCellValue('T' . $row, number_format($sub_value_total, 2));
				$sheet->setCellValue('U' . $row, number_format($sub_qty_target, 0));
				$sheet->setCellValue('V' . $row, number_format($sub_value_target, 2));

				if(sub_qty_target != 0 and sub_value_target != 0)
				{
					$sub_qty_index = ($sub_qty_total/($sub_qty_target) ?: 0)*100;
					$sub_value_index = ($sub_value_total/($sub_value_target) ?: 0)*100;
				}
				else
				{
					$sub_qty_index = 0;
					$sub_value_index = 0;
				}

				$sheet->setCellValue('W' . $row, number_format($sub_qty_index, 0));
				$sheet->setCellValue('X' . $row, number_format($sub_value_index, 0));
				$sheet->setCellValue('Y' . $row, number_format($sub_qty_ending, 0));
				$sheet->setCellValue('Z' . $row, number_format($sub_value_ending, 2));
				$sheet->setCellValue('AA' . $row, number_format($sub_qty_transit, 0));
				$sheet->setCellValue('AB' . $row, number_format($sub_value_transit, 2));

				$sub_qty_total_ending = $sub_qty_ending + $sub_qty_transit;
				$sub_value_total_ending = $sub_value_ending + $sub_value_transit;

				$sheet->setCellValue('AC' . $row, number_format($qty_total_ending, 0));
				$sheet->setCellValue('AD' . $row, number_format($value_total_ending, 2));

				$sheet->setCellValue('AF' . $row, number_format($sub_qty_w1, 0));
				$sheet->setCellValue('AG' . $row, number_format($sub_qty_w1 + $sub_qty_w2, 0));
				$sheet->setCellValue('AH' . $row, number_format($sub_qty_w1 + $sub_qty_w2 + $sub_qty_w3, 0));
				$sheet->setCellValue('AI' . $row, number_format($sub_qty_w1 + $sub_qty_w2 + $sub_qty_w3 + $sub_qty_w4, 0));
				$sheet->setCellValue('AJ' . $row, number_format($sub_qty_w1 + $sub_qty_w2 + $sub_qty_w3 + $sub_qty_w4 + $sub_qty_w5, 0));
				$sheet->setCellValue('AK' . $row, number_format($sub_qty_w1 + $sub_qty_w2 + $sub_qty_w3 + $sub_qty_w4 + $sub_qty_w5 + $sub_qty_w6, 0));
				
				// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
				$sheet->getStyle('A' . $row)->applyFromArray($style_row);
				$sheet->getStyle('B' . $row)->applyFromArray($style_row);
				$sheet->getStyle('C' . $row)->applyFromArray($style_row);
				$sheet->getStyle('D' . $row)->applyFromArray($style_row);
				$sheet->getStyle('E' . $row)->applyFromArray($style_row);
				$sheet->getStyle('F' . $row)->applyFromArray($style_row);
				$sheet->getStyle('G' . $row)->applyFromArray($style_row);
				$sheet->getStyle('H' . $row)->applyFromArray($style_row);
				$sheet->getStyle('I' . $row)->applyFromArray($style_row);
				$sheet->getStyle('J' . $row)->applyFromArray($style_row);
				$sheet->getStyle('K' . $row)->applyFromArray($style_row);
				$sheet->getStyle('L' . $row)->applyFromArray($style_row);
				$sheet->getStyle('M' . $row)->applyFromArray($style_row);
				$sheet->getStyle('N' . $row)->applyFromArray($style_row);
				$sheet->getStyle('O' . $row)->applyFromArray($style_row);
				$sheet->getStyle('P' . $row)->applyFromArray($style_row);
				$sheet->getStyle('Q' . $row)->applyFromArray($style_row);
				$sheet->getStyle('R' . $row)->applyFromArray($style_row);
				$sheet->getStyle('S' . $row)->applyFromArray($style_row);
				$sheet->getStyle('T' . $row)->applyFromArray($style_row);
				$sheet->getStyle('U' . $row)->applyFromArray($style_row);
				$sheet->getStyle('V' . $row)->applyFromArray($style_row);
				$sheet->getStyle('W' . $row)->applyFromArray($style_row);
				$sheet->getStyle('X' . $row)->applyFromArray($style_row);
				$sheet->getStyle('Y' . $row)->applyFromArray($style_row);
				$sheet->getStyle('Z' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AA' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AB' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AC' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AD' . $row)->applyFromArray($style_row);

				$sheet->getStyle('AF' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AG' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AH' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AI' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AJ' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AK' . $row)->applyFromArray($style_row);


				$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
				$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
				$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
				$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
				$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
				$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
				$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('I' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('J' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('K' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('L' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('M' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('N' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('O' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('P' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('Q' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('R' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('S' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('T' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('U' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('V' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('W' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('X' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('Y' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('Z' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AA' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AB' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AC' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AD' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

				$sheet->getStyle('AF' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AG' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AH' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AI' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AJ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AK' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

				$sheet->getStyle('A' . $row . ':AD' . $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFA07A');
				$sheet->getStyle('A' . $row . ':AD' . $row)->getFont()->setBold(true);

				$sheet->getStyle('AF' . $row . ':AK' . $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFA07A');
				$sheet->getStyle('AF' . $row . ':AK' . $row)->getFont()->setBold(true);

				$sub_qty_w1 = 0;
				$sub_qty_w2 = 0;
				$sub_qty_w3 = 0;
				$sub_qty_w4 = 0;
				$sub_qty_w5 = 0;
				$sub_qty_w6 = 0;
				$sub_qty_total = 0;
				$sub_qty_target = 0;
				$sub_qty_ending = 0;
				$sub_qty_transit = 0;

				$sub_value_w1 = 0;
				$sub_value_w2 = 0;
				$sub_value_w3 = 0;
				$sub_value_w4 = 0;
				$sub_value_w5 = 0;
				$sub_value_w6 = 0;
				$sub_value_total = 0;
				$sub_value_target = 0;
				$sub_value_ending = 0;
				$sub_value_transit = 0;

				$row++;
            }

			$sheet->setCellValue('A' . $row, $no);
    		$sheet->setCellValue('B' . $row, $rows['principal']);
			$sheet->setCellValue('C' . $row, $rows['item_group']);
			$sheet->setCellValue('D' . $row, $rows['item_code']);
			$sheet->setCellValue('E' . $row, $rows['item_name']);
			$sheet->setCellValue('F' . $row, $rows['unit']);

			$sheet->setCellValue('G' . $row, number_format($rows['qty_w1'], 0));
			$sheet->setCellValue('H' . $row, number_format($rows['value_w1'], 2));
			$sheet->setCellValue('I' . $row, number_format($rows['qty_w2'], 0));
			$sheet->setCellValue('J' . $row, number_format($rows['value_w2'], 2));
			$sheet->setCellValue('K' . $row, number_format($rows['qty_w3'], 0));
			$sheet->setCellValue('L' . $row, number_format($rows['value_w3'], 2));
			$sheet->setCellValue('M' . $row, number_format($rows['qty_w4'], 0));
			$sheet->setCellValue('N' . $row, number_format($rows['value_w4'], 2));
			$sheet->setCellValue('O' . $row, number_format($rows['qty_w5'], 0));
			$sheet->setCellValue('P' . $row, number_format($rows['value_w5'], 2));
			$sheet->setCellValue('Q' . $row, number_format($rows['qty_w6'], 0));
			$sheet->setCellValue('R' . $row, number_format($rows['value_w6'], 2));
			$sheet->setCellValue('S' . $row, number_format($rows['qty_total'], 0));
			$sheet->setCellValue('T' . $row, number_format($rows['value_total'], 2));
			$sheet->setCellValue('U' . $row, number_format($rows['target_qty'], 0));
			$sheet->setCellValue('V' . $row, number_format($rows['target_value'], 2));

			if($row['target_qty'] != 0 and $row['target_value'] != 0)
			{
			$index_qty = ($row['qty_total']/($row['target_qty']) ?: 0)*100;
			$index_val = ($row['value_total']/($row['target_value']) ?: 0)*100;
			}
			else
			{
			$index_qty = 0;
			$index_val = 0;
			}

			$sheet->setCellValue('W' . $row, number_format($index_qty, 0));
			$sheet->setCellValue('X' . $row, number_format($index_val, 0));
			$sheet->setCellValue('Y' . $row, number_format($rows['ending_qty'], 0));
			$sheet->setCellValue('Z' . $row, number_format($rows['ending_value'], 2));
			$sheet->setCellValue('AA' . $row, number_format($rows['transit_qty'], 0));
			$sheet->setCellValue('AB' . $row, number_format($rows['transit_value'], 2));

			$total_ending_qty = $row['ending_qty'] + $row['transit_qty'];
			$total_ending_val = $row['ending_value'] + $row['transit_value'];

			$sheet->setCellValue('AC' . $row, number_format($total_ending_qty, 0));
			$sheet->setCellValue('AD' . $row, number_format($total_ending_val, 2));

			$sheet->setCellValue('AF' . $row, number_format($rows['qty_w1'], 0));
			$sheet->setCellValue('AG' . $row, number_format($rows['qty_w1'] + $rows['qty_w2'], 0));
			$sheet->setCellValue('AH' . $row, number_format($rows['qty_w1'] + $rows['qty_w2'] + $rows['qty_w3'], 0));
			$sheet->setCellValue('AI' . $row, number_format($rows['qty_w1'] + $rows['qty_w2'] + $rows['qty_w3'] + $rows['qty_w4'], 0));
			$sheet->setCellValue('AJ' . $row, number_format($rows['qty_w1'] + $rows['qty_w2'] + $rows['qty_w3'] + $rows['qty_w4'] + $rows['qty_w5'], 0));
			$sheet->setCellValue('AK' . $row, number_format($rows['qty_w1'] + $rows['qty_w2'] + $rows['qty_w3'] + $rows['qty_w4'] + $rows['qty_w5'] + $rows['qty_w6'], 0));

			// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
			$sheet->getStyle('A' . $row)->applyFromArray($style_row);
			$sheet->getStyle('B' . $row)->applyFromArray($style_row);
			$sheet->getStyle('C' . $row)->applyFromArray($style_row);
			$sheet->getStyle('D' . $row)->applyFromArray($style_row);
			$sheet->getStyle('E' . $row)->applyFromArray($style_row);
			$sheet->getStyle('F' . $row)->applyFromArray($style_row);
			$sheet->getStyle('G' . $row)->applyFromArray($style_row);
			$sheet->getStyle('H' . $row)->applyFromArray($style_row);
			$sheet->getStyle('I' . $row)->applyFromArray($style_row);
			$sheet->getStyle('J' . $row)->applyFromArray($style_row);
			$sheet->getStyle('K' . $row)->applyFromArray($style_row);
			$sheet->getStyle('L' . $row)->applyFromArray($style_row);
			$sheet->getStyle('M' . $row)->applyFromArray($style_row);
			$sheet->getStyle('N' . $row)->applyFromArray($style_row);
			$sheet->getStyle('O' . $row)->applyFromArray($style_row);
			$sheet->getStyle('P' . $row)->applyFromArray($style_row);
			$sheet->getStyle('Q' . $row)->applyFromArray($style_row);
			$sheet->getStyle('R' . $row)->applyFromArray($style_row);
			$sheet->getStyle('S' . $row)->applyFromArray($style_row);
			$sheet->getStyle('T' . $row)->applyFromArray($style_row);
			$sheet->getStyle('U' . $row)->applyFromArray($style_row);
			$sheet->getStyle('V' . $row)->applyFromArray($style_row);
			$sheet->getStyle('W' . $row)->applyFromArray($style_row);
			$sheet->getStyle('X' . $row)->applyFromArray($style_row);
			$sheet->getStyle('Y' . $row)->applyFromArray($style_row);
			$sheet->getStyle('Z' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AA' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AB' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AC' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AD' . $row)->applyFromArray($style_row);

			$sheet->getStyle('AF' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AG' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AH' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AI' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AJ' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AK' . $row)->applyFromArray($style_row);


			$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('I' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('J' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('K' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('L' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('M' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('N' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('O' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('P' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('Q' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('R' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('S' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('T' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('U' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('V' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('W' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('X' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('Y' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('Z' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AA' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AB' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AC' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AD' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

			$sheet->getStyle('AF' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AG' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AH' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AI' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AJ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AK' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

			$item_group = $rows['item_group'];
			$principal = $rows['principal'];

			$qty_w1 += $rows['qty_w1'];
			$value_w1 += $rows['value_w1'];
			$qty_w2 += $rows['qty_w2'];
			$value_w2 += $rows['value_w2'];
			$qty_w3 += $rows['qty_w3'];
			$value_w3 += $rows['value_w3'];
			$qty_w4 += $rows['qty_w4'];
			$value_w4 += $rows['value_w4'];
			$qty_w5 += $rows['qty_w5'];
			$value_w5 += $rows['value_w5'];
			$qty_w6 += $rows['qty_w6'];
			$value_w6 += $rows['value_w6'];
			$qty_total += $rows['qty_total'];
			$value_total += $rows['value_total'];
			$qty_target += $rows['target_qty'];
			$value_target += $rows['target_value'];
			$sum_index_qty += $index_qty;
			$sum_index_val += $index_val;
			$sum_total_ending_qty += $total_ending_qty;
			$sum_total_ending_val += $total_ending_val;

			$sub_qty_w1 += $rows['qty_w1'];
			$sub_value_w1 += $rows['value_w1'];
			$sub_qty_w2 += $rows['qty_w2'];
			$sub_value_w2 += $rows['value_w2'];
			$sub_qty_w3 += $rows['qty_w3'];
			$sub_value_w3 += $rows['value_w3'];
			$sub_qty_w4 += $rows['qty_w4'];
			$sub_value_w4 += $rows['value_w4'];
			$sub_qty_w5 += $rows['qty_w5'];
			$sub_value_w5 += $rows['value_w5'];
			$sub_qty_w6 += $rows['qty_w6'];
			$sub_value_w6 += $rows['value_w6'];
			$sub_qty_total += $rows['qty_total'];
			$sub_value_total += $rows['value_total'];
			$sub_qty_target += $rows['target_qty'];
			$sub_value_target += $rows['target_value'];
			$sub_sum_index_qty += $index_qty;
			$sub_sum_index_val += $index_val;
			$sub_sum_total_ending_qty += $total_ending_qty;
			$sub_sum_total_ending_val += $total_ending_val;
			
			$total_qty_w1 += $rows['qty_w1'];
			$total_value_w1 += $rows['value_w1'];
			$total_qty_w2 += $rows['qty_w2'];
			$total_value_w2 += $rows['value_w2'];
			$total_qty_w3 += $rows['qty_w3'];
			$total_value_w3 += $rows['value_w3'];
			$total_qty_w4 += $rows['qty_w4'];
			$total_value_w4 += $rows['value_w4'];
			$total_qty_w5 += $rows['qty_w5'];
			$total_value_w5 += $rows['value_w5'];
			$total_qty_w6 += $rows['qty_w6'];
			$total_value_w6 += $rows['value_w6'];
			$total_qty_total += $rows['qty_total'];
			$total_value_total += $rows['value_total'];
			$total_qty_target += $rows['target_qty'];
			$total_value_target += $rows['target_value'];
			$total_sum_index_qty += $index_qty;
			$total_sum_index_val += $index_val;
			$total_sum_total_ending_qty += $total_ending_qty;
			$total_sum_total_ending_val += $total_ending_val;

			$no++; // Tambah 1 setiap kali looping
    		$row++; // Tambah 1 setiap kali looping
		endforeach;

		//item_group end
		//$row = $row + 1;
		$sheet->setCellValue('A' . $row, '');
		$sheet->setCellValue('B' . $row, $principal);
		$sheet->setCellValue('C' . $row, $item_group);
		$sheet->setCellValue('D' . $row, '');
		$sheet->setCellValue('E' . $row, 'Sub Total ' . $item_group);
		$sheet->setCellValue('F' . $row, '');
		$sheet->setCellValue('G' . $row, number_format($qty_w1, 0));
		$sheet->setCellValue('H' . $row, number_format($value_w1, 2));
		$sheet->setCellValue('I' . $row, number_format($qty_w2, 0));
		$sheet->setCellValue('J' . $row, number_format($value_w2, 2));
		$sheet->setCellValue('K' . $row, number_format($qty_w3, 0));
		$sheet->setCellValue('L' . $row, number_format($value_w3, 2));
		$sheet->setCellValue('M' . $row, number_format($qty_w4, 0));
		$sheet->setCellValue('N' . $row, number_format($value_w4, 2));
		$sheet->setCellValue('O' . $row, number_format($qty_w5, 0));
		$sheet->setCellValue('P' . $row, number_format($value_w5, 2));
		$sheet->setCellValue('Q' . $row, number_format($qty_w6, 0));
		$sheet->setCellValue('R' . $row, number_format($value_w6, 2));
		$sheet->setCellValue('S' . $row, number_format($qty_total, 0));
		$sheet->setCellValue('T' . $row, number_format($value_total, 2));
		$sheet->setCellValue('U' . $row, number_format($qty_target, 0));
		$sheet->setCellValue('V' . $row, number_format($value_target, 2));

		if(qty_target != 0 and value_index != 0)
		{
			$qty_index = ($qty_total/($qty_target) ?: 0)*100;
			$value_index = ($value_total/($value_target) ?: 0)*100;
		}
		else
		{
			$qty_index = 0;
			$value_index = 0;
		}

		$sheet->setCellValue('W' . $row, number_format($qty_index, 0));
		$sheet->setCellValue('X' . $row, number_format($value_index, 2));
		$sheet->setCellValue('Y' . $row, number_format($qty_ending, 0));
		$sheet->setCellValue('Z' . $row, number_format($value_ending, 2));
		$sheet->setCellValue('AA' . $row, number_format($qty_transit, 0));
		$sheet->setCellValue('AB' . $row, number_format($value_transit, 2));

		$qty_total_ending = $qty_ending + $qty_transit;
		$value_total_ending = $value_ending + $value_transit;

		$sheet->setCellValue('AC' . $row, number_format($qty_total_ending, 0));
		$sheet->setCellValue('AD' . $row, number_format($value_total_ending, 2));

		$sheet->setCellValue('AF' . $row, number_format($qty_w1, 0));
		$sheet->setCellValue('AG' . $row, number_format($qty_w1 + $qty_w2, 0));
		$sheet->setCellValue('AH' . $row, number_format($qty_w1 + $qty_w2 + $qty_w3, 0));
		$sheet->setCellValue('AI' . $row, number_format($qty_w1 + $qty_w2 + $qty_w3 + $qty_w4, 0));
		$sheet->setCellValue('AJ' . $row, number_format($qty_w1 + $qty_w2 + $qty_w3 + $qty_w4 + $qty_w5, 0));
		$sheet->setCellValue('AK' . $row, number_format($qty_w1 + $qty_w2 + $qty_w3 + $qty_w4 + $qty_w5 + $qty_w6, 0));


		// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
		$sheet->getStyle('A' . $row)->applyFromArray($style_row);
		$sheet->getStyle('B' . $row)->applyFromArray($style_row);
		$sheet->getStyle('C' . $row)->applyFromArray($style_row);
		$sheet->getStyle('D' . $row)->applyFromArray($style_row);
		$sheet->getStyle('E' . $row)->applyFromArray($style_row);
		$sheet->getStyle('F' . $row)->applyFromArray($style_row);
		$sheet->getStyle('G' . $row)->applyFromArray($style_row);
		$sheet->getStyle('H' . $row)->applyFromArray($style_row);
		$sheet->getStyle('I' . $row)->applyFromArray($style_row);
		$sheet->getStyle('J' . $row)->applyFromArray($style_row);
		$sheet->getStyle('K' . $row)->applyFromArray($style_row);
		$sheet->getStyle('L' . $row)->applyFromArray($style_row);
		$sheet->getStyle('M' . $row)->applyFromArray($style_row);
		$sheet->getStyle('N' . $row)->applyFromArray($style_row);
		$sheet->getStyle('O' . $row)->applyFromArray($style_row);
		$sheet->getStyle('P' . $row)->applyFromArray($style_row);
		$sheet->getStyle('Q' . $row)->applyFromArray($style_row);
		$sheet->getStyle('R' . $row)->applyFromArray($style_row);
		$sheet->getStyle('S' . $row)->applyFromArray($style_row);
		$sheet->getStyle('T' . $row)->applyFromArray($style_row);
		$sheet->getStyle('U' . $row)->applyFromArray($style_row);
		$sheet->getStyle('V' . $row)->applyFromArray($style_row);
		$sheet->getStyle('W' . $row)->applyFromArray($style_row);
		$sheet->getStyle('X' . $row)->applyFromArray($style_row);
		$sheet->getStyle('Y' . $row)->applyFromArray($style_row);
		$sheet->getStyle('Z' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AA' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AB' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AC' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AD' . $row)->applyFromArray($style_row);

		$sheet->getStyle('AF' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AG' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AH' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AI' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AJ' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AK' . $row)->applyFromArray($style_row);


		$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('I' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('J' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('K' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('L' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('M' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('N' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('O' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('P' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('Q' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('R' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('S' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('T' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('U' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('V' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('W' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('X' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('Y' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('Z' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AA' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AB' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AC' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AD' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

		$sheet->getStyle('AF' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AG' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AH' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AI' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AJ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AK' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

		$sheet->getStyle('A' . $row . ':AD' . $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');
		$sheet->getStyle('A' . $row . ':AD' . $row)->getFont()->setBold(true);
		$sheet->getStyle('AF' . $row . ':AK' . $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');
		$sheet->getStyle('AF' . $row . ':AK' . $row)->getFont()->setBold(true);

		//principal end
		$row = $row + 1;
		$sheet->setCellValue('A' . $row, '');
		$sheet->setCellValue('B' . $row, $principal);
		$sheet->setCellValue('C' . $row, '');
		$sheet->setCellValue('D' . $row, '');
		$sheet->setCellValue('E' . $row, 'TOTAL ' . $principal);
		$sheet->setCellValue('F' . $row, '');
		$sheet->setCellValue('G' . $row, number_format($sub_qty_w1, 0));
		$sheet->setCellValue('H' . $row, number_format($sub_value_w1, 2));
		$sheet->setCellValue('I' . $row, number_format($sub_qty_w2, 0));
		$sheet->setCellValue('J' . $row, number_format($sub_value_w2, 2));
		$sheet->setCellValue('K' . $row, number_format($sub_qty_w3, 0));
		$sheet->setCellValue('L' . $row, number_format($sub_value_w3, 0));
		$sheet->setCellValue('M' . $row, number_format($sub_qty_w4, 0));
		$sheet->setCellValue('N' . $row, number_format($sub_value_w4, 2));
		$sheet->setCellValue('O' . $row, number_format($sub_qty_w5, 0));
		$sheet->setCellValue('P' . $row, number_format($sub_value_w5, 2));
		$sheet->setCellValue('Q' . $row, number_format($sub_qty_w6, 0));
		$sheet->setCellValue('R' . $row, number_format($sub_value_w6, 2));
		$sheet->setCellValue('S' . $row, number_format($sub_qty_total, 0));
		$sheet->setCellValue('T' . $row, number_format($sub_value_total, 2));
		$sheet->setCellValue('U' . $row, number_format($sub_qty_target, 0));
		$sheet->setCellValue('V' . $row, number_format($sub_value_target, 2));

		if(sub_qty_target != 0 and sub_value_target != 0)
		{
			$sub_qty_index = ($sub_qty_total/($sub_qty_target) ?: 0)*100;
			$sub_value_index = ($sub_value_total/($sub_value_target) ?: 0)*100;
		}
		else
		{
			$sub_qty_index = 0;
			$sub_value_index = 0;
		}

		$sheet->setCellValue('W' . $row, number_format($sub_qty_index, 0));
		$sheet->setCellValue('X' . $row, number_format($sub_value_index, 0));
		$sheet->setCellValue('Y' . $row, number_format($sub_qty_ending, 0));
		$sheet->setCellValue('Z' . $row, number_format($sub_value_ending, 2));
		$sheet->setCellValue('AA' . $row, number_format($sub_qty_transit, 0));
		$sheet->setCellValue('AB' . $row, number_format($sub_value_transit, 2));

		$sub_qty_total_ending = $sub_qty_ending + $sub_qty_transit;
		$sub_value_total_ending = $sub_value_ending + $sub_value_transit;

		$sheet->setCellValue('AC' . $row, number_format($sub_qty_total_ending, 0));
		$sheet->setCellValue('AD' . $row, number_format($sub_value_total_ending, 2));

		$sheet->setCellValue('AF' . $row, number_format($sub_qty_w1, 0));
		$sheet->setCellValue('AG' . $row, number_format($sub_qty_w1 + $sub_qty_w2, 0));
		$sheet->setCellValue('AH' . $row, number_format($sub_qty_w1 + $sub_qty_w2 + $sub_qty_w3, 0));
		$sheet->setCellValue('AI' . $row, number_format($sub_qty_w1 + $sub_qty_w2 + $sub_qty_w3 + $sub_qty_w4, 0));
		$sheet->setCellValue('AJ' . $row, number_format($sub_qty_w1 + $sub_qty_w2 + $sub_qty_w3 + $sub_qty_w4 + $sub_qty_w5, 0));
		$sheet->setCellValue('AK' . $row, number_format($sub_qty_w1 + $sub_qty_w2 + $sub_qty_w3 + $sub_qty_w4 + $sub_qty_w5 + $sub_qty_w6, 0));
		

		// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
		$sheet->getStyle('A' . $row)->applyFromArray($style_row);
		$sheet->getStyle('B' . $row)->applyFromArray($style_row);
		$sheet->getStyle('C' . $row)->applyFromArray($style_row);
		$sheet->getStyle('D' . $row)->applyFromArray($style_row);
		$sheet->getStyle('E' . $row)->applyFromArray($style_row);
		$sheet->getStyle('F' . $row)->applyFromArray($style_row);
		$sheet->getStyle('G' . $row)->applyFromArray($style_row);
		$sheet->getStyle('H' . $row)->applyFromArray($style_row);
		$sheet->getStyle('I' . $row)->applyFromArray($style_row);
		$sheet->getStyle('J' . $row)->applyFromArray($style_row);
		$sheet->getStyle('K' . $row)->applyFromArray($style_row);
		$sheet->getStyle('L' . $row)->applyFromArray($style_row);
		$sheet->getStyle('M' . $row)->applyFromArray($style_row);
		$sheet->getStyle('N' . $row)->applyFromArray($style_row);
		$sheet->getStyle('O' . $row)->applyFromArray($style_row);
		$sheet->getStyle('P' . $row)->applyFromArray($style_row);
		$sheet->getStyle('Q' . $row)->applyFromArray($style_row);
		$sheet->getStyle('R' . $row)->applyFromArray($style_row);
		$sheet->getStyle('S' . $row)->applyFromArray($style_row);
		$sheet->getStyle('T' . $row)->applyFromArray($style_row);
		$sheet->getStyle('U' . $row)->applyFromArray($style_row);
		$sheet->getStyle('V' . $row)->applyFromArray($style_row);
		$sheet->getStyle('W' . $row)->applyFromArray($style_row);
		$sheet->getStyle('X' . $row)->applyFromArray($style_row);
		$sheet->getStyle('Y' . $row)->applyFromArray($style_row);
		$sheet->getStyle('Z' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AA' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AB' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AC' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AD' . $row)->applyFromArray($style_row);

		$sheet->getStyle('AF' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AG' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AH' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AI' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AJ' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AK' . $row)->applyFromArray($style_row);


		$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('I' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('J' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('K' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('L' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('M' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('N' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('O' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('P' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('Q' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('R' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('S' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('T' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('U' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('V' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('W' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('X' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('Y' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('Z' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AA' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AB' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AC' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AD' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

		$sheet->getStyle('AF' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AG' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AH' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AI' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AJ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AK' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

		$sheet->getStyle('A' . $row . ':AD' . $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFA07A');
		$sheet->getStyle('A' . $row . ':AD' . $row)->getFont()->setBold(true);
		$sheet->getStyle('AF' . $row . ':AK' . $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFA07A');
		$sheet->getStyle('AF' . $row . ':AK' . $row)->getFont()->setBold(true);

		//grand total
		$row = $row + 1;
		$sheet->setCellValue('A' . $row, '');
		$sheet->setCellValue('B' . $row, '');
		$sheet->setCellValue('C' . $row, '');
		$sheet->setCellValue('D' . $row, '');
		$sheet->setCellValue('E' . $row, 'GRAND TOTAL');
		$sheet->setCellValue('F' . $row, '');
		$sheet->setCellValue('G' . $row, number_format($total_qty_w1, 0));
		$sheet->setCellValue('H' . $row, number_format($total_value_w1, 2));
		$sheet->setCellValue('I' . $row, number_format($total_qty_w2, 0));
		$sheet->setCellValue('J' . $row, number_format($total_value_w2, 2));
		$sheet->setCellValue('K' . $row, number_format($total_qty_w3, 0));
		$sheet->setCellValue('L' . $row, number_format($total_value_w3, 2));
		$sheet->setCellValue('M' . $row, number_format($total_qty_w4, 0));
		$sheet->setCellValue('N' . $row, number_format($total_value_w4, 2));
		$sheet->setCellValue('O' . $row, number_format($total_qty_w5, 0));
		$sheet->setCellValue('P' . $row, number_format($total_value_w5, 2));
		$sheet->setCellValue('Q' . $row, number_format($total_qty_w6, 0));
		$sheet->setCellValue('R' . $row, number_format($total_value_w6, 2));
		$sheet->setCellValue('S' . $row, number_format($total_qty_total, 0));
		$sheet->setCellValue('T' . $row, number_format($total_value_total, 2));
		$sheet->setCellValue('U' . $row, number_format($total_qty_target, 0));
		$sheet->setCellValue('V' . $row, number_format($total_value_target, 2));

		if(total_qty_target != 0 and total_value_target != 0)
		{
			$total_qty_index = ($total_qty_total/($total_qty_target) ?: 0)*100;
			$total_value_index = ($total_value_total/($total_value_target) ?: 0)*100;
		}
		else
		{
			$total_qty_index = 0;
			$total_value_index = 0;
		}

		$sheet->setCellValue('W' . $row, number_format($total_qty_index, 0));
		$sheet->setCellValue('X' . $row, number_format($total_value_index, 0));
		$sheet->setCellValue('Y' . $row, number_format($total_qty_ending, 0));
		$sheet->setCellValue('Z' . $row, number_format($total_value_ending, 2));
		$sheet->setCellValue('AA' . $row, number_format($total_qty_transit, 0));
		$sheet->setCellValue('AB' . $row, number_format($total_value_transit, 2));

		$total_qty_total_ending = $total_qty_ending + $total_qty_transit;
		$total_value_total_ending = $total_value_ending + $total_value_transit;

		$sheet->setCellValue('AC' . $row, number_format($total_qty_total_ending, 0));
		$sheet->setCellValue('AD' . $row, number_format($total_value_total_ending, 2));

		$sheet->setCellValue('AF' . $row, number_format($total_qty_w1, 0));
		$sheet->setCellValue('AG' . $row, number_format($total_qty_w1 + $total_qty_w2, 0));
		$sheet->setCellValue('AH' . $row, number_format($total_qty_w1 + $total_qty_w2 + $total_qty_w3, 0));
		$sheet->setCellValue('AI' . $row, number_format($total_qty_w1 + $total_qty_w2 + $total_qty_w3 + $total_qty_w4, 0));
		$sheet->setCellValue('AJ' . $row, number_format($total_qty_w1 + $total_qty_w2 + $total_qty_w3 + $total_qty_w4 + $total_qty_w5, 0));
		$sheet->setCellValue('AK' . $row, number_format($total_qty_w1 + $total_qty_w2 + $total_qty_w3 + $total_qty_w4 + $total_qty_w5 + $total_qty_w6, 0));

		// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
		$sheet->getStyle('A' . $row)->applyFromArray($style_row);
		$sheet->getStyle('B' . $row)->applyFromArray($style_row);
		$sheet->getStyle('C' . $row)->applyFromArray($style_row);
		$sheet->getStyle('D' . $row)->applyFromArray($style_row);
		$sheet->getStyle('E' . $row)->applyFromArray($style_row);
		$sheet->getStyle('F' . $row)->applyFromArray($style_row);
		$sheet->getStyle('G' . $row)->applyFromArray($style_row);
		$sheet->getStyle('H' . $row)->applyFromArray($style_row);
		$sheet->getStyle('I' . $row)->applyFromArray($style_row);
		$sheet->getStyle('J' . $row)->applyFromArray($style_row);
		$sheet->getStyle('K' . $row)->applyFromArray($style_row);
		$sheet->getStyle('L' . $row)->applyFromArray($style_row);
		$sheet->getStyle('M' . $row)->applyFromArray($style_row);
		$sheet->getStyle('N' . $row)->applyFromArray($style_row);
		$sheet->getStyle('O' . $row)->applyFromArray($style_row);
		$sheet->getStyle('P' . $row)->applyFromArray($style_row);
		$sheet->getStyle('Q' . $row)->applyFromArray($style_row);
		$sheet->getStyle('R' . $row)->applyFromArray($style_row);
		$sheet->getStyle('S' . $row)->applyFromArray($style_row);
		$sheet->getStyle('T' . $row)->applyFromArray($style_row);
		$sheet->getStyle('U' . $row)->applyFromArray($style_row);
		$sheet->getStyle('V' . $row)->applyFromArray($style_row);
		$sheet->getStyle('W' . $row)->applyFromArray($style_row);
		$sheet->getStyle('X' . $row)->applyFromArray($style_row);
		$sheet->getStyle('Y' . $row)->applyFromArray($style_row);
		$sheet->getStyle('Z' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AA' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AB' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AC' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AD' . $row)->applyFromArray($style_row);

		$sheet->getStyle('AF' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AG' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AH' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AI' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AJ' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AK' . $row)->applyFromArray($style_row);


		$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
		$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('I' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('J' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('K' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('L' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('M' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('N' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('O' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('P' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('Q' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('R' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('S' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('T' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('U' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('V' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('W' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('X' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('Y' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('Z' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AA' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AB' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AC' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AD' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

		$sheet->getStyle('AF' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AG' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AH' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AI' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AJ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AK' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

		$sheet->getStyle('A' . $row . ':AD' . $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFA07A');
		$sheet->getStyle('A' . $row . ':AD' . $row)->getFont()->setBold(true);
		$sheet->getStyle('AF' . $row . ':AK' . $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFA07A');
		$sheet->getStyle('AF' . $row . ':AK' . $row)->getFont()->setBold(true);


		//set columns width
		$sheet->getColumnDimension('A')->setWidth(5); 
		$sheet->getColumnDimension('B')->setWidth(11); 
		$sheet->getColumnDimension('C')->setWidth(22);
		$sheet->getColumnDimension('D')->setWidth(12);
		$sheet->getColumnDimension('E')->setWidth(53);
		$sheet->getColumnDimension('F')->setWidth(6);
		$sheet->getColumnDimension('G')->setWidth(10);
		$sheet->getColumnDimension('H')->setWidth(16);
		$sheet->getColumnDimension('I')->setWidth(10);
		$sheet->getColumnDimension('J')->setWidth(16);
		$sheet->getColumnDimension('K')->setWidth(10);
		$sheet->getColumnDimension('L')->setWidth(16);
		$sheet->getColumnDimension('M')->setWidth(10);
		$sheet->getColumnDimension('N')->setWidth(16);
		$sheet->getColumnDimension('O')->setWidth(10);
		$sheet->getColumnDimension('P')->setWidth(16);
		$sheet->getColumnDimension('Q')->setWidth(10);
		$sheet->getColumnDimension('R')->setWidth(16);
		$sheet->getColumnDimension('S')->setWidth(10);
		$sheet->getColumnDimension('T')->setWidth(16);
		$sheet->getColumnDimension('U')->setWidth(10);
		$sheet->getColumnDimension('V')->setWidth(16);
		$sheet->getColumnDimension('W')->setWidth(8);//Index(%)
		$sheet->getColumnDimension('X')->setWidth(8);//Index(%)
		$sheet->getColumnDimension('Y')->setWidth(10);
		$sheet->getColumnDimension('Z')->setWidth(16);
		$sheet->getColumnDimension('AA')->setWidth(10);
		$sheet->getColumnDimension('AB')->setWidth(16);
		$sheet->getColumnDimension('AC')->setWidth(10);
		$sheet->getColumnDimension('AD')->setWidth(16);

		$sheet->getColumnDimension('AF')->setWidth(10);
		$sheet->getColumnDimension('AG')->setWidth(12);
		$sheet->getColumnDimension('AH')->setWidth(12);
		$sheet->getColumnDimension('AI')->setWidth(12);
		$sheet->getColumnDimension('AJ')->setWidth(12);
		$sheet->getColumnDimension('AK')->setWidth(12);
		

		// Set orientasi kertas jadi LANDSCAPE
		$sheet->getPageSetup()->setOrientation(\PhpOffice\PhpSpreadsheet\Worksheet\PageSetup::ORIENTATION_LANDSCAPE);
		// Set judul file excel nya
		$sheet->setTitle("Selling Out - Weekly");
		// Proses file excel
		header('Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet');
		header('Content-Disposition: attachment; filename="Report Selling Out - Weekly ("' . $year . '").xlsx"'); // Set nama file excel nya
		header('Cache-Control: max-age=0');

		$writer = new Xlsx($spreadsheet);
		$writer->save('php://output');

	}

	public function export_sellingout_cmo()
	{
		$spreadsheet = new Spreadsheet();
		$sheet = $spreadsheet->getActiveSheet();
		// Buat sebuah variabel untuk menampung pengaturan style dari header tabel
		$style_col = [
			'font' => ['bold' => true], // Set font nya jadi bold
			'alignment' => [
				'horizontal' => \PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER, // Set text jadi ditengah secara horizontal (center)
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'top' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border top dengan garis tipis
				'right' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN],  // Set border right dengan garis tipis
				'bottom' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border bottom dengan garis tipis
				'left' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN] // Set border left dengan garis tipis
			]
		];
		// Buat sebuah variabel untuk menampung pengaturan style dari isi tabel
		$style_row = [
			'alignment' => [
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'top' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border top dengan garis tipis
				'right' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN],  // Set border right dengan garis tipis
				'bottom' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border bottom dengan garis tipis
				'left' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN] // Set border left dengan garis tipis
			]
		];


		if(isset($_POST['by_dist']))
		{
			$kode_dist = $_POST['by_dist'];
		}
		else
		{
			$kode_dist = "";
		}

		if (isset($_POST['by_year']))
		{
			$year = $_POST['by_year'];
		}
		else
		{
			$year = date('Y');
		}

		if(isset($_POST['by_month']))
		{
			$month = $_POST['by_month'];
		}
		else
		{
			$month = date('m');
		}

		$dateObj   = DateTime::createFromFormat('!m', $month);
		$monthName = $dateObj->format('F'); // March

		if($kode_dist != 'By Distributor')
		{
			$data['buffer_dist'] = $this->model('DistributorModel')->getDistByCode($kode_dist);
			$buffer = $data['buffer_dist']['buffer_stock'];
			$lead_time = $data['buffer_dist']['lead_time'];
		}

		$data['distributor'] = $this->model('DistributorModel')->getDistByCode($kode_dist);


		$sheet->setCellValue('A1', "CONFORM MONTHLY ORDER - CMO (" . $year . ")"); // Set kolom A1 dengan tulisan 
		$sheet->setCellValue('A2', "Distributor : " . $data['distributor']['distributor']);
		$sheet->setCellValue('A3', "Area : " . $data['distributor']['area']); 
		$sheet->setCellValue('A4', "Month : " . $monthName . " - " . $year); 
		//$sheet->mergeCells('A1:F1'); // Set Merge Cell pada kolom A1 sampai F1
		$sheet->getStyle('A1')->getFont()->setBold(true); // Set bold kolom A1
		$sheet->getStyle('A2')->getFont()->setBold(true);
		$sheet->getStyle('A3')->getFont()->setBold(true);
		$sheet->getStyle('A4')->getFont()->setBold(true);
		$sheet->getStyle('A1')->getFont()->setSize(20); // Set font size 15 untuk kolom A1
		// Buat header tabel nya pada baris ke 6
		$sheet->setCellValue('A6', "#"); // Set kolom A6 dengan tulisan "#"
		$sheet->mergeCells('A6:A8');//Set Merge Cell
		$sheet->setCellValue('B6', "Item Code");
		$sheet->mergeCells('B6:B8');
		$sheet->setCellValue('C6', "Description");
		$sheet->mergeCells('C6:C8'); 
		$sheet->setCellValue('D6', "Unit");
		$sheet->mergeCells('D6:D8'); 
		$sheet->setCellValue('E6', "DBP (000)");
		$sheet->mergeCells('E6:E8');
		$sheet->setCellValue('F6', "Stock on Hand");
		$sheet->mergeCells('F6:F8');
		$sheet->getStyle('F6')->getAlignment()->setWrapText(true);
		$sheet->setCellValue('G6', "Order in Transit");
		$sheet->mergeCells('G6:G8');
		$sheet->getStyle('G6')->getAlignment()->setWrapText(true);
		$sheet->setCellValue('H6', "Total Stock ");
		$sheet->mergeCells('H6:H8');
		$sheet->setCellValue('I6', "Value Stock");
		$sheet->mergeCells('I6:I8');
		
		$sheet->setCellValue('J6', "Avg. Sales (3 mnth)");//AVG Sales
		$sheet->mergeCells('J6:K6');//AVG Sales
		$sheet->setCellValue('J7', "Volume");//AVG Sales
		$sheet->mergeCells('J7:J8');//AVG Sales
		$sheet->setCellValue('K7', "Rupiah");//AVG Sales
		$sheet->mergeCells('K7:K8');//AVG Sales

		$sheet->setCellValue('L6', "Stock Cover Days");
		$sheet->mergeCells('L6:L8');
		$sheet->getStyle('L6')->getAlignment()->setWrapText(true);

		$sheet->setCellValue('M6', "Estimate (Sell Out)");//Estimate
		$sheet->mergeCells('M6:N6');//Estimate
		$sheet->setCellValue('M7', "Volume");//Estimate
		$sheet->mergeCells('M7:M8');//Estimate
		$sheet->setCellValue('N7', "Rupiah");//Estimate
		$sheet->mergeCells('N7:N8');//Estimate

		$sheet->setCellValue('O6', "Buffer Stock (days)");
		$sheet->getStyle('O6')->getAlignment()->setWrapText(true);
		$sheet->mergeCells('O6:O7');
		$sheet->setCellValue('O8', $buffer);

		$sheet->setCellValue('P6', "Lead Time Delivery (days)");
		$sheet->getStyle('P6')->getAlignment()->setWrapText(true);
		$sheet->mergeCells('P6:P7');
		$sheet->setCellValue('P8', $lead_time);

		$sheet->setCellValue('Q6', "Total Plan Order");
		$sheet->mergeCells('Q6:Q8');
		$sheet->getStyle('Q6')->getAlignment()->setWrapText(true);

		$sheet->setCellValue('R6', "Additional Order");//Additional Order
		$sheet->mergeCells('R6:S6');//Additional Order
		$sheet->setCellValue('R7', "Promo Plan");//Additional Order
		$sheet->mergeCells('R7:R8');//Additional Order
		$sheet->setCellValue('S7', "Pembulatan");//Additional Order
		$sheet->mergeCells('S7:S8');//Additional Order

		$sheet->setCellValue('T6', "TOTAL - CMO (PCS)");//Total CMO pcs
		$sheet->mergeCells('T6:U6');//Total CMO pcs
		$sheet->setCellValue('T7', "Volume");//Total CMO pcs
		$sheet->mergeCells('T7:T8');//Total CMO pcs
		$sheet->setCellValue('U7', "Rupiah");//Total CMO pcs
		$sheet->mergeCells('U7:U8');//Total CMO pcs

		$sheet->setCellValue('V6', "TOTAL - CMO (KARTON)");//Total CMO CARTON
		$sheet->getStyle('V6')->getAlignment()->setWrapText(true);
		$sheet->setCellValue('V7', "Volume");//Total CMO CARTON
		$sheet->mergeCells('V7:V8');//Total CMO pcs

		$sheet->setCellValue('W6', "CMO Break Down per Week = PO (KARTON)");//per Week
		$sheet->mergeCells('W6:AA6');//per Week
		$sheet->setCellValue('W7', "Week 1");//per Week
		$sheet->mergeCells('W7:W8');//per Week
		$sheet->setCellValue('X7', "Week 2");//per Week
		$sheet->mergeCells('X7:X8');//per Week
		$sheet->setCellValue('Y7', "Week 3");//per Week
		$sheet->mergeCells('Y7:Y8');//per Week
		$sheet->setCellValue('Z7', "Week 4");//per Week
		$sheet->mergeCells('Z7:Z8');//per Week
		$sheet->setCellValue('AA7', "CWO VS PO");//per Week
		$sheet->mergeCells('AA7:AA8');//per Week

		$sheet->setCellValue('AB6', "This Month Target");//target
		$sheet->mergeCells('AB6:AD6');//target
		$sheet->setCellValue('AB7', "Volume");//target
		$sheet->mergeCells('AB7:AB8');//target
		$sheet->setCellValue('AC7', "Rupiah");//target
		$sheet->mergeCells('AC7:AC8');//target
		$sheet->setCellValue('AD7', "Idx (%)");//target
		$sheet->mergeCells('AD7:AD8');//target


		
		
		// Apply style header yang telah kita buat tadi ke masing-masing kolom header
		$sheet->getStyle('A6')->applyFromArray($style_col);
		$sheet->getStyle('B6')->applyFromArray($style_col);
		$sheet->getStyle('C6')->applyFromArray($style_col);
		$sheet->getStyle('D6')->applyFromArray($style_col);
		$sheet->getStyle('E6')->applyFromArray($style_col);
		$sheet->getStyle('F6')->applyFromArray($style_col);
		$sheet->getStyle('G6')->applyFromArray($style_col);
		$sheet->getStyle('H6')->applyFromArray($style_col);
		$sheet->getStyle('I6')->applyFromArray($style_col);
		$sheet->getStyle('J6')->applyFromArray($style_col);
		$sheet->getStyle('K6')->applyFromArray($style_col);
		$sheet->getStyle('L6')->applyFromArray($style_col);
		$sheet->getStyle('M6')->applyFromArray($style_col);
		$sheet->getStyle('N6')->applyFromArray($style_col);
		$sheet->getStyle('O6')->applyFromArray($style_col);
		$sheet->getStyle('P6')->applyFromArray($style_col);
		$sheet->getStyle('Q6')->applyFromArray($style_col);
		$sheet->getStyle('R6')->applyFromArray($style_col);
		$sheet->getStyle('S6')->applyFromArray($style_col);
		$sheet->getStyle('T6')->applyFromArray($style_col);
		$sheet->getStyle('U6')->applyFromArray($style_col);
		$sheet->getStyle('V6')->applyFromArray($style_col);
		$sheet->getStyle('W6')->applyFromArray($style_col);
		$sheet->getStyle('X6')->applyFromArray($style_col);
		$sheet->getStyle('Y6')->applyFromArray($style_col);
		$sheet->getStyle('Z6')->applyFromArray($style_col);
		$sheet->getStyle('AA6')->applyFromArray($style_col);
		$sheet->getStyle('AB6')->applyFromArray($style_col);
		$sheet->getStyle('AC6')->applyFromArray($style_col);
		$sheet->getStyle('AD6')->applyFromArray($style_col);

		$sheet->getStyle('A7')->applyFromArray($style_col);
		$sheet->getStyle('B7')->applyFromArray($style_col);
		$sheet->getStyle('C7')->applyFromArray($style_col);
		$sheet->getStyle('D7')->applyFromArray($style_col);
		$sheet->getStyle('E7')->applyFromArray($style_col);
		$sheet->getStyle('F7')->applyFromArray($style_col);
		$sheet->getStyle('G7')->applyFromArray($style_col);
		$sheet->getStyle('H7')->applyFromArray($style_col);
		$sheet->getStyle('I7')->applyFromArray($style_col);
		$sheet->getStyle('J7')->applyFromArray($style_col);
		$sheet->getStyle('K7')->applyFromArray($style_col);
		$sheet->getStyle('L7')->applyFromArray($style_col);
		$sheet->getStyle('M7')->applyFromArray($style_col);
		$sheet->getStyle('N7')->applyFromArray($style_col);
		$sheet->getStyle('O7')->applyFromArray($style_col);
		$sheet->getStyle('P7')->applyFromArray($style_col);
		$sheet->getStyle('Q7')->applyFromArray($style_col);
		$sheet->getStyle('R7')->applyFromArray($style_col);
		$sheet->getStyle('S7')->applyFromArray($style_col);
		$sheet->getStyle('T7')->applyFromArray($style_col);
		$sheet->getStyle('U7')->applyFromArray($style_col);
		$sheet->getStyle('V7')->applyFromArray($style_col);
		$sheet->getStyle('W7')->applyFromArray($style_col);
		$sheet->getStyle('X7')->applyFromArray($style_col);
		$sheet->getStyle('Y7')->applyFromArray($style_col);
		$sheet->getStyle('Z7')->applyFromArray($style_col);
		$sheet->getStyle('AA7')->applyFromArray($style_col);
		$sheet->getStyle('AB7')->applyFromArray($style_col);
		$sheet->getStyle('AC7')->applyFromArray($style_col);
		$sheet->getStyle('AD7')->applyFromArray($style_col);

		$sheet->getStyle('A8')->applyFromArray($style_col);
		$sheet->getStyle('B8')->applyFromArray($style_col);
		$sheet->getStyle('C8')->applyFromArray($style_col);
		$sheet->getStyle('D8')->applyFromArray($style_col);
		$sheet->getStyle('E8')->applyFromArray($style_col);
		$sheet->getStyle('F8')->applyFromArray($style_col);
		$sheet->getStyle('G8')->applyFromArray($style_col);
		$sheet->getStyle('H8')->applyFromArray($style_col);
		$sheet->getStyle('I8')->applyFromArray($style_col);
		$sheet->getStyle('J8')->applyFromArray($style_col);
		$sheet->getStyle('K8')->applyFromArray($style_col);
		$sheet->getStyle('L8')->applyFromArray($style_col);
		$sheet->getStyle('M8')->applyFromArray($style_col);
		$sheet->getStyle('N8')->applyFromArray($style_col);
		$sheet->getStyle('O8')->applyFromArray($style_col);
		$sheet->getStyle('P8')->applyFromArray($style_col);
		$sheet->getStyle('Q8')->applyFromArray($style_col);
		$sheet->getStyle('R8')->applyFromArray($style_col);
		$sheet->getStyle('S8')->applyFromArray($style_col);
		$sheet->getStyle('T8')->applyFromArray($style_col);
		$sheet->getStyle('U8')->applyFromArray($style_col);
		$sheet->getStyle('V8')->applyFromArray($style_col);
		$sheet->getStyle('W8')->applyFromArray($style_col);
		$sheet->getStyle('X8')->applyFromArray($style_col);
		$sheet->getStyle('Y8')->applyFromArray($style_col);
		$sheet->getStyle('Z8')->applyFromArray($style_col);
		$sheet->getStyle('AA8')->applyFromArray($style_col);
		$sheet->getStyle('AB8')->applyFromArray($style_col);
		$sheet->getStyle('AC8')->applyFromArray($style_col);
		$sheet->getStyle('AD8')->applyFromArray($style_col);

		$sheet->getStyle('A6:AD8')->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');
		//$sheet->getStyle('AF6:AK8')->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');

		// Set height baris ke 1 dan 2
		$sheet->getRowDimension('1')->setRowHeight(40);
		$sheet->getRowDimension('2')->setRowHeight(20);
		$sheet->getRowDimension('3')->setRowHeight(20);
		$sheet->getRowDimension('4')->setRowHeight(20);
		$sheet->getRowDimension('6')->setRowHeight(30);


		$item_group = '';
		$principal = '';

		$sub_ending_qty = 0;
		$sub_transit_qty = 0;
		$sub_total_ending_qty = 0;
		$sub_total_ending_val = 0;
		$sub_qty_avg_sales = 0;
		$sub_value_avg_sales = 0;
		$sub_stock_cover_days = 0;
		$sub_buffer_stock_days = 0;
		$sub_lead_time_delivery = 0;
		$sub_plan_order = 0;
		$sub_cmo_pcs_qty = 0;
		$sub_cmo_pcs_val = 0;
		$sub_cmo_carton_qty = 0;
		$sub_target_qty = 0;
		$sub_target_val = 0;
		$sub_target_idx = 0;

		$total_ending_qty = 0;
		$total_transit_qty = 0;
		$total_total_ending_qty = 0;
		$total_total_ending_val = 0;
		$total_qty_avg_sales = 0;
		$total_value_avg_sales = 0;
		$total_stock_cover_days = 0;
		$total_buffer_stock_days = 0;
		$total_lead_time_delivery = 0;
		$total_plan_order = 0;
		$total_cmo_pcs_qty = 0;
		$total_cmo_pcs_val = 0;
		$total_cmo_carton_qty = 0;
		$total_target_qty = 0;
		$total_target_val = 0;
		$total_target_idx = 0;

		$grand_ending_qty = 0;
		$grand_transit_qty = 0;
		$grand_total_ending_qty = 0;
		$grand_total_ending_val = 0;
		$grand_qty_avg_sales = 0;
		$grand_value_avg_sales = 0;
		$grand_stock_cover_days = 0;
		$grand_buffer_stock_days = 0;
		$grand_lead_time_delivery = 0;
		$grand_plan_order = 0;
		$grand_cmo_pcs_qty = 0;
		$grand_cmo_pcs_val = 0;
		$grand_cmo_carton_qty = 0;
		$grand_target_qty = 0;
		$grand_target_val = 0;
		$grand_target_idx = 0;


		$no = 1; // Untuk penomoran tabel, di awal set dengan 1
		$row = 9;

		$data['cmo'] = $this->model('ReportModel')->getSellingOut_CMO();

		foreach ($data['cmo'] as $rows) :

			if ($item_group != $rows['item_group'] and $item_group != '' )
            {
				
				$sheet->setCellValue('A' . $row, '');
				$sheet->setCellValue('B' . $row, '');
				$sheet->setCellValue('C' . $row, 'Sub Total ' . $item_group);
				$sheet->setCellValue('D' . $row, '');
				$sheet->setCellValue('E' . $row, '');
				$sheet->setCellValue('F' . $row, $sub_ending_qty, 0);
				$sheet->setCellValue('G' . $row, $sub_transit_qty, 0);
				$sheet->setCellValue('H' . $row, $sub_total_ending_qty, 0);
				$sheet->setCellValue('I' . $row, $sub_total_ending_val, 0);
				$sheet->setCellValue('J' . $row, $sub_qty_avg_sales, 0);
				$sheet->setCellValue('K' . $row, $sub_value_avg_sales, 0);
				$sheet->setCellValue('L' . $row, $sub_stock_cover_days, 0);
				$sheet->setCellValue('M' . $row, $sub_qty_avg_sales, 0);
				$sheet->setCellValue('N' . $row, $sub_value_avg_sales, 0);
				$sheet->setCellValue('O' . $row, $sub_buffer_stock_days, 0);
				$sheet->setCellValue('P' . $row, $sub_lead_time_delivery, 0);
				$sheet->setCellValue('Q' . $row, $sub_plan_order, 0);
				$sheet->setCellValue('R' . $row, '');
				$sheet->setCellValue('S' . $row, '');
				$sheet->setCellValue('T' . $row, $sub_cmo_pcs_qty, 0);
				$sheet->setCellValue('U' . $row, $sub_cmo_pcs_val, 0);
				$sheet->setCellValue('V' . $row, $sub_cmo_carton_qty, 2);
				$sheet->setCellValue('W' . $row, '');
				$sheet->setCellValue('X' . $row, '');
				$sheet->setCellValue('Y' . $row, '');
				$sheet->setCellValue('Z' . $row, '');
				$sheet->setCellValue('AA' . $row, '');
				$sheet->setCellValue('AB' . $row, $sub_target_qty, 0);
				$sheet->setCellValue('AC' . $row, $sub_target_val, 0);
				$sheet->setCellValue('AD' . $row, $sub_target_idx, 2);

				// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
				$sheet->getStyle('A' . $row)->applyFromArray($style_row);
				$sheet->getStyle('B' . $row)->applyFromArray($style_row);
				$sheet->getStyle('C' . $row)->applyFromArray($style_row);
				$sheet->getStyle('D' . $row)->applyFromArray($style_row);
				$sheet->getStyle('E' . $row)->applyFromArray($style_row);
				$sheet->getStyle('F' . $row)->applyFromArray($style_row);
				$sheet->getStyle('G' . $row)->applyFromArray($style_row);
				$sheet->getStyle('H' . $row)->applyFromArray($style_row);
				$sheet->getStyle('I' . $row)->applyFromArray($style_row);
				$sheet->getStyle('J' . $row)->applyFromArray($style_row);
				$sheet->getStyle('K' . $row)->applyFromArray($style_row);
				$sheet->getStyle('L' . $row)->applyFromArray($style_row);
				$sheet->getStyle('M' . $row)->applyFromArray($style_row);
				$sheet->getStyle('N' . $row)->applyFromArray($style_row);
				$sheet->getStyle('O' . $row)->applyFromArray($style_row);
				$sheet->getStyle('P' . $row)->applyFromArray($style_row);
				$sheet->getStyle('Q' . $row)->applyFromArray($style_row);
				$sheet->getStyle('R' . $row)->applyFromArray($style_row);
				$sheet->getStyle('S' . $row)->applyFromArray($style_row);
				$sheet->getStyle('T' . $row)->applyFromArray($style_row);
				$sheet->getStyle('U' . $row)->applyFromArray($style_row);
				$sheet->getStyle('V' . $row)->applyFromArray($style_row);
				$sheet->getStyle('W' . $row)->applyFromArray($style_row);
				$sheet->getStyle('X' . $row)->applyFromArray($style_row);
				$sheet->getStyle('Y' . $row)->applyFromArray($style_row);
				$sheet->getStyle('Z' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AA' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AB' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AC' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AD' . $row)->applyFromArray($style_row);

				$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
				$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
				$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
				$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
				$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('I' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('J' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('K' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('L' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('M' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('N' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('O' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('P' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('Q' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('R' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('S' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('T' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('U' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('V' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('W' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('X' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('Y' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('Z' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AA' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AB' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AC' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AD' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
	
				$sheet->getStyle('A' . $row . ':AD' . $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');
				$sheet->getStyle('A' . $row . ':AD' . $row)->getFont()->setBold(true);

				$sub_ending_qty = 0;
				$sub_transit_qty = 0;
				$sub_total_ending_qty = 0;
				$sub_total_ending_val = 0;
				$sub_qty_avg_sales = 0;
				$sub_value_avg_sales = 0;
				$sub_stock_cover_days = 0;
				$sub_buffer_stock_days = 0;
				$sub_lead_time_delivery = 0;
				$sub_plan_order = 0;
				$sub_cmo_pcs_qty = 0;
				$sub_cmo_pcs_val = 0;
				$sub_cmo_carton_qty = 0;
				$sub_target_qty = 0;
				$sub_target_val = 0;
				$sub_target_idx = 0;

				$row++;
            }

			if ($principal != $rows['principal'] and $principal != '' )
            {
				
				$sheet->setCellValue('A' . $row, '');
				$sheet->setCellValue('B' . $row, '');
				$sheet->setCellValue('C' . $row, 'TOTAL ' . $principal);
				$sheet->setCellValue('D' . $row, '');
				$sheet->setCellValue('E' . $row, '');
				$sheet->setCellValue('F' . $row, $total_ending_qty);
				$sheet->setCellValue('G' . $row, $total_transit_qty);
				$sheet->setCellValue('H' . $row, $total_total_ending_qty);
				$sheet->setCellValue('I' . $row, $total_total_ending_val);
				$sheet->setCellValue('J' . $row, $total_qty_avg_sales);
				$sheet->setCellValue('K' . $row, $total_value_avg_sales);
				$sheet->setCellValue('L' . $row, $total_stock_cover_days);
				$sheet->setCellValue('M' . $row, $total_qty_avg_sales);
				$sheet->setCellValue('N' . $row, $total_value_avg_sales);
				$sheet->setCellValue('O' . $row, $total_buffer_stock_days);
				$sheet->setCellValue('P' . $row, $total_lead_time_delivery);
				$sheet->setCellValue('Q' . $row, $total_plan_order);
				$sheet->setCellValue('R' . $row, '');
				$sheet->setCellValue('S' . $row, '');
				$sheet->setCellValue('T' . $row, $total_cmo_pcs_qty);
				$sheet->setCellValue('U' . $row, $total_cmo_pcs_val);
				$sheet->setCellValue('V' . $row, $total_cmo_carton_qty);
				$sheet->setCellValue('W' . $row, '');
				$sheet->setCellValue('X' . $row, '');
				$sheet->setCellValue('Y' . $row, '');
				$sheet->setCellValue('Z' . $row, '');
				$sheet->setCellValue('AA' . $row, '');
				$sheet->setCellValue('AB' . $row, $total_target_qty);
				$sheet->setCellValue('AC' . $row, $total_target_val);
				$sheet->setCellValue('AD' . $row, $total_target_idx);
				
				// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
				$sheet->getStyle('A' . $row)->applyFromArray($style_row);
				$sheet->getStyle('B' . $row)->applyFromArray($style_row);
				$sheet->getStyle('C' . $row)->applyFromArray($style_row);
				$sheet->getStyle('D' . $row)->applyFromArray($style_row);
				$sheet->getStyle('E' . $row)->applyFromArray($style_row);
				$sheet->getStyle('F' . $row)->applyFromArray($style_row);
				$sheet->getStyle('G' . $row)->applyFromArray($style_row);
				$sheet->getStyle('H' . $row)->applyFromArray($style_row);
				$sheet->getStyle('I' . $row)->applyFromArray($style_row);
				$sheet->getStyle('J' . $row)->applyFromArray($style_row);
				$sheet->getStyle('K' . $row)->applyFromArray($style_row);
				$sheet->getStyle('L' . $row)->applyFromArray($style_row);
				$sheet->getStyle('M' . $row)->applyFromArray($style_row);
				$sheet->getStyle('N' . $row)->applyFromArray($style_row);
				$sheet->getStyle('O' . $row)->applyFromArray($style_row);
				$sheet->getStyle('P' . $row)->applyFromArray($style_row);
				$sheet->getStyle('Q' . $row)->applyFromArray($style_row);
				$sheet->getStyle('R' . $row)->applyFromArray($style_row);
				$sheet->getStyle('S' . $row)->applyFromArray($style_row);
				$sheet->getStyle('T' . $row)->applyFromArray($style_row);
				$sheet->getStyle('U' . $row)->applyFromArray($style_row);
				$sheet->getStyle('V' . $row)->applyFromArray($style_row);
				$sheet->getStyle('W' . $row)->applyFromArray($style_row);
				$sheet->getStyle('X' . $row)->applyFromArray($style_row);
				$sheet->getStyle('Y' . $row)->applyFromArray($style_row);
				$sheet->getStyle('Z' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AA' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AB' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AC' . $row)->applyFromArray($style_row);
				$sheet->getStyle('AD' . $row)->applyFromArray($style_row);


				$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
				$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
				$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
				$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
				$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('I' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('J' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('K' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('L' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('M' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('N' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('O' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('P' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('Q' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('R' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('S' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('T' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('U' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('V' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('W' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('X' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('Y' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('Z' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AA' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AB' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AC' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyle('AD' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

				$sheet->getStyle('A' . $row . ':AD' . $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFA07A');
				$sheet->getStyle('A' . $row . ':AD' . $row)->getFont()->setBold(true);

				$total_ending_qty = 0;
				$total_transit_qty = 0;
				$total_total_ending_qty = 0;
				$total_total_ending_val = 0;
				$total_qty_avg_sales = 0;
				$total_value_avg_sales = 0;
				$total_stock_cover_days = 0;
				$total_buffer_stock_days = 0;
				$total_lead_time_delivery = 0;
				$total_plan_order = 0;
				$total_cmo_pcs_qty = 0;
				$total_cmo_pcs_val = 0;
				$total_cmo_carton_qty = 0;
				$total_target_qty = 0;
				$total_target_val = 0;
				$total_target_idx = 0;

				$row++;
            }

			$sheet->setCellValue('A' . $row, $no);
    		$sheet->setCellValue('B' . $row, $rows['item_code']);
			$sheet->setCellValue('C' . $row, $rows['item_name']);
			$sheet->setCellValue('D' . $row, $rows['unit']);
			$sheet->setCellValue('E' . $row, $rows['dist_exc']);
			$sheet->setCellValue('F' . $row, $rows['ending_qty']);
			$sheet->setCellValue('G' . $row, $rows['transit_qty']);
			$ttl_ending_qty = $rows['ending_qty'] + $rows['transit_qty'];
			$ttl_ending_val = $ttl_ending_qty * $rows['dist_exc'];
			$sheet->setCellValue('H' . $row, $ttl_ending_qty);
			$sheet->setCellValue('I' . $row, $ttl_ending_val);
			$sheet->setCellValue('J' . $row, $rows['qty_avg_sales']);
			$sheet->setCellValue('K' . $row, $rows['value_avg_sales']);

			if($rows['qty_avg_sales'] == 0 or $ttl_ending_qty == 0)
			{
				$stock_cover_days = 0;
			}
			else
			{
				$stock_cover_days = ($ttl_ending_qty/$rows['qty_avg_sales'])*30;
			}

			$sheet->setCellValue('L' . $row, $stock_cover_days);
			$sheet->setCellValue('M' . $row, $rows['qty_avg_sales']);
			$sheet->setCellValue('N' . $row, $rows['value_avg_sales']);
			$sheet->setCellValue('O' . $row, $rows['buffer_stock_days']);
			$sheet->setCellValue('P' . $row, $rows['lead_time_delivery']);

			$plan_order = ($rows['qty_avg_sales'] + $rows['buffer_stock_days'] + $rows['lead_time_delivery']) - ttl_ending_qty ;

			$sheet->setCellValue('Q' . $row, $plan_order);
			$sheet->setCellValue('R' . $row, '');
			$sheet->setCellValue('S' . $row, '');

			$cmo_pcs_qty = $plan_order;
			$cmo_pcs_val = $cmo_pcs_qty * $rows['dist_exc'];
			$cmo_carton_qty = $cmo_pcs_qty * $rows['unit_conversion'];

			$sheet->setCellValue('T' . $row, $cmo_pcs_qty);
			$sheet->setCellValue('U' . $row, $cmo_pcs_val);
			$sheet->setCellValue('V' . $row, $cmo_carton_qty);
			$sheet->setCellValue('W' . $row, '');
			$sheet->setCellValue('X' . $row, '');
			$sheet->setCellValue('Y' . $row, '');
			$sheet->setCellValue('Z' . $row, '');
			$sheet->setCellValue('AA' . $row, '');

			$target_qty = $rows['target_qty'];
			$target_val = $target_qty * $rows['dist_exc'];
			if($target_val == 0 or $cmo_pcs_val == 0)
			{
				$target_idx = 0;
			}
			else
			{
				$target_idx = ($cmo_pcs_val/$target_val)*100;
			} 

			$sheet->setCellValue('AB' . $row, $target_qty);
			$sheet->setCellValue('AC' . $row, $target_val);
			$sheet->setCellValue('AD' . $row, $target_idx);

			// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
			$sheet->getStyle('A' . $row)->applyFromArray($style_row);
			$sheet->getStyle('B' . $row)->applyFromArray($style_row);
			$sheet->getStyle('C' . $row)->applyFromArray($style_row);
			$sheet->getStyle('D' . $row)->applyFromArray($style_row);
			$sheet->getStyle('E' . $row)->applyFromArray($style_row);
			$sheet->getStyle('F' . $row)->applyFromArray($style_row);
			$sheet->getStyle('G' . $row)->applyFromArray($style_row);
			$sheet->getStyle('H' . $row)->applyFromArray($style_row);
			$sheet->getStyle('I' . $row)->applyFromArray($style_row);
			$sheet->getStyle('J' . $row)->applyFromArray($style_row);
			$sheet->getStyle('K' . $row)->applyFromArray($style_row);
			$sheet->getStyle('L' . $row)->applyFromArray($style_row);
			$sheet->getStyle('M' . $row)->applyFromArray($style_row);
			$sheet->getStyle('N' . $row)->applyFromArray($style_row);
			$sheet->getStyle('O' . $row)->applyFromArray($style_row);
			$sheet->getStyle('P' . $row)->applyFromArray($style_row);
			$sheet->getStyle('Q' . $row)->applyFromArray($style_row);
			$sheet->getStyle('R' . $row)->applyFromArray($style_row);
			$sheet->getStyle('S' . $row)->applyFromArray($style_row);
			$sheet->getStyle('T' . $row)->applyFromArray($style_row);
			$sheet->getStyle('U' . $row)->applyFromArray($style_row);
			$sheet->getStyle('V' . $row)->applyFromArray($style_row);
			$sheet->getStyle('W' . $row)->applyFromArray($style_row);
			$sheet->getStyle('X' . $row)->applyFromArray($style_row);
			$sheet->getStyle('Y' . $row)->applyFromArray($style_row);
			$sheet->getStyle('Z' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AA' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AB' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AC' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AD' . $row)->applyFromArray($style_row);

			$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('I' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('J' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('K' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('L' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('M' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('N' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('O' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('P' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('Q' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('R' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('S' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('T' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('U' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('V' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('W' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('X' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('Y' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('Z' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AA' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AB' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AC' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AD' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

			$item_group = $rows['item_group'];
			$principal = $rows['principal'];

			$sub_ending_qty += $rows['ending_qty'];
			$sub_transit_qty += $rows['transit_qty'];
			$sub_total_ending_qty += $ttl_ending_qty;
			$sub_total_ending_val += $ttl_ending_val;
			$sub_qty_avg_sales += $rows['qty_avg_sales'];
			$sub_value_avg_sales += $rows['value_avg_sales'];
			$sub_stock_cover_days += $stock_cover_days;
			$sub_buffer_stock_days += $rows['buffer_stock_days'];
			$sub_lead_time_delivery += $rows['lead_time_delivery'];
			$sub_plan_order += $plan_order;
			$sub_cmo_pcs_qty += $cmo_pcs_qty;
			$sub_cmo_pcs_val += $cmo_pcs_val;
			$sub_cmo_carton_qty += $cmo_carton_qty;
			$sub_target_qty += $target_qty;
			$sub_target_val += $target_val;
			$sub_target_idx += $target_idx;

			$total_ending_qty += $rows['ending_qty'];
			$total_transit_qty += $rows['transit_qty'];
			$total_total_ending_qty += $ttl_ending_qty;
			$total_total_ending_val += $ttl_ending_val;
			$total_qty_avg_sales += $rows['qty_avg_sales'];
			$total_value_avg_sales += $rows['value_avg_sales'];
			$total_stock_cover_days += $stock_cover_days;
			$total_buffer_stock_days += $rows['buffer_stock_days'];
			$total_lead_time_delivery += $rows['lead_time_delivery'];
			$total_plan_order += $plan_order;
			$total_cmo_pcs_qty += $cmo_pcs_qty;
			$total_cmo_pcs_val += $cmo_pcs_val;
			$total_cmo_carton_qty += $cmo_carton_qty;
			$total_target_qty += $target_qty;
			$total_target_val += $target_val;
			$total_target_idx += $target_idx;

			$grand_ending_qty += $rows['ending_qty'];
			$grand_transit_qty += $rows['transit_qty'];
			$grand_total_ending_qty += $ttl_ending_qty;
			$grand_total_ending_val += $ttl_ending_val;
			$grand_qty_avg_sales += $rows['qty_avg_sales'];
			$grand_value_avg_sales += $rows['value_avg_sales'];
			$grand_stock_cover_days += $stock_cover_days;
			$grand_buffer_stock_days += $rows['buffer_stock_days'];
			$grand_lead_time_delivery += $rows['lead_time_delivery'];
			$grand_plan_order += $plan_order;
			$grand_cmo_pcs_qty += $cmo_pcs_qty;
			$grand_cmo_pcs_val += $cmo_pcs_val;
			$grand_cmo_carton_qty += $cmo_carton_qty;
			$grand_target_qty += $target_qty;
			$grand_target_val += $target_val;
			$grand_target_idx += $target_idx;

			$no++; // Tambah 1 setiap kali looping
    		$row++; // Tambah 1 setiap kali looping
		endforeach;

		//item_group end
		//$row = $row + 1;
		$sheet->setCellValue('A' . $row, '');
		$sheet->setCellValue('B' . $row, '');
		$sheet->setCellValue('C' . $row, 'Sub Total ' . $item_group);
		$sheet->setCellValue('D' . $row, '');
		$sheet->setCellValue('E' . $row, '');
		$sheet->setCellValue('F' . $row, $sub_ending_qty);
		$sheet->setCellValue('G' . $row, $sub_transit_qty);
		$sheet->setCellValue('H' . $row, $sub_total_ending_qty);
		$sheet->setCellValue('I' . $row, $sub_total_ending_val);
		$sheet->setCellValue('J' . $row, $sub_qty_avg_sales);
		$sheet->setCellValue('K' . $row, $sub_value_avg_sales);
		$sheet->setCellValue('L' . $row, $sub_stock_cover_days);
		$sheet->setCellValue('M' . $row, $sub_qty_avg_sales);
		$sheet->setCellValue('N' . $row, $sub_value_avg_sales);
		$sheet->setCellValue('O' . $row, $sub_buffer_stock_days);
		$sheet->setCellValue('P' . $row, $sub_lead_time_delivery);
		$sheet->setCellValue('Q' . $row, $sub_plan_order);
		$sheet->setCellValue('R' . $row, '');
		$sheet->setCellValue('S' . $row, '');
		$sheet->setCellValue('T' . $row, $sub_cmo_pcs_qty);
		$sheet->setCellValue('U' . $row, $sub_cmo_pcs_val);
		$sheet->setCellValue('V' . $row, $sub_cmo_carton_qty);
		$sheet->setCellValue('W' . $row, '');
		$sheet->setCellValue('X' . $row, '');
		$sheet->setCellValue('Y' . $row, '');
		$sheet->setCellValue('Z' . $row, '');
		$sheet->setCellValue('AA' . $row, '');
		$sheet->setCellValue('AB' . $row, $sub_target_qty);
		$sheet->setCellValue('AC' . $row, $sub_target_val);
		$sheet->setCellValue('AD' . $row, $sub_target_idx);


		// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
		$sheet->getStyle('A' . $row)->applyFromArray($style_row);
		$sheet->getStyle('B' . $row)->applyFromArray($style_row);
		$sheet->getStyle('C' . $row)->applyFromArray($style_row);
		$sheet->getStyle('D' . $row)->applyFromArray($style_row);
		$sheet->getStyle('E' . $row)->applyFromArray($style_row);
		$sheet->getStyle('F' . $row)->applyFromArray($style_row);
		$sheet->getStyle('G' . $row)->applyFromArray($style_row);
		$sheet->getStyle('H' . $row)->applyFromArray($style_row);
		$sheet->getStyle('I' . $row)->applyFromArray($style_row);
		$sheet->getStyle('J' . $row)->applyFromArray($style_row);
		$sheet->getStyle('K' . $row)->applyFromArray($style_row);
		$sheet->getStyle('L' . $row)->applyFromArray($style_row);
		$sheet->getStyle('M' . $row)->applyFromArray($style_row);
		$sheet->getStyle('N' . $row)->applyFromArray($style_row);
		$sheet->getStyle('O' . $row)->applyFromArray($style_row);
		$sheet->getStyle('P' . $row)->applyFromArray($style_row);
		$sheet->getStyle('Q' . $row)->applyFromArray($style_row);
		$sheet->getStyle('R' . $row)->applyFromArray($style_row);
		$sheet->getStyle('S' . $row)->applyFromArray($style_row);
		$sheet->getStyle('T' . $row)->applyFromArray($style_row);
		$sheet->getStyle('U' . $row)->applyFromArray($style_row);
		$sheet->getStyle('V' . $row)->applyFromArray($style_row);
		$sheet->getStyle('W' . $row)->applyFromArray($style_row);
		$sheet->getStyle('X' . $row)->applyFromArray($style_row);
		$sheet->getStyle('Y' . $row)->applyFromArray($style_row);
		$sheet->getStyle('Z' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AA' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AB' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AC' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AD' . $row)->applyFromArray($style_row);

		$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('I' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('J' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('K' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('L' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('M' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('N' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('O' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('P' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('Q' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('R' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('S' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('T' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('U' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('V' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('W' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('X' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('Y' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('Z' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AA' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AB' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AC' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AD' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

		$sheet->getStyle('A' . $row . ':AD' . $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');
		$sheet->getStyle('A' . $row . ':AD' . $row)->getFont()->setBold(true);

		//principal end
		$row = $row + 1;
		$sheet->setCellValue('A' . $row, '');
		$sheet->setCellValue('B' . $row, '');
		$sheet->setCellValue('C' . $row, 'TOTAL ' . $principal);
		$sheet->setCellValue('D' . $row, '');
		$sheet->setCellValue('E' . $row, '');
		$sheet->setCellValue('F' . $row, $total_ending_qty);
		$sheet->setCellValue('G' . $row, $total_transit_qty);
		$sheet->setCellValue('H' . $row, $total_total_ending_qty);
		$sheet->setCellValue('I' . $row, $total_total_ending_val);
		$sheet->setCellValue('J' . $row, $total_qty_avg_sales);
		$sheet->setCellValue('K' . $row, $total_value_avg_sales);
		$sheet->setCellValue('L' . $row, $total_stock_cover_days);
		$sheet->setCellValue('M' . $row, $total_qty_avg_sales);
		$sheet->setCellValue('N' . $row, $total_value_avg_sales);
		$sheet->setCellValue('O' . $row, $total_buffer_stock_days);
		$sheet->setCellValue('P' . $row, $total_lead_time_delivery);
		$sheet->setCellValue('Q' . $row, $total_plan_order);
		$sheet->setCellValue('R' . $row, '');
		$sheet->setCellValue('S' . $row, '');
		$sheet->setCellValue('T' . $row, $total_cmo_pcs_qty);
		$sheet->setCellValue('U' . $row, $total_cmo_pcs_val);
		$sheet->setCellValue('V' . $row, $total_cmo_carton_qty);
		$sheet->setCellValue('W' . $row, '');
		$sheet->setCellValue('X' . $row, '');
		$sheet->setCellValue('Y' . $row, '');
		$sheet->setCellValue('Z' . $row, '');
		$sheet->setCellValue('AA' . $row, '');
		$sheet->setCellValue('AB' . $row, $total_target_qty);
		$sheet->setCellValue('AC' . $row, $total_target_val);
		$sheet->setCellValue('AD' . $row, $total_target_idx);
		

		// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
		$sheet->getStyle('A' . $row)->applyFromArray($style_row);
		$sheet->getStyle('B' . $row)->applyFromArray($style_row);
		$sheet->getStyle('C' . $row)->applyFromArray($style_row);
		$sheet->getStyle('D' . $row)->applyFromArray($style_row);
		$sheet->getStyle('E' . $row)->applyFromArray($style_row);
		$sheet->getStyle('F' . $row)->applyFromArray($style_row);
		$sheet->getStyle('G' . $row)->applyFromArray($style_row);
		$sheet->getStyle('H' . $row)->applyFromArray($style_row);
		$sheet->getStyle('I' . $row)->applyFromArray($style_row);
		$sheet->getStyle('J' . $row)->applyFromArray($style_row);
		$sheet->getStyle('K' . $row)->applyFromArray($style_row);
		$sheet->getStyle('L' . $row)->applyFromArray($style_row);
		$sheet->getStyle('M' . $row)->applyFromArray($style_row);
		$sheet->getStyle('N' . $row)->applyFromArray($style_row);
		$sheet->getStyle('O' . $row)->applyFromArray($style_row);
		$sheet->getStyle('P' . $row)->applyFromArray($style_row);
		$sheet->getStyle('Q' . $row)->applyFromArray($style_row);
		$sheet->getStyle('R' . $row)->applyFromArray($style_row);
		$sheet->getStyle('S' . $row)->applyFromArray($style_row);
		$sheet->getStyle('T' . $row)->applyFromArray($style_row);
		$sheet->getStyle('U' . $row)->applyFromArray($style_row);
		$sheet->getStyle('V' . $row)->applyFromArray($style_row);
		$sheet->getStyle('W' . $row)->applyFromArray($style_row);
		$sheet->getStyle('X' . $row)->applyFromArray($style_row);
		$sheet->getStyle('Y' . $row)->applyFromArray($style_row);
		$sheet->getStyle('Z' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AA' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AB' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AC' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AD' . $row)->applyFromArray($style_row);


		$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('I' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('J' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('K' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('L' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('M' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('N' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('O' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('P' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('Q' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('R' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('S' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('T' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('U' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('V' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('W' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('X' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('Y' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('Z' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AA' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AB' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AC' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AD' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

		$sheet->getStyle('A' . $row . ':AD' . $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFA07A');
		$sheet->getStyle('A' . $row . ':AD' . $row)->getFont()->setBold(true);

		//grand total
		$row = $row + 1;
		$sheet->setCellValue('A' . $row, '');
		$sheet->setCellValue('B' . $row, '');
		$sheet->setCellValue('C' . $row, 'GRAND TOTAL');
		$sheet->setCellValue('D' . $row, '');
		$sheet->setCellValue('E' . $row, '');
		$sheet->setCellValue('F' . $row, $grand_ending_qty);
		$sheet->setCellValue('G' . $row, $grand_transit_qty);
		$sheet->setCellValue('H' . $row, $grand_total_ending_qty);
		$sheet->setCellValue('I' . $row, $grand_total_ending_val);
		$sheet->setCellValue('J' . $row, $grand_qty_avg_sales);
		$sheet->setCellValue('K' . $row, $grand_value_avg_sales);
		$sheet->setCellValue('L' . $row, $grand_stock_cover_days);
		$sheet->setCellValue('M' . $row, $grand_qty_avg_sales);
		$sheet->setCellValue('N' . $row, $grand_value_avg_sales);
		$sheet->setCellValue('O' . $row, $grand_buffer_stock_days);
		$sheet->setCellValue('P' . $row, $grand_lead_time_delivery);
		$sheet->setCellValue('Q' . $row, $grand_plan_order);
		$sheet->setCellValue('R' . $row, '');
		$sheet->setCellValue('S' . $row, '');
		$sheet->setCellValue('T' . $row, $grand_cmo_pcs_qty);
		$sheet->setCellValue('U' . $row, $grand_cmo_pcs_val);
		$sheet->setCellValue('V' . $row, $grand_cmo_carton_qty);
		$sheet->setCellValue('W' . $row, '');
		$sheet->setCellValue('X' . $row, '');
		$sheet->setCellValue('Y' . $row, '');
		$sheet->setCellValue('Z' . $row, '');
		$sheet->setCellValue('AA' . $row, '');
		$sheet->setCellValue('AB' . $row, $grand_target_qty);
		$sheet->setCellValue('AC' . $row, $grand_target_val);
		$sheet->setCellValue('AD' . $row, $grand_target_idx);

		// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
		$sheet->getStyle('A' . $row)->applyFromArray($style_row);
		$sheet->getStyle('B' . $row)->applyFromArray($style_row);
		$sheet->getStyle('C' . $row)->applyFromArray($style_row);
		$sheet->getStyle('D' . $row)->applyFromArray($style_row);
		$sheet->getStyle('E' . $row)->applyFromArray($style_row);
		$sheet->getStyle('F' . $row)->applyFromArray($style_row);
		$sheet->getStyle('G' . $row)->applyFromArray($style_row);
		$sheet->getStyle('H' . $row)->applyFromArray($style_row);
		$sheet->getStyle('I' . $row)->applyFromArray($style_row);
		$sheet->getStyle('J' . $row)->applyFromArray($style_row);
		$sheet->getStyle('K' . $row)->applyFromArray($style_row);
		$sheet->getStyle('L' . $row)->applyFromArray($style_row);
		$sheet->getStyle('M' . $row)->applyFromArray($style_row);
		$sheet->getStyle('N' . $row)->applyFromArray($style_row);
		$sheet->getStyle('O' . $row)->applyFromArray($style_row);
		$sheet->getStyle('P' . $row)->applyFromArray($style_row);
		$sheet->getStyle('Q' . $row)->applyFromArray($style_row);
		$sheet->getStyle('R' . $row)->applyFromArray($style_row);
		$sheet->getStyle('S' . $row)->applyFromArray($style_row);
		$sheet->getStyle('T' . $row)->applyFromArray($style_row);
		$sheet->getStyle('U' . $row)->applyFromArray($style_row);
		$sheet->getStyle('V' . $row)->applyFromArray($style_row);
		$sheet->getStyle('W' . $row)->applyFromArray($style_row);
		$sheet->getStyle('X' . $row)->applyFromArray($style_row);
		$sheet->getStyle('Y' . $row)->applyFromArray($style_row);
		$sheet->getStyle('Z' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AA' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AB' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AC' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AD' . $row)->applyFromArray($style_row);

		$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('I' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('J' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('K' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('L' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('M' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('N' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('O' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('P' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('Q' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('R' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('S' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('T' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('U' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('V' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('W' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('X' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('Y' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('Z' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AA' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AB' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AC' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AD' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

		$sheet->getStyle('A' . $row . ':AD' . $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFA07A');
		$sheet->getStyle('A' . $row . ':AD' . $row)->getFont()->setBold(true);


		//set columns width
		$sheet->getColumnDimension('A')->setWidth(5); 
		$sheet->getColumnDimension('B')->setWidth(11); 
		$sheet->getColumnDimension('C')->setWidth(53);
		$sheet->getColumnDimension('D')->setWidth(12);
		$sheet->getColumnDimension('E')->setWidth(12);
		$sheet->getColumnDimension('F')->setWidth(12);
		$sheet->getColumnDimension('G')->setWidth(12);
		$sheet->getColumnDimension('H')->setWidth(12);
		$sheet->getColumnDimension('I')->setWidth(12);
		$sheet->getColumnDimension('J')->setWidth(12);
		$sheet->getColumnDimension('K')->setWidth(12);
		$sheet->getColumnDimension('L')->setWidth(12);
		$sheet->getColumnDimension('M')->setWidth(12);
		$sheet->getColumnDimension('N')->setWidth(12);
		$sheet->getColumnDimension('O')->setWidth(12);
		$sheet->getColumnDimension('P')->setWidth(12);
		$sheet->getColumnDimension('Q')->setWidth(12);
		$sheet->getColumnDimension('R')->setWidth(12);
		$sheet->getColumnDimension('S')->setWidth(12);
		$sheet->getColumnDimension('T')->setWidth(12);
		$sheet->getColumnDimension('U')->setWidth(12);
		$sheet->getColumnDimension('V')->setWidth(12);
		$sheet->getColumnDimension('W')->setWidth(12);//Index(%)
		$sheet->getColumnDimension('X')->setWidth(12);//Index(%)
		$sheet->getColumnDimension('Y')->setWidth(12);
		$sheet->getColumnDimension('Z')->setWidth(12);
		$sheet->getColumnDimension('AA')->setWidth(12);
		$sheet->getColumnDimension('AB')->setWidth(12);
		$sheet->getColumnDimension('AC')->setWidth(12);
		$sheet->getColumnDimension('AD')->setWidth(12);
		

		// Set orientasi kertas jadi LANDSCAPE
		$sheet->getPageSetup()->setOrientation(\PhpOffice\PhpSpreadsheet\Worksheet\PageSetup::ORIENTATION_LANDSCAPE);
		// Set judul file excel nya
		$sheet->setTitle("Conform Monthly Order - CMO");
		// Proses file excel
		header('Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet');
		header('Content-Disposition: attachment; filename="Conform Monthly Order - CMO ("' . $year . '").xlsx"'); // Set nama file excel nya
		header('Cache-Control: max-age=0');

		$writer = new Xlsx($spreadsheet);
		$writer->save('php://output');

	}

	public function export_sellingout_salesman()
	{
		$spreadsheet = new Spreadsheet();
		$sheet = $spreadsheet->getActiveSheet();
		// Buat sebuah variabel untuk menampung pengaturan style dari header tabel
		$style_col = [
			'font' => ['bold' => true], // Set font nya jadi bold
			'alignment' => [
				'horizontal' => \PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER, // Set text jadi ditengah secara horizontal (center)
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'top' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border top dengan garis tipis
				'right' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN],  // Set border right dengan garis tipis
				'bottom' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border bottom dengan garis tipis
				'left' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN] // Set border left dengan garis tipis
			]
		];
		// Buat sebuah variabel untuk menampung pengaturan style dari isi tabel
		$style_row = [
			'alignment' => [
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'top' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border top dengan garis tipis
				'right' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN],  // Set border right dengan garis tipis
				'bottom' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border bottom dengan garis tipis
				'left' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN] // Set border left dengan garis tipis
			]
		];


		if (isset($_POST['by_island']))
		{
			$island = $_POST['by_island'];
		}
		else
		{
			$island = "";
		}

		if (isset($_POST['by_region']))
		{
			$region = $_POST['by_region'];
		}
		else
		{
			$region = "";
		}

		if (isset($_POST['by_area']))
		{
			$area = $_POST['by_area'];
		}
		else
		{
			$area = "";
		}

		if (isset($_POST['by_principal']))
		{
			$principal = $_POST['by_principal'];
		}
		else
		{
			$principal = "";
		}

		if (isset($_POST['by_year']))
		{
			$year = $_POST['by_year'];
		}
		else
		{
			$year = date('Y');
		}


		$sheet->setCellValue('A1', "Report Selling Out - Salesman (" . $year . ")"); // Set kolom A1 dengan tulisan 
		$sheet->setCellValue('A2', "Island : " . $island);
		$sheet->setCellValue('A3', "Region : " . $region); 
		$sheet->setCellValue('A4', "Area : " . $area);
		$sheet->setCellValue('A5', "Principal : " . $principal);  
		//$sheet->mergeCells('A1:F1'); // Set Merge Cell pada kolom A1 sampai F1
		$sheet->getStyle('A1')->getFont()->setBold(true); // Set bold kolom A1
		$sheet->getStyle('A2')->getFont()->setBold(true);
		$sheet->getStyle('A3')->getFont()->setBold(true);
		$sheet->getStyle('A4')->getFont()->setBold(true);
		$sheet->getStyle('A5')->getFont()->setBold(true);
		$sheet->getStyle('A1')->getFont()->setSize(20); // Set font size 15 untuk kolom A1
		// Buat header tabel nya pada baris ke 6
		$sheet->setCellValue('A7', "#"); // Set kolom A6 dengan tulisan "#"
		$sheet->mergeCells('A7:A9');//Set Merge Cell
		$sheet->setCellValue('B7', "Salesman");
		$sheet->mergeCells('B7:B9');
		
		//Header Month
		$sheet->setCellValue('C7', "January");
		$sheet->mergeCells('C7:H7');
		$sheet->setCellValue('I7', "February");
		$sheet->mergeCells('I7:N7');
		$sheet->setCellValue('O7', "March");
		$sheet->mergeCells('O7:T7');
		$sheet->setCellValue('U7', "April");
		$sheet->mergeCells('U7:Z7');
		$sheet->setCellValue('AA7', "May");
		$sheet->mergeCells('AA7:AF7');
		$sheet->setCellValue('AG7', "June");
		$sheet->mergeCells('AG7:AL7');
		$sheet->setCellValue('AM7', "July");
		$sheet->mergeCells('AM7:AR7');
		$sheet->setCellValue('AS7', "August");
		$sheet->mergeCells('AS7:AX7');
		$sheet->setCellValue('AY7', "September");
		$sheet->mergeCells('AY7:BD7');
		$sheet->setCellValue('BE7', "October");
		$sheet->mergeCells('BE7:BJ7');
		$sheet->setCellValue('BK7', "November");
		$sheet->mergeCells('BK7:BP7');
		$sheet->setCellValue('BQ7', "December");
		$sheet->mergeCells('BQ7:BV7');
		$sheet->setCellValue('BW7', "Total");
		$sheet->mergeCells('BW7:CB7');


		//Header Actual, Target, Index
		$sheet->setCellValue('C8', "Actual");
		$sheet->mergeCells('C8:D8');
		$sheet->setCellValue('E8', "Target");
		$sheet->mergeCells('E8:F8');
		$sheet->setCellValue('G8', "Index(%)");
		$sheet->mergeCells('G8:H8');
		$sheet->setCellValue('I8', "Actual");
		$sheet->mergeCells('I8:J8');
		$sheet->setCellValue('K8', "Target");
		$sheet->mergeCells('K8:L8');
		$sheet->setCellValue('M8', "Index(%)");
		$sheet->mergeCells('M8:N8');
		$sheet->setCellValue('O8', "Actual");
		$sheet->mergeCells('O8:P8');
		$sheet->setCellValue('Q8', "Target");
		$sheet->mergeCells('Q8:R8');
		$sheet->setCellValue('S8', "Index(%)");
		$sheet->mergeCells('S8:T8');
		$sheet->setCellValue('U8', "Actual");
		$sheet->mergeCells('U8:V8');
		$sheet->setCellValue('W8', "Target");
		$sheet->mergeCells('W8:X8');
		$sheet->setCellValue('Y8', "Index(%)");
		$sheet->mergeCells('Y8:Z8');
		$sheet->setCellValue('AA8', "Actual");
		$sheet->mergeCells('AA8:AB8');
		$sheet->setCellValue('AC8', "Target");
		$sheet->mergeCells('AC8:AD8');
		$sheet->setCellValue('AE8', "Index(%)");
		$sheet->mergeCells('AE8:AF8');
		$sheet->setCellValue('AG8', "Actual");
		$sheet->mergeCells('AG8:AH8');
		$sheet->setCellValue('AI8', "Target");
		$sheet->mergeCells('AI8:AJ8');
		$sheet->setCellValue('AK8', "Index(%)");
		$sheet->mergeCells('AK8:AL8');
		$sheet->setCellValue('AM8', "Actual");
		$sheet->mergeCells('AM8:AN8');
		$sheet->setCellValue('AO8', "Target");
		$sheet->mergeCells('AO8:AP8');
		$sheet->setCellValue('AQ8', "Index(%)");
		$sheet->mergeCells('AQ8:AR8');
		$sheet->setCellValue('AS8', "Actual");
		$sheet->mergeCells('AS8:AT8');
		$sheet->setCellValue('AU8', "Target");
		$sheet->mergeCells('AU8:AV8');
		$sheet->setCellValue('AW8', "Index(%)");
		$sheet->mergeCells('AW8:AX8');
		$sheet->setCellValue('AY8', "Actual");
		$sheet->mergeCells('AY8:AZ8');
		$sheet->setCellValue('BA8', "Target");
		$sheet->mergeCells('BA8:BB8');
		$sheet->setCellValue('BC8', "Index(%)");
		$sheet->mergeCells('BC8:BD8');
		$sheet->setCellValue('BE8', "Actual");
		$sheet->mergeCells('BE8:BF8');
		$sheet->setCellValue('BG8', "Target");
		$sheet->mergeCells('BG8:BH8');
		$sheet->setCellValue('BI8', "Index(%)");
		$sheet->mergeCells('BI8:BJ8');
		$sheet->setCellValue('BK8', "Actual");
		$sheet->mergeCells('BK8:BL8');
		$sheet->setCellValue('BM8', "Target");
		$sheet->mergeCells('BM8:BN8');
		$sheet->setCellValue('BO8', "Index(%)");
		$sheet->mergeCells('BO8:BP8');
		$sheet->setCellValue('BQ8', "Actual");
		$sheet->mergeCells('BQ8:BR8');
		$sheet->setCellValue('BS8', "Target");
		$sheet->mergeCells('BS8:BT8');
		$sheet->setCellValue('BU8', "Index(%)");
		$sheet->mergeCells('BU8:BV8');
		$sheet->setCellValue('BW8', "Actual");//TOTAL
		$sheet->mergeCells('BW8:BX8');
		$sheet->setCellValue('BY8', "Target");
		$sheet->mergeCells('BY8:BZ8');
		$sheet->setCellValue('CA8', "Index(%)");//TOTAL
		$sheet->mergeCells('CA8:CB8');


		//Header QTY, VALUE
		$sheet->setCellValue('C9', "Qty");
		$sheet->setCellValue('D9', "Value");
		$sheet->setCellValue('E9', "Qty");
		$sheet->setCellValue('F9', "Value");
		$sheet->setCellValue('G9', "Qty");
		$sheet->setCellValue('H9', "Value");
		$sheet->setCellValue('I9', "Qty");
		$sheet->setCellValue('J9', "Value");
		$sheet->setCellValue('K9', "Qty");
		$sheet->setCellValue('L9', "Value");
		$sheet->setCellValue('M9', "Qty");
		$sheet->setCellValue('N9', "Value");
		$sheet->setCellValue('O9', "Qty");
		$sheet->setCellValue('P9', "Value");
		$sheet->setCellValue('Q9', "Qty");
		$sheet->setCellValue('R9', "Value");
		$sheet->setCellValue('S9', "Qty");
		$sheet->setCellValue('T9', "Value");
		$sheet->setCellValue('U9', "Qty");
		$sheet->setCellValue('V9', "Value");
		$sheet->setCellValue('W9', "Qty");
		$sheet->setCellValue('X9', "Value");
		$sheet->setCellValue('Y9', "Qty");
		$sheet->setCellValue('Z9', "Value");
		$sheet->setCellValue('AA9', "Qty");
		$sheet->setCellValue('AB9', "Value");
		$sheet->setCellValue('AC9', "Qty");
		$sheet->setCellValue('AD9', "Value");
		$sheet->setCellValue('AE9', "Qty");
		$sheet->setCellValue('AF9', "Value");
		$sheet->setCellValue('AG9', "Qty");
		$sheet->setCellValue('AH9', "Value");
		$sheet->setCellValue('AI9', "Qty");
		$sheet->setCellValue('AJ9', "Value");
		$sheet->setCellValue('AK9', "Qty");
		$sheet->setCellValue('AL9', "Value");
		$sheet->setCellValue('AM9', "Qty");
		$sheet->setCellValue('AN9', "Value");
		$sheet->setCellValue('AO9', "Qty");
		$sheet->setCellValue('AP9', "Value");
		$sheet->setCellValue('AQ9', "Qty");
		$sheet->setCellValue('AR9', "Value");
		$sheet->setCellValue('AS9', "Qty");
		$sheet->setCellValue('AT9', "Value");
		$sheet->setCellValue('AU9', "Qty");
		$sheet->setCellValue('AV9', "Value");
		$sheet->setCellValue('AW9', "Qty");
		$sheet->setCellValue('AX9', "Value");
		$sheet->setCellValue('AY9', "Qty");
		$sheet->setCellValue('AZ9', "Value");
		$sheet->setCellValue('BA9', "Qty");
		$sheet->setCellValue('BB9', "Value");
		$sheet->setCellValue('BC9', "Qty");
		$sheet->setCellValue('BD9', "Value");
		$sheet->setCellValue('BE9', "Qty");
		$sheet->setCellValue('BF9', "Value");
		$sheet->setCellValue('BG9', "Qty");
		$sheet->setCellValue('BH9', "Value");
		$sheet->setCellValue('BI9', "Qty");
		$sheet->setCellValue('BJ9', "Value");
		$sheet->setCellValue('BK9', "Qty");
		$sheet->setCellValue('BL9', "Value");
		$sheet->setCellValue('BM9', "Qty");
		$sheet->setCellValue('BN9', "Value");
		$sheet->setCellValue('BO9', "Qty");
		$sheet->setCellValue('BP9', "Value");
		$sheet->setCellValue('BQ9', "Qty");
		$sheet->setCellValue('BR9', "Value");
		$sheet->setCellValue('BS9', "Qty");
		$sheet->setCellValue('BT9', "Value");
		$sheet->setCellValue('BU9', "Qty");
		$sheet->setCellValue('BV9', "Value");
		$sheet->setCellValue('BW9', "Qty");
		$sheet->setCellValue('BX9', "Value");
		$sheet->setCellValue('BY9', "Qty");
		$sheet->setCellValue('BZ9', "Value");
		$sheet->setCellValue('CA9', "Qty");
		$sheet->setCellValue('CB9', "Value");
		
		
		// Apply style header yang telah kita buat tadi ke masing-masing kolom header
		$sheet->getStyle('A7')->applyFromArray($style_col);
		$sheet->getStyle('B7')->applyFromArray($style_col);
		$sheet->getStyle('C7')->applyFromArray($style_col);
		$sheet->getStyle('D7')->applyFromArray($style_col);
		$sheet->getStyle('E7')->applyFromArray($style_col);
		$sheet->getStyle('F7')->applyFromArray($style_col);
		$sheet->getStyle('G7')->applyFromArray($style_col);
		$sheet->getStyle('H7')->applyFromArray($style_col);
		$sheet->getStyle('I7')->applyFromArray($style_col);
		$sheet->getStyle('J7')->applyFromArray($style_col);
		$sheet->getStyle('K7')->applyFromArray($style_col);
		$sheet->getStyle('L7')->applyFromArray($style_col);
		$sheet->getStyle('M7')->applyFromArray($style_col);
		$sheet->getStyle('N7')->applyFromArray($style_col);
		$sheet->getStyle('O7')->applyFromArray($style_col);
		$sheet->getStyle('P7')->applyFromArray($style_col);
		$sheet->getStyle('Q7')->applyFromArray($style_col);
		$sheet->getStyle('R7')->applyFromArray($style_col);
		$sheet->getStyle('S7')->applyFromArray($style_col);
		$sheet->getStyle('T7')->applyFromArray($style_col);
		$sheet->getStyle('U7')->applyFromArray($style_col);
		$sheet->getStyle('V7')->applyFromArray($style_col);
		$sheet->getStyle('W7')->applyFromArray($style_col);
		$sheet->getStyle('X7')->applyFromArray($style_col);
		$sheet->getStyle('Y7')->applyFromArray($style_col);
		$sheet->getStyle('Z7')->applyFromArray($style_col);
		$sheet->getStyle('AA7')->applyFromArray($style_col);
		$sheet->getStyle('AB7')->applyFromArray($style_col);
		$sheet->getStyle('AC7')->applyFromArray($style_col);
		$sheet->getStyle('AD7')->applyFromArray($style_col);
		$sheet->getStyle('AE7')->applyFromArray($style_col);
		$sheet->getStyle('AF7')->applyFromArray($style_col);
		$sheet->getStyle('AG7')->applyFromArray($style_col);
		$sheet->getStyle('AH7')->applyFromArray($style_col);
		$sheet->getStyle('AI7')->applyFromArray($style_col);
		$sheet->getStyle('AJ7')->applyFromArray($style_col);
		$sheet->getStyle('AK7')->applyFromArray($style_col);
		$sheet->getStyle('AL7')->applyFromArray($style_col);
		$sheet->getStyle('AM7')->applyFromArray($style_col);
		$sheet->getStyle('AN7')->applyFromArray($style_col);
		$sheet->getStyle('AO7')->applyFromArray($style_col);
		$sheet->getStyle('AP7')->applyFromArray($style_col);
		$sheet->getStyle('AQ7')->applyFromArray($style_col);
		$sheet->getStyle('AR7')->applyFromArray($style_col);
		$sheet->getStyle('AS7')->applyFromArray($style_col);
		$sheet->getStyle('AT7')->applyFromArray($style_col);
		$sheet->getStyle('AU7')->applyFromArray($style_col);
		$sheet->getStyle('AV7')->applyFromArray($style_col);
		$sheet->getStyle('AW7')->applyFromArray($style_col);
		$sheet->getStyle('AX7')->applyFromArray($style_col);
		$sheet->getStyle('AY7')->applyFromArray($style_col);
		$sheet->getStyle('AZ7')->applyFromArray($style_col);
		$sheet->getStyle('BA7')->applyFromArray($style_col);
		$sheet->getStyle('BB7')->applyFromArray($style_col);
		$sheet->getStyle('BC7')->applyFromArray($style_col);
		$sheet->getStyle('BD7')->applyFromArray($style_col);
		$sheet->getStyle('BE7')->applyFromArray($style_col);
		$sheet->getStyle('BF7')->applyFromArray($style_col);
		$sheet->getStyle('BG7')->applyFromArray($style_col);
		$sheet->getStyle('BH7')->applyFromArray($style_col);
		$sheet->getStyle('BI7')->applyFromArray($style_col);
		$sheet->getStyle('BJ7')->applyFromArray($style_col);
		$sheet->getStyle('BK7')->applyFromArray($style_col);
		$sheet->getStyle('BL7')->applyFromArray($style_col);
		$sheet->getStyle('BM7')->applyFromArray($style_col);
		$sheet->getStyle('BN7')->applyFromArray($style_col);
		$sheet->getStyle('BO7')->applyFromArray($style_col);
		$sheet->getStyle('BP7')->applyFromArray($style_col);
		$sheet->getStyle('BQ7')->applyFromArray($style_col);
		$sheet->getStyle('BR7')->applyFromArray($style_col);
		$sheet->getStyle('BS7')->applyFromArray($style_col);
		$sheet->getStyle('BT7')->applyFromArray($style_col);
		$sheet->getStyle('BU7')->applyFromArray($style_col);
		$sheet->getStyle('BV7')->applyFromArray($style_col);
		$sheet->getStyle('BW7')->applyFromArray($style_col);
		$sheet->getStyle('BX7')->applyFromArray($style_col);
		$sheet->getStyle('BY7')->applyFromArray($style_col);
		$sheet->getStyle('BZ7')->applyFromArray($style_col);
		$sheet->getStyle('CA7')->applyFromArray($style_col);
		$sheet->getStyle('CB7')->applyFromArray($style_col);

		$sheet->getStyle('A8')->applyFromArray($style_col);
		$sheet->getStyle('B8')->applyFromArray($style_col);
		$sheet->getStyle('C8')->applyFromArray($style_col);
		$sheet->getStyle('D8')->applyFromArray($style_col);
		$sheet->getStyle('E8')->applyFromArray($style_col);
		$sheet->getStyle('F8')->applyFromArray($style_col);
		$sheet->getStyle('G8')->applyFromArray($style_col);
		$sheet->getStyle('H8')->applyFromArray($style_col);
		$sheet->getStyle('I8')->applyFromArray($style_col);
		$sheet->getStyle('J8')->applyFromArray($style_col);
		$sheet->getStyle('K8')->applyFromArray($style_col);
		$sheet->getStyle('L8')->applyFromArray($style_col);
		$sheet->getStyle('M8')->applyFromArray($style_col);
		$sheet->getStyle('N8')->applyFromArray($style_col);
		$sheet->getStyle('O8')->applyFromArray($style_col);
		$sheet->getStyle('P8')->applyFromArray($style_col);
		$sheet->getStyle('Q8')->applyFromArray($style_col);
		$sheet->getStyle('R8')->applyFromArray($style_col);
		$sheet->getStyle('S8')->applyFromArray($style_col);
		$sheet->getStyle('T8')->applyFromArray($style_col);
		$sheet->getStyle('U8')->applyFromArray($style_col);
		$sheet->getStyle('V8')->applyFromArray($style_col);
		$sheet->getStyle('W8')->applyFromArray($style_col);
		$sheet->getStyle('X8')->applyFromArray($style_col);
		$sheet->getStyle('Y8')->applyFromArray($style_col);
		$sheet->getStyle('Z8')->applyFromArray($style_col);
		$sheet->getStyle('AA8')->applyFromArray($style_col);
		$sheet->getStyle('AB8')->applyFromArray($style_col);
		$sheet->getStyle('AC8')->applyFromArray($style_col);
		$sheet->getStyle('AD8')->applyFromArray($style_col);
		$sheet->getStyle('AE8')->applyFromArray($style_col);
		$sheet->getStyle('AF8')->applyFromArray($style_col);
		$sheet->getStyle('AG8')->applyFromArray($style_col);
		$sheet->getStyle('AH8')->applyFromArray($style_col);
		$sheet->getStyle('AI8')->applyFromArray($style_col);
		$sheet->getStyle('AJ8')->applyFromArray($style_col);
		$sheet->getStyle('AK8')->applyFromArray($style_col);
		$sheet->getStyle('AL8')->applyFromArray($style_col);
		$sheet->getStyle('AM8')->applyFromArray($style_col);
		$sheet->getStyle('AN8')->applyFromArray($style_col);
		$sheet->getStyle('AO8')->applyFromArray($style_col);
		$sheet->getStyle('AP8')->applyFromArray($style_col);
		$sheet->getStyle('AQ8')->applyFromArray($style_col);
		$sheet->getStyle('AR8')->applyFromArray($style_col);
		$sheet->getStyle('AS8')->applyFromArray($style_col);
		$sheet->getStyle('AT8')->applyFromArray($style_col);
		$sheet->getStyle('AU8')->applyFromArray($style_col);
		$sheet->getStyle('AV8')->applyFromArray($style_col);
		$sheet->getStyle('AW8')->applyFromArray($style_col);
		$sheet->getStyle('AX8')->applyFromArray($style_col);
		$sheet->getStyle('AY8')->applyFromArray($style_col);
		$sheet->getStyle('AZ8')->applyFromArray($style_col);
		$sheet->getStyle('BA8')->applyFromArray($style_col);
		$sheet->getStyle('BB8')->applyFromArray($style_col);
		$sheet->getStyle('BC8')->applyFromArray($style_col);
		$sheet->getStyle('BD8')->applyFromArray($style_col);
		$sheet->getStyle('BE8')->applyFromArray($style_col);
		$sheet->getStyle('BF8')->applyFromArray($style_col);
		$sheet->getStyle('BG8')->applyFromArray($style_col);
		$sheet->getStyle('BH8')->applyFromArray($style_col);
		$sheet->getStyle('BI8')->applyFromArray($style_col);
		$sheet->getStyle('BJ8')->applyFromArray($style_col);
		$sheet->getStyle('BK8')->applyFromArray($style_col);
		$sheet->getStyle('BL8')->applyFromArray($style_col);
		$sheet->getStyle('BM8')->applyFromArray($style_col);
		$sheet->getStyle('BN8')->applyFromArray($style_col);
		$sheet->getStyle('BO8')->applyFromArray($style_col);
		$sheet->getStyle('BP8')->applyFromArray($style_col);
		$sheet->getStyle('BQ8')->applyFromArray($style_col);
		$sheet->getStyle('BR8')->applyFromArray($style_col);
		$sheet->getStyle('BS8')->applyFromArray($style_col);
		$sheet->getStyle('BT8')->applyFromArray($style_col);
		$sheet->getStyle('BU8')->applyFromArray($style_col);
		$sheet->getStyle('BV8')->applyFromArray($style_col);
		$sheet->getStyle('BW8')->applyFromArray($style_col);
		$sheet->getStyle('BX8')->applyFromArray($style_col);
		$sheet->getStyle('BY8')->applyFromArray($style_col);
		$sheet->getStyle('BZ8')->applyFromArray($style_col);
		$sheet->getStyle('CA8')->applyFromArray($style_col);
		$sheet->getStyle('CB8')->applyFromArray($style_col);

		$sheet->getStyle('A9')->applyFromArray($style_col);
		$sheet->getStyle('B9')->applyFromArray($style_col);
		$sheet->getStyle('C9')->applyFromArray($style_col);
		$sheet->getStyle('D9')->applyFromArray($style_col);
		$sheet->getStyle('E9')->applyFromArray($style_col);
		$sheet->getStyle('F9')->applyFromArray($style_col);
		$sheet->getStyle('G9')->applyFromArray($style_col);
		$sheet->getStyle('H9')->applyFromArray($style_col);
		$sheet->getStyle('I9')->applyFromArray($style_col);
		$sheet->getStyle('J9')->applyFromArray($style_col);
		$sheet->getStyle('K9')->applyFromArray($style_col);
		$sheet->getStyle('L9')->applyFromArray($style_col);
		$sheet->getStyle('M9')->applyFromArray($style_col);
		$sheet->getStyle('N9')->applyFromArray($style_col);
		$sheet->getStyle('O9')->applyFromArray($style_col);
		$sheet->getStyle('P9')->applyFromArray($style_col);
		$sheet->getStyle('Q9')->applyFromArray($style_col);
		$sheet->getStyle('R9')->applyFromArray($style_col);
		$sheet->getStyle('S9')->applyFromArray($style_col);
		$sheet->getStyle('T9')->applyFromArray($style_col);
		$sheet->getStyle('U9')->applyFromArray($style_col);
		$sheet->getStyle('V9')->applyFromArray($style_col);
		$sheet->getStyle('W9')->applyFromArray($style_col);
		$sheet->getStyle('X9')->applyFromArray($style_col);
		$sheet->getStyle('Y9')->applyFromArray($style_col);
		$sheet->getStyle('Z9')->applyFromArray($style_col);
		$sheet->getStyle('AA9')->applyFromArray($style_col);
		$sheet->getStyle('AB9')->applyFromArray($style_col);
		$sheet->getStyle('AC9')->applyFromArray($style_col);
		$sheet->getStyle('AD9')->applyFromArray($style_col);
		$sheet->getStyle('AE9')->applyFromArray($style_col);
		$sheet->getStyle('AF9')->applyFromArray($style_col);
		$sheet->getStyle('AG9')->applyFromArray($style_col);
		$sheet->getStyle('AH9')->applyFromArray($style_col);
		$sheet->getStyle('AI9')->applyFromArray($style_col);
		$sheet->getStyle('AJ9')->applyFromArray($style_col);
		$sheet->getStyle('AK9')->applyFromArray($style_col);
		$sheet->getStyle('AL9')->applyFromArray($style_col);
		$sheet->getStyle('AM9')->applyFromArray($style_col);
		$sheet->getStyle('AN9')->applyFromArray($style_col);
		$sheet->getStyle('AO9')->applyFromArray($style_col);
		$sheet->getStyle('AP9')->applyFromArray($style_col);
		$sheet->getStyle('AQ9')->applyFromArray($style_col);
		$sheet->getStyle('AR9')->applyFromArray($style_col);
		$sheet->getStyle('AS9')->applyFromArray($style_col);
		$sheet->getStyle('AT9')->applyFromArray($style_col);
		$sheet->getStyle('AU9')->applyFromArray($style_col);
		$sheet->getStyle('AV9')->applyFromArray($style_col);
		$sheet->getStyle('AW9')->applyFromArray($style_col);
		$sheet->getStyle('AX9')->applyFromArray($style_col);
		$sheet->getStyle('AY9')->applyFromArray($style_col);
		$sheet->getStyle('AZ9')->applyFromArray($style_col);
		$sheet->getStyle('BA9')->applyFromArray($style_col);
		$sheet->getStyle('BB9')->applyFromArray($style_col);
		$sheet->getStyle('BC9')->applyFromArray($style_col);
		$sheet->getStyle('BD9')->applyFromArray($style_col);
		$sheet->getStyle('BE9')->applyFromArray($style_col);
		$sheet->getStyle('BF9')->applyFromArray($style_col);
		$sheet->getStyle('BG9')->applyFromArray($style_col);
		$sheet->getStyle('BH9')->applyFromArray($style_col);
		$sheet->getStyle('BI9')->applyFromArray($style_col);
		$sheet->getStyle('BJ9')->applyFromArray($style_col);
		$sheet->getStyle('BK9')->applyFromArray($style_col);
		$sheet->getStyle('BL9')->applyFromArray($style_col);
		$sheet->getStyle('BM9')->applyFromArray($style_col);
		$sheet->getStyle('BN9')->applyFromArray($style_col);
		$sheet->getStyle('BO9')->applyFromArray($style_col);
		$sheet->getStyle('BP9')->applyFromArray($style_col);
		$sheet->getStyle('BQ9')->applyFromArray($style_col);
		$sheet->getStyle('BR9')->applyFromArray($style_col);
		$sheet->getStyle('BS9')->applyFromArray($style_col);
		$sheet->getStyle('BT9')->applyFromArray($style_col);
		$sheet->getStyle('BU9')->applyFromArray($style_col);
		$sheet->getStyle('BV9')->applyFromArray($style_col);
		$sheet->getStyle('BW9')->applyFromArray($style_col);
		$sheet->getStyle('BX9')->applyFromArray($style_col);
		$sheet->getStyle('BY9')->applyFromArray($style_col);
		$sheet->getStyle('BZ9')->applyFromArray($style_col);
		$sheet->getStyle('CA9')->applyFromArray($style_col);
		$sheet->getStyle('CB9')->applyFromArray($style_col);

		$sheet->getStyle('A7:BV9')->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');
		$sheet->getStyle('BW7:CB9')->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFA07A');//TOTAL

		// Set height baris ke 1 dan 2
		$sheet->getRowDimension('1')->setRowHeight(40);
		$sheet->getRowDimension('2')->setRowHeight(20);
		$sheet->getRowDimension('3')->setRowHeight(20);
		$sheet->getRowDimension('4')->setRowHeight(20);
		$sheet->getRowDimension('5')->setRowHeight(20);


		//$item_group = '';
        //$principal = '';

        $qty_jan = 0;
		$qty_feb = 0;
		$qty_mar = 0;
		$qty_apr = 0;
		$qty_mei = 0;
		$qty_jun = 0;
		$qty_jul = 0;
		$qty_agu = 0;
		$qty_sep = 0;
		$qty_okt = 0;
		$qty_nop = 0;
		$qty_des = 0;
		$qty_year = 0;

		$val_jan = 0;
		$val_feb = 0;
		$val_mar = 0;
		$val_apr = 0;
		$val_mei = 0;
		$val_jun = 0;
		$val_jul = 0;
		$val_agu = 0;
		$val_sep = 0;
		$val_okt = 0;
		$val_nop = 0;
		$val_des = 0;
		$val_year = 0;

		$target_qty_jan = 0;
		$target_qty_feb = 0;
		$target_qty_mar = 0;
		$target_qty_apr = 0;
		$target_qty_mei = 0;
		$target_qty_jun = 0;
		$target_qty_jul = 0;
		$target_qty_agu = 0;
		$target_qty_sep = 0;
		$target_qty_okt = 0;
		$target_qty_nop = 0;
		$target_qty_des = 0;
		$target_qty_year = 0;

		$target_val_jan = 0;
		$target_val_feb = 0;
		$target_val_mar = 0;
		$target_val_apr = 0;
		$target_val_mei = 0;
		$target_val_jun = 0;
		$target_val_jul = 0;
		$target_val_agu = 0;
		$target_val_sep = 0;
		$target_val_okt = 0;
		$target_val_nop = 0;
		$target_val_des = 0;
		$target_val_year = 0;

		$idx_qty_jan = 0;
		$idx_qty_feb = 0;
		$idx_qty_mar = 0;
		$idx_qty_apr = 0;
		$idx_qty_mei = 0;
		$idx_qty_jun = 0;
		$idx_qty_jul = 0;
		$idx_qty_agu = 0;
		$idx_qty_sep = 0;
		$idx_qty_okt = 0;
		$idx_qty_nop = 0;
		$idx_qty_des = 0;
		$idx_qty_year = 0;

		$idx_val_jan = 0;
		$idx_val_feb = 0;
		$idx_val_mar = 0;
		$idx_val_apr = 0;
		$idx_val_mei = 0;
		$idx_val_jun = 0;
		$idx_val_jul = 0;
		$idx_val_agu = 0;
		$idx_val_sep = 0;
		$idx_val_okt = 0;
		$idx_val_nop = 0;
		$idx_val_des = 0;
		$idx_val_year = 0;

		$total_qty_jan = 0;
		$total_qty_feb = 0;
		$total_qty_mar = 0;
		$total_qty_apr = 0;
		$total_qty_mei = 0;
		$total_qty_jun = 0;
		$total_qty_jul = 0;
		$total_qty_agu = 0;
		$total_qty_sep = 0;
		$total_qty_okt = 0;
		$total_qty_nop = 0;
		$total_qty_des = 0;
		$total_qty_year = 0;

		$total_val_jan = 0;
		$total_val_feb = 0;
		$total_val_mar = 0;
		$total_val_apr = 0;
		$total_val_mei = 0;
		$total_val_jun = 0;
		$total_val_jul = 0;
		$total_val_agu = 0;
		$total_val_sep = 0;
		$total_val_okt = 0;
		$total_val_nop = 0;
		$total_val_des = 0;
		$total_val_year = 0;

		$total_target_qty_jan = 0;
		$total_target_qty_feb = 0;
		$total_target_qty_mar = 0;
		$total_target_qty_apr = 0;
		$total_target_qty_mei = 0;
		$total_target_qty_jun = 0;
		$total_target_qty_jul = 0;
		$total_target_qty_agu = 0;
		$total_target_qty_sep = 0;
		$total_target_qty_okt = 0;
		$total_target_qty_nop = 0;
		$total_target_qty_des = 0;
		$total_target_qty_year = 0;

		$total_target_val_jan = 0;
		$total_target_val_feb = 0;
		$total_target_val_mar = 0;
		$total_target_val_apr = 0;
		$total_target_val_mei = 0;
		$total_target_val_jun = 0;
		$total_target_val_jul = 0;
		$total_target_val_agu = 0;
		$total_target_val_sep = 0;
		$total_target_val_okt = 0;
		$total_target_val_nop = 0;
		$total_target_val_des = 0;
		$total_target_val_year = 0;

		$total_idx_qty_jan = 0;
		$total_idx_qty_feb = 0;
		$total_idx_qty_mar = 0;
		$total_idx_qty_apr = 0;
		$total_idx_qty_mei = 0;
		$total_idx_qty_jun = 0;
		$total_idx_qty_jul = 0;
		$total_idx_qty_agu = 0;
		$total_idx_qty_sep = 0;
		$total_idx_qty_okt = 0;
		$total_idx_qty_nop = 0;
		$total_idx_qty_des = 0;
		$total_idx_qty_year = 0;

		$total_idx_val_jan = 0;
		$total_idx_val_feb = 0;
		$total_idx_val_mar = 0;
		$total_idx_val_apr = 0;
		$total_idx_val_mei = 0;
		$total_idx_val_jun = 0;
		$total_idx_val_jul = 0;
		$total_idx_val_agu = 0;
		$total_idx_val_sep = 0;
		$total_idx_val_okt = 0;
		$total_idx_val_nop = 0;
		$total_idx_val_des = 0;
		$total_idx_val_year = 0;


		$no = 1; // Untuk penomoran tabel, di awal set dengan 1
		$row = 10;

		// $data1 = array(
		// 	'island' => $island,
		// 	'region' => $region,
		// 	'area' => $area,
		// 	'principal' => $principal,
		// 	'year' => $year
		// );

		$data['so_salesman_year'] = $this->model('ReportModel')->getSellingOut_Salesman_Year2();

		foreach ($data['so_salesman_year'] as $rows) :

			$sheet->setCellValue('A' . $row, $no);
    		$sheet->setCellValue('B' . $row, $rows['salesman']);

			$sheet->setCellValue('C' . $row, number_format($rows['qty_jan'], 0));
			$sheet->setCellValue('D' . $row, number_format($rows['value_jan'], 2));
			$sheet->setCellValue('E' . $row, number_format($rows['target_qty_jan'], 0));
			$sheet->setCellValue('F' . $row, number_format($rows['target_value_jan'], 2));
			$sheet->setCellValue('G' . $row, number_format($rows['idx_qty_jan'], 0));
			$sheet->setCellValue('H' . $row, number_format($rows['idx_value_jan'], 0));
			$sheet->setCellValue('I' . $row, number_format($rows['qty_feb'], 0));
			$sheet->setCellValue('J' . $row, number_format($rows['value_feb'], 2));
			$sheet->setCellValue('K' . $row, number_format($rows['target_qty_feb'], 0));
			$sheet->setCellValue('L' . $row, number_format($rows['target_value_feb'], 2));
			$sheet->setCellValue('M' . $row, number_format($rows['idx_qty_feb'], 0));
			$sheet->setCellValue('N' . $row, number_format($rows['idx_value_feb'], 0));
			$sheet->setCellValue('O' . $row, number_format($rows['qty_mar'], 0));
			$sheet->setCellValue('P' . $row, number_format($rows['value_mar'], 2));
			$sheet->setCellValue('Q' . $row, number_format($rows['target_qty_mar'], 0));
			$sheet->setCellValue('R' . $row, number_format($rows['target_value_mar'], 2));
			$sheet->setCellValue('S' . $row, number_format($rows['idx_qty_mar'], 0));
			$sheet->setCellValue('T' . $row, number_format($rows['idx_value_mar'], 0));
			$sheet->setCellValue('U' . $row, number_format($rows['qty_apr'], 0));
			$sheet->setCellValue('V' . $row, number_format($rows['value_apr'], 2));
			$sheet->setCellValue('W' . $row, number_format($rows['target_qty_apr'], 0));
			$sheet->setCellValue('X' . $row, number_format($rows['target_value_apr'], 2));
			$sheet->setCellValue('Y' . $row, number_format($rows['idx_qty_apr'], 0));
			$sheet->setCellValue('Z' . $row, number_format($rows['idx_value_apr'], 0));
			$sheet->setCellValue('AA' . $row, number_format($rows['qty_mei'], 0));
			$sheet->setCellValue('AB' . $row, number_format($rows['value_mei'], 2));
			$sheet->setCellValue('AC' . $row, number_format($rows['target_qty_mei'], 0));
			$sheet->setCellValue('AD' . $row, number_format($rows['target_value_mei'], 2));
			$sheet->setCellValue('AE' . $row, number_format($rows['idx_qty_mei'], 0));
			$sheet->setCellValue('AF' . $row, number_format($rows['idx_value_mei'], 0));
			$sheet->setCellValue('AG' . $row, number_format($rows['qty_jun'], 0));
			$sheet->setCellValue('AH' . $row, number_format($rows['value_jun'], 2));
			$sheet->setCellValue('AI' . $row, number_format($rows['target_qty_jun'], 0));
			$sheet->setCellValue('AJ' . $row, number_format($rows['target_value_jun'], 2));
			$sheet->setCellValue('AK' . $row, number_format($rows['idx_qty_jun'], 0));
			$sheet->setCellValue('AL' . $row, number_format($rows['idx_value_jun'], 0));
			$sheet->setCellValue('AM' . $row, number_format($rows['qty_jul'], 0));
			$sheet->setCellValue('AN' . $row, number_format($rows['value_jul'], 2));
			$sheet->setCellValue('AO' . $row, number_format($rows['target_qty_jul'], 0));
			$sheet->setCellValue('AP' . $row, number_format($rows['target_value_jul'], 2));
			$sheet->setCellValue('AQ' . $row, number_format($rows['idx_qty_jul'], 0));
			$sheet->setCellValue('AR' . $row, number_format($rows['idx_value_jul'], 0));
			$sheet->setCellValue('AS' . $row, number_format($rows['qty_agu'], 0));
			$sheet->setCellValue('AT' . $row, number_format($rows['value_agu'], 2));
			$sheet->setCellValue('AU' . $row, number_format($rows['target_qty_agu'], 0));
			$sheet->setCellValue('AV' . $row, number_format($rows['target_value_agu'], 2));
			$sheet->setCellValue('AW' . $row, number_format($rows['idx_qty_agu'], 0));
			$sheet->setCellValue('AX' . $row, number_format($rows['idx_value_agu'], 0));
			$sheet->setCellValue('AY' . $row, number_format($rows['qty_sep'], 0));
			$sheet->setCellValue('AZ' . $row, number_format($rows['value_sep'], 2));
			$sheet->setCellValue('BA' . $row, number_format($rows['target_qty_sep'], 0));
			$sheet->setCellValue('BB' . $row, number_format($rows['target_value_sep'], 2));
			$sheet->setCellValue('BC' . $row, number_format($rows['idx_qty_sep'], 0));
			$sheet->setCellValue('BD' . $row, number_format($rows['idx_value_sep'], 0));
			$sheet->setCellValue('BE' . $row, number_format($rows['qty_okt'], 0));
			$sheet->setCellValue('BF' . $row, number_format($rows['value_okt'], 2));
			$sheet->setCellValue('BG' . $row, number_format($rows['target_qty_okt'], 0));
			$sheet->setCellValue('BH' . $row, number_format($rows['target_value_okt'], 2));
			$sheet->setCellValue('BI' . $row, number_format($rows['idx_qty_okt'], 0));
			$sheet->setCellValue('BJ' . $row, number_format($rows['idx_value_okt'], 0));
			$sheet->setCellValue('BK' . $row, number_format($rows['qty_nop'], 0));
			$sheet->setCellValue('BL' . $row, number_format($rows['value_nop'], 2));
			$sheet->setCellValue('BM' . $row, number_format($rows['target_qty_nop'], 0));
			$sheet->setCellValue('BN' . $row, number_format($rows['target_value_nop'], 2));
			$sheet->setCellValue('BO' . $row, number_format($rows['idx_qty_nop'], 0));
			$sheet->setCellValue('BP' . $row, number_format($rows['idx_value_nop'], 0));
			$sheet->setCellValue('BQ' . $row, number_format($rows['qty_des'], 0));
			$sheet->setCellValue('BR' . $row, number_format($rows['value_des'], 2));
			$sheet->setCellValue('BS' . $row, number_format($rows['target_qty_des'], 0));
			$sheet->setCellValue('BT' . $row, number_format($rows['target_value_des'], 2));
			$sheet->setCellValue('BU' . $row, number_format($rows['idx_qty_des'], 0));
			$sheet->setCellValue('BV' . $row, number_format($rows['idx_value_des'], 0));

			$qty_year = $rows['qty_jan'] + $rows['qty_feb'] + $rows['qty_mar'] + $rows['qty_apr'] + $rows['qty_mei'] + $rows['qty_jun'] + $rows['qty_jul'] + $rows['qty_agu'] + $rows['qty_sep'] + $rows['qty_okt'] + $rows['qty_nop'] + $rows['qty_des'];
			$target_qty_year = $rows['target_qty_jan'] + $rows['target_qty_feb'] + $rows['target_qty_mar'] + $rows['target_qty_apr'] + $rows['target_qty_mei'] + $rows['target_qty_jun'] + $rows['target_qty_jul'] + $rows['target_qty_agu'] + $rows['target_qty_sep'] + $rows['target_qty_okt'] + $rows['target_qty_nop'] + $rows['target_qty_des'];
			$idx_qty_year = ($qty_year/($target_qty_year ?: 1))*100;
			$val_year = $rows['value_jan'] + $rows['value_feb'] + $rows['value_mar'] + $rows['value_apr'] + $rows['value_mei'] + $rows['value_jun'] + $rows['value_jul'] + $rows['value_agu'] + $rows['value_sep'] + $rows['value_okt'] + $rows['value_nop'] + $rows['value_des'];
			$target_val_year = $rows['target_value_jan'] + $rows['target_value_feb'] + $rows['target_value_mar'] + $rows['target_value_apr'] + $rows['target_value_mei'] + $rows['target_value_jun'] + $rows['target_value_jul'] + $rows['target_value_agu'] + $rows['target_value_sep'] + $rows['target_value_okt'] + $rows['target_value_nop'] + $rows['target_value_des'];
			$idx_val_year = ($val_year/($target_val_year ?: 1))*100;
			// $qty_avg = $qty_year / 12;
			// $target_qty_avg = $target_qty_year / 12;
			// $idx_qty_avg = ($qty_avg/($target_qty_avg ?: 1))*100;
			// $val_avg = $val_year / 12;
			// $target_val_avg = $target_val_year / 12;
			// $idx_val_avg = ($val_avg/($target_val_avg ?: 1))*100;

			$sheet->setCellValue('BW' . $row, number_format($qty_year, 0));
			$sheet->setCellValue('BX' . $row, number_format($val_year, 2));
			$sheet->setCellValue('BY' . $row, number_format($target_qty_year, 0));
			$sheet->setCellValue('BZ' . $row, number_format($target_val_year, 2));
			$sheet->setCellValue('CA' . $row, number_format($idx_qty_year, 0));
			$sheet->setCellValue('CB' . $row, number_format($idx_val_year, 0));

			// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
			$sheet->getStyle('A' . $row)->applyFromArray($style_row);
			$sheet->getStyle('B' . $row)->applyFromArray($style_row);
			$sheet->getStyle('C' . $row)->applyFromArray($style_row);
			$sheet->getStyle('D' . $row)->applyFromArray($style_row);
			$sheet->getStyle('E' . $row)->applyFromArray($style_row);
			$sheet->getStyle('F' . $row)->applyFromArray($style_row);
			$sheet->getStyle('G' . $row)->applyFromArray($style_row);
			$sheet->getStyle('H' . $row)->applyFromArray($style_row);
			$sheet->getStyle('I' . $row)->applyFromArray($style_row);
			$sheet->getStyle('J' . $row)->applyFromArray($style_row);
			$sheet->getStyle('K' . $row)->applyFromArray($style_row);
			$sheet->getStyle('L' . $row)->applyFromArray($style_row);
			$sheet->getStyle('M' . $row)->applyFromArray($style_row);
			$sheet->getStyle('N' . $row)->applyFromArray($style_row);
			$sheet->getStyle('O' . $row)->applyFromArray($style_row);
			$sheet->getStyle('P' . $row)->applyFromArray($style_row);
			$sheet->getStyle('Q' . $row)->applyFromArray($style_row);
			$sheet->getStyle('R' . $row)->applyFromArray($style_row);
			$sheet->getStyle('S' . $row)->applyFromArray($style_row);
			$sheet->getStyle('T' . $row)->applyFromArray($style_row);
			$sheet->getStyle('U' . $row)->applyFromArray($style_row);
			$sheet->getStyle('V' . $row)->applyFromArray($style_row);
			$sheet->getStyle('W' . $row)->applyFromArray($style_row);
			$sheet->getStyle('X' . $row)->applyFromArray($style_row);
			$sheet->getStyle('Y' . $row)->applyFromArray($style_row);
			$sheet->getStyle('Z' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AA' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AB' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AC' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AD' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AE' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AF' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AG' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AH' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AI' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AJ' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AK' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AL' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AM' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AN' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AO' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AP' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AQ' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AR' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AS' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AT' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AU' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AV' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AW' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AX' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AY' . $row)->applyFromArray($style_row);
			$sheet->getStyle('AZ' . $row)->applyFromArray($style_row);
			$sheet->getStyle('BA' . $row)->applyFromArray($style_row);
			$sheet->getStyle('BB' . $row)->applyFromArray($style_row);
			$sheet->getStyle('BC' . $row)->applyFromArray($style_row);
			$sheet->getStyle('BD' . $row)->applyFromArray($style_row);
			$sheet->getStyle('BE' . $row)->applyFromArray($style_row);
			$sheet->getStyle('BF' . $row)->applyFromArray($style_row);
			$sheet->getStyle('BG' . $row)->applyFromArray($style_row);
			$sheet->getStyle('BH' . $row)->applyFromArray($style_row);
			$sheet->getStyle('BI' . $row)->applyFromArray($style_row);
			$sheet->getStyle('BJ' . $row)->applyFromArray($style_row);
			$sheet->getStyle('BK' . $row)->applyFromArray($style_row);
			$sheet->getStyle('BL' . $row)->applyFromArray($style_row);
			$sheet->getStyle('BM' . $row)->applyFromArray($style_row);
			$sheet->getStyle('BN' . $row)->applyFromArray($style_row);
			$sheet->getStyle('BO' . $row)->applyFromArray($style_row);
			$sheet->getStyle('BP' . $row)->applyFromArray($style_row);
			$sheet->getStyle('BQ' . $row)->applyFromArray($style_row);
			$sheet->getStyle('BR' . $row)->applyFromArray($style_row);
			$sheet->getStyle('BS' . $row)->applyFromArray($style_row);
			$sheet->getStyle('BT' . $row)->applyFromArray($style_row);
			$sheet->getStyle('BU' . $row)->applyFromArray($style_row);
			$sheet->getStyle('BV' . $row)->applyFromArray($style_row);
			$sheet->getStyle('BW' . $row)->applyFromArray($style_row);
			$sheet->getStyle('BX' . $row)->applyFromArray($style_row);
			$sheet->getStyle('BY' . $row)->applyFromArray($style_row);
			$sheet->getStyle('BZ' . $row)->applyFromArray($style_row);
			$sheet->getStyle('CA' . $row)->applyFromArray($style_row);
			$sheet->getStyle('CB' . $row)->applyFromArray($style_row);

			$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('I' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('J' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('K' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('L' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('M' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('N' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('O' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('P' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('Q' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('R' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('S' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('T' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('U' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('V' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('W' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('X' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('Y' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('Z' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AA' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AB' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AC' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AD' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AE' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AF' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AG' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AH' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AI' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AJ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AK' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AL' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AM' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AN' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AO' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AP' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AQ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AR' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AS' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AT' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AU' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AV' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AX' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AY' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('AZ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('BA' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('BB' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('BC' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('BD' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('BE' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('BF' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('BG' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('BH' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('BI' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('BJ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('BK' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('BL' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('BM' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('BN' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('BO' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('BQ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('BR' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('BS' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('BT' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('BU' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('BV' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('BW' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('BX' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('BY' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('BZ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('CA' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyle('CB' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

			$qty_jan += $rows['qty_jan'];
			$qty_feb += $rows['qty_feb'];
			$qty_mar += $rows['qty_mar'];
			$qty_apr += $rows['qty_apr'];
			$qty_mei += $rows['qty_mei'];
			$qty_jun += $rows['qty_jun'];
			$qty_jul += $rows['qty_jul'];
			$qty_agu += $rows['qty_agu'];
			$qty_sep += $rows['qty_sep'];
			$qty_okt += $rows['qty_okt'];
			$qty_nop += $rows['qty_nop'];
			$qty_des += $rows['qty_des'];

			$val_jan += $rows['value_jan'];
			$val_feb += $rows['value_feb'];
			$val_mar += $rows['value_mar'];
			$val_apr += $rows['value_apr'];
			$val_mei += $rows['value_mei'];
			$val_jun += $rows['value_jun'];
			$val_jul += $rows['value_jul'];
			$val_agu += $rows['value_agu'];
			$val_sep += $rows['value_sep'];
			$val_okt += $rows['value_okt'];
			$val_nop += $rows['value_nop'];
			$val_des += $rows['value_des'];

			$target_qty_jan += $rows['target_qty_jan'];
			$target_qty_feb += $rows['target_qty_feb'];
			$target_qty_mar += $rows['target_qty_mar'];
			$target_qty_apr += $rows['target_qty_apr'];
			$target_qty_mei += $rows['target_qty_mei'];
			$target_qty_jun += $rows['target_qty_jun'];
			$target_qty_jul += $rows['target_qty_jul'];
			$target_qty_agu += $rows['target_qty_agu'];
			$target_qty_sep += $rows['target_qty_sep'];
			$target_qty_okt += $rows['target_qty_okt'];
			$target_qty_nop += $rows['target_qty_nop'];
			$target_qty_des += $rows['target_qty_des'];

			$target_val_jan += $rows['target_value_jan'];
			$target_val_feb += $rows['target_value_feb'];
			$target_val_mar += $rows['target_value_mar'];
			$target_val_apr += $rows['target_value_apr'];
			$target_val_mei += $rows['target_value_mei'];
			$target_val_jun += $rows['target_value_jun'];
			$target_val_jul += $rows['target_value_jul'];
			$target_val_agu += $rows['target_value_agu'];
			$target_val_sep += $rows['target_value_sep'];
			$target_val_okt += $rows['target_value_okt'];
			$target_val_nop += $rows['target_value_nop'];
			$target_val_des += $rows['target_value_des'];

			$idx_qty_jan = ($qty_jan/($target_qty_jan ?: 1))*100;
			$idx_qty_feb = ($qty_feb/($target_qty_feb ?: 1))*100;
			$idx_qty_mar = ($qty_mar/($target_qty_mar ?: 1))*100;
			$idx_qty_apr = ($qty_apr/($target_qty_apr ?: 1))*100;
			$idx_qty_mei = ($qty_mei/($target_qty_mei ?: 1))*100;
			$idx_qty_jun = ($qty_jun/($target_qty_jun ?: 1))*100;
			$idx_qty_jul = ($qty_jul/($target_qty_jul ?: 1))*100;
			$idx_qty_agu = ($qty_agu/($target_qty_agu ?: 1))*100;
			$idx_qty_sep = ($qty_sep/($target_qty_sep ?: 1))*100;
			$idx_qty_okt = ($qty_okt/($target_qty_okt ?: 1))*100;
			$idx_qty_nop = ($qty_nop/($target_qty_nop ?: 1))*100;
			$idx_qty_des = ($qty_des/($target_qty_des ?: 1))*100;

			$idx_val_jan = ($val_jan/($target_val_jan ?: 1))*100;
			$idx_val_feb = ($val_feb/($target_val_feb ?: 1))*100;
			$idx_val_mar = ($val_mar/($target_val_mar ?: 1))*100;
			$idx_val_apr = ($val_apr/($target_val_apr ?: 1))*100;
			$idx_val_mei = ($val_mei/($target_val_mei ?: 1))*100;
			$idx_val_jun = ($val_jun/($target_val_jun ?: 1))*100;
			$idx_val_jul = ($val_jul/($target_val_jul ?: 1))*100;
			$idx_val_agu = ($val_agu/($target_val_agu ?: 1))*100;
			$idx_val_sep = ($val_sep/($target_val_sep ?: 1))*100;
			$idx_val_okt = ($val_okt/($target_val_okt ?: 1))*100;
			$idx_val_nop = ($val_nop/($target_val_nop ?: 1))*100;
			$idx_val_des = ($val_des/($target_val_des ?: 1))*100;

			$total_qty_jan += $rows['qty_jan'];
			$total_qty_feb += $rows['qty_feb'];
			$total_qty_mar += $rows['qty_mar'];
			$total_qty_apr += $rows['qty_apr'];
			$total_qty_mei += $rows['qty_mei'];
			$total_qty_jun += $rows['qty_jun'];
			$total_qty_jul += $rows['qty_jul'];
			$total_qty_agu += $rows['qty_agu'];
			$total_qty_sep += $rows['qty_sep'];
			$total_qty_okt += $rows['qty_okt'];
			$total_qty_nop += $rows['qty_nop'];
			$total_qty_des += $rows['qty_des'];
	
			$total_val_jan += $rows['value_jan'];
			$total_val_feb += $rows['value_feb'];
			$total_val_mar += $rows['value_mar'];
			$total_val_apr += $rows['value_apr'];
			$total_val_mei += $rows['value_mei'];
			$total_val_jun += $rows['value_jun'];
			$total_val_jul += $rows['value_jul'];
			$total_val_agu += $rows['value_agu'];
			$total_val_sep += $rows['value_sep'];
			$total_val_okt += $rows['value_okt'];
			$total_val_nop += $rows['value_nop'];
			$total_val_des += $rows['value_des'];

			$total_target_qty_jan += $rows['target_qty_jan'];
			$total_target_qty_feb += $rows['target_qty_feb'];
			$total_target_qty_mar += $rows['target_qty_mar'];
			$total_target_qty_apr += $rows['target_qty_apr'];
			$total_target_qty_mei += $rows['target_qty_mei'];
			$total_target_qty_jun += $rows['target_qty_jun'];
			$total_target_qty_jul += $rows['target_qty_jul'];
			$total_target_qty_agu += $rows['target_qty_agu'];
			$total_target_qty_sep += $rows['target_qty_sep'];
			$total_target_qty_okt += $rows['target_qty_okt'];
			$total_target_qty_nop += $rows['target_qty_nop'];
			$total_target_qty_des += $rows['target_qty_des'];

			$total_target_val_jan += $rows['target_value_jan'];
			$total_target_val_feb += $rows['target_value_feb'];
			$total_target_val_mar += $rows['target_value_mar'];
			$total_target_val_apr += $rows['target_value_apr'];
			$total_target_val_mei += $rows['target_value_mei'];
			$total_target_val_jun += $rows['target_value_jun'];
			$total_target_val_jul += $rows['target_value_jul'];
			$total_target_val_agu += $rows['target_value_agu'];
			$total_target_val_sep += $rows['target_value_sep'];
			$total_target_val_okt += $rows['target_value_okt'];
			$total_target_val_nop += $rows['target_value_nop'];
			$total_target_val_des += $rows['target_value_des'];

			$total_idx_qty_jan = ($total_qty_jan/($total_target_qty_jan ?: 1))*100;
			$total_idx_qty_feb = ($total_qty_feb/($total_target_qty_feb ?: 1))*100;
			$total_idx_qty_mar = ($total_qty_mar/($total_target_qty_mar ?: 1))*100;
			$total_idx_qty_apr = ($total_qty_apr/($total_target_qty_apr ?: 1))*100;
			$total_idx_qty_mei = ($total_qty_mei/($total_target_qty_mei ?: 1))*100;
			$total_idx_qty_jun = ($total_qty_jun/($total_target_qty_jun ?: 1))*100;
			$total_idx_qty_jul = ($total_qty_jul/($total_target_qty_jul ?: 1))*100;
			$total_idx_qty_agu = ($total_qty_agu/($total_target_qty_agu ?: 1))*100;
			$total_idx_qty_sep = ($total_qty_sep/($total_target_qty_sep ?: 1))*100;
			$total_idx_qty_okt = ($total_qty_okt/($total_target_qty_okt ?: 1))*100;
			$total_idx_qty_nop = ($total_qty_nop/($total_target_qty_nop ?: 1))*100;
			$total_idx_qty_des = ($total_qty_des/($total_target_qty_des ?: 1))*100;
	
			$total_idx_val_jan = ($total_val_jan/($total_target_val_jan ?: 1))*100;
			$total_idx_val_feb = ($total_val_feb/($total_target_val_feb ?: 1))*100;
			$total_idx_val_mar = ($total_val_mar/($total_target_val_mar ?: 1))*100;
			$total_idx_val_apr = ($total_val_apr/($total_target_val_apr ?: 1))*100;
			$total_idx_val_mei = ($total_val_mei/($total_target_val_mei ?: 1))*100;
			$total_idx_val_jun = ($total_val_jun/($total_target_val_jun ?: 1))*100;
			$total_idx_val_jul = ($total_val_jul/($total_target_val_jul ?: 1))*100;
			$total_idx_val_agu = ($total_val_agu/($total_target_val_agu ?: 1))*100;
			$total_idx_val_sep = ($total_val_sep/($total_target_val_sep ?: 1))*100;
			$total_idx_val_okt = ($total_val_okt/($total_target_val_okt ?: 1))*100;
			$total_idx_val_nop = ($total_val_nop/($total_target_val_nop ?: 1))*100;
			$total_idx_val_des = ($total_val_des/($total_target_val_des ?: 1))*100;

			$no++; // Tambah 1 setiap kali looping
    		$row++; // Tambah 1 setiap kali looping
		endforeach;

		//grand total
		//$row = $row + 1;
		$sheet->setCellValue('A' . $row, '');
		$sheet->setCellValue('B' . $row, 'TOTAL');
		$sheet->setCellValue('C' . $row, number_format($total_qty_jan, 0));
		$sheet->setCellValue('D' . $row, number_format($total_val_jan, 2));
		$sheet->setCellValue('E' . $row, number_format($total_target_qty_jan, 0));
		$sheet->setCellValue('F' . $row, number_format($total_target_val_jan, 2));
		$sheet->setCellValue('G' . $row, number_format($total_idx_qty_jan, 0));
		$sheet->setCellValue('H' . $row, number_format($total_idx_val_jan, 0));
		$sheet->setCellValue('I' . $row, number_format($total_qty_feb, 0));
		$sheet->setCellValue('J' . $row, number_format($total_val_feb, 2));
		$sheet->setCellValue('K' . $row, number_format($total_target_qty_feb, 0));
		$sheet->setCellValue('L' . $row, number_format($total_target_val_feb, 2));
		$sheet->setCellValue('M' . $row, number_format($total_idx_qty_feb, 0));
		$sheet->setCellValue('N' . $row, number_format($total_idx_val_feb, 0));
		$sheet->setCellValue('O' . $row, number_format($total_qty_mar, 0));
		$sheet->setCellValue('P' . $row, number_format($total_val_mar, 2));
		$sheet->setCellValue('Q' . $row, number_format($total_target_qty_mar, 0));
		$sheet->setCellValue('R' . $row, number_format($total_target_val_mar, 2));
		$sheet->setCellValue('S' . $row, number_format($total_idx_qty_mar, 0));
		$sheet->setCellValue('T' . $row, number_format($total_idx_val_mar, 0));
		$sheet->setCellValue('U' . $row, number_format($total_qty_apr, 0));
		$sheet->setCellValue('V' . $row, number_format($total_val_apr, 2));
		$sheet->setCellValue('W' . $row, number_format($total_target_qty_apr, 0));
		$sheet->setCellValue('X' . $row, number_format($total_target_val_apr, 2));
		$sheet->setCellValue('Y' . $row, number_format($total_idx_qty_apr, 0));
		$sheet->setCellValue('Z' . $row, number_format($total_idx_val_apr, 0));
		$sheet->setCellValue('AA' . $row, number_format($total_qty_mei, 0));
		$sheet->setCellValue('AB' . $row, number_format($total_val_mei, 2));
		$sheet->setCellValue('AC' . $row, number_format($total_target_qty_mei, 0));
		$sheet->setCellValue('AD' . $row, number_format($total_target_val_mei, 2));
		$sheet->setCellValue('AE' . $row, number_format($total_idx_qty_mei, 0));
		$sheet->setCellValue('AF' . $row, number_format($total_idx_val_mei, 0));
		$sheet->setCellValue('AG' . $row, number_format($total_qty_jun, 0));
		$sheet->setCellValue('AH' . $row, number_format($total_val_jun, 2));
		$sheet->setCellValue('AI' . $row, number_format($total_target_qty_jun, 0));
		$sheet->setCellValue('AJ' . $row, number_format($total_target_val_jun, 2));
		$sheet->setCellValue('AK' . $row, number_format($total_idx_qty_jun, 0));
		$sheet->setCellValue('AL' . $row, number_format($total_idx_val_jun, 0));
		$sheet->setCellValue('AM' . $row, number_format($total_qty_jul, 0));
		$sheet->setCellValue('AN' . $row, number_format($total_val_jul, 2));
		$sheet->setCellValue('AO' . $row, number_format($total_target_qty_jul, 0));
		$sheet->setCellValue('AP' . $row, number_format($total_target_val_jul, 2));
		$sheet->setCellValue('AQ' . $row, number_format($total_idx_qty_jul, 0));
		$sheet->setCellValue('AR' . $row, number_format($total_idx_val_jul, 0));
		$sheet->setCellValue('AS' . $row, number_format($total_qty_agu, 0));
		$sheet->setCellValue('AT' . $row, number_format($total_val_agu, 2));
		$sheet->setCellValue('AU' . $row, number_format($total_target_qty_agu, 0));
		$sheet->setCellValue('AV' . $row, number_format($total_target_val_agu, 2));
		$sheet->setCellValue('AW' . $row, number_format($total_idx_qty_agu, 0));
		$sheet->setCellValue('AX' . $row, number_format($total_idx_val_agu, 0));
		$sheet->setCellValue('AY' . $row, number_format($total_qty_sep, 0));
		$sheet->setCellValue('AZ' . $row, number_format($total_val_sep, 2));
		$sheet->setCellValue('BA' . $row, number_format($total_target_qty_sep, 0));
		$sheet->setCellValue('BB' . $row, number_format($total_target_val_sep, 2));
		$sheet->setCellValue('BC' . $row, number_format($total_idx_qty_sep, 0));
		$sheet->setCellValue('BD' . $row, number_format($total_idx_val_sep, 0));
		$sheet->setCellValue('BE' . $row, number_format($total_qty_okt, 0));
		$sheet->setCellValue('BF' . $row, number_format($total_val_okt, 2));
		$sheet->setCellValue('BG' . $row, number_format($total_target_qty_okt, 0));
		$sheet->setCellValue('BH' . $row, number_format($total_target_val_okt, 2));
		$sheet->setCellValue('BI' . $row, number_format($total_idx_qty_okt, 0));
		$sheet->setCellValue('BJ' . $row, number_format($total_idx_val_okt, 0));
		$sheet->setCellValue('BK' . $row, number_format($total_qty_nop, 0));
		$sheet->setCellValue('BL' . $row, number_format($total_val_nop, 2));
		$sheet->setCellValue('BM' . $row, number_format($total_target_qty_nop, 0));
		$sheet->setCellValue('BN' . $row, number_format($total_target_val_nop, 2));
		$sheet->setCellValue('BO' . $row, number_format($total_idx_qty_nop, 0));
		$sheet->setCellValue('BP' . $row, number_format($total_idx_val_nop, 0));
		$sheet->setCellValue('BQ' . $row, number_format($total_qty_des, 0));
		$sheet->setCellValue('BR' . $row, number_format($total_val_des, 2));
		$sheet->setCellValue('BS' . $row, number_format($total_target_qty_des, 0));
		$sheet->setCellValue('BT' . $row, number_format($total_target_val_des, 2));
		$sheet->setCellValue('BU' . $row, number_format($total_idx_qty_des, 0));
		$sheet->setCellValue('BV' . $row, number_format($total_idx_val_des, 0));

		$total_qty_year = $total_qty_jan + $total_qty_feb + $total_qty_mar + $total_qty_apr + $total_qty_mei + $total_qty_jun + $total_qty_jul + $total_qty_agu + $total_qty_sep + $total_qty_okt + $total_qty_nop + $total_qty_des;
		$total_target_qty_year = $total_target_qty_jan + $total_target_qty_feb + $total_target_qty_mar + $total_target_qty_apr + $total_target_qty_mei + $total_target_qty_jun + $total_target_qty_jul + $total_target_qty_agu + $total_target_qty_sep + $total_target_qty_okt + $total_target_qty_nop + $total_target_qty_des;
		$total_idx_qty_year = ($total_qty_year/($total_target_qty_year ?: 1))*100;
		$total_val_year = $total_val_jan + $total_val_feb + $total_val_mar + $total_val_apr + $total_val_mei + $total_val_jun + $total_val_jul + $total_val_agu + $total_val_sep + $total_val_okt + $total_val_nop + $total_val_des;
		$total_target_val_year = $total_target_val_jan + $total_target_val_feb + $total_target_val_mar + $total_target_val_apr + $total_target_val_mei + $total_target_val_jun + $total_target_val_jul + $total_target_val_agu + $total_target_val_sep + $total_target_val_okt + $total_target_val_nop + $total_target_val_des;
		$total_idx_val_year = ($total_val_year/($total_target_val_year ?: 1))*100;

		$sheet->setCellValue('BW' . $row, number_format($total_qty_year, 0));
		$sheet->setCellValue('BX' . $row, number_format($total_val_year, 2));
		$sheet->setCellValue('BY' . $row, number_format($total_target_qty_year, 0));
		$sheet->setCellValue('BZ' . $row, number_format($total_target_val_year, 2));
		$sheet->setCellValue('CA' . $row, number_format($total_idx_qty_year, 0));
		$sheet->setCellValue('CB' . $row, number_format($total_idx_val_year, 0));

		// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
		$sheet->getStyle('A' . $row)->applyFromArray($style_row);
		$sheet->getStyle('B' . $row)->applyFromArray($style_row);
		$sheet->getStyle('C' . $row)->applyFromArray($style_row);
		$sheet->getStyle('D' . $row)->applyFromArray($style_row);
		$sheet->getStyle('E' . $row)->applyFromArray($style_row);
		$sheet->getStyle('F' . $row)->applyFromArray($style_row);
		$sheet->getStyle('G' . $row)->applyFromArray($style_row);
		$sheet->getStyle('H' . $row)->applyFromArray($style_row);
		$sheet->getStyle('I' . $row)->applyFromArray($style_row);
		$sheet->getStyle('J' . $row)->applyFromArray($style_row);
		$sheet->getStyle('K' . $row)->applyFromArray($style_row);
		$sheet->getStyle('L' . $row)->applyFromArray($style_row);
		$sheet->getStyle('M' . $row)->applyFromArray($style_row);
		$sheet->getStyle('N' . $row)->applyFromArray($style_row);
		$sheet->getStyle('O' . $row)->applyFromArray($style_row);
		$sheet->getStyle('P' . $row)->applyFromArray($style_row);
		$sheet->getStyle('Q' . $row)->applyFromArray($style_row);
		$sheet->getStyle('R' . $row)->applyFromArray($style_row);
		$sheet->getStyle('S' . $row)->applyFromArray($style_row);
		$sheet->getStyle('T' . $row)->applyFromArray($style_row);
		$sheet->getStyle('U' . $row)->applyFromArray($style_row);
		$sheet->getStyle('V' . $row)->applyFromArray($style_row);
		$sheet->getStyle('W' . $row)->applyFromArray($style_row);
		$sheet->getStyle('X' . $row)->applyFromArray($style_row);
		$sheet->getStyle('Y' . $row)->applyFromArray($style_row);
		$sheet->getStyle('Z' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AA' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AB' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AC' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AD' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AE' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AF' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AG' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AH' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AI' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AJ' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AK' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AL' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AM' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AN' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AO' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AP' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AQ' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AR' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AS' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AT' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AU' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AV' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AW' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AX' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AY' . $row)->applyFromArray($style_row);
		$sheet->getStyle('AZ' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BA' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BB' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BC' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BD' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BE' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BF' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BG' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BH' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BI' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BJ' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BK' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BL' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BM' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BN' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BO' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BP' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BQ' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BR' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BS' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BT' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BU' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BV' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BW' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BX' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BY' . $row)->applyFromArray($style_row);
		$sheet->getStyle('BZ' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CA' . $row)->applyFromArray($style_row);
		$sheet->getStyle('CB' . $row)->applyFromArray($style_row);


		$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('B' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyle('C' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('D' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('E' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('F' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('G' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('H' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('I' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('J' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('K' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('L' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('M' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('N' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('O' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('P' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('Q' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('R' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('S' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('T' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('U' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('V' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('W' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('X' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('Y' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('Z' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AA' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AB' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AC' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AD' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AE' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AF' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AG' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AH' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AI' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AJ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AK' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AL' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AM' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AN' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AO' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AP' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AQ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AR' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AS' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AT' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AU' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AV' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AX' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AY' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('AZ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BA' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BB' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BC' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BD' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BE' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BF' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BG' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BH' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BI' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BJ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BK' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BL' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BM' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BN' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BO' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BQ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BR' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BS' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BT' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BU' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BV' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BW' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BX' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BY' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('BZ' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CA' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyle('CB' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

		$sheet->getStyle('A' . $row . ':CB' . $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFA07A');
		$sheet->getStyle('A' . $row . ':CB' . $row)->getFont()->setBold(true);


		//set columns width
		$sheet->getColumnDimension('A')->setWidth(5); 
		$sheet->getColumnDimension('B')->setWidth(40); 
		$sheet->getColumnDimension('C')->setWidth(10);
		$sheet->getColumnDimension('D')->setWidth(16);
		$sheet->getColumnDimension('E')->setWidth(10);
		$sheet->getColumnDimension('F')->setWidth(16);
		$sheet->getColumnDimension('G')->setWidth(8);//Index(%)
		$sheet->getColumnDimension('H')->setWidth(8);//Index(%)
		$sheet->getColumnDimension('I')->setWidth(10);
		$sheet->getColumnDimension('J')->setWidth(16);
		$sheet->getColumnDimension('K')->setWidth(10);
		$sheet->getColumnDimension('L')->setWidth(16);
		$sheet->getColumnDimension('M')->setWidth(8);//Index(%)
		$sheet->getColumnDimension('N')->setWidth(8);//Index(%)
		$sheet->getColumnDimension('O')->setWidth(10);
		$sheet->getColumnDimension('P')->setWidth(16);
		$sheet->getColumnDimension('Q')->setWidth(10);
		$sheet->getColumnDimension('R')->setWidth(16);
		$sheet->getColumnDimension('S')->setWidth(8);//Index(%)
		$sheet->getColumnDimension('T')->setWidth(8);//Index(%)
		$sheet->getColumnDimension('U')->setWidth(10);
		$sheet->getColumnDimension('V')->setWidth(16);
		$sheet->getColumnDimension('W')->setWidth(10);
		$sheet->getColumnDimension('X')->setWidth(16);
		$sheet->getColumnDimension('Y')->setWidth(8);//Index(%)
		$sheet->getColumnDimension('Z')->setWidth(8);//Index(%)
		$sheet->getColumnDimension('AA')->setWidth(10);
		$sheet->getColumnDimension('AB')->setWidth(16);
		$sheet->getColumnDimension('AC')->setWidth(10);
		$sheet->getColumnDimension('AD')->setWidth(16);
		$sheet->getColumnDimension('AE')->setWidth(8);//Index(%)
		$sheet->getColumnDimension('AF')->setWidth(8);//Index(%)
		$sheet->getColumnDimension('AG')->setWidth(10);
		$sheet->getColumnDimension('AH')->setWidth(16);
		$sheet->getColumnDimension('AI')->setWidth(10);
		$sheet->getColumnDimension('AJ')->setWidth(16);
		$sheet->getColumnDimension('AK')->setWidth(8);//Index(%)
		$sheet->getColumnDimension('AL')->setWidth(8);//Index(%)
		$sheet->getColumnDimension('AM')->setWidth(10);
		$sheet->getColumnDimension('AN')->setWidth(16);
		$sheet->getColumnDimension('AO')->setWidth(10);
		$sheet->getColumnDimension('AP')->setWidth(16);
		$sheet->getColumnDimension('AQ')->setWidth(8);//Index(%)
		$sheet->getColumnDimension('AR')->setWidth(8);//Index(%)
		$sheet->getColumnDimension('AS')->setWidth(10);
		$sheet->getColumnDimension('AT')->setWidth(16);
		$sheet->getColumnDimension('AU')->setWidth(10);
		$sheet->getColumnDimension('AV')->setWidth(16);
		$sheet->getColumnDimension('AW')->setWidth(8);//Index(%)
		$sheet->getColumnDimension('AX')->setWidth(8);//Index(%)
		$sheet->getColumnDimension('AY')->setWidth(10);
		$sheet->getColumnDimension('AZ')->setWidth(16);
		$sheet->getColumnDimension('BA')->setWidth(10);
		$sheet->getColumnDimension('BB')->setWidth(16);
		$sheet->getColumnDimension('BC')->setWidth(8);//Index(%)
		$sheet->getColumnDimension('BD')->setWidth(8);//Index(%)
		$sheet->getColumnDimension('BE')->setWidth(10);
		$sheet->getColumnDimension('BF')->setWidth(16);
		$sheet->getColumnDimension('BG')->setWidth(10);
		$sheet->getColumnDimension('BH')->setWidth(16);
		$sheet->getColumnDimension('BI')->setWidth(8);//Index(%)
		$sheet->getColumnDimension('BJ')->setWidth(8);//Index(%)
		$sheet->getColumnDimension('BK')->setWidth(10);
		$sheet->getColumnDimension('BL')->setWidth(16);
		$sheet->getColumnDimension('BM')->setWidth(10);
		$sheet->getColumnDimension('BN')->setWidth(16);
		$sheet->getColumnDimension('BO')->setWidth(8);//Index(%)
		$sheet->getColumnDimension('BP')->setWidth(8);//Index(%)
		$sheet->getColumnDimension('BQ')->setWidth(10);
		$sheet->getColumnDimension('BR')->setWidth(16);
		$sheet->getColumnDimension('BS')->setWidth(10);
		$sheet->getColumnDimension('BT')->setWidth(16);
		$sheet->getColumnDimension('BU')->setWidth(8);//Index(%)
		$sheet->getColumnDimension('BV')->setWidth(8);//Index(%)
		$sheet->getColumnDimension('BW')->setWidth(10);
		$sheet->getColumnDimension('BX')->setWidth(16);
		$sheet->getColumnDimension('BY')->setWidth(10);
		$sheet->getColumnDimension('BZ')->setWidth(16);
		$sheet->getColumnDimension('CA')->setWidth(8);//Index(%)
		$sheet->getColumnDimension('CB')->setWidth(8);//Index(%)

		// Set orientasi kertas jadi LANDSCAPE
		$sheet->getPageSetup()->setOrientation(\PhpOffice\PhpSpreadsheet\Worksheet\PageSetup::ORIENTATION_LANDSCAPE);
		// Set judul file excel nya
		$sheet->setTitle("Selling Out - Salesman");
		// Proses file excel
		header('Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet');
		header('Content-Disposition: attachment; filename="Report Selling Out - Salesman ("' . $year . '").xlsx"'); // Set nama file excel nya
		header('Cache-Control: max-age=0');

		$writer = new Xlsx($spreadsheet);
		$writer->save('php://output');

	}

	public function export_distribution_jordan()
	{
		$spreadsheet = new Spreadsheet();
		$sheet = $spreadsheet->getActiveSheet();
		// Buat sebuah variabel untuk menampung pengaturan style dari header tabel
		$style_col = [
			'font' => ['bold' => true], // Set font nya jadi bold
			'alignment' => [
				'horizontal' => \PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER, // Set text jadi ditengah secara horizontal (center)
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'top' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border top dengan garis tipis
				'right' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN],  // Set border right dengan garis tipis
				'bottom' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border bottom dengan garis tipis
				'left' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN] // Set border left dengan garis tipis
			]
		];

		$style_range = [
			'font' => ['bold' => true], // Set font nya jadi bold
			'alignment' => [
				'horizontal' => \PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER, // Set text jadi ditengah secara horizontal (center)
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'allBorders' => [
					'borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN, // Set border top dengan garis tipis
				]
			]
		];

		$style_range_row = [
			'alignment' => [
				'horizontal' => \PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER, // Set text jadi ditengah secara horizontal (center)
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'allBorders' => [
					'borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN, // Set border top dengan garis tipis
				]
			]
		];

		// Buat sebuah variabel untuk menampung pengaturan style dari isi tabel
		$style_row = [
			'alignment' => [
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'top' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border top dengan garis tipis
				'right' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN],  // Set border right dengan garis tipis
				'bottom' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border bottom dengan garis tipis
				'left' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN] // Set border left dengan garis tipis
			]
		];


		if (isset($_POST['by_island']))
		{
			$island = $_POST['by_island'];
		}
		else
		{
			$island = "";
		}

		if (isset($_POST['by_region']))
		{
			$region = $_POST['by_region'];
		}
		else
		{
			$region = "";
		}

		if (isset($_POST['by_area']))
		{
			$area = implode(',', $_POST['by_area']);
			$area = str_replace(",", "','", $area);
			// $data['area_arr'] = $_POST['by_area'];
			$title = $area;
		}
		else
		{
			$area = "";
			// $data['area_arr'] = $data['area'];
			$title = "NATIONAL";
		}

		if(isset($_POST['by_month']))
		{
			$month = $_POST['by_month'];
		}else
		{
			$month = date('m');
		}

		if(isset($_POST['by_year']))
		{
			$year = $_POST['by_year'];
		}else
		{
			$year = date('Y');
		}

		$fromdate = '-' .$month. '-1';
		$todate = '-' .$month. '-31';

		$data['sku_name'] = $this->model('SkuModel')->getItemNameSKUJordan();
		$data['sku_group'] = $this->model('SkuModel')->getGroupSKUJordan();
		$data['sku_count'] = $this->model('SkuModel')->getCountSKUJordan();
		$data['sku_code'] = $this->model('SkuModel')->getItemCodeSKUJordan();

		$dateObj   = DateTime::createFromFormat('!m', $month);
		$monthName = $dateObj->format('F'); // March

		$sheet->setCellValue('A1', "Report Distribution - JORDAN"); // Set kolom A1 dengan tulisan "Report Selling In - By Outlet"
		$sheet->setCellValue('A2', "Island : " . $island); // Set kolom A2 dengan tulisan "Outlet Type : EC_EC"
		$sheet->setCellValue('A3', "Region : " . $region); // Set kolom A3 dengan tulisan "Outlet Type : EC_EC"
		$sheet->setCellValue('A4', "Area : " . $area);
		$sheet->setCellValue('A5', "Month : " . $monthName . " - " .$year);
		//$sheet->mergeCells('A1:F1'); // Set Merge Cell pada kolom A1 sampai F1
		$sheet->getStyle('A1')->getFont()->setBold(true); // Set bold kolom A1
		$sheet->getStyle('A2')->getFont()->setBold(true); // Set bold kolom A2
		$sheet->getStyle('A3')->getFont()->setBold(true); // Set bold kolom A3
		$sheet->getStyle('A4')->getFont()->setBold(true);
		$sheet->getStyle('A5')->getFont()->setBold(true);
		$sheet->getStyle('A1')->getFont()->setSize(20); // Set font size 15 untuk kolom A1
		// Buat header tabel nya pada baris ke 7
		$sheet->setCellValue('A7', "#"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('A7:A9'); // Set Merge Row pada kolom A6 sampai A8
		$sheet->setCellValue('B7', "TYPE OF OUTLET"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('B7:B9'); // Set Merge Row pada kolom A6 sampai A8
		$sheet->setCellValue('C7', "Code"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('C7:C9'); // Set Merge Row pada kolom A6 sampai A8
		$sheet->setCellValue('D7', "RO"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('D7:D9');
		$start_col = 5;

		foreach ($data['sku_group'] as $row_sku) :
			//$sheet->setCellValue('E7', $row_sku['item_group']);
			$sheet->setCellValueByColumnAndRow($start_col, 7, $row_sku['item_group']);
			$last_col = $start_col + ($row_sku['count_name']*2) - 1;
			$sheet->mergeCellsByColumnAndRow($start_col, 7, $last_col, 7);
			$start_col = $last_col + 1;
		endforeach;

		$sheet->setCellValueByColumnAndRow($start_col, 7, 'TOTAL');
		$sheet->mergeCellsByColumnAndRow($start_col, 7, $start_col + 1 , 8);

		$start_col = 5;
		foreach ($data['sku_name'] as $row_sku) :
			//$sheet->setCellValue('E7', $row_sku['item_group']);
			$sheet->setCellValueByColumnAndRow($start_col, 8, $row_sku['item_name']);
			$last_col = $start_col + 1;
			$sheet->mergeCellsByColumnAndRow($start_col, 8, $last_col, 8);
			$start_col = $last_col + 1;
		endforeach;
		$start_col = 5;
		foreach ($data['sku_name'] as $row_sku) :
			$sheet->setCellValueByColumnAndRow($start_col, 9, "DISTR. NO'S");
			$start_col = $start_col + 1;
			$sheet->setCellValueByColumnAndRow($start_col, 9, "%");
			$start_col = $start_col + 1;
		endforeach;

		$sheet->setCellValueByColumnAndRow($start_col, 9, "DISTR. NO'S");
		$sheet->setCellValueByColumnAndRow($start_col + 1, 9, "%");
		
		// Apply style header yang telah kita buat tadi ke masing-masing kolom header
		$sheet->getStyleByColumnAndRow(1, 8, $last_col, 8)->getAlignment()->setWrapText(true);
		$sheet->getStyleByColumnAndRow(1, 9, $last_col, 9)->getAlignment()->setWrapText(true);
		$sheet->getStyleByColumnAndRow(1, 7, $last_col, 9)->applyFromArray($style_range);
		$sheet->getStyleByColumnAndRow(1, 7, $last_col, 9)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');
		$sheet->getStyleByColumnAndRow($last_col + 1, 7, $last_col + 2, 9)->getAlignment()->setWrapText(true);
		$sheet->getStyleByColumnAndRow($last_col + 1, 7, $last_col + 2, 9)->applyFromArray($style_range);
		$sheet->getStyleByColumnAndRow($last_col + 1, 7, $last_col + 2, 9)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FF6D6D');

		// Set height baris ke 1, 2 dan 3
		$sheet->getRowDimension('1')->setRowHeight(40);
		$sheet->getRowDimension('2')->setRowHeight(20);
		$sheet->getRowDimension('3')->setRowHeight(20);
		$sheet->getRowDimension('4')->setRowHeight(20);
		$sheet->getRowDimension('5')->setRowHeight(20);
		$sheet->getRowDimension('8')->setRowHeight(60);

		$no = 1; // Untuk penomoran tabel, di awal set dengan 1
		$row = 10;

		$data1 = array(
			'island' => $island,
			'region' => $region,
			'area' => $area,
			'month' => $month,
			'year' => $year
		);

		$data['distr_jordan'] = $this->model('ReportModel')->getDistr_jordan_ALL($data);

		$data_col = 1;
		$data_row = 10;

		$channel='';

		$total_RO = 0;
		$x=1;
		foreach($data['sku_code'] as $sku):
			$total_d[$x] = 0;
			$total_p[$x] = 0;
			$x++;
		endforeach;
		
		$total_dAll = 0;
		$total_pAll = 0;

		foreach ($data['distr_jordan'] as $rows) :
			$data_col = 1;

			if ($channel != $rows['channel'])
            {
				$channel = $rows['channel'];
				$sheet->setCellValueByColumnAndRow($data_col, $data_row, '');
				$sheet->setCellValueByColumnAndRow($data_col + 1, $data_row, $rows['channel']);
				$sheet->setCellValueByColumnAndRow($data_col + 2, $data_row, '');
				$sheet->setCellValueByColumnAndRow($data_col + 3, $data_row, '');
				$a=1;
				$baris=4;
				foreach($data['sku_code'] as $sku):
					$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, '');
					$baris = $baris + 1;
					$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, '');
					$a++;
					$baris++;
				endforeach;
				$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, '');
				$sheet->setCellValueByColumnAndRow($data_col + $baris + 1, $data_row, '');

				$sheet->getStyleByColumnAndRow(1, $data_row, $last_col + 2, $data_row)->applyFromArray($style_range);
				$sheet->getStyleByColumnAndRow(1, $data_row, $last_col + 2, $data_row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('d9e1f2');

				$data_row++;

			}

			$sheet->setCellValueByColumnAndRow($data_col, $data_row, $no);
			$sheet->setCellValueByColumnAndRow($data_col + 1, $data_row, $rows['desc_type']);
			$sheet->setCellValueByColumnAndRow($data_col + 2, $data_row, $rows['outlet_type']);
			$sheet->setCellValueByColumnAndRow($data_col + 3, $data_row, $rows['RO']);
			$sheet->getStyleByColumnAndRow($data_col + 3, $data_row)->getNumberFormat()->setFormatCode('#,##0');
			$a=1;
			$baris=4;
			foreach($data['sku_code'] as $sku):
				$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($rows['d'.$a], 0));
				$sheet->getStyleByColumnAndRow($data_col + $baris, $data_row)->getNumberFormat()->setFormatCode('#,##0');
				$baris = $baris + 1;
				$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($rows['%'.$a], 2));
				$a++;
				$baris++;
			endforeach;
			
			$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, $rows['dtotal']);
			$sheet->getStyleByColumnAndRow($data_col + $baris, $data_row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->setCellValueByColumnAndRow($data_col + $baris + 1, $data_row, number_format($rows['%total'], 0));

			$total_RO += $rows['RO'];
			$x = 1;
			foreach($data['sku_code'] as $sku):
				$total_d[$x] += $rows['d'.$x];
				if($total_RO==0)
				{
					$total_p[$x] = 0;
				}
				else
				{
					$total_p[$x] = ($total_d[$x]/$total_RO)*100;
				} 
				//$total_p[$x] = ($total_d[$x]/($total_RO ?: 1))*100;
				$x++;
			endforeach;
			
			$total_dAll += $rows['dtotal'];

			
			// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
			$sheet->getStyleByColumnAndRow(1, $data_row, $last_col + 2, $data_row)->applyFromArray($style_range_row);
			$sheet->getStyleByColumnAndRow(1, $data_row, null, $data_row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyleByColumnAndRow(2, $data_row, null, $data_row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyleByColumnAndRow(3, $data_row, null, $data_row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyleByColumnAndRow(4, 10, $last_col + 2, $data_row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

			$no++; // Tambah 1 setiap kali looping
    		$row++; // Tambah 1 setiap kali looping
			$data_row++;
		endforeach;

		if($total_RO==0)
		{
			$total_pAll = 0;
		}
		else
		{
			$total_pAll = ($total_dAll/$total_RO)*100;
		}
		//$total_pAll = ($total_dAll/($total_RO ?: 1))*100;

		//$data_row = $data_row + 1;

		$sheet->setCellValueByColumnAndRow($data_col, $data_row, '');
		$sheet->setCellValueByColumnAndRow($data_col + 1, $data_row, 'TOTAL');
		$sheet->setCellValueByColumnAndRow($data_col + 2, $data_row, '');
		$sheet->setCellValueByColumnAndRow($data_col + 3, $data_row, $total_RO);
		$sheet->getStyleByColumnAndRow($data_col + 3, $data_row)->getNumberFormat()->setFormatCode('#,##0');
		$a=1;
		$baris=4;
		foreach($data['sku_code'] as $sku):
			$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($total_d[$a], 0));
			$sheet->getStyleByColumnAndRow($data_col + $baris, $data_row)->getNumberFormat()->setFormatCode('#,##0');
			$baris = $baris + 1;
			$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($total_p[$a], 2));
			$a++;
			$baris++;
		endforeach;
		
		$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, $total_dAll);
		$sheet->getStyleByColumnAndRow($data_col + $baris, $data_row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->setCellValueByColumnAndRow($data_col + $baris + 1, $data_row, number_format($total_pAll, 2));

		$sheet->getStyleByColumnAndRow(1, $data_row, $last_col + 2, $data_row)->applyFromArray($style_range);
		$sheet->getStyleByColumnAndRow(1, $data_row, $last_col + 2, $data_row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFA07A');

		$sheet->getStyleByColumnAndRow(4, 10, $last_col + 2, $data_row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		

		$sheet->getColumnDimension('A')->setWidth(5); // Set width kolom A
		$sheet->getColumnDimension('B')->setWidth(40); // Set width kolom B
		$sheet->getColumnDimension('C')->setWidth(11); // Set width kolom C
		$sheet->getColumnDimension('D')->setWidth(10);

		// Set orientasi kertas jadi LANDSCAPE
		$sheet->getPageSetup()->setOrientation(\PhpOffice\PhpSpreadsheet\Worksheet\PageSetup::ORIENTATION_LANDSCAPE);
		// Set judul file excel nya
		$sheet->setTitle('Distribution - JORDAN');
		// Proses file excel
		header('Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet');
		header('Content-Disposition: attachment; filename="Report Distribution - JORDAN.xlsx"'); // Set nama file excel nya
		header('Cache-Control: max-age=0');

		$writer = new Xlsx($spreadsheet);
		$writer->save('php://output');


	}

	public function export_distribution_jordan_area()
	{
		$data['area'] = $this->model('AreaModel')->getAllArea();

		$spreadsheet = new Spreadsheet();
		$sheet = $spreadsheet->getActiveSheet();
		$sheet_arr = [];
		// Buat sebuah variabel untuk menampung pengaturan style dari header tabel
		$style_col = [
			'font' => ['bold' => true], // Set font nya jadi bold
			'alignment' => [
				'horizontal' => \PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER, // Set text jadi ditengah secara horizontal (center)
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'top' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border top dengan garis tipis
				'right' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN],  // Set border right dengan garis tipis
				'bottom' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border bottom dengan garis tipis
				'left' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN] // Set border left dengan garis tipis
			]
		];

		$style_range = [
			'font' => ['bold' => true], // Set font nya jadi bold
			'alignment' => [
				'horizontal' => \PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER, // Set text jadi ditengah secara horizontal (center)
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'allBorders' => [
					'borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN, // Set border top dengan garis tipis
				]
			]
		];

		$style_range_row = [
			'alignment' => [
				'horizontal' => \PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER, // Set text jadi ditengah secara horizontal (center)
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'allBorders' => [
					'borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN, // Set border top dengan garis tipis
				]
			]
		];

		// Buat sebuah variabel untuk menampung pengaturan style dari isi tabel
		$style_row = [
			'alignment' => [
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'top' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border top dengan garis tipis
				'right' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN],  // Set border right dengan garis tipis
				'bottom' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border bottom dengan garis tipis
				'left' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN] // Set border left dengan garis tipis
			]
		];


		if (isset($_POST['by_island']))
		{
			$island = $_POST['by_island'];
		}
		else
		{
			$island = "";
		}

		if (isset($_POST['by_region']))
		{
			$region = $_POST['by_region'];
		}
		else
		{
			$region = "";
		}

		if (isset($_POST['by_area']))
		{
			$area = implode(',', $_POST['by_area']);
			$area2 = implode(',', $_POST['by_area']);
			$area = str_replace(",", "','", $area);
			// $area3 = "'" . $area . "'";
			$data['area_arr'] = $this->model('AreaModel')->getArea($area);
			$title = "COMBINED AREA";
		}
		else
		{
			$area = "";
			$data['area_arr'] = $data['area'];
			$title = "NATIONAL";
		}

		if(isset($_POST['by_month']))
		{
			$month = $_POST['by_month'];
		}else
		{
			$month = date('m');
		}

		if(isset($_POST['by_year']))
		{
			$year = $_POST['by_year'];
		}else
		{
			$year = date('Y');
		}

		$fromdate = '-' .$month. '-1';
		$todate = '-' .$month. '-31';

		$data['sku_name'] = $this->model('SkuModel')->getItemNameSKUJordan();
		$data['sku_group'] = $this->model('SkuModel')->getGroupSKUJordan();
		$data['sku_count'] = $this->model('SkuModel')->getCountSKUJordan();
		$data['sku_code'] = $this->model('SkuModel')->getItemCodeSKUJordan();

		$dateObj   = DateTime::createFromFormat('!m', $month);
		$monthName = $dateObj->format('F'); // March

		$sheet->setCellValue('A1', "Report Distribution - JORDAN"); // Set kolom A1 dengan tulisan "Report Selling In - By Outlet"
		$sheet->setCellValue('A2', "Island : " . $island); // Set kolom A2 dengan tulisan "Outlet Type : EC_EC"
		$sheet->setCellValue('A3', "Region : " . $region); // Set kolom A3 dengan tulisan "Outlet Type : EC_EC"
		$sheet->setCellValue('A4', "Area : " . $area2);
		$sheet->setCellValue('A5', "Month : " . $monthName . " - " .$year);
		//$sheet->mergeCells('A1:F1'); // Set Merge Cell pada kolom A1 sampai F1
		$sheet->getStyle('A1')->getFont()->setBold(true); // Set bold kolom A1
		$sheet->getStyle('A2')->getFont()->setBold(true); // Set bold kolom A2
		$sheet->getStyle('A3')->getFont()->setBold(true); // Set bold kolom A3
		$sheet->getStyle('A4')->getFont()->setBold(true);
		$sheet->getStyle('A5')->getFont()->setBold(true);
		$sheet->getStyle('A1')->getFont()->setSize(20); // Set font size 15 untuk kolom A1
		// Buat header tabel nya pada baris ke 7
		$sheet->setCellValue('A7', "#"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('A7:A9'); // Set Merge Row pada kolom A6 sampai A8
		$sheet->setCellValue('B7', "TYPE OF OUTLET"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('B7:B9'); // Set Merge Row pada kolom A6 sampai A8
		$sheet->setCellValue('C7', "Code"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('C7:C9'); // Set Merge Row pada kolom A6 sampai A8
		$sheet->setCellValue('D7', "RO"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('D7:D9');
		$start_col = 5;

		foreach ($data['sku_group'] as $row_sku) :
			//$sheet->setCellValue('E7', $row_sku['item_group']);
			$sheet->setCellValueByColumnAndRow($start_col, 7, $row_sku['item_group']);
			$last_col = $start_col + ($row_sku['count_name']*2) - 1;
			$sheet->mergeCellsByColumnAndRow($start_col, 7, $last_col, 7);
			$start_col = $last_col + 1;
		endforeach;

		$sheet->setCellValueByColumnAndRow($start_col, 7, 'TOTAL');
		$sheet->mergeCellsByColumnAndRow($start_col, 7, $start_col + 1 , 8);

		$start_col = 5;
		foreach ($data['sku_name'] as $row_sku) :
			//$sheet->setCellValue('E7', $row_sku['item_group']);
			$sheet->setCellValueByColumnAndRow($start_col, 8, $row_sku['item_name']);
			$last_col = $start_col + 1;
			$sheet->mergeCellsByColumnAndRow($start_col, 8, $last_col, 8);
			$start_col = $last_col + 1;
		endforeach;
		$start_col = 5;
		foreach ($data['sku_name'] as $row_sku) :
			$sheet->setCellValueByColumnAndRow($start_col, 9, "DISTR. NO'S");
			$start_col = $start_col + 1;
			$sheet->setCellValueByColumnAndRow($start_col, 9, "%");
			$start_col = $start_col + 1;
		endforeach;

		$sheet->setCellValueByColumnAndRow($start_col, 9, "DISTR. NO'S");
		$sheet->setCellValueByColumnAndRow($start_col + 1, 9, "%");
		
		// Apply style header yang telah kita buat tadi ke masing-masing kolom header
		$sheet->getStyleByColumnAndRow(1, 8, $last_col, 8)->getAlignment()->setWrapText(true);
		$sheet->getStyleByColumnAndRow(1, 9, $last_col, 9)->getAlignment()->setWrapText(true);
		$sheet->getStyleByColumnAndRow(1, 7, $last_col, 9)->applyFromArray($style_range);
		$sheet->getStyleByColumnAndRow(1, 7, $last_col, 9)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');
		$sheet->getStyleByColumnAndRow($last_col + 1, 7, $last_col + 2, 9)->getAlignment()->setWrapText(true);
		$sheet->getStyleByColumnAndRow($last_col + 1, 7, $last_col + 2, 9)->applyFromArray($style_range);
		$sheet->getStyleByColumnAndRow($last_col + 1, 7, $last_col + 2, 9)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FF6D6D');

		// Set height baris ke 1, 2 dan 3
		$sheet->getRowDimension('1')->setRowHeight(40);
		$sheet->getRowDimension('2')->setRowHeight(20);
		$sheet->getRowDimension('3')->setRowHeight(20);
		$sheet->getRowDimension('4')->setRowHeight(20);
		$sheet->getRowDimension('5')->setRowHeight(20);
		$sheet->getRowDimension('8')->setRowHeight(60);

		$no = 1; // Untuk penomoran tabel, di awal set dengan 1
		$row = 10;

		// $data1 = array(
		// 	'island' => $island,
		// 	'region' => $region,
		// 	'area' => $area,
		// 	'month' => $month,
		// 	'year' => $year
		// );

		$data['distr_jordan'] = $this->model('ReportModel')->getDistr_jordan_ALL($data);

		$data_col = 1;
		$data_row = 10;

		$channel='';

		$total_RO = 0;
		$x=1;
		foreach($data['sku_code'] as $sku):
			$total_d[$x] = 0;
			$total_p[$x] = 0;
			$x++;
		endforeach;
		
		$total_dAll = 0;
		$total_pAll = 0;

		foreach ($data['distr_jordan'] as $rows) :
			$data_col = 1;

			if ($channel != $rows['channel'])
            {
				$channel = $rows['channel'];
				$sheet->setCellValueByColumnAndRow($data_col, $data_row, '');
				$sheet->setCellValueByColumnAndRow($data_col + 1, $data_row, $rows['channel']);
				$sheet->setCellValueByColumnAndRow($data_col + 2, $data_row, '');
				$sheet->setCellValueByColumnAndRow($data_col + 3, $data_row, '');
				$a=1;
				$baris=4;
				foreach($data['sku_code'] as $sku):
					$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, '');
					$baris = $baris + 1;
					$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, '');
					$a++;
					$baris++;
				endforeach;
				$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, '');
				$sheet->setCellValueByColumnAndRow($data_col + $baris + 1, $data_row, '');

				$sheet->getStyleByColumnAndRow(1, $data_row, $last_col + 2, $data_row)->applyFromArray($style_range);
				$sheet->getStyleByColumnAndRow(1, $data_row, $last_col + 2, $data_row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('d9e1f2');

				$data_row++;

			}

			$sheet->setCellValueByColumnAndRow($data_col, $data_row, $no);
			$sheet->setCellValueByColumnAndRow($data_col + 1, $data_row, $rows['desc_type']);
			$sheet->setCellValueByColumnAndRow($data_col + 2, $data_row, $rows['outlet_type']);
			$sheet->setCellValueByColumnAndRow($data_col + 3, $data_row, $rows['RO']);
			$sheet->getStyleByColumnAndRow($data_col + 3, $data_row)->getNumberFormat()->setFormatCode('#,##0');
			$a=1;
			$baris=4;
			foreach($data['sku_code'] as $sku):
				$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($rows['d'.$a], 0));
				$sheet->getStyleByColumnAndRow($data_col + $baris, $data_row)->getNumberFormat()->setFormatCode('#,##0');
				$baris = $baris + 1;
				$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($rows['%'.$a], 2));
				$a++;
				$baris++;
			endforeach;
			
			$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, $rows['dtotal']);
			$sheet->getStyleByColumnAndRow($data_col + $baris, $data_row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->setCellValueByColumnAndRow($data_col + $baris + 1, $data_row, number_format($rows['%total'], 0));

			$total_RO += $rows['RO'];
			$x = 1;
			foreach($data['sku_code'] as $sku):
				$total_d[$x] += $rows['d'.$x];
				if($total_RO==0)
				{
					$total_p[$x] = 0;
				}
				else
				{
					$total_p[$x] = ($total_d[$x]/$total_RO)*100;
				} 
				//$total_p[$x] = ($total_d[$x]/($total_RO ?: 1))*100;
				$x++;
			endforeach;
			
			$total_dAll += $rows['dtotal'];

			
			// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
			$sheet->getStyleByColumnAndRow(1, $data_row, $last_col + 2, $data_row)->applyFromArray($style_range_row);
			$sheet->getStyleByColumnAndRow(1, $data_row, null, $data_row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyleByColumnAndRow(2, $data_row, null, $data_row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyleByColumnAndRow(3, $data_row, null, $data_row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyleByColumnAndRow(4, 10, $last_col + 2, $data_row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

			$no++; // Tambah 1 setiap kali looping
    		$row++; // Tambah 1 setiap kali looping
			$data_row++;
		endforeach;

		if($total_RO==0)
		{
			$total_pAll = 0;
		}
		else
		{
			$total_pAll = ($total_dAll/$total_RO)*100;
		}
		//$total_pAll = ($total_dAll/($total_RO ?: 1))*100;

		//$data_row = $data_row + 1;

		$sheet->setCellValueByColumnAndRow($data_col, $data_row, '');
		$sheet->setCellValueByColumnAndRow($data_col + 1, $data_row, 'TOTAL');
		$sheet->setCellValueByColumnAndRow($data_col + 2, $data_row, '');
		$sheet->setCellValueByColumnAndRow($data_col + 3, $data_row, $total_RO);
		$sheet->getStyleByColumnAndRow($data_col + 3, $data_row)->getNumberFormat()->setFormatCode('#,##0');
		$a=1;
		$baris=4;
		foreach($data['sku_code'] as $sku):
			$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($total_d[$a], 0));
			$sheet->getStyleByColumnAndRow($data_col + $baris, $data_row)->getNumberFormat()->setFormatCode('#,##0');
			$baris = $baris + 1;
			$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($total_p[$a], 2));
			$a++;
			$baris++;
		endforeach;
		
		$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, $total_dAll);
		$sheet->getStyleByColumnAndRow($data_col + $baris, $data_row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->setCellValueByColumnAndRow($data_col + $baris + 1, $data_row, number_format($total_pAll, 2));

		$sheet->getStyleByColumnAndRow(1, $data_row, $last_col + 2, $data_row)->applyFromArray($style_range);
		$sheet->getStyleByColumnAndRow(1, $data_row, $last_col + 2, $data_row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFA07A');

		$sheet->getStyleByColumnAndRow(4, 10, $last_col + 2, $data_row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		

		$sheet->getColumnDimension('A')->setWidth(5); // Set width kolom A
		$sheet->getColumnDimension('B')->setWidth(40); // Set width kolom B
		$sheet->getColumnDimension('C')->setWidth(11); // Set width kolom C
		$sheet->getColumnDimension('D')->setWidth(10);

		// Set orientasi kertas jadi LANDSCAPE
		$sheet->getPageSetup()->setOrientation(\PhpOffice\PhpSpreadsheet\Worksheet\PageSetup::ORIENTATION_LANDSCAPE);
		// Set judul file excel nya
		$sheet->setTitle($title);
		
		if(count($data['area_arr']) > 1)
		{
			$arr = 0;
			foreach($data['area_arr'] as $areas):
				$sheet_arr[$arr] = $spreadsheet->createSheet();
				// $sheet_arr[$arr] = $spreadsheet->getActiveSheet();

				$sheet_arr[$arr]->setCellValue('A1', "Report Distribution - JORDAN"); // Set kolom A1 dengan tulisan "Report Selling In - By Outlet"
				$sheet_arr[$arr]->setCellValue('A2', "Island : " . $island); // Set kolom A2 dengan tulisan "Outlet Type : EC_EC"
				$sheet_arr[$arr]->setCellValue('A3', "Region : " . $region); // Set kolom A3 dengan tulisan "Outlet Type : EC_EC"
				$sheet_arr[$arr]->setCellValue('A4', "Area : " . $areas['area']);
				$sheet_arr[$arr]->setCellValue('A5', "Month : " . $monthName . " - " .$year);
				//$sheet_arr[$arr]->mergeCells('A1:F1'); // Set Merge Cell pada kolom A1 sampai F1
				$sheet_arr[$arr]->getStyle('A1')->getFont()->setBold(true); // Set bold kolom A1
				$sheet_arr[$arr]->getStyle('A2')->getFont()->setBold(true); // Set bold kolom A2
				$sheet_arr[$arr]->getStyle('A3')->getFont()->setBold(true); // Set bold kolom A3
				$sheet_arr[$arr]->getStyle('A4')->getFont()->setBold(true);
				$sheet_arr[$arr]->getStyle('A5')->getFont()->setBold(true);
				$sheet_arr[$arr]->getStyle('A1')->getFont()->setSize(20); // Set font size 15 untuk kolom A1
				// Buat header tabel nya pada baris ke 7
				$sheet_arr[$arr]->setCellValue('A7', "#"); // Set kolom A6 dengan tulisan "NO"
				$sheet_arr[$arr]->mergeCells('A7:A9'); // Set Merge Row pada kolom A6 sampai A8
				$sheet_arr[$arr]->setCellValue('B7', "TYPE OF OUTLET"); // Set kolom A6 dengan tulisan "NO"
				$sheet_arr[$arr]->mergeCells('B7:B9'); // Set Merge Row pada kolom A6 sampai A8
				$sheet_arr[$arr]->setCellValue('C7', "Code"); // Set kolom A6 dengan tulisan "NO"
				$sheet_arr[$arr]->mergeCells('C7:C9'); // Set Merge Row pada kolom A6 sampai A8
				$sheet_arr[$arr]->setCellValue('D7', "RO"); // Set kolom A6 dengan tulisan "NO"
				$sheet_arr[$arr]->mergeCells('D7:D9');
				$start_col = 5;

				foreach ($data['sku_group'] as $row_sku) :
					$sheet_arr[$arr]->setCellValueByColumnAndRow($start_col, 7, $row_sku['item_group']);
					$last_col = $start_col + ($row_sku['count_name']*2) - 1;
					$sheet_arr[$arr]->mergeCellsByColumnAndRow($start_col, 7, $last_col, 7);
					$start_col = $last_col + 1;
				endforeach;

				$sheet_arr[$arr]->setCellValueByColumnAndRow($start_col, 7, 'TOTAL');
				$sheet_arr[$arr]->mergeCellsByColumnAndRow($start_col, 7, $start_col + 1 , 8);

				$start_col = 5;
				foreach ($data['sku_name'] as $row_sku) :
					$sheet_arr[$arr]->setCellValueByColumnAndRow($start_col, 8, $row_sku['item_name']);
					$last_col = $start_col + 1;
					$sheet_arr[$arr]->mergeCellsByColumnAndRow($start_col, 8, $last_col, 8);
					$start_col = $last_col + 1;
				endforeach;
				$start_col = 5;
				foreach ($data['sku_name'] as $row_sku) :
					$sheet_arr[$arr]->setCellValueByColumnAndRow($start_col, 9, "DISTR. NO'S");
					$start_col = $start_col + 1;
					$sheet_arr[$arr]->setCellValueByColumnAndRow($start_col, 9, "%");
					$start_col = $start_col + 1;
				endforeach;

				$sheet_arr[$arr]->setCellValueByColumnAndRow($start_col, 9, "DISTR. NO'S");
				$sheet_arr[$arr]->setCellValueByColumnAndRow($start_col + 1, 9, "%");
				
				// Apply style header yang telah kita buat tadi ke masing-masing kolom header
				$sheet_arr[$arr]->getStyleByColumnAndRow(1, 8, $last_col, 8)->getAlignment()->setWrapText(true);
				$sheet_arr[$arr]->getStyleByColumnAndRow(1, 9, $last_col, 9)->getAlignment()->setWrapText(true);
				$sheet_arr[$arr]->getStyleByColumnAndRow(1, 7, $last_col, 9)->applyFromArray($style_range);
				$sheet_arr[$arr]->getStyleByColumnAndRow(1, 7, $last_col, 9)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');
				$sheet_arr[$arr]->getStyleByColumnAndRow($last_col + 1, 7, $last_col + 2, 9)->getAlignment()->setWrapText(true);
				$sheet_arr[$arr]->getStyleByColumnAndRow($last_col + 1, 7, $last_col + 2, 9)->applyFromArray($style_range);
				$sheet_arr[$arr]->getStyleByColumnAndRow($last_col + 1, 7, $last_col + 2, 9)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FF6D6D');

				// Set height baris ke 1, 2 dan 3
				$sheet_arr[$arr]->getRowDimension('1')->setRowHeight(40);
				$sheet_arr[$arr]->getRowDimension('2')->setRowHeight(20);
				$sheet_arr[$arr]->getRowDimension('3')->setRowHeight(20);
				$sheet_arr[$arr]->getRowDimension('4')->setRowHeight(20);
				$sheet_arr[$arr]->getRowDimension('5')->setRowHeight(20);
				$sheet_arr[$arr]->getRowDimension('8')->setRowHeight(60);

				$no = 1; // Untuk penomoran tabel, di awal set dengan 1
				$row = 10;

				$data1 = array(
					'island' => $island,
					'region' => $region,
					'area' => $areas['area'],
					'month' => $month,
					'year' => $year
				);

				$data['distr_jordan_area'] = $this->model('ReportModel')->getDistr_jordan_ALL_Area($data1);

				$data_col = 1;
				$data_row = 10;

				$channel='';

				$total_RO = 0;
				$x=1;
				foreach($data['sku_code'] as $sku):
					$total_d[$x] = 0;
					$total_p[$x] = 0;
					$x++;
				endforeach;
				
				$total_dAll = 0;
				$total_pAll = 0;

				foreach ($data['distr_jordan_area'] as $row3) :
					$data_col = 1;

					if ($channel != $row3['channel'])
					{
						$channel = $row3['channel'];
						$sheet_arr[$arr]->setCellValueByColumnAndRow($data_col, $data_row, '');
						$sheet_arr[$arr]->setCellValueByColumnAndRow($data_col + 1, $data_row, $row3['channel']);
						$sheet_arr[$arr]->setCellValueByColumnAndRow($data_col + 2, $data_row, '');
						$sheet_arr[$arr]->setCellValueByColumnAndRow($data_col + 3, $data_row, '');
						$a=1;
						$baris=4;
						foreach($data['sku_code'] as $sku):
							$sheet_arr[$arr]->setCellValueByColumnAndRow($data_col + $baris, $data_row, '');
							$baris = $baris + 1;
							$sheet_arr[$arr]->setCellValueByColumnAndRow($data_col + $baris, $data_row, '');
							$a++;
							$baris++;
						endforeach;
						$sheet_arr[$arr]->setCellValueByColumnAndRow($data_col + $baris, $data_row, '');
						$sheet_arr[$arr]->setCellValueByColumnAndRow($data_col + $baris + 1, $data_row, '');

						$sheet_arr[$arr]->getStyleByColumnAndRow(1, $data_row, $last_col + 2, $data_row)->applyFromArray($style_range);
						$sheet_arr[$arr]->getStyleByColumnAndRow(1, $data_row, $last_col + 2, $data_row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('d9e1f2');

						$data_row++;

					}

					$sheet_arr[$arr]->setCellValueByColumnAndRow($data_col, $data_row, $no);
					$sheet_arr[$arr]->setCellValueByColumnAndRow($data_col + 1, $data_row, $row3['desc_type']);
					$sheet_arr[$arr]->setCellValueByColumnAndRow($data_col + 2, $data_row, $row3['outlet_type']);
					$sheet_arr[$arr]->setCellValueByColumnAndRow($data_col + 3, $data_row, $row3['RO']);
					$sheet_arr[$arr]->getStyleByColumnAndRow($data_col + 3, $data_row)->getNumberFormat()->setFormatCode('#,##0');
					$a=1;
					$baris=4;
					foreach($data['sku_code'] as $sku):
						$sheet_arr[$arr]->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($row3['d'.$a], 0));
						$sheet_arr[$arr]->getStyleByColumnAndRow($data_col + $baris, $data_row)->getNumberFormat()->setFormatCode('#,##0');
						$baris = $baris + 1;
						$sheet_arr[$arr]->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($row3['%'.$a], 2));
						$a++;
						$baris++;
					endforeach;
					
					$sheet_arr[$arr]->setCellValueByColumnAndRow($data_col + $baris, $data_row, $row3['dtotal']);
					$sheet_arr[$arr]->getStyleByColumnAndRow($data_col + $baris, $data_row)->getNumberFormat()->setFormatCode('#,##0');
					$sheet_arr[$arr]->setCellValueByColumnAndRow($data_col + $baris + 1, $data_row, number_format($row3['%total'], 0));

					$total_RO += $row3['RO'];
					$x = 1;
					foreach($data['sku_code'] as $sku):
						$total_d[$x] += $row3['d'.$x];
						if($total_RO==0)
						{
							$total_p[$x] = 0;
						}
						else
						{
							$total_p[$x] = ($total_d[$x]/$total_RO)*100;
						} 
						//$total_p[$x] = ($total_d[$x]/($total_RO ?: 1))*100;
						$x++;
					endforeach;
					
					$total_dAll += $row3['dtotal'];

					
					// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
					$sheet_arr[$arr]->getStyleByColumnAndRow(1, $data_row, $last_col + 2, $data_row)->applyFromArray($style_range_row);
					$sheet_arr[$arr]->getStyleByColumnAndRow(1, $data_row, null, $data_row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
					$sheet_arr[$arr]->getStyleByColumnAndRow(2, $data_row, null, $data_row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
					$sheet_arr[$arr]->getStyleByColumnAndRow(3, $data_row, null, $data_row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
					$sheet_arr[$arr]->getStyleByColumnAndRow(4, 10, $last_col + 2, $data_row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

					$no++; // Tambah 1 setiap kali looping
					$row++; // Tambah 1 setiap kali looping
					$data_row++;
				endforeach;

				if($total_RO==0)
				{
					$total_pAll = 0;
				}
				else
				{
					$total_pAll = ($total_dAll/$total_RO)*100;
				}
				//$total_pAll = ($total_dAll/($total_RO ?: 1))*100;

				//$data_row = $data_row + 1;

				$sheet_arr[$arr]->setCellValueByColumnAndRow($data_col, $data_row, '');
				$sheet_arr[$arr]->setCellValueByColumnAndRow($data_col + 1, $data_row, 'TOTAL');
				$sheet_arr[$arr]->setCellValueByColumnAndRow($data_col + 2, $data_row, '');
				$sheet_arr[$arr]->setCellValueByColumnAndRow($data_col + 3, $data_row, $total_RO);
				$sheet_arr[$arr]->getStyleByColumnAndRow($data_col + 3, $data_row)->getNumberFormat()->setFormatCode('#,##0');
				$a=1;
				$baris=4;
				foreach($data['sku_code'] as $sku):
					$sheet_arr[$arr]->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($total_d[$a], 0));
					$sheet_arr[$arr]->getStyleByColumnAndRow($data_col + $baris, $data_row)->getNumberFormat()->setFormatCode('#,##0');
					$baris = $baris + 1;
					$sheet_arr[$arr]->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($total_p[$a], 2));
					$a++;
					$baris++;
				endforeach;
				
				$sheet_arr[$arr]->setCellValueByColumnAndRow($data_col + $baris, $data_row, $total_dAll);
				$sheet_arr[$arr]->getStyleByColumnAndRow($data_col + $baris, $data_row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet_arr[$arr]->setCellValueByColumnAndRow($data_col + $baris + 1, $data_row, number_format($total_pAll, 2));

				$sheet_arr[$arr]->getStyleByColumnAndRow(1, $data_row, $last_col + 2, $data_row)->applyFromArray($style_range);
				$sheet_arr[$arr]->getStyleByColumnAndRow(1, $data_row, $last_col + 2, $data_row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFA07A');

				$sheet_arr[$arr]->getStyleByColumnAndRow(4, 10, $last_col + 2, $data_row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				

				$sheet_arr[$arr]->getColumnDimension('A')->setWidth(5); // Set width kolom A
				$sheet_arr[$arr]->getColumnDimension('B')->setWidth(40); // Set width kolom B
				$sheet_arr[$arr]->getColumnDimension('C')->setWidth(11); // Set width kolom C
				$sheet_arr[$arr]->getColumnDimension('D')->setWidth(10);

				// Set orientasi kertas jadi LANDSCAPE
				$sheet_arr[$arr]->getPageSetup()->setOrientation(\PhpOffice\PhpSpreadsheet\Worksheet\PageSetup::ORIENTATION_LANDSCAPE);
				// Set judul file excel nya
				$sheet_arr[$arr]->setTitle($areas['area']);

				$arr++;
			endforeach;
		}
		
		// Proses file excel
		header('Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet');
		header('Content-Disposition: attachment; filename="Report Distribution - JORDAN (Area Detail).xlsx"'); // Set nama file excel nya
		header('Cache-Control: max-age=0');

		$writer = new Xlsx($spreadsheet);
		$writer->save('php://output');


	}

	public function export_distribution_riemann()
	{
		$spreadsheet = new Spreadsheet();
		$sheet = $spreadsheet->getActiveSheet();
		// Buat sebuah variabel untuk menampung pengaturan style dari header tabel
		$style_col = [
			'font' => ['bold' => true], // Set font nya jadi bold
			'alignment' => [
				'horizontal' => \PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER, // Set text jadi ditengah secara horizontal (center)
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'top' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border top dengan garis tipis
				'right' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN],  // Set border right dengan garis tipis
				'bottom' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border bottom dengan garis tipis
				'left' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN] // Set border left dengan garis tipis
			]
		];

		$style_range = [
			'font' => ['bold' => true], // Set font nya jadi bold
			'alignment' => [
				'horizontal' => \PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER, // Set text jadi ditengah secara horizontal (center)
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'allBorders' => [
					'borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN, // Set border top dengan garis tipis
				]
			]
		];

		$style_range_row = [
			'alignment' => [
				'horizontal' => \PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER, // Set text jadi ditengah secara horizontal (center)
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'allBorders' => [
					'borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN, // Set border top dengan garis tipis
				]
			]
		];

		// Buat sebuah variabel untuk menampung pengaturan style dari isi tabel
		$style_row = [
			'alignment' => [
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'top' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border top dengan garis tipis
				'right' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN],  // Set border right dengan garis tipis
				'bottom' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border bottom dengan garis tipis
				'left' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN] // Set border left dengan garis tipis
			]
		];


		if (isset($_POST['by_island']))
		{
			$island = $_POST['by_island'];
		}
		else
		{
			$island = "";
		}

		if (isset($_POST['by_region']))
		{
			$region = $_POST['by_region'];
		}
		else
		{
			$region = "";
		}

		if (isset($_POST['by_area']))
		{
			$area = implode(',', $_POST['by_area']);
			$area = str_replace(",", "','", $area);
			// $data['area_arr'] = $_POST['by_area'];
			$title = $area;
		}
		else
		{
			$area = "";
			// $data['area_arr'] = $data['area'];
			$title = "NATIONAL";
		}

		if(isset($_POST['by_month']))
		{
			$month = $_POST['by_month'];
		}else
		{
			$month = date('m');
		}

		if(isset($_POST['by_year']))
		{
			$year = $_POST['by_year'];
		}else
		{
			$year = date('Y');
		}

		$fromdate = '-' .$month. '-1';
		$todate = '-' .$month. '-31';

		$data['sku_name'] = $this->model('SkuModel')->getItemNameSKURiemann();
		$data['sku_group'] = $this->model('SkuModel')->getGroupSKURiemann();
		$data['sku_count'] = $this->model('SkuModel')->getCountSKURiemann();
		$data['sku_code'] = $this->model('SkuModel')->getItemCodeSKURiemann();

		$dateObj   = DateTime::createFromFormat('!m', $month);
		$monthName = $dateObj->format('F'); // March

		$sheet->setCellValue('A1', "Report Distribution - RIEMANN"); // Set kolom A1 dengan tulisan "Report Selling In - By Outlet"
		$sheet->setCellValue('A2', "Island : " . $island); // Set kolom A2 dengan tulisan "Outlet Type : EC_EC"
		$sheet->setCellValue('A3', "Region : " . $region); // Set kolom A3 dengan tulisan "Outlet Type : EC_EC"
		$sheet->setCellValue('A4', "Area : " . $area);
		$sheet->setCellValue('A5', "Month : " . $monthName . " - " .$year);
		//$sheet->mergeCells('A1:F1'); // Set Merge Cell pada kolom A1 sampai F1
		$sheet->getStyle('A1')->getFont()->setBold(true); // Set bold kolom A1
		$sheet->getStyle('A2')->getFont()->setBold(true); // Set bold kolom A2
		$sheet->getStyle('A3')->getFont()->setBold(true); // Set bold kolom A3
		$sheet->getStyle('A4')->getFont()->setBold(true);
		$sheet->getStyle('A5')->getFont()->setBold(true);
		$sheet->getStyle('A1')->getFont()->setSize(20); // Set font size 15 untuk kolom A1
		// Buat header tabel nya pada baris ke 7
		$sheet->setCellValue('A7', "#"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('A7:A9'); // Set Merge Row pada kolom A6 sampai A8
		$sheet->setCellValue('B7', "TYPE OF OUTLET"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('B7:B9'); // Set Merge Row pada kolom A6 sampai A8
		$sheet->setCellValue('C7', "Code"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('C7:C9'); // Set Merge Row pada kolom A6 sampai A8
		$sheet->setCellValue('D7', "RO"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('D7:D9');
		$start_col = 5;

		foreach ($data['sku_group'] as $row_sku) :
			//$sheet->setCellValue('E7', $row_sku['item_group']);
			$sheet->setCellValueByColumnAndRow($start_col, 7, $row_sku['item_group']);
			$last_col = $start_col + ($row_sku['count_name']*2) - 1;
			$sheet->mergeCellsByColumnAndRow($start_col, 7, $last_col, 7);
			$start_col = $last_col + 1;
		endforeach;

		$sheet->setCellValueByColumnAndRow($start_col, 7, 'TOTAL');
		$sheet->mergeCellsByColumnAndRow($start_col, 7, $start_col + 1 , 8);

		$start_col = 5;
		foreach ($data['sku_name'] as $row_sku) :
			//$sheet->setCellValue('E7', $row_sku['item_group']);
			$sheet->setCellValueByColumnAndRow($start_col, 8, $row_sku['item_name']);
			$last_col = $start_col + 1;
			$sheet->mergeCellsByColumnAndRow($start_col, 8, $last_col, 8);
			$start_col = $last_col + 1;
		endforeach;
		$start_col = 5;
		foreach ($data['sku_name'] as $row_sku) :
			$sheet->setCellValueByColumnAndRow($start_col, 9, "DISTR. NO'S");
			$start_col = $start_col + 1;
			$sheet->setCellValueByColumnAndRow($start_col, 9, "%");
			$start_col = $start_col + 1;
		endforeach;

		$sheet->setCellValueByColumnAndRow($start_col, 9, "DISTR. NO'S");
		$sheet->setCellValueByColumnAndRow($start_col + 1, 9, "%");
		
		// Apply style header yang telah kita buat tadi ke masing-masing kolom header
		$sheet->getStyleByColumnAndRow(1, 8, $last_col, 8)->getAlignment()->setWrapText(true);
		$sheet->getStyleByColumnAndRow(1, 9, $last_col, 9)->getAlignment()->setWrapText(true);
		$sheet->getStyleByColumnAndRow(1, 7, $last_col, 9)->applyFromArray($style_range);
		$sheet->getStyleByColumnAndRow(1, 7, $last_col, 9)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');
		$sheet->getStyleByColumnAndRow($last_col + 1, 7, $last_col + 2, 9)->getAlignment()->setWrapText(true);
		$sheet->getStyleByColumnAndRow($last_col + 1, 7, $last_col + 2, 9)->applyFromArray($style_range);
		$sheet->getStyleByColumnAndRow($last_col + 1, 7, $last_col + 2, 9)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FF6D6D');

		// Set height baris ke 1, 2 dan 3
		$sheet->getRowDimension('1')->setRowHeight(40);
		$sheet->getRowDimension('2')->setRowHeight(20);
		$sheet->getRowDimension('3')->setRowHeight(20);
		$sheet->getRowDimension('4')->setRowHeight(20);
		$sheet->getRowDimension('5')->setRowHeight(20);
		$sheet->getRowDimension('8')->setRowHeight(60);

		$no = 1; // Untuk penomoran tabel, di awal set dengan 1
		$row = 10;

		$data1 = array(
			'island' => $island,
			'region' => $region,
			'area' => $area,
			'month' => $month,
			'year' => $year
		);

		$data['distr_riemann'] = $this->model('ReportModel')->getDistr_riemann_ALL($data);

		$data_col = 1;
		$data_row = 10;

		$channel='';

		$total_RO = 0;
		$x=1;
		foreach($data['sku_code'] as $sku):
			$total_d[$x] = 0;
			$total_p[$x] = 0;
			$x++;
		endforeach;
		
		$total_dAll = 0;
		$total_pAll = 0;

		foreach ($data['distr_riemann'] as $rows) :
			$data_col = 1;

			if ($channel != $rows['channel'])
            {
				$channel = $rows['channel'];
				$sheet->setCellValueByColumnAndRow($data_col, $data_row, '');
				$sheet->setCellValueByColumnAndRow($data_col + 1, $data_row, $rows['channel']);
				$sheet->setCellValueByColumnAndRow($data_col + 2, $data_row, '');
				$sheet->setCellValueByColumnAndRow($data_col + 3, $data_row, '');
				$a=1;
				$baris=4;
				foreach($data['sku_code'] as $sku):
					$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, '');
					$baris = $baris + 1;
					$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, '');
					$a++;
					$baris++;
				endforeach;
				$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, '');
				$sheet->setCellValueByColumnAndRow($data_col + $baris + 1, $data_row, '');

				$sheet->getStyleByColumnAndRow(1, $data_row, $last_col + 2, $data_row)->applyFromArray($style_range);
				$sheet->getStyleByColumnAndRow(1, $data_row, $last_col + 2, $data_row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('d9e1f2');

				$data_row++;

			}

			$sheet->setCellValueByColumnAndRow($data_col, $data_row, $no);
			$sheet->setCellValueByColumnAndRow($data_col + 1, $data_row, $rows['desc_type']);
			$sheet->setCellValueByColumnAndRow($data_col + 2, $data_row, $rows['outlet_type']);
			$sheet->setCellValueByColumnAndRow($data_col + 3, $data_row, $rows['RO']);
			$sheet->getStyleByColumnAndRow($data_col + 3, $data_row)->getNumberFormat()->setFormatCode('#,##0');
			$a=1;
			$baris=4;
			foreach($data['sku_code'] as $sku):
				$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($rows['d'.$a], 0));
				$sheet->getStyleByColumnAndRow($data_col + $baris, $data_row)->getNumberFormat()->setFormatCode('#,##0');
				$baris = $baris + 1;
				$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($rows['%'.$a], 2));
				$a++;
				$baris++;
			endforeach;
			
			$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, $rows['dtotal']);
			$sheet->getStyleByColumnAndRow($data_col + $baris, $data_row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->setCellValueByColumnAndRow($data_col + $baris + 1, $data_row, number_format($rows['%total'], 0));

			$total_RO += $rows['RO'];
			$x = 1;
			foreach($data['sku_code'] as $sku):
				$total_d[$x] += $rows['d'.$x];
				if($total_RO==0)
				{
					$total_p[$x] = 0;
				}
				else
				{
					$total_p[$x] = ($total_d[$x]/$total_RO)*100;
				} 
				//$total_p[$x] = ($total_d[$x]/($total_RO ?: 1))*100;
				$x++;
			endforeach;
			
			$total_dAll += $rows['dtotal'];

			
			// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
			$sheet->getStyleByColumnAndRow(1, $data_row, $last_col + 2, $data_row)->applyFromArray($style_range_row);
			$sheet->getStyleByColumnAndRow(1, $data_row, null, $data_row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyleByColumnAndRow(2, $data_row, null, $data_row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyleByColumnAndRow(3, $data_row, null, $data_row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyleByColumnAndRow(4, 10, $last_col + 2, $data_row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

			$no++; // Tambah 1 setiap kali looping
    		$row++; // Tambah 1 setiap kali looping
			$data_row++;
		endforeach;

		if($total_RO==0)
		{
			$total_pAll = 0;
		}
		else
		{
			$total_pAll = ($total_dAll/$total_RO)*100;
		}
		//$total_pAll = ($total_dAll/($total_RO ?: 1))*100;

		//$data_row = $data_row + 1;

		$sheet->setCellValueByColumnAndRow($data_col, $data_row, '');
		$sheet->setCellValueByColumnAndRow($data_col + 1, $data_row, 'TOTAL');
		$sheet->setCellValueByColumnAndRow($data_col + 2, $data_row, '');
		$sheet->setCellValueByColumnAndRow($data_col + 3, $data_row, $total_RO);
		$sheet->getStyleByColumnAndRow($data_col + 3, $data_row)->getNumberFormat()->setFormatCode('#,##0');
		$a=1;
		$baris=4;
		foreach($data['sku_code'] as $sku):
			$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($total_d[$a], 0));
			$sheet->getStyleByColumnAndRow($data_col + $baris, $data_row)->getNumberFormat()->setFormatCode('#,##0');
			$baris = $baris + 1;
			$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($total_p[$a], 2));
			$a++;
			$baris++;
		endforeach;
		
		$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, $total_dAll);
		$sheet->getStyleByColumnAndRow($data_col + $baris, $data_row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->setCellValueByColumnAndRow($data_col + $baris + 1, $data_row, number_format($total_pAll, 2));

		$sheet->getStyleByColumnAndRow(1, $data_row, $last_col + 2, $data_row)->applyFromArray($style_range);
		$sheet->getStyleByColumnAndRow(1, $data_row, $last_col + 2, $data_row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFA07A');

		$sheet->getStyleByColumnAndRow(4, 10, $last_col + 2, $data_row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		

		$sheet->getColumnDimension('A')->setWidth(5); // Set width kolom A
		$sheet->getColumnDimension('B')->setWidth(40); // Set width kolom B
		$sheet->getColumnDimension('C')->setWidth(11); // Set width kolom C
		$sheet->getColumnDimension('D')->setWidth(10);

		// Set orientasi kertas jadi LANDSCAPE
		$sheet->getPageSetup()->setOrientation(\PhpOffice\PhpSpreadsheet\Worksheet\PageSetup::ORIENTATION_LANDSCAPE);
		// Set judul file excel nya
		$sheet->setTitle('Distribution - RIEMANN');
		// Proses file excel
		header('Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet');
		header('Content-Disposition: attachment; filename="Report Distribution - RIEMANN.xlsx"'); // Set nama file excel nya
		header('Cache-Control: max-age=0');

		$writer = new Xlsx($spreadsheet);
		$writer->save('php://output');


	}

	public function export_distribution_riemann_area()
	{
		$data['area'] = $this->model('AreaModel')->getAllArea();

		$spreadsheet = new Spreadsheet();
		$sheet = $spreadsheet->getActiveSheet();
		$sheet_arr = [];
		// Buat sebuah variabel untuk menampung pengaturan style dari header tabel
		$style_col = [
			'font' => ['bold' => true], // Set font nya jadi bold
			'alignment' => [
				'horizontal' => \PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER, // Set text jadi ditengah secara horizontal (center)
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'top' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border top dengan garis tipis
				'right' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN],  // Set border right dengan garis tipis
				'bottom' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border bottom dengan garis tipis
				'left' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN] // Set border left dengan garis tipis
			]
		];

		$style_range = [
			'font' => ['bold' => true], // Set font nya jadi bold
			'alignment' => [
				'horizontal' => \PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER, // Set text jadi ditengah secara horizontal (center)
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'allBorders' => [
					'borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN, // Set border top dengan garis tipis
				]
			]
		];

		$style_range_row = [
			'alignment' => [
				'horizontal' => \PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER, // Set text jadi ditengah secara horizontal (center)
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'allBorders' => [
					'borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN, // Set border top dengan garis tipis
				]
			]
		];

		// Buat sebuah variabel untuk menampung pengaturan style dari isi tabel
		$style_row = [
			'alignment' => [
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'top' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border top dengan garis tipis
				'right' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN],  // Set border right dengan garis tipis
				'bottom' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border bottom dengan garis tipis
				'left' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN] // Set border left dengan garis tipis
			]
		];


		if (isset($_POST['by_island']))
		{
			$island = $_POST['by_island'];
		}
		else
		{
			$island = "";
		}

		if (isset($_POST['by_region']))
		{
			$region = $_POST['by_region'];
		}
		else
		{
			$region = "";
		}

		if (isset($_POST['by_area']))
		{
			$area = implode(',', $_POST['by_area']);
			$area2 = implode(',', $_POST['by_area']);
			$area = str_replace(",", "','", $area);
			// $area3 = "'" . $area . "'";
			$data['area_arr'] = $this->model('AreaModel')->getArea($area);
			$title = "COMBINED AREA";
		}
		else
		{
			$area = "";
			$data['area_arr'] = $data['area'];
			$title = "NATIONAL";
		}

		if(isset($_POST['by_month']))
		{
			$month = $_POST['by_month'];
		}else
		{
			$month = date('m');
		}

		if(isset($_POST['by_year']))
		{
			$year = $_POST['by_year'];
		}else
		{
			$year = date('Y');
		}

		$fromdate = '-' .$month. '-1';
		$todate = '-' .$month. '-31';

		$data['sku_name'] = $this->model('SkuModel')->getItemNameSKURiemann();
		$data['sku_group'] = $this->model('SkuModel')->getGroupSKURiemann();
		$data['sku_count'] = $this->model('SkuModel')->getCountSKURiemann();
		$data['sku_code'] = $this->model('SkuModel')->getItemCodeRiemann();

		$dateObj   = DateTime::createFromFormat('!m', $month);
		$monthName = $dateObj->format('F'); // March

		$sheet->setCellValue('A1', "Report Distribution - RIEMANN"); // Set kolom A1 dengan tulisan "Report Selling In - By Outlet"
		$sheet->setCellValue('A2', "Island : " . $island); // Set kolom A2 dengan tulisan "Outlet Type : EC_EC"
		$sheet->setCellValue('A3', "Region : " . $region); // Set kolom A3 dengan tulisan "Outlet Type : EC_EC"
		$sheet->setCellValue('A4', "Area : " . $area2);
		$sheet->setCellValue('A5', "Month : " . $monthName . " - " .$year);
		//$sheet->mergeCells('A1:F1'); // Set Merge Cell pada kolom A1 sampai F1
		$sheet->getStyle('A1')->getFont()->setBold(true); // Set bold kolom A1
		$sheet->getStyle('A2')->getFont()->setBold(true); // Set bold kolom A2
		$sheet->getStyle('A3')->getFont()->setBold(true); // Set bold kolom A3
		$sheet->getStyle('A4')->getFont()->setBold(true);
		$sheet->getStyle('A5')->getFont()->setBold(true);
		$sheet->getStyle('A1')->getFont()->setSize(20); // Set font size 15 untuk kolom A1
		// Buat header tabel nya pada baris ke 7
		$sheet->setCellValue('A7', "#"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('A7:A9'); // Set Merge Row pada kolom A6 sampai A8
		$sheet->setCellValue('B7', "TYPE OF OUTLET"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('B7:B9'); // Set Merge Row pada kolom A6 sampai A8
		$sheet->setCellValue('C7', "Code"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('C7:C9'); // Set Merge Row pada kolom A6 sampai A8
		$sheet->setCellValue('D7', "RO"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('D7:D9');
		$start_col = 5;

		foreach ($data['sku_group'] as $row_sku) :
			//$sheet->setCellValue('E7', $row_sku['item_group']);
			$sheet->setCellValueByColumnAndRow($start_col, 7, $row_sku['item_group']);
			$last_col = $start_col + ($row_sku['count_name']*2) - 1;
			$sheet->mergeCellsByColumnAndRow($start_col, 7, $last_col, 7);
			$start_col = $last_col + 1;
		endforeach;

		$sheet->setCellValueByColumnAndRow($start_col, 7, 'TOTAL');
		$sheet->mergeCellsByColumnAndRow($start_col, 7, $start_col + 1 , 8);

		$start_col = 5;
		foreach ($data['sku_name'] as $row_sku) :
			//$sheet->setCellValue('E7', $row_sku['item_group']);
			$sheet->setCellValueByColumnAndRow($start_col, 8, $row_sku['item_name']);
			$last_col = $start_col + 1;
			$sheet->mergeCellsByColumnAndRow($start_col, 8, $last_col, 8);
			$start_col = $last_col + 1;
		endforeach;
		$start_col = 5;
		foreach ($data['sku_name'] as $row_sku) :
			$sheet->setCellValueByColumnAndRow($start_col, 9, "DISTR. NO'S");
			$start_col = $start_col + 1;
			$sheet->setCellValueByColumnAndRow($start_col, 9, "%");
			$start_col = $start_col + 1;
		endforeach;

		$sheet->setCellValueByColumnAndRow($start_col, 9, "DISTR. NO'S");
		$sheet->setCellValueByColumnAndRow($start_col + 1, 9, "%");
		
		// Apply style header yang telah kita buat tadi ke masing-masing kolom header
		$sheet->getStyleByColumnAndRow(1, 8, $last_col, 8)->getAlignment()->setWrapText(true);
		$sheet->getStyleByColumnAndRow(1, 9, $last_col, 9)->getAlignment()->setWrapText(true);
		$sheet->getStyleByColumnAndRow(1, 7, $last_col, 9)->applyFromArray($style_range);
		$sheet->getStyleByColumnAndRow(1, 7, $last_col, 9)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');
		$sheet->getStyleByColumnAndRow($last_col + 1, 7, $last_col + 2, 9)->getAlignment()->setWrapText(true);
		$sheet->getStyleByColumnAndRow($last_col + 1, 7, $last_col + 2, 9)->applyFromArray($style_range);
		$sheet->getStyleByColumnAndRow($last_col + 1, 7, $last_col + 2, 9)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FF6D6D');

		// Set height baris ke 1, 2 dan 3
		$sheet->getRowDimension('1')->setRowHeight(40);
		$sheet->getRowDimension('2')->setRowHeight(20);
		$sheet->getRowDimension('3')->setRowHeight(20);
		$sheet->getRowDimension('4')->setRowHeight(20);
		$sheet->getRowDimension('5')->setRowHeight(20);
		$sheet->getRowDimension('8')->setRowHeight(60);

		$no = 1; // Untuk penomoran tabel, di awal set dengan 1
		$row = 10;

		// $data1 = array(
		// 	'island' => $island,
		// 	'region' => $region,
		// 	'area' => $area,
		// 	'month' => $month,
		// 	'year' => $year
		// );

		$data['distr_riemann'] = $this->model('ReportModel')->getDistr_riemann_ALL($data);

		$data_col = 1;
		$data_row = 10;

		$channel='';

		$total_RO = 0;
		$x=1;
		foreach($data['sku_code'] as $sku):
			$total_d[$x] = 0;
			$total_p[$x] = 0;
			$x++;
		endforeach;
		
		$total_dAll = 0;
		$total_pAll = 0;

		foreach ($data['distr_riemann'] as $rows) :
			$data_col = 1;

			if ($channel != $rows['channel'])
            {
				$channel = $rows['channel'];
				$sheet->setCellValueByColumnAndRow($data_col, $data_row, '');
				$sheet->setCellValueByColumnAndRow($data_col + 1, $data_row, $rows['channel']);
				$sheet->setCellValueByColumnAndRow($data_col + 2, $data_row, '');
				$sheet->setCellValueByColumnAndRow($data_col + 3, $data_row, '');
				$a=1;
				$baris=4;
				foreach($data['sku_code'] as $sku):
					$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, '');
					$baris = $baris + 1;
					$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, '');
					$a++;
					$baris++;
				endforeach;
				$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, '');
				$sheet->setCellValueByColumnAndRow($data_col + $baris + 1, $data_row, '');

				$sheet->getStyleByColumnAndRow(1, $data_row, $last_col + 2, $data_row)->applyFromArray($style_range);
				$sheet->getStyleByColumnAndRow(1, $data_row, $last_col + 2, $data_row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('d9e1f2');

				$data_row++;

			}

			$sheet->setCellValueByColumnAndRow($data_col, $data_row, $no);
			$sheet->setCellValueByColumnAndRow($data_col + 1, $data_row, $rows['desc_type']);
			$sheet->setCellValueByColumnAndRow($data_col + 2, $data_row, $rows['outlet_type']);
			$sheet->setCellValueByColumnAndRow($data_col + 3, $data_row, $rows['RO']);
			$sheet->getStyleByColumnAndRow($data_col + 3, $data_row)->getNumberFormat()->setFormatCode('#,##0');
			$a=1;
			$baris=4;
			foreach($data['sku_code'] as $sku):
				$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($rows['d'.$a], 0));
				$sheet->getStyleByColumnAndRow($data_col + $baris, $data_row)->getNumberFormat()->setFormatCode('#,##0');
				$baris = $baris + 1;
				$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($rows['%'.$a], 2));
				$a++;
				$baris++;
			endforeach;
			
			$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, $rows['dtotal']);
			$sheet->getStyleByColumnAndRow($data_col + $baris, $data_row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->setCellValueByColumnAndRow($data_col + $baris + 1, $data_row, number_format($rows['%total'], 0));

			$total_RO += $rows['RO'];
			$x = 1;
			foreach($data['sku_code'] as $sku):
				$total_d[$x] += $rows['d'.$x];
				if($total_RO==0)
				{
					$total_p[$x] = 0;
				}
				else
				{
					$total_p[$x] = ($total_d[$x]/$total_RO)*100;
				} 
				//$total_p[$x] = ($total_d[$x]/($total_RO ?: 1))*100;
				$x++;
			endforeach;
			
			$total_dAll += $rows['dtotal'];

			
			// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
			$sheet->getStyleByColumnAndRow(1, $data_row, $last_col + 2, $data_row)->applyFromArray($style_range_row);
			$sheet->getStyleByColumnAndRow(1, $data_row, null, $data_row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyleByColumnAndRow(2, $data_row, null, $data_row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyleByColumnAndRow(3, $data_row, null, $data_row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyleByColumnAndRow(4, 10, $last_col + 2, $data_row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

			$no++; // Tambah 1 setiap kali looping
    		$row++; // Tambah 1 setiap kali looping
			$data_row++;
		endforeach;

		if($total_RO==0)
		{
			$total_pAll = 0;
		}
		else
		{
			$total_pAll = ($total_dAll/$total_RO)*100;
		}
		//$total_pAll = ($total_dAll/($total_RO ?: 1))*100;

		//$data_row = $data_row + 1;

		$sheet->setCellValueByColumnAndRow($data_col, $data_row, '');
		$sheet->setCellValueByColumnAndRow($data_col + 1, $data_row, 'TOTAL');
		$sheet->setCellValueByColumnAndRow($data_col + 2, $data_row, '');
		$sheet->setCellValueByColumnAndRow($data_col + 3, $data_row, $total_RO);
		$sheet->getStyleByColumnAndRow($data_col + 3, $data_row)->getNumberFormat()->setFormatCode('#,##0');
		$a=1;
		$baris=4;
		foreach($data['sku_code'] as $sku):
			$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($total_d[$a], 0));
			$sheet->getStyleByColumnAndRow($data_col + $baris, $data_row)->getNumberFormat()->setFormatCode('#,##0');
			$baris = $baris + 1;
			$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($total_p[$a], 2));
			$a++;
			$baris++;
		endforeach;
		
		$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, $total_dAll);
		$sheet->getStyleByColumnAndRow($data_col + $baris, $data_row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->setCellValueByColumnAndRow($data_col + $baris + 1, $data_row, number_format($total_pAll, 2));

		$sheet->getStyleByColumnAndRow(1, $data_row, $last_col + 2, $data_row)->applyFromArray($style_range);
		$sheet->getStyleByColumnAndRow(1, $data_row, $last_col + 2, $data_row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFA07A');

		$sheet->getStyleByColumnAndRow(4, 10, $last_col + 2, $data_row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		

		$sheet->getColumnDimension('A')->setWidth(5); // Set width kolom A
		$sheet->getColumnDimension('B')->setWidth(40); // Set width kolom B
		$sheet->getColumnDimension('C')->setWidth(11); // Set width kolom C
		$sheet->getColumnDimension('D')->setWidth(10);

		// Set orientasi kertas jadi LANDSCAPE
		$sheet->getPageSetup()->setOrientation(\PhpOffice\PhpSpreadsheet\Worksheet\PageSetup::ORIENTATION_LANDSCAPE);
		// Set judul file excel nya
		$sheet->setTitle($title);
		
		if(count($data['area_arr']) > 1)
		{
			$arr = 0;
			foreach($data['area_arr'] as $areas):
				$sheet_arr[$arr] = $spreadsheet->createSheet();
				// $sheet_arr[$arr] = $spreadsheet->getActiveSheet();

				$sheet_arr[$arr]->setCellValue('A1', "Report Distribution - RIEMANN"); // Set kolom A1 dengan tulisan "Report Selling In - By Outlet"
				$sheet_arr[$arr]->setCellValue('A2', "Island : " . $island); // Set kolom A2 dengan tulisan "Outlet Type : EC_EC"
				$sheet_arr[$arr]->setCellValue('A3', "Region : " . $region); // Set kolom A3 dengan tulisan "Outlet Type : EC_EC"
				$sheet_arr[$arr]->setCellValue('A4', "Area : " . $areas['area']);
				$sheet_arr[$arr]->setCellValue('A5', "Month : " . $monthName . " - " .$year);
				//$sheet_arr[$arr]->mergeCells('A1:F1'); // Set Merge Cell pada kolom A1 sampai F1
				$sheet_arr[$arr]->getStyle('A1')->getFont()->setBold(true); // Set bold kolom A1
				$sheet_arr[$arr]->getStyle('A2')->getFont()->setBold(true); // Set bold kolom A2
				$sheet_arr[$arr]->getStyle('A3')->getFont()->setBold(true); // Set bold kolom A3
				$sheet_arr[$arr]->getStyle('A4')->getFont()->setBold(true);
				$sheet_arr[$arr]->getStyle('A5')->getFont()->setBold(true);
				$sheet_arr[$arr]->getStyle('A1')->getFont()->setSize(20); // Set font size 15 untuk kolom A1
				// Buat header tabel nya pada baris ke 7
				$sheet_arr[$arr]->setCellValue('A7', "#"); // Set kolom A6 dengan tulisan "NO"
				$sheet_arr[$arr]->mergeCells('A7:A9'); // Set Merge Row pada kolom A6 sampai A8
				$sheet_arr[$arr]->setCellValue('B7', "TYPE OF OUTLET"); // Set kolom A6 dengan tulisan "NO"
				$sheet_arr[$arr]->mergeCells('B7:B9'); // Set Merge Row pada kolom A6 sampai A8
				$sheet_arr[$arr]->setCellValue('C7', "Code"); // Set kolom A6 dengan tulisan "NO"
				$sheet_arr[$arr]->mergeCells('C7:C9'); // Set Merge Row pada kolom A6 sampai A8
				$sheet_arr[$arr]->setCellValue('D7', "RO"); // Set kolom A6 dengan tulisan "NO"
				$sheet_arr[$arr]->mergeCells('D7:D9');
				$start_col = 5;

				foreach ($data['sku_group'] as $row_sku) :
					$sheet_arr[$arr]->setCellValueByColumnAndRow($start_col, 7, $row_sku['item_group']);
					$last_col = $start_col + ($row_sku['count_name']*2) - 1;
					$sheet_arr[$arr]->mergeCellsByColumnAndRow($start_col, 7, $last_col, 7);
					$start_col = $last_col + 1;
				endforeach;

				$sheet_arr[$arr]->setCellValueByColumnAndRow($start_col, 7, 'TOTAL');
				$sheet_arr[$arr]->mergeCellsByColumnAndRow($start_col, 7, $start_col + 1 , 8);

				$start_col = 5;
				foreach ($data['sku_name'] as $row_sku) :
					$sheet_arr[$arr]->setCellValueByColumnAndRow($start_col, 8, $row_sku['item_name']);
					$last_col = $start_col + 1;
					$sheet_arr[$arr]->mergeCellsByColumnAndRow($start_col, 8, $last_col, 8);
					$start_col = $last_col + 1;
				endforeach;
				$start_col = 5;
				foreach ($data['sku_name'] as $row_sku) :
					$sheet_arr[$arr]->setCellValueByColumnAndRow($start_col, 9, "DISTR. NO'S");
					$start_col = $start_col + 1;
					$sheet_arr[$arr]->setCellValueByColumnAndRow($start_col, 9, "%");
					$start_col = $start_col + 1;
				endforeach;

				$sheet_arr[$arr]->setCellValueByColumnAndRow($start_col, 9, "DISTR. NO'S");
				$sheet_arr[$arr]->setCellValueByColumnAndRow($start_col + 1, 9, "%");
				
				// Apply style header yang telah kita buat tadi ke masing-masing kolom header
				$sheet_arr[$arr]->getStyleByColumnAndRow(1, 8, $last_col, 8)->getAlignment()->setWrapText(true);
				$sheet_arr[$arr]->getStyleByColumnAndRow(1, 9, $last_col, 9)->getAlignment()->setWrapText(true);
				$sheet_arr[$arr]->getStyleByColumnAndRow(1, 7, $last_col, 9)->applyFromArray($style_range);
				$sheet_arr[$arr]->getStyleByColumnAndRow(1, 7, $last_col, 9)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');
				$sheet_arr[$arr]->getStyleByColumnAndRow($last_col + 1, 7, $last_col + 2, 9)->getAlignment()->setWrapText(true);
				$sheet_arr[$arr]->getStyleByColumnAndRow($last_col + 1, 7, $last_col + 2, 9)->applyFromArray($style_range);
				$sheet_arr[$arr]->getStyleByColumnAndRow($last_col + 1, 7, $last_col + 2, 9)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FF6D6D');

				// Set height baris ke 1, 2 dan 3
				$sheet_arr[$arr]->getRowDimension('1')->setRowHeight(40);
				$sheet_arr[$arr]->getRowDimension('2')->setRowHeight(20);
				$sheet_arr[$arr]->getRowDimension('3')->setRowHeight(20);
				$sheet_arr[$arr]->getRowDimension('4')->setRowHeight(20);
				$sheet_arr[$arr]->getRowDimension('5')->setRowHeight(20);
				$sheet_arr[$arr]->getRowDimension('8')->setRowHeight(60);

				$no = 1; // Untuk penomoran tabel, di awal set dengan 1
				$row = 10;

				$data1 = array(
					'island' => $island,
					'region' => $region,
					'area' => $areas['area'],
					'month' => $month,
					'year' => $year
				);

				$data['distr_riemann_area'] = $this->model('ReportModel')->getDistr_riemann_ALL_Area($data1);

				$data_col = 1;
				$data_row = 10;

				$channel='';

				$total_RO = 0;
				$x=1;
				foreach($data['sku_code'] as $sku):
					$total_d[$x] = 0;
					$total_p[$x] = 0;
					$x++;
				endforeach;
				
				$total_dAll = 0;
				$total_pAll = 0;

				foreach ($data['distr_riemann_area'] as $row3) :
					$data_col = 1;

					if ($channel != $row3['channel'])
					{
						$channel = $row3['channel'];
						$sheet_arr[$arr]->setCellValueByColumnAndRow($data_col, $data_row, '');
						$sheet_arr[$arr]->setCellValueByColumnAndRow($data_col + 1, $data_row, $row3['channel']);
						$sheet_arr[$arr]->setCellValueByColumnAndRow($data_col + 2, $data_row, '');
						$sheet_arr[$arr]->setCellValueByColumnAndRow($data_col + 3, $data_row, '');
						$a=1;
						$baris=4;
						foreach($data['sku_code'] as $sku):
							$sheet_arr[$arr]->setCellValueByColumnAndRow($data_col + $baris, $data_row, '');
							$baris = $baris + 1;
							$sheet_arr[$arr]->setCellValueByColumnAndRow($data_col + $baris, $data_row, '');
							$a++;
							$baris++;
						endforeach;
						$sheet_arr[$arr]->setCellValueByColumnAndRow($data_col + $baris, $data_row, '');
						$sheet_arr[$arr]->setCellValueByColumnAndRow($data_col + $baris + 1, $data_row, '');

						$sheet_arr[$arr]->getStyleByColumnAndRow(1, $data_row, $last_col + 2, $data_row)->applyFromArray($style_range);
						$sheet_arr[$arr]->getStyleByColumnAndRow(1, $data_row, $last_col + 2, $data_row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('d9e1f2');

						$data_row++;

					}

					$sheet_arr[$arr]->setCellValueByColumnAndRow($data_col, $data_row, $no);
					$sheet_arr[$arr]->setCellValueByColumnAndRow($data_col + 1, $data_row, $row3['desc_type']);
					$sheet_arr[$arr]->setCellValueByColumnAndRow($data_col + 2, $data_row, $row3['outlet_type']);
					$sheet_arr[$arr]->setCellValueByColumnAndRow($data_col + 3, $data_row, $row3['RO']);
					$sheet_arr[$arr]->getStyleByColumnAndRow($data_col + 3, $data_row)->getNumberFormat()->setFormatCode('#,##0');
					$a=1;
					$baris=4;
					foreach($data['sku_code'] as $sku):
						$sheet_arr[$arr]->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($row3['d'.$a], 0));
						$sheet_arr[$arr]->getStyleByColumnAndRow($data_col + $baris, $data_row)->getNumberFormat()->setFormatCode('#,##0');
						$baris = $baris + 1;
						$sheet_arr[$arr]->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($row3['%'.$a], 2));
						$a++;
						$baris++;
					endforeach;
					
					$sheet_arr[$arr]->setCellValueByColumnAndRow($data_col + $baris, $data_row, $row3['dtotal']);
					$sheet_arr[$arr]->getStyleByColumnAndRow($data_col + $baris, $data_row)->getNumberFormat()->setFormatCode('#,##0');
					$sheet_arr[$arr]->setCellValueByColumnAndRow($data_col + $baris + 1, $data_row, number_format($row3['%total'], 0));

					$total_RO += $row3['RO'];
					$x = 1;
					foreach($data['sku_code'] as $sku):
						$total_d[$x] += $row3['d'.$x];
						if($total_RO==0)
						{
							$total_p[$x] = 0;
						}
						else
						{
							$total_p[$x] = ($total_d[$x]/$total_RO)*100;
						} 
						//$total_p[$x] = ($total_d[$x]/($total_RO ?: 1))*100;
						$x++;
					endforeach;
					
					$total_dAll += $row3['dtotal'];

					
					// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
					$sheet_arr[$arr]->getStyleByColumnAndRow(1, $data_row, $last_col + 2, $data_row)->applyFromArray($style_range_row);
					$sheet_arr[$arr]->getStyleByColumnAndRow(1, $data_row, null, $data_row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
					$sheet_arr[$arr]->getStyleByColumnAndRow(2, $data_row, null, $data_row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
					$sheet_arr[$arr]->getStyleByColumnAndRow(3, $data_row, null, $data_row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
					$sheet_arr[$arr]->getStyleByColumnAndRow(4, 10, $last_col + 2, $data_row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

					$no++; // Tambah 1 setiap kali looping
					$row++; // Tambah 1 setiap kali looping
					$data_row++;
				endforeach;

				if($total_RO==0)
				{
					$total_pAll = 0;
				}
				else
				{
					$total_pAll = ($total_dAll/$total_RO)*100;
				}
				//$total_pAll = ($total_dAll/($total_RO ?: 1))*100;

				//$data_row = $data_row + 1;

				$sheet_arr[$arr]->setCellValueByColumnAndRow($data_col, $data_row, '');
				$sheet_arr[$arr]->setCellValueByColumnAndRow($data_col + 1, $data_row, 'TOTAL');
				$sheet_arr[$arr]->setCellValueByColumnAndRow($data_col + 2, $data_row, '');
				$sheet_arr[$arr]->setCellValueByColumnAndRow($data_col + 3, $data_row, $total_RO);
				$sheet_arr[$arr]->getStyleByColumnAndRow($data_col + 3, $data_row)->getNumberFormat()->setFormatCode('#,##0');
				$a=1;
				$baris=4;
				foreach($data['sku_code'] as $sku):
					$sheet_arr[$arr]->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($total_d[$a], 0));
					$sheet_arr[$arr]->getStyleByColumnAndRow($data_col + $baris, $data_row)->getNumberFormat()->setFormatCode('#,##0');
					$baris = $baris + 1;
					$sheet_arr[$arr]->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($total_p[$a], 2));
					$a++;
					$baris++;
				endforeach;
				
				$sheet_arr[$arr]->setCellValueByColumnAndRow($data_col + $baris, $data_row, $total_dAll);
				$sheet_arr[$arr]->getStyleByColumnAndRow($data_col + $baris, $data_row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet_arr[$arr]->setCellValueByColumnAndRow($data_col + $baris + 1, $data_row, number_format($total_pAll, 2));

				$sheet_arr[$arr]->getStyleByColumnAndRow(1, $data_row, $last_col + 2, $data_row)->applyFromArray($style_range);
				$sheet_arr[$arr]->getStyleByColumnAndRow(1, $data_row, $last_col + 2, $data_row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFA07A');

				$sheet_arr[$arr]->getStyleByColumnAndRow(4, 10, $last_col + 2, $data_row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				

				$sheet_arr[$arr]->getColumnDimension('A')->setWidth(5); // Set width kolom A
				$sheet_arr[$arr]->getColumnDimension('B')->setWidth(40); // Set width kolom B
				$sheet_arr[$arr]->getColumnDimension('C')->setWidth(11); // Set width kolom C
				$sheet_arr[$arr]->getColumnDimension('D')->setWidth(10);

				// Set orientasi kertas jadi LANDSCAPE
				$sheet_arr[$arr]->getPageSetup()->setOrientation(\PhpOffice\PhpSpreadsheet\Worksheet\PageSetup::ORIENTATION_LANDSCAPE);
				// Set judul file excel nya
				$sheet_arr[$arr]->setTitle($areas['area']);

				$arr++;
			endforeach;
		}
		
		// Proses file excel
		header('Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet');
		header('Content-Disposition: attachment; filename="Report Distribution - RIEMANN (Area Detail).xlsx"'); // Set nama file excel nya
		header('Cache-Control: max-age=0');

		$writer = new Xlsx($spreadsheet);
		$writer->save('php://output');


	}

	public function export_distribution_jordan_newOT()
	{
		$spreadsheet = new Spreadsheet();
		$sheet = $spreadsheet->getActiveSheet();
		// Buat sebuah variabel untuk menampung pengaturan style dari header tabel
		$style_col = [
			'font' => ['bold' => true], // Set font nya jadi bold
			'alignment' => [
				'horizontal' => \PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER, // Set text jadi ditengah secara horizontal (center)
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'top' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border top dengan garis tipis
				'right' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN],  // Set border right dengan garis tipis
				'bottom' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border bottom dengan garis tipis
				'left' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN] // Set border left dengan garis tipis
			]
		];

		$style_range = [
			'font' => ['bold' => true], // Set font nya jadi bold
			'alignment' => [
				'horizontal' => \PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER, // Set text jadi ditengah secara horizontal (center)
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'allBorders' => [
					'borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN, // Set border top dengan garis tipis
				]
			]
		];

		$style_range_row = [
			'alignment' => [
				'horizontal' => \PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER, // Set text jadi ditengah secara horizontal (center)
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'allBorders' => [
					'borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN, // Set border top dengan garis tipis
				]
			]
		];

		// Buat sebuah variabel untuk menampung pengaturan style dari isi tabel
		$style_row = [
			'alignment' => [
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'top' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border top dengan garis tipis
				'right' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN],  // Set border right dengan garis tipis
				'bottom' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border bottom dengan garis tipis
				'left' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN] // Set border left dengan garis tipis
			]
		];


		if (isset($_POST['by_island']))
		{
			$island = $_POST['by_island'];
		}
		else
		{
			$island = "";
		}

		if (isset($_POST['by_region']))
		{
			$region = $_POST['by_region'];
		}
		else
		{
			$region = "";
		}

		if (isset($_POST['by_area']))
		{
			$area = $_POST['by_area'];
		}
		else
		{
			$area = "";
		}

		if(isset($_POST['by_month']))
		{
			$month = $_POST['by_month'];
		}else
		{
			$month = date('m');
		}

		if(isset($_POST['by_year']))
		{
			$year = $_POST['by_year'];
		}else
		{
			$year = date('Y');
		}

		$fromdate = '-' .$month. '-1';
		$todate = '-' .$month. '-31';

		$data['sku_name'] = $this->model('SkuModel')->getItemNameSKUJordan();
		$data['sku_group'] = $this->model('SkuModel')->getGroupSKUJordan();
		$data['sku_count'] = $this->model('SkuModel')->getCountSKUJordan();
		$data['sku_code'] = $this->model('SkuModel')->getItemCodeSKUJordan();

		$dateObj   = DateTime::createFromFormat('!m', $month);
		$monthName = $dateObj->format('F'); // March

		$sheet->setCellValue('A1', "Report Distribution - JORDAN"); // Set kolom A1 dengan tulisan "Report Selling In - By Outlet"
		$sheet->setCellValue('A2', "Island : " . $island); // Set kolom A2 dengan tulisan "Outlet Type : EC_EC"
		$sheet->setCellValue('A3', "Region : " . $region); // Set kolom A3 dengan tulisan "Outlet Type : EC_EC"
		$sheet->setCellValue('A4', "Area : " . $area);
		$sheet->setCellValue('A5', "Month : " . $monthName . " - " .$year);
		//$sheet->mergeCells('A1:F1'); // Set Merge Cell pada kolom A1 sampai F1
		$sheet->getStyle('A1')->getFont()->setBold(true); // Set bold kolom A1
		$sheet->getStyle('A2')->getFont()->setBold(true); // Set bold kolom A2
		$sheet->getStyle('A3')->getFont()->setBold(true); // Set bold kolom A3
		$sheet->getStyle('A4')->getFont()->setBold(true);
		$sheet->getStyle('A5')->getFont()->setBold(true);
		$sheet->getStyle('A1')->getFont()->setSize(20); // Set font size 15 untuk kolom A1
		// Buat header tabel nya pada baris ke 7
		$sheet->setCellValue('A7', "#"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('A7:A9'); // Set Merge Row pada kolom A6 sampai A8
		$sheet->setCellValue('B7', "TYPE OF OUTLET"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('B7:B9'); // Set Merge Row pada kolom A6 sampai A8
		$sheet->setCellValue('C7', "Code"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('C7:C9'); // Set Merge Row pada kolom A6 sampai A8
		$sheet->setCellValue('D7', "RO"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('D7:D9');
		$start_col = 5;

		foreach ($data['sku_group'] as $row_sku) :
			//$sheet->setCellValue('E7', $row_sku['item_group']);
			$sheet->setCellValueByColumnAndRow($start_col, 7, $row_sku['item_group']);
			$last_col = $start_col + ($row_sku['count_name']*2) - 1;
			$sheet->mergeCellsByColumnAndRow($start_col, 7, $last_col, 7);
			$start_col = $last_col + 1;
		endforeach;

		$sheet->setCellValueByColumnAndRow($start_col, 7, 'TOTAL');
		$sheet->mergeCellsByColumnAndRow($start_col, 7, $start_col + 1 , 8);

		$start_col = 5;
		foreach ($data['sku_name'] as $row_sku) :
			//$sheet->setCellValue('E7', $row_sku['item_group']);
			$sheet->setCellValueByColumnAndRow($start_col, 8, $row_sku['item_name']);
			$last_col = $start_col + 1;
			$sheet->mergeCellsByColumnAndRow($start_col, 8, $last_col, 8);
			$start_col = $last_col + 1;
		endforeach;
		$start_col = 5;
		foreach ($data['sku_name'] as $row_sku) :
			$sheet->setCellValueByColumnAndRow($start_col, 9, "DISTR. NO'S");
			$start_col = $start_col + 1;
			$sheet->setCellValueByColumnAndRow($start_col, 9, "%");
			$start_col = $start_col + 1;
		endforeach;

		$sheet->setCellValueByColumnAndRow($start_col, 9, "DISTR. NO'S");
		$sheet->setCellValueByColumnAndRow($start_col + 1, 9, "%");
		
		// Apply style header yang telah kita buat tadi ke masing-masing kolom header
		$sheet->getStyleByColumnAndRow(1, 8, $last_col, 8)->getAlignment()->setWrapText(true);
		$sheet->getStyleByColumnAndRow(1, 9, $last_col, 9)->getAlignment()->setWrapText(true);
		$sheet->getStyleByColumnAndRow(1, 7, $last_col, 9)->applyFromArray($style_range);
		$sheet->getStyleByColumnAndRow(1, 7, $last_col, 9)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');
		$sheet->getStyleByColumnAndRow($last_col + 1, 7, $last_col + 2, 9)->getAlignment()->setWrapText(true);
		$sheet->getStyleByColumnAndRow($last_col + 1, 7, $last_col + 2, 9)->applyFromArray($style_range);
		$sheet->getStyleByColumnAndRow($last_col + 1, 7, $last_col + 2, 9)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FF6D6D');

		// Set height baris ke 1, 2 dan 3
		$sheet->getRowDimension('1')->setRowHeight(40);
		$sheet->getRowDimension('2')->setRowHeight(20);
		$sheet->getRowDimension('3')->setRowHeight(20);
		$sheet->getRowDimension('4')->setRowHeight(20);
		$sheet->getRowDimension('5')->setRowHeight(20);
		$sheet->getRowDimension('8')->setRowHeight(60);

		$no = 1; // Untuk penomoran tabel, di awal set dengan 1
		$row = 10;

		$data1 = array(
			'island' => $island,
			'region' => $region,
			'area' => $area,
			'month' => $month,
			'year' => $year
		);

		$data['distr_jordan'] = $this->model('ReportModel')->getDistr_jordan_new_OT($data);

		$data_col = 1;
		$data_row = 10;

		$channel='';

		$total_RO = 0;
		$x=1;
		foreach($data['sku_code'] as $sku):
			$total_d[$x] = 0;
			$total_p[$x] = 0;
			$x++;
		endforeach;
		
		$total_dAll = 0;
		$total_pAll = 0;

		foreach ($data['distr_jordan'] as $rows) :
			$data_col = 1;

			if ($channel != $rows['channel'])
            {
				$channel = $rows['channel'];
				$sheet->setCellValueByColumnAndRow($data_col, $data_row, '');
				$sheet->setCellValueByColumnAndRow($data_col + 1, $data_row, $rows['channel']);
				$sheet->setCellValueByColumnAndRow($data_col + 2, $data_row, '');
				$sheet->setCellValueByColumnAndRow($data_col + 3, $data_row, '');
				$a=1;
				$baris=4;
				foreach($data['sku_code'] as $sku):
					$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, '');
					$baris = $baris + 1;
					$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, '');
					$a++;
					$baris++;
				endforeach;
				$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, '');
				$sheet->setCellValueByColumnAndRow($data_col + $baris + 1, $data_row, '');

				$sheet->getStyleByColumnAndRow(1, $data_row, $last_col + 2, $data_row)->applyFromArray($style_range);
				$sheet->getStyleByColumnAndRow(1, $data_row, $last_col + 2, $data_row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('d9e1f2');

				$data_row++;

			}

			$sheet->setCellValueByColumnAndRow($data_col, $data_row, $no);
			$sheet->setCellValueByColumnAndRow($data_col + 1, $data_row, $rows['desc_type']);
			$sheet->setCellValueByColumnAndRow($data_col + 2, $data_row, $rows['outlet_type']);
			$sheet->setCellValueByColumnAndRow($data_col + 3, $data_row, number_format($rows['RO'], 0));
			$a=1;
			$baris=4;
			foreach($data['sku_code'] as $sku):
				$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($rows['d'.$a], 0));
				$baris = $baris + 1;
				$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($rows['%'.$a], 2));
				$a++;
				$baris++;
			endforeach;
			
			$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($rows['dtotal'], 0));
			$sheet->setCellValueByColumnAndRow($data_col + $baris + 1, $data_row, number_format($rows['%total'], 0));

			$total_RO += $rows['RO'];
			$x = 1;
			foreach($data['sku_code'] as $sku):
				$total_d[$x] += $rows['d'.$x];
				$total_p[$x] = ($total_d[$x]/($total_RO ?: 1))*100;
				$x++;
			endforeach;
			
			$total_dAll += $rows['dtotal'];

			
			// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
			$sheet->getStyleByColumnAndRow(1, $data_row, $last_col + 2, $data_row)->applyFromArray($style_range_row);
			$sheet->getStyleByColumnAndRow(1, $data_row, null, $data_row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyleByColumnAndRow(2, $data_row, null, $data_row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyleByColumnAndRow(3, $data_row, null, $data_row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyleByColumnAndRow(4, 10, $last_col + 2, $data_row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

			$no++; // Tambah 1 setiap kali looping
    		$row++; // Tambah 1 setiap kali looping
			$data_row++;
		endforeach;

		$total_pAll = ($total_dAll/($total_RO ?: 1))*100;

		//$data_row = $data_row + 1;

		$sheet->setCellValueByColumnAndRow($data_col, $data_row, '');
		$sheet->setCellValueByColumnAndRow($data_col + 1, $data_row, 'TOTAL');
		$sheet->setCellValueByColumnAndRow($data_col + 2, $data_row, '');
		$sheet->setCellValueByColumnAndRow($data_col + 3, $data_row, number_format($total_RO, 0));
		$a=1;
		$baris=4;
		foreach($data['sku_code'] as $sku):
			$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($total_d[$a], 0));
			$baris = $baris + 1;
			$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($total_p[$a], 2));
			$a++;
			$baris++;
		endforeach;
		
		$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($total_dAll, 0));
		$sheet->setCellValueByColumnAndRow($data_col + $baris + 1, $data_row, number_format($total_pAll, 2));

		$sheet->getStyleByColumnAndRow(1, $data_row, $last_col + 2, $data_row)->applyFromArray($style_range);
		$sheet->getStyleByColumnAndRow(1, $data_row, $last_col + 2, $data_row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFA07A');

		$sheet->getStyleByColumnAndRow(4, 10, $last_col + 2, $data_row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		

		$sheet->getColumnDimension('A')->setWidth(5); // Set width kolom A
		$sheet->getColumnDimension('B')->setWidth(40); // Set width kolom B
		$sheet->getColumnDimension('C')->setWidth(11); // Set width kolom C
		$sheet->getColumnDimension('D')->setWidth(10);

		// Set orientasi kertas jadi LANDSCAPE
		$sheet->getPageSetup()->setOrientation(\PhpOffice\PhpSpreadsheet\Worksheet\PageSetup::ORIENTATION_LANDSCAPE);
		// Set judul file excel nya
		$sheet->setTitle("Distribution - JORDAN");
		// Proses file excel
		header('Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet');
		header('Content-Disposition: attachment; filename="Report Distribution - JORDAN.xlsx"'); // Set nama file excel nya
		header('Cache-Control: max-age=0');

		$writer = new Xlsx($spreadsheet);
		$writer->save('php://output');


	}

	public function export_direct_jordan()
	{
		$spreadsheet = new Spreadsheet();
		$sheet = $spreadsheet->getActiveSheet();
		// Buat sebuah variabel untuk menampung pengaturan style dari header tabel
		$style_col = [
			'font' => ['bold' => true], // Set font nya jadi bold
			'alignment' => [
				'horizontal' => \PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER, // Set text jadi ditengah secara horizontal (center)
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'top' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border top dengan garis tipis
				'right' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN],  // Set border right dengan garis tipis
				'bottom' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border bottom dengan garis tipis
				'left' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN] // Set border left dengan garis tipis
			]
		];

		$style_range = [
			'font' => ['bold' => true], // Set font nya jadi bold
			'alignment' => [
				'horizontal' => \PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER, // Set text jadi ditengah secara horizontal (center)
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'allBorders' => [
					'borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN, // Set border top dengan garis tipis
				]
			]
		];

		$style_range_row = [
			'alignment' => [
				'horizontal' => \PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER, // Set text jadi ditengah secara horizontal (center)
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'allBorders' => [
					'borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN, // Set border top dengan garis tipis
				]
			]
		];

		// Buat sebuah variabel untuk menampung pengaturan style dari isi tabel
		$style_row = [
			'alignment' => [
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'top' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border top dengan garis tipis
				'right' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN],  // Set border right dengan garis tipis
				'bottom' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border bottom dengan garis tipis
				'left' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN] // Set border left dengan garis tipis
			]
		];


		if (isset($_POST['by_island']))
		{
			$island = $_POST['by_island'];
		}
		else
		{
			$island = "";
		}

		if (isset($_POST['by_region']))
		{
			$region = $_POST['by_region'];
		}
		else
		{
			$region = "";
		}

		if (isset($_POST['by_area']))
		{
			$area = $_POST['by_area'];
		}
		else
		{
			$area = "";
		}

		if(isset($_POST['by_month']))
		{
			$month = $_POST['by_month'];
		}else
		{
			$month = date('m');
		}

		if(isset($_POST['by_year']))
		{
			$year = $_POST['by_year'];
		}else
		{
			$year = date('Y');
		}

		$fromdate = '-' .$month. '-1';
		$todate = '-' .$month. '-31';

		$data['sku_name'] = $this->model('SkuModel')->getItemNameSKUJordan();
		$data['sku_group'] = $this->model('SkuModel')->getGroupSKUJordan();
		$data['sku_count'] = $this->model('SkuModel')->getCountSKUJordan();
		$data['sku_code'] = $this->model('SkuModel')->getItemCodeSKUJordan();

		$dateObj   = DateTime::createFromFormat('!m', $month);
		$monthName = $dateObj->format('F'); // March

		$sheet->setCellValue('A1', "Direct Distribution - JORDAN"); // Set kolom A1 dengan tulisan "Report Selling In - By Outlet"
		$sheet->setCellValue('A2', "Island : Direct"); // Set kolom A2 dengan tulisan "Outlet Type : EC_EC"
		$sheet->setCellValue('A3', "Region : Direct"); // Set kolom A3 dengan tulisan "Outlet Type : EC_EC"
		$sheet->setCellValue('A4', "Area : JKT MT");
		$sheet->setCellValue('A5', "Month : " . $monthName . " - " .$year);
		//$sheet->mergeCells('A1:F1'); // Set Merge Cell pada kolom A1 sampai F1
		$sheet->getStyle('A1')->getFont()->setBold(true); // Set bold kolom A1
		$sheet->getStyle('A2')->getFont()->setBold(true); // Set bold kolom A2
		$sheet->getStyle('A3')->getFont()->setBold(true); // Set bold kolom A3
		$sheet->getStyle('A4')->getFont()->setBold(true);
		$sheet->getStyle('A5')->getFont()->setBold(true);
		$sheet->getStyle('A1')->getFont()->setSize(20); // Set font size 15 untuk kolom A1
		// Buat header tabel nya pada baris ke 7
		$sheet->setCellValue('A7', "#"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('A7:A9'); // Set Merge Row pada kolom A6 sampai A8
		$sheet->setCellValue('B7', "TYPE OF OUTLET"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('B7:B9'); // Set Merge Row pada kolom A6 sampai A8
		$sheet->setCellValue('C7', "Code"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('C7:C9'); // Set Merge Row pada kolom A6 sampai A8
		$sheet->setCellValue('D7', "RO"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('D7:D9');
		$start_col = 5;

		foreach ($data['sku_group'] as $row_sku) :
			//$sheet->setCellValue('E7', $row_sku['item_group']);
			$sheet->setCellValueByColumnAndRow($start_col, 7, $row_sku['item_group']);
			$last_col = $start_col + ($row_sku['count_name']*2) - 1;
			$sheet->mergeCellsByColumnAndRow($start_col, 7, $last_col, 7);
			$start_col = $last_col + 1;
		endforeach;

		$sheet->setCellValueByColumnAndRow($start_col, 7, 'TOTAL');
		$sheet->mergeCellsByColumnAndRow($start_col, 7, $start_col + 1 , 8);

		$start_col = 5;
		foreach ($data['sku_name'] as $row_sku) :
			//$sheet->setCellValue('E7', $row_sku['item_group']);
			$sheet->setCellValueByColumnAndRow($start_col, 8, $row_sku['item_name']);
			$last_col = $start_col + 1;
			$sheet->mergeCellsByColumnAndRow($start_col, 8, $last_col, 8);
			$start_col = $last_col + 1;
		endforeach;
		$start_col = 5;
		foreach ($data['sku_name'] as $row_sku) :
			$sheet->setCellValueByColumnAndRow($start_col, 9, "DISTR. NO'S");
			$start_col = $start_col + 1;
			$sheet->setCellValueByColumnAndRow($start_col, 9, "%");
			$start_col = $start_col + 1;
		endforeach;

		$sheet->setCellValueByColumnAndRow($start_col, 9, "DISTR. NO'S");
		$sheet->setCellValueByColumnAndRow($start_col + 1, 9, "%");
		
		// Apply style header yang telah kita buat tadi ke masing-masing kolom header
		$sheet->getStyleByColumnAndRow(1, 8, $last_col, 8)->getAlignment()->setWrapText(true);
		$sheet->getStyleByColumnAndRow(1, 9, $last_col, 9)->getAlignment()->setWrapText(true);
		$sheet->getStyleByColumnAndRow(1, 7, $last_col, 9)->applyFromArray($style_range);
		$sheet->getStyleByColumnAndRow(1, 7, $last_col, 9)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');
		$sheet->getStyleByColumnAndRow($last_col + 1, 7, $last_col + 2, 9)->getAlignment()->setWrapText(true);
		$sheet->getStyleByColumnAndRow($last_col + 1, 7, $last_col + 2, 9)->applyFromArray($style_range);
		$sheet->getStyleByColumnAndRow($last_col + 1, 7, $last_col + 2, 9)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FF6D6D');

		// Set height baris ke 1, 2 dan 3
		$sheet->getRowDimension('1')->setRowHeight(40);
		$sheet->getRowDimension('2')->setRowHeight(20);
		$sheet->getRowDimension('3')->setRowHeight(20);
		$sheet->getRowDimension('4')->setRowHeight(20);
		$sheet->getRowDimension('5')->setRowHeight(20);
		$sheet->getRowDimension('8')->setRowHeight(60);

		$no = 1; // Untuk penomoran tabel, di awal set dengan 1
		$row = 10;

		$data1 = array(
			'island' => $island,
			'region' => $region,
			'area' => $area,
			'month' => $month,
			'year' => $year
		);

		$data['distr_jordan'] = $this->model('ReportModel')->getDistr_jordan_direct($data);

		$data_col = 1;
		$data_row = 10;

		$channel='';

		$total_RO = 0;
		$x=1;
		foreach($data['sku_code'] as $sku):
			$total_d[$x] = 0;
			$total_p[$x] = 0;
			$x++;
		endforeach;
		
		$total_dAll = 0;
		$total_pAll = 0;

		foreach ($data['distr_jordan'] as $rows) :
			$data_col = 1;

			if ($channel != $rows['channel'])
            {
				$channel = $rows['channel'];
				$sheet->setCellValueByColumnAndRow($data_col, $data_row, '');
				$sheet->setCellValueByColumnAndRow($data_col + 1, $data_row, $rows['channel']);
				$sheet->setCellValueByColumnAndRow($data_col + 2, $data_row, '');
				$sheet->setCellValueByColumnAndRow($data_col + 3, $data_row, '');
				$a=1;
				$baris=4;
				foreach($data['sku_code'] as $sku):
					$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, '');
					$baris = $baris + 1;
					$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, '');
					$a++;
					$baris++;
				endforeach;
				$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, '');
				$sheet->setCellValueByColumnAndRow($data_col + $baris + 1, $data_row, '');

				$sheet->getStyleByColumnAndRow(1, $data_row, $last_col + 2, $data_row)->applyFromArray($style_range);
				$sheet->getStyleByColumnAndRow(1, $data_row, $last_col + 2, $data_row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('d9e1f2');

				$data_row++;

			}

			$sheet->setCellValueByColumnAndRow($data_col, $data_row, $no);
			$sheet->setCellValueByColumnAndRow($data_col + 1, $data_row, $rows['desc_type']);
			$sheet->setCellValueByColumnAndRow($data_col + 2, $data_row, $rows['outlet_type']);
			$sheet->setCellValueByColumnAndRow($data_col + 3, $data_row, number_format($rows['RO'], 0));
			$a=1;
			$baris=4;
			foreach($data['sku_code'] as $sku):
				$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($rows['d'.$a], 0));
				$baris = $baris + 1;
				$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($rows['%'.$a], 2));
				$a++;
				$baris++;
			endforeach;
			
			$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($rows['dtotal'], 0));
			$sheet->setCellValueByColumnAndRow($data_col + $baris + 1, $data_row, number_format($rows['%total'], 0));

			$total_RO += $rows['RO'];
			$x = 1;
			foreach($data['sku_code'] as $sku):
				$total_d[$x] += $rows['d'.$x];
				if($total_RO==0)
				{
					$total_p[$x] = 0;
				}
				else
				{
					$total_p[$x] = ($total_d[$x]/$total_RO)*100;
				}
				//$total_p[$x] = ($total_d[$x]/($total_RO ?: 1))*100;
				$x++;
			endforeach;
			
			$total_dAll += $rows['dtotal'];

			
			// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
			$sheet->getStyleByColumnAndRow(1, $data_row, $last_col + 2, $data_row)->applyFromArray($style_range_row);
			$sheet->getStyleByColumnAndRow(1, $data_row, null, $data_row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyleByColumnAndRow(2, $data_row, null, $data_row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyleByColumnAndRow(3, $data_row, null, $data_row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyleByColumnAndRow(4, 10, $last_col + 2, $data_row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

			$no++; // Tambah 1 setiap kali looping
    		$row++; // Tambah 1 setiap kali looping
			$data_row++;
		endforeach;

		if($total_RO==0)
		{
			$total_pAll = 0;
		}
		else
		{
			$total_pAll = ($total_dAll/$total_RO)*100;
		} 
		//$total_pAll = ($total_dAll/($total_RO ?: 1))*100;

		//$data_row = $data_row + 1;

		$sheet->setCellValueByColumnAndRow($data_col, $data_row, '');
		$sheet->setCellValueByColumnAndRow($data_col + 1, $data_row, 'TOTAL');
		$sheet->setCellValueByColumnAndRow($data_col + 2, $data_row, '');
		$sheet->setCellValueByColumnAndRow($data_col + 3, $data_row, number_format($total_RO, 0));
		$a=1;
		$baris=4;
		foreach($data['sku_code'] as $sku):
			$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($total_d[$a], 0));
			$baris = $baris + 1;
			$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($total_p[$a], 2));
			$a++;
			$baris++;
		endforeach;
		
		$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($total_dAll, 0));
		$sheet->setCellValueByColumnAndRow($data_col + $baris + 1, $data_row, number_format($total_pAll, 2));

		$sheet->getStyleByColumnAndRow(1, $data_row, $last_col + 2, $data_row)->applyFromArray($style_range);
		$sheet->getStyleByColumnAndRow(1, $data_row, $last_col + 2, $data_row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFA07A');

		$sheet->getStyleByColumnAndRow(4, 10, $last_col + 2, $data_row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		

		$sheet->getColumnDimension('A')->setWidth(5); // Set width kolom A
		$sheet->getColumnDimension('B')->setWidth(40); // Set width kolom B
		$sheet->getColumnDimension('C')->setWidth(11); // Set width kolom C
		$sheet->getColumnDimension('D')->setWidth(10);

		// Set orientasi kertas jadi LANDSCAPE
		$sheet->getPageSetup()->setOrientation(\PhpOffice\PhpSpreadsheet\Worksheet\PageSetup::ORIENTATION_LANDSCAPE);
		// Set judul file excel nya
		$sheet->setTitle("Distribution - JORDAN");
		// Proses file excel
		header('Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet');
		header('Content-Disposition: attachment; filename="Direct Distribution - JORDAN.xlsx"'); // Set nama file excel nya
		header('Cache-Control: max-age=0');

		$writer = new Xlsx($spreadsheet);
		$writer->save('php://output');


	}

	public function export_distribution_lord()
	{
		$spreadsheet = new Spreadsheet();
		$sheet = $spreadsheet->getActiveSheet();
		// Buat sebuah variabel untuk menampung pengaturan style dari header tabel
		$style_col = [
			'font' => ['bold' => true], // Set font nya jadi bold
			'alignment' => [
				'horizontal' => \PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER, // Set text jadi ditengah secara horizontal (center)
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'top' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border top dengan garis tipis
				'right' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN],  // Set border right dengan garis tipis
				'bottom' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border bottom dengan garis tipis
				'left' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN] // Set border left dengan garis tipis
			]
		];

		$style_range = [
			'font' => ['bold' => true], // Set font nya jadi bold
			'alignment' => [
				'horizontal' => \PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER, // Set text jadi ditengah secara horizontal (center)
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'allBorders' => [
					'borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN, // Set border top dengan garis tipis
				]
			]
		];

		$style_range_row = [
			'alignment' => [
				'horizontal' => \PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER, // Set text jadi ditengah secara horizontal (center)
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'allBorders' => [
					'borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN, // Set border top dengan garis tipis
				]
			]
		];

		// Buat sebuah variabel untuk menampung pengaturan style dari isi tabel
		$style_row = [
			'alignment' => [
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'top' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border top dengan garis tipis
				'right' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN],  // Set border right dengan garis tipis
				'bottom' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border bottom dengan garis tipis
				'left' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN] // Set border left dengan garis tipis
			]
		];


		if (isset($_POST['by_island']))
		{
			$island = $_POST['by_island'];
		}
		else
		{
			$island = "";
		}

		if (isset($_POST['by_region']))
		{
			$region = $_POST['by_region'];
		}
		else
		{
			$region = "";
		}

		if (isset($_POST['by_area']))
		{
			$area = implode(',', $_POST['by_area']);
			$area = str_replace(",", "','", $area);;
		}
		elseif ($_SESSION['area'] != 'ALL')
		{
			$session_area = str_replace(", ", "','", $_SESSION['area']); 
			$area = $session_area;
		}

		if(isset($_POST['by_month']))
		{
			$month = $_POST['by_month'];
		}else
		{
			$month = date('m');
		}

		if(isset($_POST['by_year']))
		{
			$year = $_POST['by_year'];
		}else
		{
			$year = date('Y');
		}

		$fromdate = '-' .$month. '-1';
		$todate = '-' .$month. '-31';

		$data['sku_name'] = $this->model('SkuModel')->getItemNameSKULord();
		$data['sku_group'] = $this->model('SkuModel')->getGroupSKULord();
		$data['sku_count'] = $this->model('SkuModel')->getCountSKULord();
		$data['sku_code'] = $this->model('SkuModel')->getItemCodeSKULord();

		$dateObj   = DateTime::createFromFormat('!m', $month);
		$monthName = $dateObj->format('F'); // March

		$sheet->setCellValue('A1', "Report Distribution - LORD"); // Set kolom A1 dengan tulisan "Report Selling In - By Outlet"
		$sheet->setCellValue('A2', "Island : " . $island); // Set kolom A2 dengan tulisan "Outlet Type : EC_EC"
		$sheet->setCellValue('A3', "Region : " . $region); // Set kolom A3 dengan tulisan "Outlet Type : EC_EC"
		$sheet->setCellValue('A4', "Area : " . $area);
		$sheet->setCellValue('A5', "Month : " . $monthName . " - " .$year);
		//$sheet->mergeCells('A1:F1'); // Set Merge Cell pada kolom A1 sampai F1
		$sheet->getStyle('A1')->getFont()->setBold(true); // Set bold kolom A1
		$sheet->getStyle('A2')->getFont()->setBold(true); // Set bold kolom A2
		$sheet->getStyle('A3')->getFont()->setBold(true); // Set bold kolom A3
		$sheet->getStyle('A4')->getFont()->setBold(true);
		$sheet->getStyle('A5')->getFont()->setBold(true);
		$sheet->getStyle('A1')->getFont()->setSize(20); // Set font size 15 untuk kolom A1
		// Buat header tabel nya pada baris ke 7
		$sheet->setCellValue('A7', "#"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('A7:A9'); // Set Merge Row pada kolom A6 sampai A8
		$sheet->setCellValue('B7', "TYPE OF OUTLET"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('B7:B9'); // Set Merge Row pada kolom A6 sampai A8
		$sheet->setCellValue('C7', "Code"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('C7:C9'); // Set Merge Row pada kolom A6 sampai A8
		$sheet->setCellValue('D7', "RO"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('D7:D9');
		$start_col = 5;

		foreach ($data['sku_group'] as $row_sku) :
			//$sheet->setCellValue('E7', $row_sku['item_group']);
			$sheet->setCellValueByColumnAndRow($start_col, 7, $row_sku['item_group']);
			$last_col = $start_col + ($row_sku['count_name']*2) - 1;
			$sheet->mergeCellsByColumnAndRow($start_col, 7, $last_col, 7);
			$start_col = $last_col + 1;
		endforeach;

		$sheet->setCellValueByColumnAndRow($start_col, 7, 'TOTAL');
		$sheet->mergeCellsByColumnAndRow($start_col, 7, $start_col + 1 , 8);

		$start_col = 5;
		foreach ($data['sku_name'] as $row_sku) :
			//$sheet->setCellValue('E7', $row_sku['item_group']);
			$sheet->setCellValueByColumnAndRow($start_col, 8, $row_sku['item_name']);
			$last_col = $start_col + 1;
			$sheet->mergeCellsByColumnAndRow($start_col, 8, $last_col, 8);
			$start_col = $last_col + 1;
		endforeach;
		$start_col = 5;
		foreach ($data['sku_name'] as $row_sku) :
			$sheet->setCellValueByColumnAndRow($start_col, 9, "DISTR. NO'S");
			$start_col = $start_col + 1;
			$sheet->setCellValueByColumnAndRow($start_col, 9, "%");
			$start_col = $start_col + 1;
		endforeach;

		$sheet->setCellValueByColumnAndRow($start_col, 9, "DISTR. NO'S");
		$sheet->setCellValueByColumnAndRow($start_col + 1, 9, "%");
		
		// Apply style header yang telah kita buat tadi ke masing-masing kolom header
		$sheet->getStyleByColumnAndRow(1, 8, $last_col, 8)->getAlignment()->setWrapText(true);
		$sheet->getStyleByColumnAndRow(1, 9, $last_col, 9)->getAlignment()->setWrapText(true);
		$sheet->getStyleByColumnAndRow(1, 7, $last_col, 9)->applyFromArray($style_range);
		$sheet->getStyleByColumnAndRow(1, 7, $last_col, 9)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');
		$sheet->getStyleByColumnAndRow($last_col + 1, 7, $last_col + 2, 9)->getAlignment()->setWrapText(true);
		$sheet->getStyleByColumnAndRow($last_col + 1, 7, $last_col + 2, 9)->applyFromArray($style_range);
		$sheet->getStyleByColumnAndRow($last_col + 1, 7, $last_col + 2, 9)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FF6D6D');

		// Set height baris ke 1, 2 dan 3
		$sheet->getRowDimension('1')->setRowHeight(40);
		$sheet->getRowDimension('2')->setRowHeight(20);
		$sheet->getRowDimension('3')->setRowHeight(20);
		$sheet->getRowDimension('4')->setRowHeight(20);
		$sheet->getRowDimension('5')->setRowHeight(20);
		$sheet->getRowDimension('8')->setRowHeight(60);

		$no = 1; // Untuk penomoran tabel, di awal set dengan 1
		$row = 10;

		$data1 = array(
			'island' => $island,
			'region' => $region,
			'area' => $area,
			'month' => $month,
			'year' => $year
		);

		//$data['distr_lord'] = $this->model('ReportModel')->getDistr_jordan_ALL($data);
		$data['distr_lord'] = $this->model('ReportModel')->getDistr_lord_ALL($data);

		$data_col = 1;
		$data_row = 10;

		$channel='';

		$total_RO = 0;
		$x=1;
		foreach($data['sku_code'] as $sku):
			$total_d[$x] = 0;
			$total_p[$x] = 0;
			$x++;
		endforeach;
		
		$total_dAll = 0;
		$total_pAll = 0;

		foreach ($data['distr_lord'] as $rows) :
			$data_col = 1;

			if ($channel != $rows['channel'])
            {
				$channel = $rows['channel'];
				$sheet->setCellValueByColumnAndRow($data_col, $data_row, '');
				$sheet->setCellValueByColumnAndRow($data_col + 1, $data_row, $rows['channel']);
				$sheet->setCellValueByColumnAndRow($data_col + 2, $data_row, '');
				$sheet->setCellValueByColumnAndRow($data_col + 3, $data_row, '');
				$a=1;
				$baris=4;
				foreach($data['sku_code'] as $sku):
					$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, '');
					$baris = $baris + 1;
					$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, '');
					$a++;
					$baris++;
				endforeach;
				$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, '');
				$sheet->setCellValueByColumnAndRow($data_col + $baris + 1, $data_row, '');

				$sheet->getStyleByColumnAndRow(1, $data_row, $last_col + 2, $data_row)->applyFromArray($style_range);
				$sheet->getStyleByColumnAndRow(1, $data_row, $last_col + 2, $data_row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('d9e1f2');

				$data_row++;

			}

			$sheet->setCellValueByColumnAndRow($data_col, $data_row, $no);
			$sheet->setCellValueByColumnAndRow($data_col + 1, $data_row, $rows['desc_type']);
			$sheet->setCellValueByColumnAndRow($data_col + 2, $data_row, $rows['outlet_type']);
			$sheet->setCellValueByColumnAndRow($data_col + 3, $data_row, number_format($rows['RO'], 0));
			$a=1;
			$baris=4;
			foreach($data['sku_code'] as $sku):
				$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($rows['d'.$a], 0));
				$baris = $baris + 1;
				$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($rows['%'.$a], 2));
				$a++;
				$baris++;
			endforeach;
			
			$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($rows['dtotal'], 0));
			$sheet->setCellValueByColumnAndRow($data_col + $baris + 1, $data_row, number_format($rows['%total'], 0));

			$total_RO += $rows['RO'];
			$x = 1;
			foreach($data['sku_code'] as $sku):
				$total_d[$x] += $rows['d'.$x];
				if($total_RO==0)
				{
					$total_p[$x] = 0;
				}
				else
				{
					$total_p[$x] = ($total_d[$x]/$total_RO)*100;
				} 
				//$total_p[$x] = ($total_d[$x]/($total_RO ?: 1))*100;
				$x++;
			endforeach;
			
			$total_dAll += $rows['dtotal'];

			// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
			$sheet->getStyleByColumnAndRow(1, $data_row, $last_col + 2, $data_row)->applyFromArray($style_range_row);
			$sheet->getStyleByColumnAndRow(1, $data_row, null, $data_row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyleByColumnAndRow(2, $data_row, null, $data_row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyleByColumnAndRow(3, $data_row, null, $data_row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyleByColumnAndRow(4, 10, $last_col + 2, $data_row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

			$no++; // Tambah 1 setiap kali looping
    		$row++; // Tambah 1 setiap kali looping
			$data_row++;
		endforeach;

		if($total_RO==0)
		{
			$total_pAll = 0;
		}
		else
		{
			$total_pAll = ($total_dAll/$total_RO)*100;
		}
		//$total_pAll = ($total_dAll/($total_RO ?: 1))*100;

		//$data_row = $data_row + 1;

		$sheet->setCellValueByColumnAndRow($data_col, $data_row, '');
		$sheet->setCellValueByColumnAndRow($data_col + 1, $data_row, 'TOTAL');
		$sheet->setCellValueByColumnAndRow($data_col + 2, $data_row, '');
		$sheet->setCellValueByColumnAndRow($data_col + 3, $data_row, number_format($total_RO, 0));
		$a=1;
		$baris=4;
		foreach($data['sku_code'] as $sku):
			$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($total_d[$a], 0));
			$baris = $baris + 1;
			$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($total_p[$a], 2));
			$a++;
			$baris++;
		endforeach;
		
		$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($total_dAll, 0));
		$sheet->setCellValueByColumnAndRow($data_col + $baris + 1, $data_row, number_format($total_pAll, 2));
		

		$sheet->getStyleByColumnAndRow(1, $data_row, $last_col + 2, $data_row)->applyFromArray($style_range);
		$sheet->getStyleByColumnAndRow(1, $data_row, $last_col + 2, $data_row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFA07A');

		$sheet->getStyleByColumnAndRow(4, 10, $last_col + 2, $data_row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		

		$sheet->getColumnDimension('A')->setWidth(5); // Set width kolom A
		$sheet->getColumnDimension('B')->setWidth(40); // Set width kolom B
		$sheet->getColumnDimension('C')->setWidth(11); // Set width kolom C
		$sheet->getColumnDimension('D')->setWidth(10);

		// Set orientasi kertas jadi LANDSCAPE
		$sheet->getPageSetup()->setOrientation(\PhpOffice\PhpSpreadsheet\Worksheet\PageSetup::ORIENTATION_LANDSCAPE);
		// Set judul file excel nya
		$sheet->setTitle("Distribution - LORD");
		// Proses file excel
		header('Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet');
		header('Content-Disposition: attachment; filename="Report Distribution - LORD.xlsx"'); // Set nama file excel nya
		header('Cache-Control: max-age=0');

		$writer = new Xlsx($spreadsheet);
		$writer->save('php://output');
	}

	public function export_direct_lord()
	{
		$spreadsheet = new Spreadsheet();
		$sheet = $spreadsheet->getActiveSheet();
		// Buat sebuah variabel untuk menampung pengaturan style dari header tabel
		$style_col = [
			'font' => ['bold' => true], // Set font nya jadi bold
			'alignment' => [
				'horizontal' => \PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER, // Set text jadi ditengah secara horizontal (center)
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'top' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border top dengan garis tipis
				'right' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN],  // Set border right dengan garis tipis
				'bottom' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border bottom dengan garis tipis
				'left' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN] // Set border left dengan garis tipis
			]
		];

		$style_range = [
			'font' => ['bold' => true], // Set font nya jadi bold
			'alignment' => [
				'horizontal' => \PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER, // Set text jadi ditengah secara horizontal (center)
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'allBorders' => [
					'borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN, // Set border top dengan garis tipis
				]
			]
		];

		$style_range_row = [
			'alignment' => [
				'horizontal' => \PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER, // Set text jadi ditengah secara horizontal (center)
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'allBorders' => [
					'borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN, // Set border top dengan garis tipis
				]
			]
		];

		// Buat sebuah variabel untuk menampung pengaturan style dari isi tabel
		$style_row = [
			'alignment' => [
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'top' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border top dengan garis tipis
				'right' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN],  // Set border right dengan garis tipis
				'bottom' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border bottom dengan garis tipis
				'left' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN] // Set border left dengan garis tipis
			]
		];


		if (isset($_POST['by_island']))
		{
			$island = $_POST['by_island'];
		}
		else
		{
			$island = "";
		}

		if (isset($_POST['by_region']))
		{
			$region = $_POST['by_region'];
		}
		else
		{
			$region = "";
		}

		if (isset($_POST['by_area']))
		{
			$area = $_POST['by_area'];
		}
		else
		{
			$area = "";
		}

		if(isset($_POST['by_month']))
		{
			$month = $_POST['by_month'];
		}else
		{
			$month = date('m');
		}

		if(isset($_POST['by_year']))
		{
			$year = $_POST['by_year'];
		}else
		{
			$year = date('Y');
		}

		$fromdate = '-' .$month. '-1';
		$todate = '-' .$month. '-31';

		$data['sku_name'] = $this->model('SkuModel')->getItemNameSKULord();
		$data['sku_group'] = $this->model('SkuModel')->getGroupSKULord();
		$data['sku_count'] = $this->model('SkuModel')->getCountSKULord();
		$data['sku_code'] = $this->model('SkuModel')->getItemCodeSKULord();

		$dateObj   = DateTime::createFromFormat('!m', $month);
		$monthName = $dateObj->format('F'); // March

		$sheet->setCellValue('A1', "Direct Distribution - LORD"); // Set kolom A1 dengan tulisan "Report Selling In - By Outlet"
		$sheet->setCellValue('A2', "Island : Direct"); // Set kolom A2 dengan tulisan "Outlet Type : EC_EC"
		$sheet->setCellValue('A3', "Region : Direct"); // Set kolom A3 dengan tulisan "Outlet Type : EC_EC"
		$sheet->setCellValue('A4', "Area : JKT MT");
		$sheet->setCellValue('A5', "Month : " . $monthName . " - " .$year);
		//$sheet->mergeCells('A1:F1'); // Set Merge Cell pada kolom A1 sampai F1
		$sheet->getStyle('A1')->getFont()->setBold(true); // Set bold kolom A1
		$sheet->getStyle('A2')->getFont()->setBold(true); // Set bold kolom A2
		$sheet->getStyle('A3')->getFont()->setBold(true); // Set bold kolom A3
		$sheet->getStyle('A4')->getFont()->setBold(true);
		$sheet->getStyle('A5')->getFont()->setBold(true);
		$sheet->getStyle('A1')->getFont()->setSize(20); // Set font size 15 untuk kolom A1
		// Buat header tabel nya pada baris ke 7
		$sheet->setCellValue('A7', "#"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('A7:A9'); // Set Merge Row pada kolom A6 sampai A8
		$sheet->setCellValue('B7', "TYPE OF OUTLET"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('B7:B9'); // Set Merge Row pada kolom A6 sampai A8
		$sheet->setCellValue('C7', "Code"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('C7:C9'); // Set Merge Row pada kolom A6 sampai A8
		$sheet->setCellValue('D7', "RO"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('D7:D9');
		$start_col = 5;

		foreach ($data['sku_group'] as $row_sku) :
			//$sheet->setCellValue('E7', $row_sku['item_group']);
			$sheet->setCellValueByColumnAndRow($start_col, 7, $row_sku['item_group']);
			$last_col = $start_col + ($row_sku['count_name']*2) - 1;
			$sheet->mergeCellsByColumnAndRow($start_col, 7, $last_col, 7);
			$start_col = $last_col + 1;
		endforeach;

		$sheet->setCellValueByColumnAndRow($start_col, 7, 'TOTAL');
		$sheet->mergeCellsByColumnAndRow($start_col, 7, $start_col + 1 , 8);

		$start_col = 5;
		foreach ($data['sku_name'] as $row_sku) :
			//$sheet->setCellValue('E7', $row_sku['item_group']);
			$sheet->setCellValueByColumnAndRow($start_col, 8, $row_sku['item_name']);
			$last_col = $start_col + 1;
			$sheet->mergeCellsByColumnAndRow($start_col, 8, $last_col, 8);
			$start_col = $last_col + 1;
		endforeach;
		$start_col = 5;
		foreach ($data['sku_name'] as $row_sku) :
			$sheet->setCellValueByColumnAndRow($start_col, 9, "DISTR. NO'S");
			$start_col = $start_col + 1;
			$sheet->setCellValueByColumnAndRow($start_col, 9, "%");
			$start_col = $start_col + 1;
		endforeach;

		$sheet->setCellValueByColumnAndRow($start_col, 9, "DISTR. NO'S");
		$sheet->setCellValueByColumnAndRow($start_col + 1, 9, "%");
		
		// Apply style header yang telah kita buat tadi ke masing-masing kolom header
		$sheet->getStyleByColumnAndRow(1, 8, $last_col, 8)->getAlignment()->setWrapText(true);
		$sheet->getStyleByColumnAndRow(1, 9, $last_col, 9)->getAlignment()->setWrapText(true);
		$sheet->getStyleByColumnAndRow(1, 7, $last_col, 9)->applyFromArray($style_range);
		$sheet->getStyleByColumnAndRow(1, 7, $last_col, 9)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');
		$sheet->getStyleByColumnAndRow($last_col + 1, 7, $last_col + 2, 9)->getAlignment()->setWrapText(true);
		$sheet->getStyleByColumnAndRow($last_col + 1, 7, $last_col + 2, 9)->applyFromArray($style_range);
		$sheet->getStyleByColumnAndRow($last_col + 1, 7, $last_col + 2, 9)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FF6D6D');

		// Set height baris ke 1, 2 dan 3
		$sheet->getRowDimension('1')->setRowHeight(40);
		$sheet->getRowDimension('2')->setRowHeight(20);
		$sheet->getRowDimension('3')->setRowHeight(20);
		$sheet->getRowDimension('4')->setRowHeight(20);
		$sheet->getRowDimension('5')->setRowHeight(20);
		$sheet->getRowDimension('8')->setRowHeight(60);

		$no = 1; // Untuk penomoran tabel, di awal set dengan 1
		$row = 10;

		$data1 = array(
			'island' => $island,
			'region' => $region,
			'area' => $area,
			'month' => $month,
			'year' => $year
		);

		//$data['distr_lord'] = $this->model('ReportModel')->getDistr_jordan_ALL($data);
		$data['distr_lord'] = $this->model('ReportModel')->getDistr_lord_direct($data);

		$data_col = 1;
		$data_row = 10;

		$channel='';

		$total_RO = 0;
		$x=1;
		foreach($data['sku_code'] as $sku):
			$total_d[$x] = 0;
			$total_p[$x] = 0;
			$x++;
		endforeach;
		
		$total_dAll = 0;
		$total_pAll = 0;

		foreach ($data['distr_lord'] as $rows) :
			$data_col = 1;

			if ($channel != $rows['channel'])
            {
				$channel = $rows['channel'];
				$sheet->setCellValueByColumnAndRow($data_col, $data_row, '');
				$sheet->setCellValueByColumnAndRow($data_col + 1, $data_row, $rows['channel']);
				$sheet->setCellValueByColumnAndRow($data_col + 2, $data_row, '');
				$sheet->setCellValueByColumnAndRow($data_col + 3, $data_row, '');
				$a=1;
				$baris=4;
				foreach($data['sku_code'] as $sku):
					$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, '');
					$baris = $baris + 1;
					$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, '');
					$a++;
					$baris++;
				endforeach;
				$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, '');
				$sheet->setCellValueByColumnAndRow($data_col + $baris + 1, $data_row, '');

				$sheet->getStyleByColumnAndRow(1, $data_row, $last_col + 2, $data_row)->applyFromArray($style_range);
				$sheet->getStyleByColumnAndRow(1, $data_row, $last_col + 2, $data_row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('d9e1f2');

				$data_row++;

			}

			$sheet->setCellValueByColumnAndRow($data_col, $data_row, $no);
			$sheet->setCellValueByColumnAndRow($data_col + 1, $data_row, $rows['desc_type']);
			$sheet->setCellValueByColumnAndRow($data_col + 2, $data_row, $rows['outlet_type']);
			$sheet->setCellValueByColumnAndRow($data_col + 3, $data_row, number_format($rows['RO'], 0));
			$a=1;
			$baris=4;
			foreach($data['sku_code'] as $sku):
				$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($rows['d'.$a], 0));
				$baris = $baris + 1;
				$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($rows['%'.$a], 2));
				$a++;
				$baris++;
			endforeach;
			
			$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($rows['dtotal'], 0));
			$sheet->setCellValueByColumnAndRow($data_col + $baris + 1, $data_row, number_format($rows['%total'], 0));

			$total_RO += $rows['RO'];
			$x = 1;
			foreach($data['sku_code'] as $sku):
				$total_d[$x] += $rows['d'.$x];
				if($total_RO==0)
				{
					$total_p[$x] = 0;
				}
				else
				{
					$total_p[$x] = ($total_d[$x]/$total_RO)*100;
				} 
				//$total_p[$x] = ($total_d[$x]/($total_RO ?: 1))*100;
				$x++;
			endforeach;
			
			$total_dAll += $rows['dtotal'];

			// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
			$sheet->getStyleByColumnAndRow(1, $data_row, $last_col + 2, $data_row)->applyFromArray($style_range_row);
			$sheet->getStyleByColumnAndRow(1, $data_row, null, $data_row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyleByColumnAndRow(2, $data_row, null, $data_row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyleByColumnAndRow(3, $data_row, null, $data_row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyleByColumnAndRow(4, 10, $last_col + 2, $data_row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

			$no++; // Tambah 1 setiap kali looping
    		$row++; // Tambah 1 setiap kali looping
			$data_row++;
		endforeach;

		if($total_RO==0)
		{
			$total_pAll = 0;
		}
		else
		{
			$total_pAll = ($total_dAll/$total_RO)*100;
		}
		//$total_pAll = ($total_dAll/($total_RO ?: 1))*100;

		//$data_row = $data_row + 1;

		$sheet->setCellValueByColumnAndRow($data_col, $data_row, '');
		$sheet->setCellValueByColumnAndRow($data_col + 1, $data_row, 'TOTAL');
		$sheet->setCellValueByColumnAndRow($data_col + 2, $data_row, '');
		$sheet->setCellValueByColumnAndRow($data_col + 3, $data_row, number_format($total_RO, 0));
		$a=1;
		$baris=4;
		foreach($data['sku_code'] as $sku):
			$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($total_d[$a], 0));
			$baris = $baris + 1;
			$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($total_p[$a], 2));
			$a++;
			$baris++;
		endforeach;
		
		$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($total_dAll, 0));
		$sheet->setCellValueByColumnAndRow($data_col + $baris + 1, $data_row, number_format($total_pAll, 2));
		

		$sheet->getStyleByColumnAndRow(1, $data_row, $last_col + 2, $data_row)->applyFromArray($style_range);
		$sheet->getStyleByColumnAndRow(1, $data_row, $last_col + 2, $data_row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFA07A');

		$sheet->getStyleByColumnAndRow(4, 10, $last_col + 2, $data_row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		

		$sheet->getColumnDimension('A')->setWidth(5); // Set width kolom A
		$sheet->getColumnDimension('B')->setWidth(40); // Set width kolom B
		$sheet->getColumnDimension('C')->setWidth(11); // Set width kolom C
		$sheet->getColumnDimension('D')->setWidth(10);

		// Set orientasi kertas jadi LANDSCAPE
		$sheet->getPageSetup()->setOrientation(\PhpOffice\PhpSpreadsheet\Worksheet\PageSetup::ORIENTATION_LANDSCAPE);
		// Set judul file excel nya
		$sheet->setTitle("Distribution - LORD");
		// Proses file excel
		header('Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet');
		header('Content-Disposition: attachment; filename="Direct Distribution - LORD.xlsx"'); // Set nama file excel nya
		header('Cache-Control: max-age=0');

		$writer = new Xlsx($spreadsheet);
		$writer->save('php://output');


	}

	public function export_distribution_lord_newOT()
	{
		$spreadsheet = new Spreadsheet();
		$sheet = $spreadsheet->getActiveSheet();
		// Buat sebuah variabel untuk menampung pengaturan style dari header tabel
		$style_col = [
			'font' => ['bold' => true], // Set font nya jadi bold
			'alignment' => [
				'horizontal' => \PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER, // Set text jadi ditengah secara horizontal (center)
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'top' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border top dengan garis tipis
				'right' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN],  // Set border right dengan garis tipis
				'bottom' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border bottom dengan garis tipis
				'left' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN] // Set border left dengan garis tipis
			]
		];

		$style_range = [
			'font' => ['bold' => true], // Set font nya jadi bold
			'alignment' => [
				'horizontal' => \PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER, // Set text jadi ditengah secara horizontal (center)
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'allBorders' => [
					'borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN, // Set border top dengan garis tipis
				]
			]
		];

		$style_range_row = [
			'alignment' => [
				'horizontal' => \PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER, // Set text jadi ditengah secara horizontal (center)
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'allBorders' => [
					'borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN, // Set border top dengan garis tipis
				]
			]
		];

		// Buat sebuah variabel untuk menampung pengaturan style dari isi tabel
		$style_row = [
			'alignment' => [
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'top' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border top dengan garis tipis
				'right' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN],  // Set border right dengan garis tipis
				'bottom' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border bottom dengan garis tipis
				'left' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN] // Set border left dengan garis tipis
			]
		];


		if (isset($_POST['by_island']))
		{
			$island = $_POST['by_island'];
		}
		else
		{
			$island = "";
		}

		if (isset($_POST['by_region']))
		{
			$region = $_POST['by_region'];
		}
		else
		{
			$region = "";
		}

		if (isset($_POST['by_area']))
		{
			$area = $_POST['by_area'];
		}
		else
		{
			$area = "";
		}

		if(isset($_POST['by_month']))
		{
			$month = $_POST['by_month'];
		}else
		{
			$month = date('m');
		}

		if(isset($_POST['by_year']))
		{
			$year = $_POST['by_year'];
		}else
		{
			$year = date('Y');
		}

		$fromdate = '-' .$month. '-1';
		$todate = '-' .$month. '-31';

		$data['sku_name'] = $this->model('SkuModel')->getItemNameSKULord();
		$data['sku_group'] = $this->model('SkuModel')->getGroupSKULord();
		$data['sku_count'] = $this->model('SkuModel')->getCountSKULord();
		$data['sku_code'] = $this->model('SkuModel')->getItemCodeSKULord();

		$dateObj   = DateTime::createFromFormat('!m', $month);
		$monthName = $dateObj->format('F'); // March

		$sheet->setCellValue('A1', "Report Distribution - LORD"); // Set kolom A1 dengan tulisan "Report Selling In - By Outlet"
		$sheet->setCellValue('A2', "Island : " . $island); // Set kolom A2 dengan tulisan "Outlet Type : EC_EC"
		$sheet->setCellValue('A3', "Region : " . $region); // Set kolom A3 dengan tulisan "Outlet Type : EC_EC"
		$sheet->setCellValue('A4', "Area : " . $area);
		$sheet->setCellValue('A5', "Month : " . $monthName . " - " .$year);
		//$sheet->mergeCells('A1:F1'); // Set Merge Cell pada kolom A1 sampai F1
		$sheet->getStyle('A1')->getFont()->setBold(true); // Set bold kolom A1
		$sheet->getStyle('A2')->getFont()->setBold(true); // Set bold kolom A2
		$sheet->getStyle('A3')->getFont()->setBold(true); // Set bold kolom A3
		$sheet->getStyle('A4')->getFont()->setBold(true);
		$sheet->getStyle('A5')->getFont()->setBold(true);
		$sheet->getStyle('A1')->getFont()->setSize(20); // Set font size 15 untuk kolom A1
		// Buat header tabel nya pada baris ke 7
		$sheet->setCellValue('A7', "#"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('A7:A9'); // Set Merge Row pada kolom A6 sampai A8
		$sheet->setCellValue('B7', "TYPE OF OUTLET"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('B7:B9'); // Set Merge Row pada kolom A6 sampai A8
		$sheet->setCellValue('C7', "Code"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('C7:C9'); // Set Merge Row pada kolom A6 sampai A8
		$sheet->setCellValue('D7', "RO"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('D7:D9');
		$start_col = 5;

		foreach ($data['sku_group'] as $row_sku) :
			//$sheet->setCellValue('E7', $row_sku['item_group']);
			$sheet->setCellValueByColumnAndRow($start_col, 7, $row_sku['item_group']);
			$last_col = $start_col + ($row_sku['count_name']*2) - 1;
			$sheet->mergeCellsByColumnAndRow($start_col, 7, $last_col, 7);
			$start_col = $last_col + 1;
		endforeach;

		$sheet->setCellValueByColumnAndRow($start_col, 7, 'TOTAL');
		$sheet->mergeCellsByColumnAndRow($start_col, 7, $start_col + 1 , 8);

		$start_col = 5;
		foreach ($data['sku_name'] as $row_sku) :
			//$sheet->setCellValue('E7', $row_sku['item_group']);
			$sheet->setCellValueByColumnAndRow($start_col, 8, $row_sku['item_name']);
			$last_col = $start_col + 1;
			$sheet->mergeCellsByColumnAndRow($start_col, 8, $last_col, 8);
			$start_col = $last_col + 1;
		endforeach;
		$start_col = 5;
		foreach ($data['sku_name'] as $row_sku) :
			$sheet->setCellValueByColumnAndRow($start_col, 9, "DISTR. NO'S");
			$start_col = $start_col + 1;
			$sheet->setCellValueByColumnAndRow($start_col, 9, "%");
			$start_col = $start_col + 1;
		endforeach;

		$sheet->setCellValueByColumnAndRow($start_col, 9, "DISTR. NO'S");
		$sheet->setCellValueByColumnAndRow($start_col + 1, 9, "%");
		
		// Apply style header yang telah kita buat tadi ke masing-masing kolom header
		$sheet->getStyleByColumnAndRow(1, 8, $last_col, 8)->getAlignment()->setWrapText(true);
		$sheet->getStyleByColumnAndRow(1, 9, $last_col, 9)->getAlignment()->setWrapText(true);
		$sheet->getStyleByColumnAndRow(1, 7, $last_col, 9)->applyFromArray($style_range);
		$sheet->getStyleByColumnAndRow(1, 7, $last_col, 9)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');
		$sheet->getStyleByColumnAndRow($last_col + 1, 7, $last_col + 2, 9)->getAlignment()->setWrapText(true);
		$sheet->getStyleByColumnAndRow($last_col + 1, 7, $last_col + 2, 9)->applyFromArray($style_range);
		$sheet->getStyleByColumnAndRow($last_col + 1, 7, $last_col + 2, 9)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FF6D6D');

		// Set height baris ke 1, 2 dan 3
		$sheet->getRowDimension('1')->setRowHeight(40);
		$sheet->getRowDimension('2')->setRowHeight(20);
		$sheet->getRowDimension('3')->setRowHeight(20);
		$sheet->getRowDimension('4')->setRowHeight(20);
		$sheet->getRowDimension('5')->setRowHeight(20);
		$sheet->getRowDimension('8')->setRowHeight(60);

		$no = 1; // Untuk penomoran tabel, di awal set dengan 1
		$row = 10;

		$data1 = array(
			'island' => $island,
			'region' => $region,
			'area' => $area,
			'month' => $month,
			'year' => $year
		);

		//$data['distr_lord'] = $this->model('ReportModel')->getDistr_jordan_ALL($data);
		$data['distr_lord'] = $this->model('ReportModel')->getDistr_lord_new_OT($data);

		$data_col = 1;
		$data_row = 10;

		$channel='';

		$total_RO = 0;
		$x=1;
		foreach($data['sku_code'] as $sku):
			$total_d[$x] = 0;
			$total_p[$x] = 0;
			$x++;
		endforeach;
		
		$total_dAll = 0;
		$total_pAll = 0;

		foreach ($data['distr_lord'] as $rows) :
			$data_col = 1;

			if ($channel != $rows['channel'])
            {
				$channel = $rows['channel'];
				$sheet->setCellValueByColumnAndRow($data_col, $data_row, '');
				$sheet->setCellValueByColumnAndRow($data_col + 1, $data_row, $rows['channel']);
				$sheet->setCellValueByColumnAndRow($data_col + 2, $data_row, '');
				$sheet->setCellValueByColumnAndRow($data_col + 3, $data_row, '');
				$a=1;
				$baris=4;
				foreach($data['sku_code'] as $sku):
					$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, '');
					$baris = $baris + 1;
					$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, '');
					$a++;
					$baris++;
				endforeach;
				$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, '');
				$sheet->setCellValueByColumnAndRow($data_col + $baris + 1, $data_row, '');

				$sheet->getStyleByColumnAndRow(1, $data_row, $last_col + 2, $data_row)->applyFromArray($style_range);
				$sheet->getStyleByColumnAndRow(1, $data_row, $last_col + 2, $data_row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('d9e1f2');

				$data_row++;

			}

			$sheet->setCellValueByColumnAndRow($data_col, $data_row, $no);
			$sheet->setCellValueByColumnAndRow($data_col + 1, $data_row, $rows['desc_type']);
			$sheet->setCellValueByColumnAndRow($data_col + 2, $data_row, $rows['outlet_type']);
			$sheet->setCellValueByColumnAndRow($data_col + 3, $data_row, number_format($rows['RO'], 0));
			$a=1;
			$baris=4;
			foreach($data['sku_code'] as $sku):
				$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($rows['d'.$a], 0));
				$baris = $baris + 1;
				$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($rows['%'.$a], 2));
				$a++;
				$baris++;
			endforeach;
			
			$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($rows['dtotal'], 0));
			$sheet->setCellValueByColumnAndRow($data_col + $baris + 1, $data_row, number_format($rows['%total'], 0));

			$total_RO += $rows['RO'];
			$x = 1;
			foreach($data['sku_code'] as $sku):
				$total_d[$x] += $rows['d'.$x];
				$total_p[$x] = ($total_d[$x]/($total_RO ?: 1))*100;
				$x++;
			endforeach;
			
			$total_dAll += $rows['dtotal'];

			// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
			$sheet->getStyleByColumnAndRow(1, $data_row, $last_col + 2, $data_row)->applyFromArray($style_range_row);
			$sheet->getStyleByColumnAndRow(1, $data_row, null, $data_row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyleByColumnAndRow(2, $data_row, null, $data_row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyleByColumnAndRow(3, $data_row, null, $data_row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyleByColumnAndRow(4, 10, $last_col + 2, $data_row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

			$no++; // Tambah 1 setiap kali looping
    		$row++; // Tambah 1 setiap kali looping
			$data_row++;
		endforeach;

		$total_pAll = ($total_dAll/($total_RO ?: 1))*100;

		//$data_row = $data_row + 1;

		$sheet->setCellValueByColumnAndRow($data_col, $data_row, '');
		$sheet->setCellValueByColumnAndRow($data_col + 1, $data_row, 'TOTAL');
		$sheet->setCellValueByColumnAndRow($data_col + 2, $data_row, '');
		$sheet->setCellValueByColumnAndRow($data_col + 3, $data_row, number_format($total_RO, 0));
		$a=1;
		$baris=4;
		foreach($data['sku_code'] as $sku):
			$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($total_d[$a], 0));
			$baris = $baris + 1;
			$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($total_p[$a], 2));
			$a++;
			$baris++;
		endforeach;
		
		$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($total_dAll, 0));
		$sheet->setCellValueByColumnAndRow($data_col + $baris + 1, $data_row, number_format($total_pAll, 2));
		

		$sheet->getStyleByColumnAndRow(1, $data_row, $last_col + 2, $data_row)->applyFromArray($style_range);
		$sheet->getStyleByColumnAndRow(1, $data_row, $last_col + 2, $data_row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFA07A');

		$sheet->getStyleByColumnAndRow(4, 10, $last_col + 2, $data_row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		

		$sheet->getColumnDimension('A')->setWidth(5); // Set width kolom A
		$sheet->getColumnDimension('B')->setWidth(40); // Set width kolom B
		$sheet->getColumnDimension('C')->setWidth(11); // Set width kolom C
		$sheet->getColumnDimension('D')->setWidth(10);

		// Set orientasi kertas jadi LANDSCAPE
		$sheet->getPageSetup()->setOrientation(\PhpOffice\PhpSpreadsheet\Worksheet\PageSetup::ORIENTATION_LANDSCAPE);
		// Set judul file excel nya
		$sheet->setTitle("Distribution - LORD");
		// Proses file excel
		header('Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet');
		header('Content-Disposition: attachment; filename="Report Distribution - LORD.xlsx"'); // Set nama file excel nya
		header('Cache-Control: max-age=0');

		$writer = new Xlsx($spreadsheet);
		$writer->save('php://output');


	}

	public function export_distribution_summary()
	{
		$spreadsheet = new Spreadsheet();
		$sheet = $spreadsheet->getActiveSheet();
		// Buat sebuah variabel untuk menampung pengaturan style dari header tabel
		$style_col = [
			'font' => ['bold' => true], // Set font nya jadi bold
			'alignment' => [
				'horizontal' => \PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER, // Set text jadi ditengah secara horizontal (center)
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'top' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border top dengan garis tipis
				'right' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN],  // Set border right dengan garis tipis
				'bottom' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border bottom dengan garis tipis
				'left' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN] // Set border left dengan garis tipis
			]
		];

		$style_range = [
			'font' => ['bold' => true], // Set font nya jadi bold
			'alignment' => [
				'horizontal' => \PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER, // Set text jadi ditengah secara horizontal (center)
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'allBorders' => [
					'borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN, // Set border top dengan garis tipis
				]
			]
		];

		$style_range_row = [
			'alignment' => [
				'horizontal' => \PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER, // Set text jadi ditengah secara horizontal (center)
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'allBorders' => [
					'borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN, // Set border top dengan garis tipis
				]
			]
		];

		// Buat sebuah variabel untuk menampung pengaturan style dari isi tabel
		$style_row = [
			'alignment' => [
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'top' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border top dengan garis tipis
				'right' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN],  // Set border right dengan garis tipis
				'bottom' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border bottom dengan garis tipis
				'left' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN] // Set border left dengan garis tipis
			]
		];

		if (isset($_POST['by_principal']))
		{
			$principal = $_POST['by_principal'];
		}
		else
		{
			$principal = "JORDAN";
		}

		if (isset($_POST['by_area']))
		{
			$area = implode(',', $_POST['by_area']);
			$area = str_replace(",", "','", $area);;
		}
		else
		{
			$area = "";
		}

		if(isset($_POST['by_year']))
		{
			$year = $_POST['by_year'];
		}else
		{
			$year = date('Y');
		}

		$old_year = (int)$year - 1;

		$get['period_so'] = $this->model('ReportModel')->getMonth_SO2($_POST['by_year']);
		$month_so = $get['period_so']['to_month'];
		$year_so = $get['period_so']['year'];

		$sheet->setCellValue('A1', "Report Distribution - SUMMARY (".$year.")"); // Set kolom A1 dengan tulisan "Report Distribution - SUMMARY"
		$sheet->setCellValue('A2', "Principal : " . $principal); // Set kolom A2 dengan tulisan "Principal : "
		$sheet->setCellValue('A3', "Area : " . $area); // Set kolom A3 dengan tulisan "Area : "
		//$sheet->mergeCells('A1:F1'); // Set Merge Cell pada kolom A1 sampai F1
		$sheet->getStyle('A1')->getFont()->setBold(true); // Set bold kolom A1
		$sheet->getStyle('A2')->getFont()->setBold(true); // Set bold kolom A2
		$sheet->getStyle('A3')->getFont()->setBold(true); // Set bold kolom A3
		$sheet->getStyle('A1')->getFont()->setSize(20); // Set font size 15 untuk kolom A1
		// Buat header tabel nya pada baris ke 5
		$sheet->setCellValue('A5', "#"); // Set kolom A5 dengan tulisan "NO"
		$sheet->mergeCells('A5:A6'); // Set Merge Row pada kolom A5 sampai A6
		$sheet->setCellValue('B5', "TYPE OF OUTLET"); 
		$sheet->mergeCells('B5:B6'); 
		$sheet->setCellValue('C5', "CODE");
		$sheet->mergeCells('C5:C6'); 
		$sheet->setCellValue('D5', "JANUARI");
		$sheet->mergeCells('D5:H5');
		$sheet->setCellValue('I5', "FEBRUARI");
		$sheet->mergeCells('I5:M5');
		$sheet->setCellValue('N5', "MARET");
		$sheet->mergeCells('N5:R5');
		$sheet->setCellValue('S5', "APRIL");
		$sheet->mergeCells('S5:W5');
		$sheet->setCellValue('X5', "MEI");
		$sheet->mergeCells('X5:AB5');
		$sheet->setCellValue('AC5', "JUNI");
		$sheet->mergeCells('AC5:AG5');
		$sheet->setCellValue('AH5', "JULI");
		$sheet->mergeCells('AH5:AL5');
		$sheet->setCellValue('AM5', "AGUSTUS");
		$sheet->mergeCells('AM5:AQ5');
		$sheet->setCellValue('AR5', "SEPTEMBER");
		$sheet->mergeCells('AR5:AV5');
		$sheet->setCellValue('AW5', "OKTOBER");
		$sheet->mergeCells('AW5:BA5');
		$sheet->setCellValue('BB5', "NOPEMBER");
		$sheet->mergeCells('BB5:BF5');
		$sheet->setCellValue('BG5', "DESEMBER");
		$sheet->mergeCells('BG5:BK5');

		$sheet->setCellValue('BM5', "PROGRESS REGISTRASI OUTLET (RO)");
		$sheet->setCellValue('CB5', "PROGRESS DISTRIBUTION (DIST)");
		$sheet->setCellValue('CQ5', "PROGRESS ACTIVE OUTLET (AO)");
		
		//Header QTY, VALUE
		$sheet->setCellValue('D6', "RO");
		$sheet->setCellValue('E6', "DIST");
		$sheet->setCellValue('F6', "DIST VS RO");
		$sheet->setCellValue('G6', "AO");
		$sheet->setCellValue('H6', "AO VS DIST");
		$sheet->setCellValue('I6', "RO");
		$sheet->setCellValue('J6', "DIST");
		$sheet->setCellValue('K6', "DIST VS RO");
		$sheet->setCellValue('L6', "AO");
		$sheet->setCellValue('M6', "AO VS DIST");
		$sheet->setCellValue('N6', "RO");
		$sheet->setCellValue('O6', "DIST");
		$sheet->setCellValue('P6', "DIST VS RO");
		$sheet->setCellValue('Q6', "AO");
		$sheet->setCellValue('R6', "AO VS DIST");
		$sheet->setCellValue('S6', "RO");
		$sheet->setCellValue('T6', "DIST");
		$sheet->setCellValue('U6', "DIST VS RO");
		$sheet->setCellValue('V6', "AO");
		$sheet->setCellValue('W6', "AO VS DIST");
		$sheet->setCellValue('X6', "RO");
		$sheet->setCellValue('Y6', "DIST");
		$sheet->setCellValue('Z6', "DIST VS RO");
		$sheet->setCellValue('AA6', "AO");
		$sheet->setCellValue('AB6', "AO VS DIST");
		$sheet->setCellValue('AC6', "RO");
		$sheet->setCellValue('AD6', "DIST");
		$sheet->setCellValue('AE6', "DIST VS RO");
		$sheet->setCellValue('AF6', "AO");
		$sheet->setCellValue('AG6', "AO VS DIST");
		$sheet->setCellValue('AH6', "RO");
		$sheet->setCellValue('AI6', "DIST");
		$sheet->setCellValue('AJ6', "DIST VS RO");
		$sheet->setCellValue('AK6', "AO");
		$sheet->setCellValue('AL6', "AO VS DIST");
		$sheet->setCellValue('AM6', "RO");
		$sheet->setCellValue('AN6', "DIST");
		$sheet->setCellValue('AO6', "DIST VS RO");
		$sheet->setCellValue('AP6', "AO");
		$sheet->setCellValue('AQ6', "AO VS DIST");
		$sheet->setCellValue('AR6', "RO");
		$sheet->setCellValue('AS6', "DIST");
		$sheet->setCellValue('AT6', "DIST VS RO");
		$sheet->setCellValue('AU6', "AO");
		$sheet->setCellValue('AV6', "AO VS DIST");
		$sheet->setCellValue('AW6', "RO");
		$sheet->setCellValue('AX6', "DIST");
		$sheet->setCellValue('AY6', "DIST VS RO");
		$sheet->setCellValue('AZ6', "AO");
		$sheet->setCellValue('BA6', "AO VS DIST");
		$sheet->setCellValue('BB6', "RO");
		$sheet->setCellValue('BC6', "DIST");
		$sheet->setCellValue('BD6', "DIST VS RO");
		$sheet->setCellValue('BE6', "AO");
		$sheet->setCellValue('BF6', "AO VS DIST");
		$sheet->setCellValue('BG6', "RO");
		$sheet->setCellValue('BH6', "DIST");
		$sheet->setCellValue('BI6', "DIST VS RO");
		$sheet->setCellValue('BJ6', "AO");
		$sheet->setCellValue('BK6', "AO VS DIST");

		$sheet->setCellValue('BM6', "JAN");
		$sheet->setCellValue('BN6', "FEB");
		$sheet->setCellValue('BO6', "MAR");
		$sheet->setCellValue('BP6', "APR");
		$sheet->setCellValue('BQ6', "MEI");
		$sheet->setCellValue('BR6', "JUN");
		$sheet->setCellValue('BS6', "JUL");
		$sheet->setCellValue('BT6', "AGU");
		$sheet->setCellValue('BU6', "SEP");
		$sheet->setCellValue('BV6', "OKT");
		$sheet->setCellValue('BW6', "NOP");
		$sheet->setCellValue('BX6', "DES");
		$sheet->setCellValue('BY6', $old_year);
		$sheet->setCellValue('BZ6', '%Growth');

		$sheet->setCellValue('CB6', "JAN");
		$sheet->setCellValue('CC6', "FEB");
		$sheet->setCellValue('CD6', "MAR");
		$sheet->setCellValue('CE6', "APR");
		$sheet->setCellValue('CF6', "MEI");
		$sheet->setCellValue('CG6', "JUN");
		$sheet->setCellValue('CH6', "JUL");
		$sheet->setCellValue('CI6', "AGU");
		$sheet->setCellValue('CJ6', "SEP");
		$sheet->setCellValue('CK6', "OKT");
		$sheet->setCellValue('CL6', "NOP");
		$sheet->setCellValue('CM6', "DES");
		$sheet->setCellValue('CN6', $old_year);
		$sheet->setCellValue('CO6', '%Growth');

		$sheet->setCellValue('CQ6', "JAN");
		$sheet->setCellValue('CR6', "FEB");
		$sheet->setCellValue('CS6', "MAR");
		$sheet->setCellValue('CT6', "APR");
		$sheet->setCellValue('CU6', "MEI");
		$sheet->setCellValue('CV6', "JUN");
		$sheet->setCellValue('CW6', "JUL");
		$sheet->setCellValue('CX6', "AGU");
		$sheet->setCellValue('CY6', "SEP");
		$sheet->setCellValue('CZ6', "OKT");
		$sheet->setCellValue('DA6', "NOP");
		$sheet->setCellValue('DB6', "DES");
		$sheet->setCellValue('DC6', $old_year);
		$sheet->setCellValue('DD6', '%Growth');
		
		// Apply style header yang telah kita buat tadi ke masing-masing kolom 
		$sheet->getStyle('A5')->applyFromArray($style_col);
		$sheet->getStyle('B5')->applyFromArray($style_col);
		$sheet->getStyle('C5')->applyFromArray($style_col);
		$sheet->getStyle('D5')->applyFromArray($style_col);
		$sheet->getStyle('E5')->applyFromArray($style_col);
		$sheet->getStyle('F5')->applyFromArray($style_col);
		$sheet->getStyle('G5')->applyFromArray($style_col);
		$sheet->getStyle('H5')->applyFromArray($style_col);
		$sheet->getStyle('I5')->applyFromArray($style_col);
		$sheet->getStyle('J5')->applyFromArray($style_col);
		$sheet->getStyle('K5')->applyFromArray($style_col);
		$sheet->getStyle('L5')->applyFromArray($style_col);
		$sheet->getStyle('M5')->applyFromArray($style_col);
		$sheet->getStyle('N5')->applyFromArray($style_col);
		$sheet->getStyle('O5')->applyFromArray($style_col);
		$sheet->getStyle('P5')->applyFromArray($style_col);
		$sheet->getStyle('Q5')->applyFromArray($style_col);
		$sheet->getStyle('R5')->applyFromArray($style_col);
		$sheet->getStyle('S5')->applyFromArray($style_col);
		$sheet->getStyle('T5')->applyFromArray($style_col);
		$sheet->getStyle('U5')->applyFromArray($style_col);
		$sheet->getStyle('V5')->applyFromArray($style_col);
		$sheet->getStyle('W5')->applyFromArray($style_col);
		$sheet->getStyle('X5')->applyFromArray($style_col);
		$sheet->getStyle('Y5')->applyFromArray($style_col);
		$sheet->getStyle('Z5')->applyFromArray($style_col);
		$sheet->getStyle('AA5')->applyFromArray($style_col);
		$sheet->getStyle('AB5')->applyFromArray($style_col);
		$sheet->getStyle('AC5')->applyFromArray($style_col);
		$sheet->getStyle('AD5')->applyFromArray($style_col);
		$sheet->getStyle('AE5')->applyFromArray($style_col);
		$sheet->getStyle('AF5')->applyFromArray($style_col);
		$sheet->getStyle('AG5')->applyFromArray($style_col);
		$sheet->getStyle('AH5')->applyFromArray($style_col);
		$sheet->getStyle('AI5')->applyFromArray($style_col);
		$sheet->getStyle('AJ5')->applyFromArray($style_col);
		$sheet->getStyle('AK5')->applyFromArray($style_col);
		$sheet->getStyle('AL5')->applyFromArray($style_col);
		$sheet->getStyle('AM5')->applyFromArray($style_col);
		$sheet->getStyle('AN5')->applyFromArray($style_col);
		$sheet->getStyle('AO5')->applyFromArray($style_col);
		$sheet->getStyle('AP5')->applyFromArray($style_col);
		$sheet->getStyle('AQ5')->applyFromArray($style_col);
		$sheet->getStyle('AR5')->applyFromArray($style_col);
		$sheet->getStyle('AS5')->applyFromArray($style_col);
		$sheet->getStyle('AT5')->applyFromArray($style_col);
		$sheet->getStyle('AU5')->applyFromArray($style_col);
		$sheet->getStyle('AV5')->applyFromArray($style_col);
		$sheet->getStyle('AW5')->applyFromArray($style_col);
		$sheet->getStyle('AX5')->applyFromArray($style_col);
		$sheet->getStyle('AY5')->applyFromArray($style_col);
		$sheet->getStyle('AZ5')->applyFromArray($style_col);
		$sheet->getStyle('BA5')->applyFromArray($style_col);
		$sheet->getStyle('BB5')->applyFromArray($style_col);
		$sheet->getStyle('BC5')->applyFromArray($style_col);
		$sheet->getStyle('BD5')->applyFromArray($style_col);
		$sheet->getStyle('BE5')->applyFromArray($style_col);
		$sheet->getStyle('BF5')->applyFromArray($style_col);
		$sheet->getStyle('BG5')->applyFromArray($style_col);
		$sheet->getStyle('BH5')->applyFromArray($style_col);
		$sheet->getStyle('BI5')->applyFromArray($style_col);
		$sheet->getStyle('BJ5')->applyFromArray($style_col);
		$sheet->getStyle('BK5')->applyFromArray($style_col);
		
		$sheet->getStyle('A6')->applyFromArray($style_col);
		$sheet->getStyle('B6')->applyFromArray($style_col);
		$sheet->getStyle('C6')->applyFromArray($style_col);
		$sheet->getStyle('D6')->applyFromArray($style_col);
		$sheet->getStyle('E6')->applyFromArray($style_col);
		$sheet->getStyle('F6')->applyFromArray($style_col);
		$sheet->getStyle('G6')->applyFromArray($style_col);
		$sheet->getStyle('H6')->applyFromArray($style_col);
		$sheet->getStyle('I6')->applyFromArray($style_col);
		$sheet->getStyle('J6')->applyFromArray($style_col);
		$sheet->getStyle('K6')->applyFromArray($style_col);
		$sheet->getStyle('L6')->applyFromArray($style_col);
		$sheet->getStyle('M6')->applyFromArray($style_col);
		$sheet->getStyle('N6')->applyFromArray($style_col);
		$sheet->getStyle('O6')->applyFromArray($style_col);
		$sheet->getStyle('P6')->applyFromArray($style_col);
		$sheet->getStyle('Q6')->applyFromArray($style_col);
		$sheet->getStyle('R6')->applyFromArray($style_col);
		$sheet->getStyle('S6')->applyFromArray($style_col);
		$sheet->getStyle('T6')->applyFromArray($style_col);
		$sheet->getStyle('U6')->applyFromArray($style_col);
		$sheet->getStyle('V6')->applyFromArray($style_col);
		$sheet->getStyle('W6')->applyFromArray($style_col);
		$sheet->getStyle('X6')->applyFromArray($style_col);
		$sheet->getStyle('Y6')->applyFromArray($style_col);
		$sheet->getStyle('Z6')->applyFromArray($style_col);
		$sheet->getStyle('AA6')->applyFromArray($style_col);
		$sheet->getStyle('AB6')->applyFromArray($style_col);
		$sheet->getStyle('AC6')->applyFromArray($style_col);
		$sheet->getStyle('AD6')->applyFromArray($style_col);
		$sheet->getStyle('AE6')->applyFromArray($style_col);
		$sheet->getStyle('AF6')->applyFromArray($style_col);
		$sheet->getStyle('AG6')->applyFromArray($style_col);
		$sheet->getStyle('AH6')->applyFromArray($style_col);
		$sheet->getStyle('AI6')->applyFromArray($style_col);
		$sheet->getStyle('AJ6')->applyFromArray($style_col);
		$sheet->getStyle('AK6')->applyFromArray($style_col);
		$sheet->getStyle('AL6')->applyFromArray($style_col);
		$sheet->getStyle('AM6')->applyFromArray($style_col);
		$sheet->getStyle('AN6')->applyFromArray($style_col);
		$sheet->getStyle('AO6')->applyFromArray($style_col);
		$sheet->getStyle('AP6')->applyFromArray($style_col);
		$sheet->getStyle('AQ6')->applyFromArray($style_col);
		$sheet->getStyle('AR6')->applyFromArray($style_col);
		$sheet->getStyle('AS6')->applyFromArray($style_col);
		$sheet->getStyle('AT6')->applyFromArray($style_col);
		$sheet->getStyle('AU6')->applyFromArray($style_col);
		$sheet->getStyle('AV6')->applyFromArray($style_col);
		$sheet->getStyle('AW6')->applyFromArray($style_col);
		$sheet->getStyle('AX6')->applyFromArray($style_col);
		$sheet->getStyle('AY6')->applyFromArray($style_col);
		$sheet->getStyle('AZ6')->applyFromArray($style_col);
		$sheet->getStyle('BA6')->applyFromArray($style_col);
		$sheet->getStyle('BB6')->applyFromArray($style_col);
		$sheet->getStyle('BC6')->applyFromArray($style_col);
		$sheet->getStyle('BD6')->applyFromArray($style_col);
		$sheet->getStyle('BE6')->applyFromArray($style_col);
		$sheet->getStyle('BF6')->applyFromArray($style_col);
		$sheet->getStyle('BG6')->applyFromArray($style_col);
		$sheet->getStyle('BH6')->applyFromArray($style_col);
		$sheet->getStyle('BI6')->applyFromArray($style_col);
		$sheet->getStyle('BJ6')->applyFromArray($style_col);
		$sheet->getStyle('BK6')->applyFromArray($style_col);

		$sheet->getStyle('BM6')->applyFromArray($style_col);
		$sheet->getStyle('BN6')->applyFromArray($style_col);
		$sheet->getStyle('BO6')->applyFromArray($style_col);
		$sheet->getStyle('BP6')->applyFromArray($style_col);
		$sheet->getStyle('BQ6')->applyFromArray($style_col);
		$sheet->getStyle('BR6')->applyFromArray($style_col);
		$sheet->getStyle('BS6')->applyFromArray($style_col);
		$sheet->getStyle('BT6')->applyFromArray($style_col);
		$sheet->getStyle('BU6')->applyFromArray($style_col);
		$sheet->getStyle('BV6')->applyFromArray($style_col);
		$sheet->getStyle('BW6')->applyFromArray($style_col);
		$sheet->getStyle('BX6')->applyFromArray($style_col);
		$sheet->getStyle('BY6')->applyFromArray($style_col);
		$sheet->getStyle('BZ6')->applyFromArray($style_col);

		$sheet->getStyle('CB6')->applyFromArray($style_col);
		$sheet->getStyle('CC6')->applyFromArray($style_col);
		$sheet->getStyle('CD6')->applyFromArray($style_col);
		$sheet->getStyle('CE6')->applyFromArray($style_col);
		$sheet->getStyle('CF6')->applyFromArray($style_col);
		$sheet->getStyle('CG6')->applyFromArray($style_col);
		$sheet->getStyle('CH6')->applyFromArray($style_col);
		$sheet->getStyle('CI6')->applyFromArray($style_col);
		$sheet->getStyle('CJ6')->applyFromArray($style_col);
		$sheet->getStyle('CK6')->applyFromArray($style_col);
		$sheet->getStyle('CL6')->applyFromArray($style_col);
		$sheet->getStyle('CM6')->applyFromArray($style_col);
		$sheet->getStyle('CN6')->applyFromArray($style_col);
		$sheet->getStyle('CO6')->applyFromArray($style_col);

		$sheet->getStyle('CQ6')->applyFromArray($style_col);
		$sheet->getStyle('CR6')->applyFromArray($style_col);
		$sheet->getStyle('CS6')->applyFromArray($style_col);
		$sheet->getStyle('CT6')->applyFromArray($style_col);
		$sheet->getStyle('CU6')->applyFromArray($style_col);
		$sheet->getStyle('CV6')->applyFromArray($style_col);
		$sheet->getStyle('CW6')->applyFromArray($style_col);
		$sheet->getStyle('CX6')->applyFromArray($style_col);
		$sheet->getStyle('CY6')->applyFromArray($style_col);
		$sheet->getStyle('CZ6')->applyFromArray($style_col);
		$sheet->getStyle('DA6')->applyFromArray($style_col);
		$sheet->getStyle('DB6')->applyFromArray($style_col);
		$sheet->getStyle('DC6')->applyFromArray($style_col);
		$sheet->getStyle('DD6')->applyFromArray($style_col);

		$sheet->getStyle('D6:BK6')->getAlignment()->setWrapText(true);

		$sheet->getStyle('A5:BK6')->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');
		$sheet->getStyle('BM6:BZ6')->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');
		$sheet->getStyle('CB6:CO6')->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');
		$sheet->getStyle('CQ6:DD6')->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');

		// Set height baris ke 1, 2 dan 3
		$sheet->getRowDimension('1')->setRowHeight(40);
		$sheet->getRowDimension('2')->setRowHeight(20);
		$sheet->getRowDimension('3')->setRowHeight(20);
		$sheet->getRowDimension('5')->setRowHeight(20);
		$sheet->getRowDimension('6')->setRowHeight(40);

		$no = 1; // Untuk penomoran tabel, di awal set dengan 1
		$row = 7;

		$data['distr_summary'] = $this->model('ReportModel')->getDistr_summary();

		$sub_ro = [];
		$sub_dist = [];
		$sub_ao = [];
		$total_ro = [];
		$total_dist = [];
		$total_ao = [];

		$sub_ro_old = 0;
		$sub_dist_old = 0;
		$sub_ao_old = 0;
		$total_ro_old = 0;
		$total_dist_old = 0;
		$total_ao_old = 0;

		// $no = 1;
		$channel = '';
		$ro_col = 64;
		$dist_col = 64 + 15;
		$ao_col = 64 + 15 + 15;

		foreach ($data['distr_summary'] as $rows) :
			// $data_col = 4;
			$data_col = 0;

			if ($channel != $rows['channel'] and $channel != '')
			{
				// $channel = $rows['channel'];
				$sheet->setCellValue('A' . $row, '');
				$sheet->setCellValue('B' . $row, $channel);
				$sheet->setCellValue('C' . $row, '');

				for($i = 1; $i <= 12; $i++)
				{
					if($i > 1)
					{
						$data_col = $data_col + 5;
					}
					else
					{
						$data_col = 4;
					}
					
					$sheet->setCellValueByColumnAndRow($data_col, $row, $sub_ro[$i]);
					$sheet->setCellValueByColumnAndRow($data_col + 1, $row, $sub_dist[$i]);
					if($sub_ro[$i] == null or $sub_ro[$i] == "0")
					{
						$sub_dist_ro = 0;
					}
					else
					{
						$sub_dist_ro = ($sub_dist[$i]/$sub_ro[$i])*100;
					}
					$sheet->setCellValueByColumnAndRow($data_col + 2, $row, number_format($sub_dist_ro, 0)." %");
					$sheet->setCellValueByColumnAndRow($data_col + 3, $row, $sub_ao[$i]);
					if($sub_dist[$i] == null or $sub_dist[$i] == "0")
					{
						$sub_ao_dist = 0;
					}
					else
					{
						$sub_ao_dist = ($sub_ao[$i]/$sub_dist[$i])*100;
					}
					$sheet->setCellValueByColumnAndRow($data_col + 4, $row, number_format($sub_ao_dist, 0)." %");
				}

				for($i = 1; $i <= 12; $i++)
				{
					$sheet->setCellValueByColumnAndRow($ro_col + $i, $row, $sub_ro[$i]);
				}

				$sheet->setCellValueByColumnAndRow($ro_col + 13, $row, $sub_ro_old);

				if($sub_ro[$month_so] == 0 or $sub_ro_old == 0)
				{
					$sheet->setCellValueByColumnAndRow($ro_col + 14, $row, '0 %');
				}
				else
				{
					$sheet->setCellValueByColumnAndRow($ro_col + 14, $row, number_format(($sub_ro[$month_so]/$sub_ro_old-1)*100, 0) . " %");
				}

				for($i = 1; $i <= 12; $i++)
				{
					$sheet->setCellValueByColumnAndRow($dist_col + $i, $row, $sub_dist[$i]);
				}

				$sheet->setCellValueByColumnAndRow($dist_col + 13, $row, $sub_dist_old);

				if($sub_dist[$month_so] == 0 or $sub_dist_old == 0)
				{
					$sheet->setCellValueByColumnAndRow($dist_col + 14, $row, '0 %');
				}
				else
				{
					$sheet->setCellValueByColumnAndRow($dist_col + 14, $row, number_format(($sub_dist[$month_so]/$sub_dist_old-1)*100, 0) . " %");
				}

				for($i = 1; $i <= 12; $i++)
				{
					$sheet->setCellValueByColumnAndRow($ao_col + $i, $row, $sub_ao[$i]);
				}

				$sheet->setCellValueByColumnAndRow($ao_col + 13, $row, $sub_ao_old);

				if($sub_ao[$month_so] == 0 or $sub_ao_old == 0)
				{
					$sheet->setCellValueByColumnAndRow($ao_col + 14, $row, '0 %');
				}
				else
				{
					$sheet->setCellValueByColumnAndRow($ao_col + 14, $row, number_format(($sub_ao[$month_so]/$sub_ao_old-1)*100, 0) . " %");
				}

				for($i = 1; $i <= 12; $i++)
				{
					$sub_ro[$i] = 0;
					$sub_dist[$i] = 0;
					$sub_ao[$i] = 0;
				}

				$sub_ro_old = 0;
				$sub_dist_old = 0;
				$sub_ao_old = 0;

				$sheet->getStyle('D' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('E' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('F' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('G' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('H' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('I' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('J' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('K' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('L' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('M' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('N' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('O' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('P' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('Q' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('R' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('S' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('T' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('U' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('V' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('W' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('X' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('Y' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('Z' . $row)->getNumberFormat()->setFormatCode('#,##0');

				$sheet->getStyle('AA' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('AB' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('AC' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('AD' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('AE' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('AF' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('AG' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('AH' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('AI' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('AJ' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('AK' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('AL' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('AM' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('AN' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('AO' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('AP' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('AQ' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('AR' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('AS' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('AT' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('AU' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('AV' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('AW' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('AX' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('AY' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('AZ' . $row)->getNumberFormat()->setFormatCode('#,##0');

				$sheet->getStyle('BA' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('BB' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('BC' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('BD' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('BE' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('BF' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('BG' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('BH' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('BI' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('BJ' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('BK' . $row)->getNumberFormat()->setFormatCode('#,##0');

				$sheet->getStyle('BM' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('BN' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('BO' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('BP' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('BQ' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('BR' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('BS' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('BT' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('BU' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('BV' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('BW' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('BX' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('BY' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('BZ' . $row)->getNumberFormat()->setFormatCode('#,##0');

				$sheet->getStyle('CB' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('CC' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('CD' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('CE' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('CF' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('CG' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('CH' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('CI' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('CJ' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('CK' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('CL' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('CM' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('CN' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('CO' . $row)->getNumberFormat()->setFormatCode('#,##0');

				$sheet->getStyle('CQ' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('CR' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('CS' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('CT' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('CU' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('CV' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('CW' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('CX' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('CY' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('CZ' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('DA' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('DB' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('DC' . $row)->getNumberFormat()->setFormatCode('#,##0');
				$sheet->getStyle('DD' . $row)->getNumberFormat()->setFormatCode('#,##0');

				$sheet->getStyle('A' . $row)->applyFromArray($style_row);
				$sheet->getStyle('B' . $row)->applyFromArray($style_row);
				$sheet->getStyle('C' . $row)->applyFromArray($style_row);
				$sheet->getStyleByColumnAndRow(1, $row, 63, $row)->applyFromArray($style_range);
				$sheet->getStyleByColumnAndRow(65, $row, 65 + 13, $row)->applyFromArray($style_range);
				$sheet->getStyleByColumnAndRow(80, $row, 80 + 13, $row)->applyFromArray($style_range);
				$sheet->getStyleByColumnAndRow(95, $row, 95 + 13, $row)->applyFromArray($style_range);
				$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
				$sheet->getStyleByColumnAndRow(4, $row, 63, $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyleByColumnAndRow(65, $row, 65 + 13, $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyleByColumnAndRow(80, $row, 80 + 13, $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyleByColumnAndRow(95, $row, 95 + 13, $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
				$sheet->getStyleByColumnAndRow(1, $row, 63, $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('d9e1f2');
				$sheet->getStyleByColumnAndRow(65, $row, 65 + 13, $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('d9e1f2');
				$sheet->getStyleByColumnAndRow(80, $row, 80 + 13, $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('d9e1f2');
				$sheet->getStyleByColumnAndRow(95, $row, 95 + 13, $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('d9e1f2');

				$row++;
			}

			$sheet->setCellValue('A' . $row, $no);
			$sheet->setCellValue('B' . $row, $rows['desc_type']);
			$sheet->setCellValue('C' . $row, $rows['outlet_type']);

			for($i = 1; $i <= 12; $i++)
			{
				if($i > 1)
				{
					$data_col = $data_col + 5;
				}
				else
				{
					$data_col = 4;
				}
				
				$sheet->setCellValueByColumnAndRow($data_col, $row, number_format($rows['RO_'.$i], 0));
				$sheet->setCellValueByColumnAndRow($data_col + 1, $row, number_format($rows['DIST_'.$i], 0));
				if($rows['RO_'.$i] == null or $rows['RO_'.$i] == "0")
				{
					$dist_ro = 0;
				}
				else
				{
					$dist_ro = ($rows['DIST_'.$i]/$rows['RO_'.$i])*100;
				}
				$sheet->setCellValueByColumnAndRow($data_col + 2, $row, number_format($dist_ro, 0)." %");
				$sheet->setCellValueByColumnAndRow($data_col + 3, $row, number_format($rows['AO_'.$i], 0));
				if($rows['DIST_'.$i] == null or $rows['DIST_'.$i] == "0")
				{
					$ao_dist = 0;
				}
				else
				{
					$ao_dist = ($rows['AO_'.$i]/$rows['DIST_'.$i])*100;
				}
				$sheet->setCellValueByColumnAndRow($data_col + 4, $row, number_format($ao_dist, 0)." %");

				$sub_ro[$i] += $rows['RO_'.$i];
				$sub_dist[$i] += $rows['DIST_'.$i];
				$sub_ao[$i] += $rows['AO_'.$i];
				$total_ro[$i] += $rows['RO_'.$i];
				$total_dist[$i] += $rows['DIST_'.$i];
				$total_ao[$i] += $rows['AO_'.$i];

			}

			for($i = 1; $i <= 12; $i++)
			{
				$sheet->setCellValueByColumnAndRow($ro_col + $i, $row, number_format($rows['RO_'.$i], 0));
			}

			$sheet->setCellValueByColumnAndRow($ro_col + 13, $row, number_format($rows['RO_12_old'], 0));

			if($rows['RO_'.$month_so] == 0 or $rows['RO_12_old'] == 0)
			{
				$sheet->setCellValueByColumnAndRow($ro_col + 14, $row, '0 %');
			}
			else
			{
				$sheet->setCellValueByColumnAndRow($ro_col + 14, $row, number_format(($rows['RO_'.$month_so]/$rows['RO_12_old']-1)*100, 0) . " %");
			}

			for($i = 1; $i <= 12; $i++)
			{
				$sheet->setCellValueByColumnAndRow($dist_col + $i, $row, number_format($rows['DIST_'.$i], 0));
			}

			$sheet->setCellValueByColumnAndRow($dist_col + 13, $row, number_format($rows['DIST_12_old'], 0));

			if($rows['DIST_'.$month_so] == 0 or $rows['DIST_12_old'] == 0)
			{
				$sheet->setCellValueByColumnAndRow($dist_col + 14, $row, '0 %');
			}
			else
			{
				$sheet->setCellValueByColumnAndRow($dist_col + 14, $row, number_format(($rows['DIST_'.$month_so]/$rows['DIST_12_old']-1)*100, 0) . " %");
			}

			for($i = 1; $i <= 12; $i++)
			{
				$sheet->setCellValueByColumnAndRow($ao_col + $i, $row, number_format($rows['AO_'.$i], 0));
			}

			$sheet->setCellValueByColumnAndRow($ao_col + 13, $row, number_format($rows['AO_12_old'], 0));

			if($rows['AO_'.$month_so] == 0 or $rows['AO_12_old'] == 0)
			{
				$sheet->setCellValueByColumnAndRow($ao_col + 14, $row, '0 %');
			}
			else
			{
				$sheet->setCellValueByColumnAndRow($ao_col + 14, $row, number_format(($rows['AO_'.$month_so]/$rows['AO_12_old']-1)*100, 0) . " %");
			}

			$sub_ro_old += $rows['RO_12_old'];
			$sub_dist_old += $rows['DIST_12_old'];
			$sub_ao_old += $rows['AO_12_old'];
			$total_ro_old += $rows['RO_12_old'];
			$total_dist_old += $rows['DIST_12_old'];
			$total_ao_old += $rows['AO_12_old'];

			$channel = $rows['channel'];

			$sheet->getStyle('D' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('E' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('F' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('G' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('H' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('I' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('J' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('K' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('L' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('M' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('N' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('O' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('P' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('Q' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('R' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('S' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('T' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('U' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('V' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('W' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('X' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('Y' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('Z' . $row)->getNumberFormat()->setFormatCode('#,##0');

			$sheet->getStyle('AA' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('AB' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('AC' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('AD' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('AE' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('AF' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('AG' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('AH' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('AI' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('AJ' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('AK' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('AL' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('AM' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('AN' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('AO' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('AP' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('AQ' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('AR' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('AS' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('AT' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('AU' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('AV' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('AW' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('AX' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('AY' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('AZ' . $row)->getNumberFormat()->setFormatCode('#,##0');

			$sheet->getStyle('BA' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('BB' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('BC' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('BD' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('BE' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('BF' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('BG' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('BH' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('BI' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('BJ' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('BK' . $row)->getNumberFormat()->setFormatCode('#,##0');

			$sheet->getStyle('BM' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('BN' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('BO' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('BP' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('BQ' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('BR' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('BS' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('BT' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('BU' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('BV' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('BW' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('BX' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('BY' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('BZ' . $row)->getNumberFormat()->setFormatCode('#,##0');

			$sheet->getStyle('CB' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('CC' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('CD' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('CE' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('CF' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('CG' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('CH' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('CI' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('CJ' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('CK' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('CL' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('CM' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('CN' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('CO' . $row)->getNumberFormat()->setFormatCode('#,##0');

			$sheet->getStyle('CQ' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('CR' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('CS' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('CT' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('CU' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('CV' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('CW' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('CX' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('CY' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('CZ' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('DA' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('DB' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('DC' . $row)->getNumberFormat()->setFormatCode('#,##0');
			$sheet->getStyle('DD' . $row)->getNumberFormat()->setFormatCode('#,##0');

			$sheet->getStyle('A' . $row)->applyFromArray($style_row);
			$sheet->getStyle('B' . $row)->applyFromArray($style_row);
			$sheet->getStyle('C' . $row)->applyFromArray($style_row);
			$sheet->getStyleByColumnAndRow(4, $row, 63, $row)->applyFromArray($style_range_row);
			$sheet->getStyleByColumnAndRow(65, $row, 65 + 13, $row)->applyFromArray($style_range_row);
			$sheet->getStyleByColumnAndRow(80, $row, 80 + 13, $row)->applyFromArray($style_range_row);
			$sheet->getStyleByColumnAndRow(95, $row, 95 + 13, $row)->applyFromArray($style_range_row);
			$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyleByColumnAndRow(4, $row, 63, $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyleByColumnAndRow(65, $row, 65 + 13, $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyleByColumnAndRow(80, $row, 80 + 13, $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
			$sheet->getStyleByColumnAndRow(95, $row, 95 + 13, $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

			$no++;
			$row++;
		endforeach;
		
		// End Of Channel
		$sheet->setCellValue('A' . $row, '');
		$sheet->setCellValue('B' . $row, $channel);
		$sheet->setCellValue('C' . $row, '');

		for($i = 1; $i <= 12; $i++)
		{
			if($i > 1)
			{
				$data_col = $data_col + 5;
			}
			else
			{
				$data_col = 4;
			}
			
			$sheet->setCellValueByColumnAndRow($data_col, $row, $sub_ro[$i]);
			$sheet->setCellValueByColumnAndRow($data_col + 1, $row, $sub_dist[$i]);
			if($sub_ro[$i] == null or $sub_ro[$i] == "0")
			{
				$sub_dist_ro = 0;
			}
			else
			{
				$sub_dist_ro = ($sub_dist[$i]/$sub_ro[$i])*100;
			}
			$sheet->setCellValueByColumnAndRow($data_col + 2, $row, number_format($sub_dist_ro, 0)." %");
			$sheet->setCellValueByColumnAndRow($data_col + 3, $row, $sub_ao[$i]);
			if($sub_dist[$i] == null or $sub_dist[$i] == "0")
			{
				$sub_ao_dist = 0;
			}
			else
			{
				$sub_ao_dist = ($sub_ao[$i]/$sub_dist[$i])*100;
			}
			$sheet->setCellValueByColumnAndRow($data_col + 4, $row, number_format($sub_ao_dist, 0)." %");
		}

		for($i = 1; $i <= 12; $i++)
		{
			$sheet->setCellValueByColumnAndRow($ro_col + $i, $row, $sub_ro[$i]);
		}

		$sheet->setCellValueByColumnAndRow($ro_col + 13, $row, $sub_ro_old);

		if($sub_ro[$month_so] == 0 or $sub_ro_old == 0)
		{
			$sheet->setCellValueByColumnAndRow($ro_col + 14, $row, '0 %');
		}
		else
		{
			$sheet->setCellValueByColumnAndRow($ro_col + 14, $row, number_format(($sub_ro[$month_so]/$sub_ro_old-1)*100, 0) . " %");
		}

		for($i = 1; $i <= 12; $i++)
		{
			$sheet->setCellValueByColumnAndRow($dist_col + $i, $row, $sub_dist[$i]);
		}

		$sheet->setCellValueByColumnAndRow($dist_col + 13, $row, $sub_dist_old);

		if($sub_dist[$month_so] == 0 or $sub_dist_old == 0)
		{
			$sheet->setCellValueByColumnAndRow($dist_col + 14, $row, '0 %');
		}
		else
		{
			$sheet->setCellValueByColumnAndRow($dist_col + 14, $row, number_format(($sub_dist[$month_so]/$sub_dist_old-1)*100, 0) . " %");
		}

		for($i = 1; $i <= 12; $i++)
		{
			$sheet->setCellValueByColumnAndRow($ao_col + $i, $row, $sub_ao[$i]);
		}

		$sheet->setCellValueByColumnAndRow($ao_col + 13, $row, $sub_ao_old);

		if($sub_ao[$month_so] == 0 or $sub_ao_old == 0)
		{
			$sheet->setCellValueByColumnAndRow($ao_col + 14, $row, '0 %');
		}
		else
		{
			$sheet->setCellValueByColumnAndRow($ao_col + 14, $row, number_format(($sub_ao[$month_so]/$sub_ao_old-1)*100, 0) . " %");
		}

		for($i = 1; $i <= 12; $i++)
		{
			$sub_ro[$i] = 0;
			$sub_dist[$i] = 0;
			$sub_ao[$i] = 0;
		}

		$sub_ro_old = 0;
		$sub_dist_old = 0;
		$sub_ao_old = 0;

		$sheet->getStyle('D' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('E' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('F' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('G' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('H' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('I' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('J' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('K' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('L' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('M' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('N' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('O' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('P' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('Q' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('R' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('S' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('T' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('U' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('V' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('W' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('X' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('Y' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('Z' . $row)->getNumberFormat()->setFormatCode('#,##0');

		$sheet->getStyle('AA' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AB' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AC' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AD' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AE' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AF' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AG' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AH' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AI' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AJ' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AK' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AL' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AM' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AN' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AO' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AP' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AQ' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AR' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AS' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AT' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AU' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AV' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AW' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AX' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AY' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AZ' . $row)->getNumberFormat()->setFormatCode('#,##0');

		$sheet->getStyle('BA' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('BB' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('BC' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('BD' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('BE' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('BF' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('BG' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('BH' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('BI' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('BJ' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('BK' . $row)->getNumberFormat()->setFormatCode('#,##0');

		$sheet->getStyle('BM' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('BN' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('BO' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('BP' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('BQ' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('BR' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('BS' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('BT' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('BU' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('BV' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('BW' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('BX' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('BY' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('BZ' . $row)->getNumberFormat()->setFormatCode('#,##0');

		$sheet->getStyle('CB' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('CC' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('CD' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('CE' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('CF' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('CG' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('CH' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('CI' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('CJ' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('CK' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('CL' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('CM' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('CN' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('CO' . $row)->getNumberFormat()->setFormatCode('#,##0');

		$sheet->getStyle('CQ' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('CR' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('CS' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('CT' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('CU' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('CV' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('CW' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('CX' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('CY' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('CZ' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('DA' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('DB' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('DC' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('DD' . $row)->getNumberFormat()->setFormatCode('#,##0');

		$sheet->getStyle('A' . $row)->applyFromArray($style_row);
		$sheet->getStyle('B' . $row)->applyFromArray($style_row);
		$sheet->getStyle('C' . $row)->applyFromArray($style_row);
		$sheet->getStyleByColumnAndRow(1, $row, 63, $row)->applyFromArray($style_range);
		$sheet->getStyleByColumnAndRow(65, $row, 65 + 13, $row)->applyFromArray($style_range);
		$sheet->getStyleByColumnAndRow(80, $row, 80 + 13, $row)->applyFromArray($style_range);
		$sheet->getStyleByColumnAndRow(95, $row, 95 + 13, $row)->applyFromArray($style_range);
		$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyleByColumnAndRow(4, $row, 63, $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyleByColumnAndRow(65, $row, 65 + 13, $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyleByColumnAndRow(80, $row, 80 + 13, $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyleByColumnAndRow(95, $row, 95 + 13, $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyleByColumnAndRow(1, $row, 63, $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('d9e1f2');
		$sheet->getStyleByColumnAndRow(65, $row, 65 + 13, $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('d9e1f2');
		$sheet->getStyleByColumnAndRow(80, $row, 80 + 13, $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('d9e1f2');
		$sheet->getStyleByColumnAndRow(95, $row, 95 + 13, $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('d9e1f2');

		$row++;

		// TOTAL
		$sheet->setCellValue('A' . $row, '');
		$sheet->setCellValue('B' . $row, 'TOTAL');
		$sheet->setCellValue('C' . $row, '');

		for($i = 1; $i <= 12; $i++)
		{
			if($i > 1)
			{
				$data_col = $data_col + 5;
			}
			else
			{
				$data_col = 4;
			}
			
			$sheet->setCellValueByColumnAndRow($data_col, $row, $total_ro[$i]);
			$sheet->setCellValueByColumnAndRow($data_col + 1, $row, $total_dist[$i]);
			if($total_ro[$i] == null or $total_ro[$i] == "0")
			{
				$total_dist_ro = 0;
			}
			else
			{
				$total_dist_ro = ($total_dist[$i]/$total_ro[$i])*100;
			}
			$sheet->setCellValueByColumnAndRow($data_col + 2, $row, number_format($total_dist_ro, 0)." %");
			$sheet->setCellValueByColumnAndRow($data_col + 3, $row, $total_ao[$i]);
			if($total_dist[$i] == null or $total_dist[$i] == "0")
			{
				$total_ao_dist = 0;
			}
			else
			{
				$total_ao_dist = ($total_ao[$i]/$total_dist[$i])*100;
			}
			$sheet->setCellValueByColumnAndRow($data_col + 4, $row, number_format($total_ao_dist, 0)." %");
		}

		for($i = 1; $i <= 12; $i++)
		{
			$sheet->setCellValueByColumnAndRow($ro_col + $i, $row, $total_ro[$i]);
		}

		$sheet->setCellValueByColumnAndRow($ro_col + 13, $row, $total_ro_old);

		if($total_ro[$month_so] == 0 or $total_ro_old == 0)
		{
			$sheet->setCellValueByColumnAndRow($ro_col + 14, $row, '0 %');
		}
		else
		{
			$sheet->setCellValueByColumnAndRow($ro_col + 14, $row, number_format(($total_ro[$month_so]/$total_ro_old-1)*100, 0) . " %");
		}

		for($i = 1; $i <= 12; $i++)
		{
			$sheet->setCellValueByColumnAndRow($dist_col + $i, $row, $total_dist[$i]);
		}

		$sheet->setCellValueByColumnAndRow($dist_col + 13, $row, $total_dist_old);

		if($total_dist[$month_so] == 0 or $total_dist_old == 0)
		{
			$sheet->setCellValueByColumnAndRow($dist_col + 14, $row, '0 %');
		}
		else
		{
			$sheet->setCellValueByColumnAndRow($dist_col + 14, $row, number_format(($total_dist[$month_so]/$total_dist_old-1)*100, 0) . " %");
		}

		for($i = 1; $i <= 12; $i++)
		{
			$sheet->setCellValueByColumnAndRow($ao_col + $i, $row, $total_ao[$i]);
		}

		$sheet->setCellValueByColumnAndRow($ao_col + 13, $row, $total_ao_old);

		if($total_ao[$month_so] == 0 or $total_ao_old == 0)
		{
			$sheet->setCellValueByColumnAndRow($ao_col + 14, $row, '0 %');
		}
		else
		{
			$sheet->setCellValueByColumnAndRow($ao_col + 14, $row, number_format(($total_ao[$month_so]/$total_ao_old-1)*100, 0) . " %");
		}

		$sheet->getStyle('D' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('E' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('F' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('G' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('H' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('I' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('J' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('K' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('L' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('M' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('N' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('O' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('P' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('Q' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('R' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('S' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('T' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('U' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('V' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('W' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('X' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('Y' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('Z' . $row)->getNumberFormat()->setFormatCode('#,##0');

		$sheet->getStyle('AA' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AB' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AC' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AD' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AE' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AF' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AG' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AH' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AI' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AJ' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AK' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AL' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AM' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AN' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AO' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AP' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AQ' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AR' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AS' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AT' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AU' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AV' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AW' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AX' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AY' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('AZ' . $row)->getNumberFormat()->setFormatCode('#,##0');

		$sheet->getStyle('BA' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('BB' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('BC' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('BD' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('BE' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('BF' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('BG' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('BH' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('BI' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('BJ' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('BK' . $row)->getNumberFormat()->setFormatCode('#,##0');

		$sheet->getStyle('BM' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('BN' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('BO' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('BP' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('BQ' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('BR' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('BS' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('BT' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('BU' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('BV' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('BW' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('BX' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('BY' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('BZ' . $row)->getNumberFormat()->setFormatCode('#,##0');

		$sheet->getStyle('CB' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('CC' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('CD' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('CE' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('CF' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('CG' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('CH' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('CI' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('CJ' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('CK' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('CL' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('CM' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('CN' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('CO' . $row)->getNumberFormat()->setFormatCode('#,##0');

		$sheet->getStyle('CQ' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('CR' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('CS' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('CT' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('CU' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('CV' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('CW' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('CX' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('CY' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('CZ' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('DA' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('DB' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('DC' . $row)->getNumberFormat()->setFormatCode('#,##0');
		$sheet->getStyle('DD' . $row)->getNumberFormat()->setFormatCode('#,##0');

		$sheet->getStyle('A' . $row)->applyFromArray($style_row);
		$sheet->getStyle('B' . $row)->applyFromArray($style_row);
		$sheet->getStyle('C' . $row)->applyFromArray($style_row);
		$sheet->getStyleByColumnAndRow(1, $row, 63, $row)->applyFromArray($style_range);
		$sheet->getStyleByColumnAndRow(65, $row, 65 + 13, $row)->applyFromArray($style_range);
		$sheet->getStyleByColumnAndRow(80, $row, 80 + 13, $row)->applyFromArray($style_range);
		$sheet->getStyleByColumnAndRow(95, $row, 95 + 13, $row)->applyFromArray($style_range);
		$sheet->getStyle('A' . $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
		$sheet->getStyleByColumnAndRow(4, $row, 63, $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyleByColumnAndRow(65, $row, 65 + 13, $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyleByColumnAndRow(80, $row, 80 + 13, $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyleByColumnAndRow(95, $row, 95 + 13, $row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		$sheet->getStyleByColumnAndRow(1, $row, 63, $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFA07A');
		$sheet->getStyleByColumnAndRow(65, $row, 65 + 13, $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFA07A');
		$sheet->getStyleByColumnAndRow(80, $row, 80 + 13, $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFA07A');
		$sheet->getStyleByColumnAndRow(95, $row, 95 + 13, $row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFA07A');

		$sheet->getColumnDimension('A')->setWidth(5); // Set width kolom A
		$sheet->getColumnDimension('B')->setWidth(40); // Set width kolom B
		$sheet->getColumnDimension('C')->setWidth(11); // Set width kolom C
		// $sheet->getColumnDimension('D')->setWidth(10);

		// Set orientasi kertas jadi LANDSCAPE
		$sheet->getPageSetup()->setOrientation(\PhpOffice\PhpSpreadsheet\Worksheet\PageSetup::ORIENTATION_LANDSCAPE);
		// Set judul file excel nya
		$sheet->setTitle("Distribution - SUMMARY");
		// Proses file excel
		header('Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet');
		header('Content-Disposition: attachment; filename="Report Distribution - SUMMARY.xlsx"'); // Set nama file excel nya
		header('Cache-Control: max-age=0');

		$writer = new Xlsx($spreadsheet);
		$writer->save('php://output');


	}

	public function export_ao_direct_jordan()
	{
		$spreadsheet = new Spreadsheet();
		$sheet = $spreadsheet->getActiveSheet();
		// Buat sebuah variabel untuk menampung pengaturan style dari header tabel
		$style_col = [
			'font' => ['bold' => true], // Set font nya jadi bold
			'alignment' => [
				'horizontal' => \PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER, // Set text jadi ditengah secara horizontal (center)
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'top' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border top dengan garis tipis
				'right' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN],  // Set border right dengan garis tipis
				'bottom' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border bottom dengan garis tipis
				'left' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN] // Set border left dengan garis tipis
			]
		];

		$style_range = [
			'font' => ['bold' => true], // Set font nya jadi bold
			'alignment' => [
				'horizontal' => \PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER, // Set text jadi ditengah secara horizontal (center)
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'allBorders' => [
					'borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN, // Set border top dengan garis tipis
				]
			]
		];

		$style_range_row = [
			'alignment' => [
				'horizontal' => \PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER, // Set text jadi ditengah secara horizontal (center)
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'allBorders' => [
					'borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN, // Set border top dengan garis tipis
				]
			]
		];

		// Buat sebuah variabel untuk menampung pengaturan style dari isi tabel
		$style_row = [
			'alignment' => [
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'top' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border top dengan garis tipis
				'right' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN],  // Set border right dengan garis tipis
				'bottom' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border bottom dengan garis tipis
				'left' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN] // Set border left dengan garis tipis
			]
		];


		if(isset($_POST['by_region']))
		{
			$region = $_POST['by_region'];
		}else
		{
			$region = "";
		}

		if(isset($_POST['by_area']))
		{
			$area = $_POST['by_area'];
		}else
		{
			$area = "";
		}

		if(isset($_POST['by_island']))
		{
			$island = $_POST['by_island'];
		}else
		{
			$island = "";
		}

		if(isset($_POST['by_month1']))
		{
			$month1 = $_POST['by_month1'];
		}else
		{
			$month1 = date('m');
		}

		if(isset($_POST['by_month2']))
		{
			$month2 = $_POST['by_month2'];
		}else
		{
			$month2 = date('m');
		}

		if(isset($_POST['by_year']))
		{
			$year = $_POST['by_year'];
		}else
		{
			$year = date('Y');
		}

		$data['sku_name'] = $this->model('SkuModel')->getItemNameSKUJordan();
		$data['sku_group'] = $this->model('SkuModel')->getGroupSKUJordan();
		$data['sku_count'] = $this->model('SkuModel')->getCountSKUJordan();
		$data['sku_code'] = $this->model('SkuModel')->getItemCodeSKUJordan();

		//$dateObj   = DateTime::createFromFormat('!m', $month);
		//$monthName = $dateObj->format('F'); // March

		$dateObj1   = DateTime::createFromFormat('!m', $month1);
		$dateObj2   = DateTime::createFromFormat('!m', $month2);
        $monthName1 = $dateObj1->format('F');
		$monthName2 = $dateObj2->format('F');

		$data['title'] = 'Contribution Summary - LORD (' . $monthName1 . ' To ' . $monthName2 . ')';

		$sheet->setCellValue('A1', "Direct Active Outlet - JORDAN"); // Set kolom A1 dengan tulisan "Report Selling In - By Outlet"
		$sheet->setCellValue('A2', "Island : " . $island); // Set kolom A2 dengan tulisan "Outlet Type : EC_EC"
		$sheet->setCellValue('A3', "Region : " . $region); // Set kolom A3 dengan tulisan "Outlet Type : EC_EC"
		$sheet->setCellValue('A4', "Area : " . $area);
		$sheet->setCellValue('A5', "Month : " . $monthName1 . " to " . $monthName1 . " - " . $year);
		//$sheet->mergeCells('A1:F1'); // Set Merge Cell pada kolom A1 sampai F1
		$sheet->getStyle('A1')->getFont()->setBold(true); // Set bold kolom A1
		$sheet->getStyle('A2')->getFont()->setBold(true); // Set bold kolom A2
		$sheet->getStyle('A3')->getFont()->setBold(true); // Set bold kolom A3
		$sheet->getStyle('A4')->getFont()->setBold(true);
		$sheet->getStyle('A5')->getFont()->setBold(true);
		$sheet->getStyle('A1')->getFont()->setSize(20); // Set font size 15 untuk kolom A1
		// Buat header tabel nya pada baris ke 7
		$sheet->setCellValue('A7', "#"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('A7:A9'); // Set Merge Row pada kolom A6 sampai A8
		$sheet->setCellValue('B7', "TYPE OF OUTLET"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('B7:B9'); // Set Merge Row pada kolom A6 sampai A8
		$sheet->setCellValue('C7', "Code"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('C7:C9'); // Set Merge Row pada kolom A6 sampai A8
		$sheet->setCellValue('D7', "RO"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('D7:D9');
		$start_col = 5;

		foreach ($data['sku_group'] as $row_sku) :
			//$sheet->setCellValue('E7', $row_sku['item_group']);
			$sheet->setCellValueByColumnAndRow($start_col, 7, $row_sku['item_group']);
			$last_col = $start_col + ($row_sku['count_name']*2) - 1;
			$sheet->mergeCellsByColumnAndRow($start_col, 7, $last_col, 7);
			$start_col = $last_col + 1;
		endforeach;

		$sheet->setCellValueByColumnAndRow($start_col, 7, 'TOTAL');
		$sheet->mergeCellsByColumnAndRow($start_col, 7, $start_col + 1 , 8);

		$start_col = 5;
		foreach ($data['sku_name'] as $row_sku) :
			//$sheet->setCellValue('E7', $row_sku['item_group']);
			$sheet->setCellValueByColumnAndRow($start_col, 8, $row_sku['item_name']);
			$last_col = $start_col + 1;
			$sheet->mergeCellsByColumnAndRow($start_col, 8, $last_col, 8);
			$start_col = $last_col + 1;
		endforeach;
		$start_col = 5;
		foreach ($data['sku_name'] as $row_sku) :
			$sheet->setCellValueByColumnAndRow($start_col, 9, "AO");
			$start_col = $start_col + 1;
			$sheet->setCellValueByColumnAndRow($start_col, 9, "%");
			$start_col = $start_col + 1;
		endforeach;

		$sheet->setCellValueByColumnAndRow($start_col, 9, "AO");
		$sheet->setCellValueByColumnAndRow($start_col + 1, 9, "%");
		
		// Apply style header yang telah kita buat tadi ke masing-masing kolom header
		$sheet->getStyleByColumnAndRow(1, 8, $last_col, 8)->getAlignment()->setWrapText(true);
		$sheet->getStyleByColumnAndRow(1, 9, $last_col, 9)->getAlignment()->setWrapText(true);
		$sheet->getStyleByColumnAndRow(1, 7, $last_col, 9)->applyFromArray($style_range);
		$sheet->getStyleByColumnAndRow(1, 7, $last_col, 9)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');
		$sheet->getStyleByColumnAndRow($last_col + 1, 7, $last_col + 2, 9)->getAlignment()->setWrapText(true);
		$sheet->getStyleByColumnAndRow($last_col + 1, 7, $last_col + 2, 9)->applyFromArray($style_range);
		$sheet->getStyleByColumnAndRow($last_col + 1, 7, $last_col + 2, 9)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FF6D6D');

		// Set height baris ke 1, 2 dan 3
		$sheet->getRowDimension('1')->setRowHeight(40);
		$sheet->getRowDimension('2')->setRowHeight(20);
		$sheet->getRowDimension('3')->setRowHeight(20);
		$sheet->getRowDimension('4')->setRowHeight(20);
		$sheet->getRowDimension('5')->setRowHeight(20);
		$sheet->getRowDimension('8')->setRowHeight(60);

		$no = 1; // Untuk penomoran tabel, di awal set dengan 1
		$row = 10;

		$data1 = array(
			'island' => $island,
			'region' => $region,
			'area' => $area,
			'month1' => $month1,
			'month2' => $month2,
			'year' => $year
		);

		//$this->model('ReportModel')->getAO_jordan1_export($data1);
		//$this->model('ReportModel')->getAO_jordan2_export($data1);

		$data['ao_jordan'] = $this->model('ReportModel')->getAO_direct_jordan($data);

		$data_col = 1;
		$data_row = 10;

		$channel='';

		$total_RO = 0;
		$x=1;
		foreach($data['sku_code'] as $sku):
			$total_d[$x] = 0;
			$total_p[$x] = 0;
			$x++;
		endforeach;
		
		$total_dAll = 0;
		$total_pAll = 0;

		foreach ($data['ao_jordan'] as $rows) :
			$data_col = 1;

			if ($channel != $rows['channel'])
            {
				$channel = $rows['channel'];
				$sheet->setCellValueByColumnAndRow($data_col, $data_row, '');
				$sheet->setCellValueByColumnAndRow($data_col + 1, $data_row, $rows['channel']);
				$sheet->setCellValueByColumnAndRow($data_col + 2, $data_row, '');
				$sheet->setCellValueByColumnAndRow($data_col + 3, $data_row, '');
				$a=1;
				$baris=4;
				foreach($data['sku_code'] as $sku):
					$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, '');
					$baris = $baris + 1;
					$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, '');
					$a++;
					$baris++;
				endforeach;
				$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, '');
				$sheet->setCellValueByColumnAndRow($data_col + $baris + 1, $data_row, '');

				$sheet->getStyleByColumnAndRow(1, $data_row, $last_col + 2, $data_row)->applyFromArray($style_range);
				$sheet->getStyleByColumnAndRow(1, $data_row, $last_col + 2, $data_row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('d9e1f2');

				$data_row++;

			}

			$sheet->setCellValueByColumnAndRow($data_col, $data_row, $no);
			$sheet->setCellValueByColumnAndRow($data_col + 1, $data_row, $rows['desc_type']);
			$sheet->setCellValueByColumnAndRow($data_col + 2, $data_row, $rows['outlet_type']);
			$sheet->setCellValueByColumnAndRow($data_col + 3, $data_row, number_format($rows['RO'], 0));
			$a=1;
			$baris=4;
			foreach($data['sku_code'] as $sku):
				$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($rows['d'.$a], 0));
				$baris = $baris + 1;
				$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($rows['%'.$a], 2));
				$a++;
				$baris++;
			endforeach;
			
			$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($rows['dtotal'], 0));
			$sheet->setCellValueByColumnAndRow($data_col + $baris + 1, $data_row, number_format($rows['%total'], 0));

			$total_RO += $rows['RO'];
			$x = 1;
			foreach($data['sku_code'] as $sku):
				$total_d[$x] += $rows['d'.$x];
				$total_p[$x] = ($total_d[$x]/($total_RO ?: 1))*100;
				$x++;
			endforeach;
			
			$total_dAll += $rows['dtotal'];

			
			// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
			$sheet->getStyleByColumnAndRow(1, $data_row, $last_col + 2, $data_row)->applyFromArray($style_range_row);
			$sheet->getStyleByColumnAndRow(1, $data_row, null, $data_row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyleByColumnAndRow(2, $data_row, null, $data_row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyleByColumnAndRow(3, $data_row, null, $data_row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyleByColumnAndRow(4, 10, $last_col + 2, $data_row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

			$no++; // Tambah 1 setiap kali looping
    		$row++; // Tambah 1 setiap kali looping
			$data_row++;
		endforeach;

		$total_pAll = ($total_dAll/($total_RO ?: 1))*100;

		//$data_row = $data_row + 1;

		$sheet->setCellValueByColumnAndRow($data_col, $data_row, '');
		$sheet->setCellValueByColumnAndRow($data_col + 1, $data_row, 'TOTAL');
		$sheet->setCellValueByColumnAndRow($data_col + 2, $data_row, '');
		$sheet->setCellValueByColumnAndRow($data_col + 3, $data_row, number_format($total_RO, 0));
		$a=1;
		$baris=4;
		foreach($data['sku_code'] as $sku):
			$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($total_d[$a], 0));
			$baris = $baris + 1;
			$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($total_p[$a], 2));
			$a++;
			$baris++;
		endforeach;
		
		$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($total_dAll, 0));
		$sheet->setCellValueByColumnAndRow($data_col + $baris + 1, $data_row, number_format($total_pAll, 2));

		$sheet->getStyleByColumnAndRow(1, $data_row, $last_col + 2, $data_row)->applyFromArray($style_range);
		$sheet->getStyleByColumnAndRow(1, $data_row, $last_col + 2, $data_row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFA07A');

		$sheet->getStyleByColumnAndRow(4, 10, $last_col + 2, $data_row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		

		$sheet->getColumnDimension('A')->setWidth(5); // Set width kolom A
		$sheet->getColumnDimension('B')->setWidth(40); // Set width kolom B
		$sheet->getColumnDimension('C')->setWidth(11); // Set width kolom C
		$sheet->getColumnDimension('D')->setWidth(10);

		// Set orientasi kertas jadi LANDSCAPE
		$sheet->getPageSetup()->setOrientation(\PhpOffice\PhpSpreadsheet\Worksheet\PageSetup::ORIENTATION_LANDSCAPE);
		// Set judul file excel nya
		$sheet->setTitle("Direct Active Outlet - JORDAN");
		// Proses file excel
		header('Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet');
		header('Content-Disposition: attachment; filename="Direct Active Outlet - JORDAN.xlsx"'); // Set nama file excel nya
		header('Cache-Control: max-age=0');

		$writer = new Xlsx($spreadsheet);
		$writer->save('php://output');


	}

	public function export_ao_direct_lord()
	{
		$spreadsheet = new Spreadsheet();
		$sheet = $spreadsheet->getActiveSheet();
		// Buat sebuah variabel untuk menampung pengaturan style dari header tabel
		$style_col = [
			'font' => ['bold' => true], // Set font nya jadi bold
			'alignment' => [
				'horizontal' => \PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER, // Set text jadi ditengah secara horizontal (center)
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'top' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border top dengan garis tipis
				'right' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN],  // Set border right dengan garis tipis
				'bottom' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border bottom dengan garis tipis
				'left' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN] // Set border left dengan garis tipis
			]
		];

		$style_range = [
			'font' => ['bold' => true], // Set font nya jadi bold
			'alignment' => [
				'horizontal' => \PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER, // Set text jadi ditengah secara horizontal (center)
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'allBorders' => [
					'borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN, // Set border top dengan garis tipis
				]
			]
		];

		$style_range_row = [
			'alignment' => [
				'horizontal' => \PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER, // Set text jadi ditengah secara horizontal (center)
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'allBorders' => [
					'borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN, // Set border top dengan garis tipis
				]
			]
		];

		// Buat sebuah variabel untuk menampung pengaturan style dari isi tabel
		$style_row = [
			'alignment' => [
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'top' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border top dengan garis tipis
				'right' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN],  // Set border right dengan garis tipis
				'bottom' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border bottom dengan garis tipis
				'left' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN] // Set border left dengan garis tipis
			]
		];


		if(isset($_POST['by_region']))
		{
			$region = $_POST['by_region'];
		}else
		{
			$region = "";
		}

		if(isset($_POST['by_area']))
		{
			$area = $_POST['by_area'];
		}else
		{
			$area = "";
		}

		if(isset($_POST['by_island']))
		{
			$island = $_POST['by_island'];
		}else
		{
			$island = "";
		}

		if(isset($_POST['by_month1']))
		{
			$month1 = $_POST['by_month1'];
		}else
		{
			$month1 = date('m');
		}

		if(isset($_POST['by_month2']))
		{
			$month2 = $_POST['by_month2'];
		}else
		{
			$month2 = date('m');
		}

		if(isset($_POST['by_year']))
		{
			$year = $_POST['by_year'];
		}else
		{
			$year = date('Y');
		}

		$data['sku_name'] = $this->model('SkuModel')->getItemNameSKUJordan();
		$data['sku_group'] = $this->model('SkuModel')->getGroupSKUJordan();
		$data['sku_count'] = $this->model('SkuModel')->getCountSKUJordan();
		$data['sku_code'] = $this->model('SkuModel')->getItemCodeSKUJordan();

		//$dateObj   = DateTime::createFromFormat('!m', $month);
		//$monthName = $dateObj->format('F'); // March

		$dateObj1   = DateTime::createFromFormat('!m', $month1);
		$dateObj2   = DateTime::createFromFormat('!m', $month2);
        $monthName1 = $dateObj1->format('F');
		$monthName2 = $dateObj2->format('F');

		$data['title'] = 'Contribution Summary - LORD (' . $monthName1 . ' To ' . $monthName2 . ')';

		$sheet->setCellValue('A1', "Direct Active Outlet - LORD"); // Set kolom A1 dengan tulisan "Report Selling In - By Outlet"
		$sheet->setCellValue('A2', "Island : " . $island); // Set kolom A2 dengan tulisan "Outlet Type : EC_EC"
		$sheet->setCellValue('A3', "Region : " . $region); // Set kolom A3 dengan tulisan "Outlet Type : EC_EC"
		$sheet->setCellValue('A4', "Area : " . $area);
		$sheet->setCellValue('A5', "Month : " . $monthName1 . " to " . $monthName1 . " - " . $year);
		//$sheet->mergeCells('A1:F1'); // Set Merge Cell pada kolom A1 sampai F1
		$sheet->getStyle('A1')->getFont()->setBold(true); // Set bold kolom A1
		$sheet->getStyle('A2')->getFont()->setBold(true); // Set bold kolom A2
		$sheet->getStyle('A3')->getFont()->setBold(true); // Set bold kolom A3
		$sheet->getStyle('A4')->getFont()->setBold(true);
		$sheet->getStyle('A5')->getFont()->setBold(true);
		$sheet->getStyle('A1')->getFont()->setSize(20); // Set font size 15 untuk kolom A1
		// Buat header tabel nya pada baris ke 7
		$sheet->setCellValue('A7', "#"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('A7:A9'); // Set Merge Row pada kolom A6 sampai A8
		$sheet->setCellValue('B7', "TYPE OF OUTLET"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('B7:B9'); // Set Merge Row pada kolom A6 sampai A8
		$sheet->setCellValue('C7', "Code"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('C7:C9'); // Set Merge Row pada kolom A6 sampai A8
		$sheet->setCellValue('D7', "RO"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('D7:D9');
		$start_col = 5;

		foreach ($data['sku_group'] as $row_sku) :
			//$sheet->setCellValue('E7', $row_sku['item_group']);
			$sheet->setCellValueByColumnAndRow($start_col, 7, $row_sku['item_group']);
			$last_col = $start_col + ($row_sku['count_name']*2) - 1;
			$sheet->mergeCellsByColumnAndRow($start_col, 7, $last_col, 7);
			$start_col = $last_col + 1;
		endforeach;

		$sheet->setCellValueByColumnAndRow($start_col, 7, 'TOTAL');
		$sheet->mergeCellsByColumnAndRow($start_col, 7, $start_col + 1 , 8);

		$start_col = 5;
		foreach ($data['sku_name'] as $row_sku) :
			//$sheet->setCellValue('E7', $row_sku['item_group']);
			$sheet->setCellValueByColumnAndRow($start_col, 8, $row_sku['item_name']);
			$last_col = $start_col + 1;
			$sheet->mergeCellsByColumnAndRow($start_col, 8, $last_col, 8);
			$start_col = $last_col + 1;
		endforeach;
		$start_col = 5;
		foreach ($data['sku_name'] as $row_sku) :
			$sheet->setCellValueByColumnAndRow($start_col, 9, "AO");
			$start_col = $start_col + 1;
			$sheet->setCellValueByColumnAndRow($start_col, 9, "%");
			$start_col = $start_col + 1;
		endforeach;

		$sheet->setCellValueByColumnAndRow($start_col, 9, "AO");
		$sheet->setCellValueByColumnAndRow($start_col + 1, 9, "%");
		
		// Apply style header yang telah kita buat tadi ke masing-masing kolom header
		$sheet->getStyleByColumnAndRow(1, 8, $last_col, 8)->getAlignment()->setWrapText(true);
		$sheet->getStyleByColumnAndRow(1, 9, $last_col, 9)->getAlignment()->setWrapText(true);
		$sheet->getStyleByColumnAndRow(1, 7, $last_col, 9)->applyFromArray($style_range);
		$sheet->getStyleByColumnAndRow(1, 7, $last_col, 9)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');
		$sheet->getStyleByColumnAndRow($last_col + 1, 7, $last_col + 2, 9)->getAlignment()->setWrapText(true);
		$sheet->getStyleByColumnAndRow($last_col + 1, 7, $last_col + 2, 9)->applyFromArray($style_range);
		$sheet->getStyleByColumnAndRow($last_col + 1, 7, $last_col + 2, 9)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FF6D6D');

		// Set height baris ke 1, 2 dan 3
		$sheet->getRowDimension('1')->setRowHeight(40);
		$sheet->getRowDimension('2')->setRowHeight(20);
		$sheet->getRowDimension('3')->setRowHeight(20);
		$sheet->getRowDimension('4')->setRowHeight(20);
		$sheet->getRowDimension('5')->setRowHeight(20);
		$sheet->getRowDimension('8')->setRowHeight(60);

		$no = 1; // Untuk penomoran tabel, di awal set dengan 1
		$row = 10;

		$data1 = array(
			'island' => $island,
			'region' => $region,
			'area' => $area,
			'month1' => $month1,
			'month2' => $month2,
			'year' => $year
		);

		//$this->model('ReportModel')->getAO_jordan1_export($data1);
		//$this->model('ReportModel')->getAO_jordan2_export($data1);

		$data['ao_jordan'] = $this->model('ReportModel')->getAO_direct_lord($data);

		$data_col = 1;
		$data_row = 10;

		$channel='';

		$total_RO = 0;
		$x=1;
		foreach($data['sku_code'] as $sku):
			$total_d[$x] = 0;
			$total_p[$x] = 0;
			$x++;
		endforeach;
		
		$total_dAll = 0;
		$total_pAll = 0;

		foreach ($data['ao_jordan'] as $rows) :
			$data_col = 1;

			if ($channel != $rows['channel'])
            {
				$channel = $rows['channel'];
				$sheet->setCellValueByColumnAndRow($data_col, $data_row, '');
				$sheet->setCellValueByColumnAndRow($data_col + 1, $data_row, $rows['channel']);
				$sheet->setCellValueByColumnAndRow($data_col + 2, $data_row, '');
				$sheet->setCellValueByColumnAndRow($data_col + 3, $data_row, '');
				$a=1;
				$baris=4;
				foreach($data['sku_code'] as $sku):
					$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, '');
					$baris = $baris + 1;
					$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, '');
					$a++;
					$baris++;
				endforeach;
				$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, '');
				$sheet->setCellValueByColumnAndRow($data_col + $baris + 1, $data_row, '');

				$sheet->getStyleByColumnAndRow(1, $data_row, $last_col + 2, $data_row)->applyFromArray($style_range);
				$sheet->getStyleByColumnAndRow(1, $data_row, $last_col + 2, $data_row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('d9e1f2');

				$data_row++;

			}

			$sheet->setCellValueByColumnAndRow($data_col, $data_row, $no);
			$sheet->setCellValueByColumnAndRow($data_col + 1, $data_row, $rows['desc_type']);
			$sheet->setCellValueByColumnAndRow($data_col + 2, $data_row, $rows['outlet_type']);
			$sheet->setCellValueByColumnAndRow($data_col + 3, $data_row, number_format($rows['RO'], 0));
			$a=1;
			$baris=4;
			foreach($data['sku_code'] as $sku):
				$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($rows['d'.$a], 0));
				$baris = $baris + 1;
				$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($rows['%'.$a], 2));
				$a++;
				$baris++;
			endforeach;
			
			$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($rows['dtotal'], 0));
			$sheet->setCellValueByColumnAndRow($data_col + $baris + 1, $data_row, number_format($rows['%total'], 0));

			$total_RO += $rows['RO'];
			$x = 1;
			foreach($data['sku_code'] as $sku):
				$total_d[$x] += $rows['d'.$x];
				$total_p[$x] = ($total_d[$x]/($total_RO ?: 1))*100;
				$x++;
			endforeach;
			
			$total_dAll += $rows['dtotal'];

			
			// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
			$sheet->getStyleByColumnAndRow(1, $data_row, $last_col + 2, $data_row)->applyFromArray($style_range_row);
			$sheet->getStyleByColumnAndRow(1, $data_row, null, $data_row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyleByColumnAndRow(2, $data_row, null, $data_row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyleByColumnAndRow(3, $data_row, null, $data_row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyleByColumnAndRow(4, 10, $last_col + 2, $data_row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

			$no++; // Tambah 1 setiap kali looping
    		$row++; // Tambah 1 setiap kali looping
			$data_row++;
		endforeach;

		$total_pAll = ($total_dAll/($total_RO ?: 1))*100;

		//$data_row = $data_row + 1;

		$sheet->setCellValueByColumnAndRow($data_col, $data_row, '');
		$sheet->setCellValueByColumnAndRow($data_col + 1, $data_row, 'TOTAL');
		$sheet->setCellValueByColumnAndRow($data_col + 2, $data_row, '');
		$sheet->setCellValueByColumnAndRow($data_col + 3, $data_row, number_format($total_RO, 0));
		$a=1;
		$baris=4;
		foreach($data['sku_code'] as $sku):
			$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($total_d[$a], 0));
			$baris = $baris + 1;
			$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($total_p[$a], 2));
			$a++;
			$baris++;
		endforeach;
		
		$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($total_dAll, 0));
		$sheet->setCellValueByColumnAndRow($data_col + $baris + 1, $data_row, number_format($total_pAll, 2));

		$sheet->getStyleByColumnAndRow(1, $data_row, $last_col + 2, $data_row)->applyFromArray($style_range);
		$sheet->getStyleByColumnAndRow(1, $data_row, $last_col + 2, $data_row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFA07A');

		$sheet->getStyleByColumnAndRow(4, 10, $last_col + 2, $data_row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		

		$sheet->getColumnDimension('A')->setWidth(5); // Set width kolom A
		$sheet->getColumnDimension('B')->setWidth(40); // Set width kolom B
		$sheet->getColumnDimension('C')->setWidth(11); // Set width kolom C
		$sheet->getColumnDimension('D')->setWidth(10);

		// Set orientasi kertas jadi LANDSCAPE
		$sheet->getPageSetup()->setOrientation(\PhpOffice\PhpSpreadsheet\Worksheet\PageSetup::ORIENTATION_LANDSCAPE);
		// Set judul file excel nya
		$sheet->setTitle("Direct Active Outlet - LORD");
		// Proses file excel
		header('Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet');
		header('Content-Disposition: attachment; filename="Direct Active Outlet - LORD.xlsx"'); // Set nama file excel nya
		header('Cache-Control: max-age=0');

		$writer = new Xlsx($spreadsheet);
		$writer->save('php://output');


	}

	public function export_activeoutlet_jordan()
	{
		$spreadsheet = new Spreadsheet();
		$sheet = $spreadsheet->getActiveSheet();
		// Buat sebuah variabel untuk menampung pengaturan style dari header tabel
		$style_col = [
			'font' => ['bold' => true], // Set font nya jadi bold
			'alignment' => [
				'horizontal' => \PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER, // Set text jadi ditengah secara horizontal (center)
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'top' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border top dengan garis tipis
				'right' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN],  // Set border right dengan garis tipis
				'bottom' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border bottom dengan garis tipis
				'left' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN] // Set border left dengan garis tipis
			]
		];

		$style_range = [
			'font' => ['bold' => true], // Set font nya jadi bold
			'alignment' => [
				'horizontal' => \PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER, // Set text jadi ditengah secara horizontal (center)
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'allBorders' => [
					'borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN, // Set border top dengan garis tipis
				]
			]
		];

		$style_range_row = [
			'alignment' => [
				'horizontal' => \PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER, // Set text jadi ditengah secara horizontal (center)
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'allBorders' => [
					'borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN, // Set border top dengan garis tipis
				]
			]
		];

		// Buat sebuah variabel untuk menampung pengaturan style dari isi tabel
		$style_row = [
			'alignment' => [
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'top' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border top dengan garis tipis
				'right' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN],  // Set border right dengan garis tipis
				'bottom' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border bottom dengan garis tipis
				'left' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN] // Set border left dengan garis tipis
			]
		];


		if(isset($_POST['by_region']))
		{
			$region = $_POST['by_region'];
		}else
		{
			$region = "";
		}

		if (isset($_POST['by_area']))
		{
			$area = implode(',', $_POST['by_area']);
			$area = str_replace(",", "','", $area);;
		}
		elseif ($_SESSION['area'] != 'ALL')
		{
			$session_area = str_replace(", ", "','", $_SESSION['area']); 
			$area = $session_area;
		}

		if(isset($_POST['by_island']))
		{
			$island = $_POST['by_island'];
		}else
		{
			$island = "";
		}

		if(isset($_POST['by_month1']))
		{
			$month1 = $_POST['by_month1'];
		}else
		{
			$month1 = date('m');
		}

		if(isset($_POST['by_month2']))
		{
			$month2 = $_POST['by_month2'];
		}else
		{
			$month2 = date('m');
		}

		if(isset($_POST['by_year']))
		{
			$year = $_POST['by_year'];
		}else
		{
			$year = date('Y');
		}

		$data['sku_name'] = $this->model('SkuModel')->getItemNameSKUJordan();
		$data['sku_group'] = $this->model('SkuModel')->getGroupSKUJordan();
		$data['sku_count'] = $this->model('SkuModel')->getCountSKUJordan();
		$data['sku_code'] = $this->model('SkuModel')->getItemCodeSKUJordan();

		//$dateObj   = DateTime::createFromFormat('!m', $month);
		//$monthName = $dateObj->format('F'); // March

		$dateObj1   = DateTime::createFromFormat('!m', $month1);
		$dateObj2   = DateTime::createFromFormat('!m', $month2);
        $monthName1 = $dateObj1->format('F');
		$monthName2 = $dateObj2->format('F');

		$data['title'] = 'Contribution Summary - LORD (' . $monthName1 . ' To ' . $monthName2 . ')';

		$sheet->setCellValue('A1', "Report Active Outlet - JORDAN"); // Set kolom A1 dengan tulisan "Report Selling In - By Outlet"
		$sheet->setCellValue('A2', "Island : " . $island); // Set kolom A2 dengan tulisan "Outlet Type : EC_EC"
		$sheet->setCellValue('A3', "Region : " . $region); // Set kolom A3 dengan tulisan "Outlet Type : EC_EC"
		$sheet->setCellValue('A4', "Area : " . $area);
		$sheet->setCellValue('A5', "Month : " . $monthName1 . " to " . $monthName1 . " - " . $year);
		//$sheet->mergeCells('A1:F1'); // Set Merge Cell pada kolom A1 sampai F1
		$sheet->getStyle('A1')->getFont()->setBold(true); // Set bold kolom A1
		$sheet->getStyle('A2')->getFont()->setBold(true); // Set bold kolom A2
		$sheet->getStyle('A3')->getFont()->setBold(true); // Set bold kolom A3
		$sheet->getStyle('A4')->getFont()->setBold(true);
		$sheet->getStyle('A5')->getFont()->setBold(true);
		$sheet->getStyle('A1')->getFont()->setSize(20); // Set font size 15 untuk kolom A1
		// Buat header tabel nya pada baris ke 7
		$sheet->setCellValue('A7', "#"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('A7:A9'); // Set Merge Row pada kolom A6 sampai A8
		$sheet->setCellValue('B7', "TYPE OF OUTLET"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('B7:B9'); // Set Merge Row pada kolom A6 sampai A8
		$sheet->setCellValue('C7', "Code"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('C7:C9'); // Set Merge Row pada kolom A6 sampai A8
		$sheet->setCellValue('D7', "RO"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('D7:D9');
		$start_col = 5;

		foreach ($data['sku_group'] as $row_sku) :
			//$sheet->setCellValue('E7', $row_sku['item_group']);
			$sheet->setCellValueByColumnAndRow($start_col, 7, $row_sku['item_group']);
			$last_col = $start_col + ($row_sku['count_name']*2) - 1;
			$sheet->mergeCellsByColumnAndRow($start_col, 7, $last_col, 7);
			$start_col = $last_col + 1;
		endforeach;

		$sheet->setCellValueByColumnAndRow($start_col, 7, 'TOTAL');
		$sheet->mergeCellsByColumnAndRow($start_col, 7, $start_col + 1 , 8);

		$start_col = 5;
		foreach ($data['sku_name'] as $row_sku) :
			//$sheet->setCellValue('E7', $row_sku['item_group']);
			$sheet->setCellValueByColumnAndRow($start_col, 8, $row_sku['item_name']);
			$last_col = $start_col + 1;
			$sheet->mergeCellsByColumnAndRow($start_col, 8, $last_col, 8);
			$start_col = $last_col + 1;
		endforeach;
		$start_col = 5;
		foreach ($data['sku_name'] as $row_sku) :
			$sheet->setCellValueByColumnAndRow($start_col, 9, "AO");
			$start_col = $start_col + 1;
			$sheet->setCellValueByColumnAndRow($start_col, 9, "%");
			$start_col = $start_col + 1;
		endforeach;

		$sheet->setCellValueByColumnAndRow($start_col, 9, "AO");
		$sheet->setCellValueByColumnAndRow($start_col + 1, 9, "%");
		
		// Apply style header yang telah kita buat tadi ke masing-masing kolom header
		$sheet->getStyleByColumnAndRow(1, 8, $last_col, 8)->getAlignment()->setWrapText(true);
		$sheet->getStyleByColumnAndRow(1, 9, $last_col, 9)->getAlignment()->setWrapText(true);
		$sheet->getStyleByColumnAndRow(1, 7, $last_col, 9)->applyFromArray($style_range);
		$sheet->getStyleByColumnAndRow(1, 7, $last_col, 9)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');
		$sheet->getStyleByColumnAndRow($last_col + 1, 7, $last_col + 2, 9)->getAlignment()->setWrapText(true);
		$sheet->getStyleByColumnAndRow($last_col + 1, 7, $last_col + 2, 9)->applyFromArray($style_range);
		$sheet->getStyleByColumnAndRow($last_col + 1, 7, $last_col + 2, 9)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FF6D6D');

		// Set height baris ke 1, 2 dan 3
		$sheet->getRowDimension('1')->setRowHeight(40);
		$sheet->getRowDimension('2')->setRowHeight(20);
		$sheet->getRowDimension('3')->setRowHeight(20);
		$sheet->getRowDimension('4')->setRowHeight(20);
		$sheet->getRowDimension('5')->setRowHeight(20);
		$sheet->getRowDimension('8')->setRowHeight(60);

		$no = 1; // Untuk penomoran tabel, di awal set dengan 1
		$row = 10;

		$data1 = array(
			'island' => $island,
			'region' => $region,
			'area' => $area,
			'month1' => $month1,
			'month2' => $month2,
			'year' => $year
		);

		// $this->model('ReportModel')->getAO_jordan1_export($data1);
		// $this->model('ReportModel')->getAO_jordan2_export($data1);

		$data['ao_jordan'] = $this->model('ReportModel')->getAO_jordan_ALL($data);

		$data_col = 1;
		$data_row = 10;

		$channel='';

		$total_RO = 0;
		$x=1;
		foreach($data['sku_code'] as $sku):
			$total_d[$x] = 0;
			$total_p[$x] = 0;
			$x++;
		endforeach;
		
		$total_dAll = 0;
		$total_pAll = 0;

		foreach ($data['ao_jordan'] as $rows) :
			$data_col = 1;

			if ($channel != $rows['channel'])
            {
				$channel = $rows['channel'];
				$sheet->setCellValueByColumnAndRow($data_col, $data_row, '');
				$sheet->setCellValueByColumnAndRow($data_col + 1, $data_row, $rows['channel']);
				$sheet->setCellValueByColumnAndRow($data_col + 2, $data_row, '');
				$sheet->setCellValueByColumnAndRow($data_col + 3, $data_row, '');
				$a=1;
				$baris=4;
				foreach($data['sku_code'] as $sku):
					$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, '');
					$baris = $baris + 1;
					$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, '');
					$a++;
					$baris++;
				endforeach;
				$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, '');
				$sheet->setCellValueByColumnAndRow($data_col + $baris + 1, $data_row, '');

				$sheet->getStyleByColumnAndRow(1, $data_row, $last_col + 2, $data_row)->applyFromArray($style_range);
				$sheet->getStyleByColumnAndRow(1, $data_row, $last_col + 2, $data_row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('d9e1f2');

				$data_row++;

			}

			$sheet->setCellValueByColumnAndRow($data_col, $data_row, $no);
			$sheet->setCellValueByColumnAndRow($data_col + 1, $data_row, $rows['desc_type']);
			$sheet->setCellValueByColumnAndRow($data_col + 2, $data_row, $rows['outlet_type']);
			$sheet->setCellValueByColumnAndRow($data_col + 3, $data_row, number_format($rows['RO'], 0));
			$a=1;
			$baris=4;
			foreach($data['sku_code'] as $sku):
				$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($rows['d'.$a], 0));
				$baris = $baris + 1;
				$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($rows['%'.$a], 2));
				$a++;
				$baris++;
			endforeach;
			
			$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($rows['dtotal'], 0));
			$sheet->setCellValueByColumnAndRow($data_col + $baris + 1, $data_row, number_format($rows['%total'], 0));

			$total_RO += $rows['RO'];
			$x = 1;
			foreach($data['sku_code'] as $sku):
				$total_d[$x] += $rows['d'.$x];
				if($total_RO==0)
				{
					$total_p[$x] = 0;
				}
				else
				{
					$total_p[$x] = ($total_d[$x]/$total_RO)*100;
				} 
				//$total_p[$x] = ($total_d[$x]/($total_RO ?: 1))*100;
				$x++;
			endforeach;
			
			$total_dAll += $rows['dtotal'];

			
			// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
			$sheet->getStyleByColumnAndRow(1, $data_row, $last_col + 2, $data_row)->applyFromArray($style_range_row);
			$sheet->getStyleByColumnAndRow(1, $data_row, null, $data_row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyleByColumnAndRow(2, $data_row, null, $data_row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyleByColumnAndRow(3, $data_row, null, $data_row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyleByColumnAndRow(4, 10, $last_col + 2, $data_row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

			$no++; // Tambah 1 setiap kali looping
    		$row++; // Tambah 1 setiap kali looping
			$data_row++;
		endforeach;

		if($total_RO==0)
		{
			$total_pAll = 0;
		}
		else
		{
			$total_pAll = ($total_dAll/$total_RO)*100;
		} 
		//$total_pAll = ($total_dAll/($total_RO ?: 1))*100;

		//$data_row = $data_row + 1;

		$sheet->setCellValueByColumnAndRow($data_col, $data_row, '');
		$sheet->setCellValueByColumnAndRow($data_col + 1, $data_row, 'TOTAL');
		$sheet->setCellValueByColumnAndRow($data_col + 2, $data_row, '');
		$sheet->setCellValueByColumnAndRow($data_col + 3, $data_row, number_format($total_RO, 0));
		$a=1;
		$baris=4;
		foreach($data['sku_code'] as $sku):
			$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($total_d[$a], 0));
			$baris = $baris + 1;
			$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($total_p[$a], 2));
			$a++;
			$baris++;
		endforeach;
		
		$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($total_dAll, 0));
		$sheet->setCellValueByColumnAndRow($data_col + $baris + 1, $data_row, number_format($total_pAll, 2));

		$sheet->getStyleByColumnAndRow(1, $data_row, $last_col + 2, $data_row)->applyFromArray($style_range);
		$sheet->getStyleByColumnAndRow(1, $data_row, $last_col + 2, $data_row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFA07A');

		$sheet->getStyleByColumnAndRow(4, 10, $last_col + 2, $data_row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		

		$sheet->getColumnDimension('A')->setWidth(5); // Set width kolom A
		$sheet->getColumnDimension('B')->setWidth(40); // Set width kolom B
		$sheet->getColumnDimension('C')->setWidth(11); // Set width kolom C
		$sheet->getColumnDimension('D')->setWidth(10);

		// Set orientasi kertas jadi LANDSCAPE
		$sheet->getPageSetup()->setOrientation(\PhpOffice\PhpSpreadsheet\Worksheet\PageSetup::ORIENTATION_LANDSCAPE);
		// Set judul file excel nya
		$sheet->setTitle("Active Outlet - JORDAN");
		// Proses file excel
		header('Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet');
		header('Content-Disposition: attachment; filename="Report Active Outlet - JORDAN.xlsx"'); // Set nama file excel nya
		header('Cache-Control: max-age=0');

		$writer = new Xlsx($spreadsheet);
		$writer->save('php://output');


	}

	public function export_activeoutlet_lord()
	{
		$spreadsheet = new Spreadsheet();
		$sheet = $spreadsheet->getActiveSheet();
		// Buat sebuah variabel untuk menampung pengaturan style dari header tabel
		$style_col = [
			'font' => ['bold' => true], // Set font nya jadi bold
			'alignment' => [
				'horizontal' => \PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER, // Set text jadi ditengah secara horizontal (center)
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'top' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border top dengan garis tipis
				'right' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN],  // Set border right dengan garis tipis
				'bottom' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border bottom dengan garis tipis
				'left' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN] // Set border left dengan garis tipis
			]
		];

		$style_range = [
			'font' => ['bold' => true], // Set font nya jadi bold
			'alignment' => [
				'horizontal' => \PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER, // Set text jadi ditengah secara horizontal (center)
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'allBorders' => [
					'borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN, // Set border top dengan garis tipis
				]
			]
		];

		$style_range_row = [
			'alignment' => [
				'horizontal' => \PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER, // Set text jadi ditengah secara horizontal (center)
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'allBorders' => [
					'borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN, // Set border top dengan garis tipis
				]
			]
		];

		// Buat sebuah variabel untuk menampung pengaturan style dari isi tabel
		$style_row = [
			'alignment' => [
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'top' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border top dengan garis tipis
				'right' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN],  // Set border right dengan garis tipis
				'bottom' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border bottom dengan garis tipis
				'left' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN] // Set border left dengan garis tipis
			]
		];


		if(isset($_POST['by_region']))
		{
			$region = $_POST['by_region'];
		}else
		{
			$region = "";
		}

		if (isset($_POST['by_area']))
		{
			$area = implode(',', $_POST['by_area']);
			$area = str_replace(",", "','", $area);;
		}
		elseif ($_SESSION['area'] != 'ALL')
		{
			$session_area = str_replace(", ", "','", $_SESSION['area']); 
			$area = $session_area;
		}

		if(isset($_POST['by_island']))
		{
			$island = $_POST['by_island'];
		}else
		{
			$island = "";
		}

		if(isset($_POST['by_month1']))
		{
			$month1 = $_POST['by_month1'];
		}else
		{
			$month1 = date('m');
		}

		if(isset($_POST['by_month2']))
		{
			$month2 = $_POST['by_month2'];
		}else
		{
			$month2 = date('m');
		}

		if(isset($_POST['by_year']))
		{
			$year = $_POST['by_year'];
		}else
		{
			$year = date('Y');
		}

		$data['sku_name'] = $this->model('SkuModel')->getItemNameSKULord();
		$data['sku_group'] = $this->model('SkuModel')->getGroupSKULord();
		$data['sku_count'] = $this->model('SkuModel')->getCountSKULord();
		$data['sku_code'] = $this->model('SkuModel')->getItemCodeSKULord();

		//$dateObj   = DateTime::createFromFormat('!m', $month);
		//$monthName = $dateObj->format('F'); // March

		$dateObj1   = DateTime::createFromFormat('!m', $month1);
		$dateObj2   = DateTime::createFromFormat('!m', $month2);
        $monthName1 = $dateObj1->format('F');
		$monthName2 = $dateObj2->format('F');

		//$data['title'] = 'Contribution Summary - LORD (' . $monthName1 . ' To ' . $monthName2 . ')';

		$sheet->setCellValue('A1', "Report Active Outlet - LORD"); // Set kolom A1 dengan tulisan "Report Selling In - By Outlet"
		$sheet->setCellValue('A2', "Island : " . $island); // Set kolom A2 dengan tulisan "Outlet Type : EC_EC"
		$sheet->setCellValue('A3', "Region : " . $region); // Set kolom A3 dengan tulisan "Outlet Type : EC_EC"
		$sheet->setCellValue('A4', "Area : " . $area);
		$sheet->setCellValue('A5', "Month : " . $monthName1 . " to " . $monthName2 . " - " . $year);
		//$sheet->mergeCells('A1:F1'); // Set Merge Cell pada kolom A1 sampai F1
		$sheet->getStyle('A1')->getFont()->setBold(true); // Set bold kolom A1
		$sheet->getStyle('A2')->getFont()->setBold(true); // Set bold kolom A2
		$sheet->getStyle('A3')->getFont()->setBold(true); // Set bold kolom A3
		$sheet->getStyle('A4')->getFont()->setBold(true);
		$sheet->getStyle('A5')->getFont()->setBold(true);
		$sheet->getStyle('A1')->getFont()->setSize(20); // Set font size 15 untuk kolom A1
		// Buat header tabel nya pada baris ke 7
		$sheet->setCellValue('A7', "#"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('A7:A9'); // Set Merge Row pada kolom A6 sampai A8
		$sheet->setCellValue('B7', "TYPE OF OUTLET"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('B7:B9'); // Set Merge Row pada kolom A6 sampai A8
		$sheet->setCellValue('C7', "Code"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('C7:C9'); // Set Merge Row pada kolom A6 sampai A8
		$sheet->setCellValue('D7', "RO"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('D7:D9');
		$start_col = 5;

		foreach ($data['sku_group'] as $row_sku) :
			//$sheet->setCellValue('E7', $row_sku['item_group']);
			$sheet->setCellValueByColumnAndRow($start_col, 7, $row_sku['item_group']);
			$last_col = $start_col + ($row_sku['count_name']*2) - 1;
			$sheet->mergeCellsByColumnAndRow($start_col, 7, $last_col, 7);
			$start_col = $last_col + 1;
		endforeach;

		$sheet->setCellValueByColumnAndRow($start_col, 7, 'TOTAL');
		$sheet->mergeCellsByColumnAndRow($start_col, 7, $start_col + 1 , 8);

		$start_col = 5;
		foreach ($data['sku_name'] as $row_sku) :
			//$sheet->setCellValue('E7', $row_sku['item_group']);
			$sheet->setCellValueByColumnAndRow($start_col, 8, $row_sku['item_name']);
			$last_col = $start_col + 1;
			$sheet->mergeCellsByColumnAndRow($start_col, 8, $last_col, 8);
			$start_col = $last_col + 1;
		endforeach;
		$start_col = 5;
		foreach ($data['sku_name'] as $row_sku) :
			$sheet->setCellValueByColumnAndRow($start_col, 9, "AO");
			$start_col = $start_col + 1;
			$sheet->setCellValueByColumnAndRow($start_col, 9, "%");
			$start_col = $start_col + 1;
		endforeach;

		$sheet->setCellValueByColumnAndRow($start_col, 9, "AO");
		$sheet->setCellValueByColumnAndRow($start_col + 1, 9, "%");
		
		// Apply style header yang telah kita buat tadi ke masing-masing kolom header
		$sheet->getStyleByColumnAndRow(1, 8, $last_col, 8)->getAlignment()->setWrapText(true);
		$sheet->getStyleByColumnAndRow(1, 9, $last_col, 9)->getAlignment()->setWrapText(true);
		$sheet->getStyleByColumnAndRow(1, 7, $last_col, 9)->applyFromArray($style_range);
		$sheet->getStyleByColumnAndRow(1, 7, $last_col, 9)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');
		$sheet->getStyleByColumnAndRow($last_col + 1, 7, $last_col + 2, 9)->getAlignment()->setWrapText(true);
		$sheet->getStyleByColumnAndRow($last_col + 1, 7, $last_col + 2, 9)->applyFromArray($style_range);
		$sheet->getStyleByColumnAndRow($last_col + 1, 7, $last_col + 2, 9)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FF6D6D');

		// Set height baris ke 1, 2 dan 3
		$sheet->getRowDimension('1')->setRowHeight(40);
		$sheet->getRowDimension('2')->setRowHeight(20);
		$sheet->getRowDimension('3')->setRowHeight(20);
		$sheet->getRowDimension('4')->setRowHeight(20);
		$sheet->getRowDimension('5')->setRowHeight(20);
		$sheet->getRowDimension('8')->setRowHeight(60);

		$no = 1; // Untuk penomoran tabel, di awal set dengan 1
		$row = 10;

		$data1 = array(
			'island' => $island,
			'region' => $region,
			'area' => $area,
			'month1' => $month1,
			'month2' => $month2,
			'year' => $year
		);

		$data['ao_lord'] = $this->model('ReportModel')->getAO_lord_ALL($data);

		$data_col = 1;
		$data_row = 10;

		$channel='';

		$total_RO = 0;
		$x=1;
		foreach($data['sku_code'] as $sku):
			$total_d[$x] = 0;
			$total_p[$x] = 0;
			$x++;
		endforeach;
		
		$total_dAll = 0;
		$total_pAll = 0;


		foreach ($data['ao_lord'] as $rows) :
			$data_col = 1;

			if ($channel != $rows['channel'])
            {
				$channel = $rows['channel'];
				$sheet->setCellValueByColumnAndRow($data_col, $data_row, '');
				$sheet->setCellValueByColumnAndRow($data_col + 1, $data_row, $rows['channel']);
				$sheet->setCellValueByColumnAndRow($data_col + 2, $data_row, '');
				$sheet->setCellValueByColumnAndRow($data_col + 3, $data_row, '');
				$a=1;
				$baris=4;
				foreach($data['sku_code'] as $sku):
					$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, '');
					$baris = $baris + 1;
					$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, '');
					$a++;
					$baris++;
				endforeach;
				$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, '');
				$sheet->setCellValueByColumnAndRow($data_col + $baris + 1, $data_row, '');

				$sheet->getStyleByColumnAndRow(1, $data_row, $last_col + 2, $data_row)->applyFromArray($style_range);
				$sheet->getStyleByColumnAndRow(1, $data_row, $last_col + 2, $data_row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('d9e1f2');

				$data_row++;

			}

			$sheet->setCellValueByColumnAndRow($data_col, $data_row, $no);
			$sheet->setCellValueByColumnAndRow($data_col + 1, $data_row, $rows['desc_type']);
			$sheet->setCellValueByColumnAndRow($data_col + 2, $data_row, $rows['outlet_type']);
			$sheet->setCellValueByColumnAndRow($data_col + 3, $data_row, number_format($rows['RO'], 0));
			$a=1;
			$baris=4;
			foreach($data['sku_code'] as $sku):
				$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($rows['d'.$a], 0));
				$baris = $baris + 1;
				$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($rows['%'.$a], 2));
				$a++;
				$baris++;
			endforeach;
			
			$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($rows['dtotal'], 0));
			$sheet->setCellValueByColumnAndRow($data_col + $baris + 1, $data_row, number_format($rows['%total'], 0));

			$total_RO += $rows['RO'];
			$x = 1;
			foreach($data['sku_code'] as $sku):
				$total_d[$x] += $rows['d'.$x];
				if($total_RO==0)
				{
					$total_p[$x] = 0;
				}
				else
				{
					$total_p[$x] = ($total_d[$x]/$total_RO)*100;
				}
				//$total_p[$x] = ($total_d[$x]/($total_RO ?: 1))*100;
				$x++;
			endforeach;
			
			$total_dAll += $rows['dtotal'];

			
			// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
			$sheet->getStyleByColumnAndRow(1, $data_row, $last_col + 2, $data_row)->applyFromArray($style_range_row);
			$sheet->getStyleByColumnAndRow(1, $data_row, null, $data_row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyleByColumnAndRow(2, $data_row, null, $data_row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyleByColumnAndRow(3, $data_row, null, $data_row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyleByColumnAndRow(4, 10, $last_col + 2, $data_row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

			$no++; // Tambah 1 setiap kali looping
    		$row++; // Tambah 1 setiap kali looping
			$data_row++;
		endforeach;

		if($total_RO==0)
		{
			$total_pAll = 0;
		}
		else
		{
			$total_pAll = ($total_dAll/$total_RO)*100;
		} 
		//$total_pAll = ($total_dAll/($total_RO ?: 1))*100;

		//$data_row = $data_row + 1;

		$sheet->setCellValueByColumnAndRow($data_col, $data_row, '');
		$sheet->setCellValueByColumnAndRow($data_col + 1, $data_row, 'TOTAL');
		$sheet->setCellValueByColumnAndRow($data_col + 2, $data_row, '');
		$sheet->setCellValueByColumnAndRow($data_col + 3, $data_row, number_format($total_RO, 0));
		$a=1;
		$baris=4;
		foreach($data['sku_code'] as $sku):
			$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($total_d[$a], 0));
			$baris = $baris + 1;
			$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($total_p[$a], 2));
			$a++;
			$baris++;
		endforeach;
		
		$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($total_dAll, 0));
		$sheet->setCellValueByColumnAndRow($data_col + $baris + 1, $data_row, number_format($total_pAll, 2));
		

		$sheet->getStyleByColumnAndRow(1, $data_row, $last_col + 2, $data_row)->applyFromArray($style_range);
		$sheet->getStyleByColumnAndRow(1, $data_row, $last_col + 2, $data_row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFA07A');

		$sheet->getStyleByColumnAndRow(4, 10, $last_col + 2, $data_row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		

		$sheet->getColumnDimension('A')->setWidth(5); // Set width kolom A
		$sheet->getColumnDimension('B')->setWidth(40); // Set width kolom B
		$sheet->getColumnDimension('C')->setWidth(11); // Set width kolom C
		$sheet->getColumnDimension('D')->setWidth(10);

		// Set orientasi kertas jadi LANDSCAPE
		$sheet->getPageSetup()->setOrientation(\PhpOffice\PhpSpreadsheet\Worksheet\PageSetup::ORIENTATION_LANDSCAPE);
		// Set judul file excel nya
		$sheet->setTitle("Active Outlet - LORD");
		// Proses file excel
		header('Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet');
		header('Content-Disposition: attachment; filename="Report Active Outlet - LORD.xlsx"'); // Set nama file excel nya
		header('Cache-Control: max-age=0');

		$writer = new Xlsx($spreadsheet);
		$writer->save('php://output');


	}

	public function export_activeoutlet_riemann()
	{
		$spreadsheet = new Spreadsheet();
		$sheet = $spreadsheet->getActiveSheet();
		// Buat sebuah variabel untuk menampung pengaturan style dari header tabel
		$style_col = [
			'font' => ['bold' => true], // Set font nya jadi bold
			'alignment' => [
				'horizontal' => \PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER, // Set text jadi ditengah secara horizontal (center)
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'top' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border top dengan garis tipis
				'right' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN],  // Set border right dengan garis tipis
				'bottom' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border bottom dengan garis tipis
				'left' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN] // Set border left dengan garis tipis
			]
		];

		$style_range = [
			'font' => ['bold' => true], // Set font nya jadi bold
			'alignment' => [
				'horizontal' => \PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER, // Set text jadi ditengah secara horizontal (center)
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'allBorders' => [
					'borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN, // Set border top dengan garis tipis
				]
			]
		];

		$style_range_row = [
			'alignment' => [
				'horizontal' => \PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER, // Set text jadi ditengah secara horizontal (center)
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'allBorders' => [
					'borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN, // Set border top dengan garis tipis
				]
			]
		];

		// Buat sebuah variabel untuk menampung pengaturan style dari isi tabel
		$style_row = [
			'alignment' => [
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'top' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border top dengan garis tipis
				'right' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN],  // Set border right dengan garis tipis
				'bottom' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border bottom dengan garis tipis
				'left' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN] // Set border left dengan garis tipis
			]
		];


		if(isset($_POST['by_region']))
		{
			$region = $_POST['by_region'];
		}else
		{
			$region = "";
		}

		if (isset($_POST['by_area']))
		{
			$area = implode(',', $_POST['by_area']);
			$area = str_replace(",", "','", $area);;
		}
		elseif ($_SESSION['area'] != 'ALL')
		{
			$session_area = str_replace(", ", "','", $_SESSION['area']); 
			$area = $session_area;
		}

		if(isset($_POST['by_island']))
		{
			$island = $_POST['by_island'];
		}else
		{
			$island = "";
		}

		if(isset($_POST['by_month1']))
		{
			$month1 = $_POST['by_month1'];
		}else
		{
			$month1 = date('m');
		}

		if(isset($_POST['by_month2']))
		{
			$month2 = $_POST['by_month2'];
		}else
		{
			$month2 = date('m');
		}

		if(isset($_POST['by_year']))
		{
			$year = $_POST['by_year'];
		}else
		{
			$year = date('Y');
		}

		$data['sku_name'] = $this->model('SkuModel')->getItemNameSKURiemann();
		$data['sku_group'] = $this->model('SkuModel')->getGroupSKURiemann();
		$data['sku_count'] = $this->model('SkuModel')->getCountSKURiemann();
		$data['sku_code'] = $this->model('SkuModel')->getItemCodeSKURiemann();

		//$dateObj   = DateTime::createFromFormat('!m', $month);
		//$monthName = $dateObj->format('F'); // March

		$dateObj1   = DateTime::createFromFormat('!m', $month1);
		$dateObj2   = DateTime::createFromFormat('!m', $month2);
        $monthName1 = $dateObj1->format('F');
		$monthName2 = $dateObj2->format('F');

		$data['title'] = 'Contribution Summary - RIEMANN (' . $monthName1 . ' To ' . $monthName2 . ')';

		$sheet->setCellValue('A1', "Report Active Outlet - RIEMANN"); // Set kolom A1 dengan tulisan "Report Selling In - By Outlet"
		$sheet->setCellValue('A2', "Island : " . $island); // Set kolom A2 dengan tulisan "Outlet Type : EC_EC"
		$sheet->setCellValue('A3', "Region : " . $region); // Set kolom A3 dengan tulisan "Outlet Type : EC_EC"
		$sheet->setCellValue('A4', "Area : " . $area);
		$sheet->setCellValue('A5', "Month : " . $monthName1 . " to " . $monthName1 . " - " . $year);
		//$sheet->mergeCells('A1:F1'); // Set Merge Cell pada kolom A1 sampai F1
		$sheet->getStyle('A1')->getFont()->setBold(true); // Set bold kolom A1
		$sheet->getStyle('A2')->getFont()->setBold(true); // Set bold kolom A2
		$sheet->getStyle('A3')->getFont()->setBold(true); // Set bold kolom A3
		$sheet->getStyle('A4')->getFont()->setBold(true);
		$sheet->getStyle('A5')->getFont()->setBold(true);
		$sheet->getStyle('A1')->getFont()->setSize(20); // Set font size 15 untuk kolom A1
		// Buat header tabel nya pada baris ke 7
		$sheet->setCellValue('A7', "#"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('A7:A9'); // Set Merge Row pada kolom A6 sampai A8
		$sheet->setCellValue('B7', "TYPE OF OUTLET"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('B7:B9'); // Set Merge Row pada kolom A6 sampai A8
		$sheet->setCellValue('C7', "Code"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('C7:C9'); // Set Merge Row pada kolom A6 sampai A8
		$sheet->setCellValue('D7', "RO"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('D7:D9');
		$start_col = 5;

		foreach ($data['sku_group'] as $row_sku) :
			//$sheet->setCellValue('E7', $row_sku['item_group']);
			$sheet->setCellValueByColumnAndRow($start_col, 7, $row_sku['item_group']);
			$last_col = $start_col + ($row_sku['count_name']*2) - 1;
			$sheet->mergeCellsByColumnAndRow($start_col, 7, $last_col, 7);
			$start_col = $last_col + 1;
		endforeach;

		$sheet->setCellValueByColumnAndRow($start_col, 7, 'TOTAL');
		$sheet->mergeCellsByColumnAndRow($start_col, 7, $start_col + 1 , 8);

		$start_col = 5;
		foreach ($data['sku_name'] as $row_sku) :
			//$sheet->setCellValue('E7', $row_sku['item_group']);
			$sheet->setCellValueByColumnAndRow($start_col, 8, $row_sku['item_name']);
			$last_col = $start_col + 1;
			$sheet->mergeCellsByColumnAndRow($start_col, 8, $last_col, 8);
			$start_col = $last_col + 1;
		endforeach;
		$start_col = 5;
		foreach ($data['sku_name'] as $row_sku) :
			$sheet->setCellValueByColumnAndRow($start_col, 9, "AO");
			$start_col = $start_col + 1;
			$sheet->setCellValueByColumnAndRow($start_col, 9, "%");
			$start_col = $start_col + 1;
		endforeach;

		$sheet->setCellValueByColumnAndRow($start_col, 9, "AO");
		$sheet->setCellValueByColumnAndRow($start_col + 1, 9, "%");
		
		// Apply style header yang telah kita buat tadi ke masing-masing kolom header
		$sheet->getStyleByColumnAndRow(1, 8, $last_col, 8)->getAlignment()->setWrapText(true);
		$sheet->getStyleByColumnAndRow(1, 9, $last_col, 9)->getAlignment()->setWrapText(true);
		$sheet->getStyleByColumnAndRow(1, 7, $last_col, 9)->applyFromArray($style_range);
		$sheet->getStyleByColumnAndRow(1, 7, $last_col, 9)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');
		$sheet->getStyleByColumnAndRow($last_col + 1, 7, $last_col + 2, 9)->getAlignment()->setWrapText(true);
		$sheet->getStyleByColumnAndRow($last_col + 1, 7, $last_col + 2, 9)->applyFromArray($style_range);
		$sheet->getStyleByColumnAndRow($last_col + 1, 7, $last_col + 2, 9)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FF6D6D');

		// Set height baris ke 1, 2 dan 3
		$sheet->getRowDimension('1')->setRowHeight(40);
		$sheet->getRowDimension('2')->setRowHeight(20);
		$sheet->getRowDimension('3')->setRowHeight(20);
		$sheet->getRowDimension('4')->setRowHeight(20);
		$sheet->getRowDimension('5')->setRowHeight(20);
		$sheet->getRowDimension('8')->setRowHeight(60);

		$no = 1; // Untuk penomoran tabel, di awal set dengan 1
		$row = 10;

		$data1 = array(
			'island' => $island,
			'region' => $region,
			'area' => $area,
			'month1' => $month1,
			'month2' => $month2,
			'year' => $year
		);

		// $this->model('ReportModel')->getAO_jordan1_export($data1);
		// $this->model('ReportModel')->getAO_jordan2_export($data1);

		$data['ao_riemann'] = $this->model('ReportModel')->getAO_riemann_ALL($data);

		$data_col = 1;
		$data_row = 10;

		$channel='';

		$total_RO = 0;
		$x=1;
		foreach($data['sku_code'] as $sku):
			$total_d[$x] = 0;
			$total_p[$x] = 0;
			$x++;
		endforeach;
		
		$total_dAll = 0;
		$total_pAll = 0;

		foreach ($data['ao_riemann'] as $rows) :
			$data_col = 1;

			if ($channel != $rows['channel'])
            {
				$channel = $rows['channel'];
				$sheet->setCellValueByColumnAndRow($data_col, $data_row, '');
				$sheet->setCellValueByColumnAndRow($data_col + 1, $data_row, $rows['channel']);
				$sheet->setCellValueByColumnAndRow($data_col + 2, $data_row, '');
				$sheet->setCellValueByColumnAndRow($data_col + 3, $data_row, '');
				$a=1;
				$baris=4;
				foreach($data['sku_code'] as $sku):
					$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, '');
					$baris = $baris + 1;
					$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, '');
					$a++;
					$baris++;
				endforeach;
				$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, '');
				$sheet->setCellValueByColumnAndRow($data_col + $baris + 1, $data_row, '');

				$sheet->getStyleByColumnAndRow(1, $data_row, $last_col + 2, $data_row)->applyFromArray($style_range);
				$sheet->getStyleByColumnAndRow(1, $data_row, $last_col + 2, $data_row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('d9e1f2');

				$data_row++;

			}

			$sheet->setCellValueByColumnAndRow($data_col, $data_row, $no);
			$sheet->setCellValueByColumnAndRow($data_col + 1, $data_row, $rows['desc_type']);
			$sheet->setCellValueByColumnAndRow($data_col + 2, $data_row, $rows['outlet_type']);
			$sheet->setCellValueByColumnAndRow($data_col + 3, $data_row, number_format($rows['RO'], 0));
			$a=1;
			$baris=4;
			foreach($data['sku_code'] as $sku):
				$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($rows['d'.$a], 0));
				$baris = $baris + 1;
				$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($rows['%'.$a], 2));
				$a++;
				$baris++;
			endforeach;
			
			$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($rows['dtotal'], 0));
			$sheet->setCellValueByColumnAndRow($data_col + $baris + 1, $data_row, number_format($rows['%total'], 0));

			$total_RO += $rows['RO'];
			$x = 1;
			foreach($data['sku_code'] as $sku):
				$total_d[$x] += $rows['d'.$x];
				if($total_RO==0)
				{
					$total_p[$x] = 0;
				}
				else
				{
					$total_p[$x] = ($total_d[$x]/$total_RO)*100;
				} 
				//$total_p[$x] = ($total_d[$x]/($total_RO ?: 1))*100;
				$x++;
			endforeach;
			
			$total_dAll += $rows['dtotal'];

			
			// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
			$sheet->getStyleByColumnAndRow(1, $data_row, $last_col + 2, $data_row)->applyFromArray($style_range_row);
			$sheet->getStyleByColumnAndRow(1, $data_row, null, $data_row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyleByColumnAndRow(2, $data_row, null, $data_row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyleByColumnAndRow(3, $data_row, null, $data_row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyleByColumnAndRow(4, 10, $last_col + 2, $data_row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

			$no++; // Tambah 1 setiap kali looping
    		$row++; // Tambah 1 setiap kali looping
			$data_row++;
		endforeach;

		if($total_RO==0)
		{
			$total_pAll = 0;
		}
		else
		{
			$total_pAll = ($total_dAll/$total_RO)*100;
		} 
		//$total_pAll = ($total_dAll/($total_RO ?: 1))*100;

		//$data_row = $data_row + 1;

		$sheet->setCellValueByColumnAndRow($data_col, $data_row, '');
		$sheet->setCellValueByColumnAndRow($data_col + 1, $data_row, 'TOTAL');
		$sheet->setCellValueByColumnAndRow($data_col + 2, $data_row, '');
		$sheet->setCellValueByColumnAndRow($data_col + 3, $data_row, number_format($total_RO, 0));
		$a=1;
		$baris=4;
		foreach($data['sku_code'] as $sku):
			$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($total_d[$a], 0));
			$baris = $baris + 1;
			$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($total_p[$a], 2));
			$a++;
			$baris++;
		endforeach;
		
		$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($total_dAll, 0));
		$sheet->setCellValueByColumnAndRow($data_col + $baris + 1, $data_row, number_format($total_pAll, 2));

		$sheet->getStyleByColumnAndRow(1, $data_row, $last_col + 2, $data_row)->applyFromArray($style_range);
		$sheet->getStyleByColumnAndRow(1, $data_row, $last_col + 2, $data_row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFA07A');

		$sheet->getStyleByColumnAndRow(4, 10, $last_col + 2, $data_row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		

		$sheet->getColumnDimension('A')->setWidth(5); // Set width kolom A
		$sheet->getColumnDimension('B')->setWidth(40); // Set width kolom B
		$sheet->getColumnDimension('C')->setWidth(11); // Set width kolom C
		$sheet->getColumnDimension('D')->setWidth(10);

		// Set orientasi kertas jadi LANDSCAPE
		$sheet->getPageSetup()->setOrientation(\PhpOffice\PhpSpreadsheet\Worksheet\PageSetup::ORIENTATION_LANDSCAPE);
		// Set judul file excel nya
		$sheet->setTitle("Active Outlet - RIEMANN");
		// Proses file excel
		header('Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet');
		header('Content-Disposition: attachment; filename="Report Active Outlet - RIEMANN.xlsx"'); // Set nama file excel nya
		header('Cache-Control: max-age=0');

		$writer = new Xlsx($spreadsheet);
		$writer->save('php://output');


	}

	public function export_contribution_jordan()
	{
		$spreadsheet = new Spreadsheet();
		$sheet = $spreadsheet->getActiveSheet();
		// Buat sebuah variabel untuk menampung pengaturan style dari header tabel
		$style_col = [
			'font' => ['bold' => true], // Set font nya jadi bold
			'alignment' => [
				'horizontal' => \PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER, // Set text jadi ditengah secara horizontal (center)
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'top' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border top dengan garis tipis
				'right' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN],  // Set border right dengan garis tipis
				'bottom' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border bottom dengan garis tipis
				'left' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN] // Set border left dengan garis tipis
			]
		];

		$style_range = [
			'font' => ['bold' => true], // Set font nya jadi bold
			'alignment' => [
				'horizontal' => \PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER, // Set text jadi ditengah secara horizontal (center)
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'allBorders' => [
					'borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN, // Set border top dengan garis tipis
				]
			]
		];

		$style_range_row = [
			'alignment' => [
				'horizontal' => \PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER, // Set text jadi ditengah secara horizontal (center)
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'allBorders' => [
					'borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN, // Set border top dengan garis tipis
				]
			]
		];

		// Buat sebuah variabel untuk menampung pengaturan style dari isi tabel
		$style_row = [
			'alignment' => [
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'top' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border top dengan garis tipis
				'right' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN],  // Set border right dengan garis tipis
				'bottom' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border bottom dengan garis tipis
				'left' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN] // Set border left dengan garis tipis
			]
		];


		if(isset($_POST['by_region']))
		{
			$region = $_POST['by_region'];
		}else
		{
			$region = "";
		}

		if (isset($_POST['by_area']))
		{
			$area = implode(',', $_POST['by_area']);
			$area = str_replace(",", "','", $area);;
		}
		elseif ($_SESSION['area'] != 'ALL')
		{
			$session_area = str_replace(", ", "','", $_SESSION['area']); 
			$area = $session_area;
		}

		if(isset($_POST['by_island']))
		{
			$island = $_POST['by_island'];
		}else
		{
			$island = "";
		}

		if(isset($_POST['by_month1']))
		{
			$month1 = $_POST['by_month1'];
		}else
		{
			$month1 = date('m');
		}

		if(isset($_POST['by_month2']))
		{
			$month2 = $_POST['by_month2'];
		}else
		{
			$month2 = date('m');
		}

		if(isset($_POST['by_year']))
		{
			$year = $_POST['by_year'];
		}else
		{
			$year = date('Y');
		}

		$data['sku_name'] = $this->model('SkuModel')->getItemNameSKUJordan();
		$data['sku_group'] = $this->model('SkuModel')->getGroupSKUJordan();
		$data['sku_count'] = $this->model('SkuModel')->getCountSKUJordan();
		$data['sku_code'] = $this->model('SkuModel')->getItemCodeSKUJordan();

		//$dateObj   = DateTime::createFromFormat('!m', $month);
		//$monthName = $dateObj->format('F'); // March

		$dateObj1   = DateTime::createFromFormat('!m', $month1);
		$dateObj2   = DateTime::createFromFormat('!m', $month2);
        $monthName1 = $dateObj1->format('F');
		$monthName2 = $dateObj2->format('F');

		$data['title'] = 'Contribution Summary - LORD (' . $monthName1 . ' To ' . $monthName2 . ')';

		$sheet->setCellValue('A1', "Report Contribution - JORDAN"); // Set kolom A1 dengan tulisan "Report Selling In - By Outlet"
		$sheet->setCellValue('A2', "Island : " . $island); // Set kolom A2 dengan tulisan "Outlet Type : EC_EC"
		$sheet->setCellValue('A3', "Region : " . $region); // Set kolom A3 dengan tulisan "Outlet Type : EC_EC"
		$sheet->setCellValue('A4', "Area : " . $area);
		$sheet->setCellValue('A5', "Month : " . $monthName1 . " to " . $monthName1 . " - " . $year);
		//$sheet->mergeCells('A1:F1'); // Set Merge Cell pada kolom A1 sampai F1
		$sheet->getStyle('A1')->getFont()->setBold(true); // Set bold kolom A1
		$sheet->getStyle('A2')->getFont()->setBold(true); // Set bold kolom A2
		$sheet->getStyle('A3')->getFont()->setBold(true); // Set bold kolom A3
		$sheet->getStyle('A4')->getFont()->setBold(true);
		$sheet->getStyle('A5')->getFont()->setBold(true);
		$sheet->getStyle('A1')->getFont()->setSize(20); // Set font size 15 untuk kolom A1
		// Buat header tabel nya pada baris ke 7
		$sheet->setCellValue('A7', "#"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('A7:A9'); // Set Merge Row pada kolom A6 sampai A8
		$sheet->setCellValue('B7', "TYPE OF OUTLET"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('B7:B9'); // Set Merge Row pada kolom A6 sampai A8
		$sheet->setCellValue('C7', "Code"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('C7:C9'); // Set Merge Row pada kolom A6 sampai A8
		$sheet->setCellValue('D7', "RO"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('D7:D9');
		$start_col = 5;

		foreach ($data['sku_group'] as $row_sku) :
			//$sheet->setCellValue('E7', $row_sku['item_group']);
			$sheet->setCellValueByColumnAndRow($start_col, 7, $row_sku['item_group']);
			$last_col = $start_col + ($row_sku['count_name']*4) - 1;
			$sheet->mergeCellsByColumnAndRow($start_col, 7, $last_col, 7);
			$start_col = $last_col + 1;
		endforeach;
		$start_col = 5;
		foreach ($data['sku_name'] as $row_sku) :
			//$sheet->setCellValue('E7', $row_sku['item_group']);
			$sheet->setCellValueByColumnAndRow($start_col, 8, $row_sku['item_name']);
			$last_col = $start_col + 3;
			$sheet->mergeCellsByColumnAndRow($start_col, 8, $last_col, 8);
			$start_col = $last_col + 1;
		endforeach;
		$sheet->setCellValueByColumnAndRow($start_col, 7, "TOTAL");
		$sheet->mergeCellsByColumnAndRow($start_col, 7, $start_col + 1, 8);

		$start_col = 5;
		foreach ($data['sku_name'] as $row_sku) :
			$sheet->setCellValueByColumnAndRow($start_col, 9, "Qty");
			$start_col = $start_col + 1;
			$sheet->setCellValueByColumnAndRow($start_col, 9, "Cont %");
			$start_col = $start_col + 1;
			$sheet->setCellValueByColumnAndRow($start_col, 9, "Value");
			$start_col = $start_col + 1;
			$sheet->setCellValueByColumnAndRow($start_col, 9, "Cont %");
			$start_col = $start_col + 1;
		endforeach;
		$sheet->setCellValueByColumnAndRow($start_col, 9, "Qty");
		$sheet->setCellValueByColumnAndRow($start_col + 1, 9, "Value");
		
		// Apply style header yang telah kita buat tadi ke masing-masing kolom header
		$sheet->getStyleByColumnAndRow(1, 8, $last_col, 8)->getAlignment()->setWrapText(true);
		$sheet->getStyleByColumnAndRow(1, 9, $last_col, 9)->getAlignment()->setWrapText(true);
		$sheet->getStyleByColumnAndRow(1, 7, $last_col + 2, 9)->applyFromArray($style_range);
		$sheet->getStyleByColumnAndRow(1, 7, $last_col, 9)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');
		$sheet->getStyleByColumnAndRow($last_col + 1, 7, $last_col + 2, 9)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FF6D6D');

		// Set height baris ke 1, 2 dan 3
		$sheet->getRowDimension('1')->setRowHeight(40);
		$sheet->getRowDimension('2')->setRowHeight(20);
		$sheet->getRowDimension('3')->setRowHeight(20);
		$sheet->getRowDimension('4')->setRowHeight(20);
		$sheet->getRowDimension('5')->setRowHeight(20);
		$sheet->getRowDimension('8')->setRowHeight(40);

		$no = 1; // Untuk penomoran tabel, di awal set dengan 1
		$row = 10;

		$data1 = array(
			'island' => $island,
			'region' => $region,
			'area' => $area,
			'month1' => $month1,
			'month2' => $month2,
			'year' => $year
		);

		$data['cont_jordan'] = $this->model('ReportModel')->getCont_jordan_ALL($data);

		$data_col = 1;
		$data_row = 10;

		$channel='';

		$sub_RO = 0;
		$x=1;
		foreach($data['sku_code'] as $sku):
			$sub_qty[$x] = 0;
			$sub_qty_p[$x] = 0;
			$sub_val[$x] = 0;
			$sub_val_p[$x] = 0;
			$total_qty[$x] = 0;
			$total_qty_p[$x] = 0;
			$total_val[$x] = 0;
			$total_val_p[$x] = 0;
			$x++;
		endforeach;

		$sub_total_qty = 0;
		$sub_total_val = 0;

		$total_RO = 0;
		$total_total_qty = 0;
		$total_total_val = 0;

		foreach ($data['cont_jordan'] as $rows) :
			$data_col = 1;

			if ($channel != $rows['channel'] and $channel != '')
            {
				$sheet->setCellValueByColumnAndRow($data_col, $data_row, '');
				$sheet->setCellValueByColumnAndRow($data_col + 1, $data_row, $channel);
				$sheet->setCellValueByColumnAndRow($data_col + 2, $data_row, 'TOTAL');
				$sheet->setCellValueByColumnAndRow($data_col + 3, $data_row, number_format($sub_RO, 0));
				$a=1;
				$baris=4;
				foreach($data['sku_code'] as $sku):
					$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($sub_qty[$a], 0));
					$baris = $baris + 1;
					$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($sub_qty_p[$a], 2));
					$baris = $baris + 1;
					$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($sub_val[$a], 0));
					$baris = $baris + 1;
					$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($sub_val_p[$a], 2));
					$a++;
					$baris++;
				endforeach;
				$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($sub_total_qty, 0));
				$sheet->setCellValueByColumnAndRow($data_col + $baris + 1, $data_row, number_format($sub_total_val, 0));

				$sheet->getStyleByColumnAndRow(1, $data_row, $last_col + 2, $data_row)->applyFromArray($style_range);
				$sheet->getStyleByColumnAndRow(1, $data_row, $last_col + 2, $data_row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');

				$data_row++;

				$sub_RO = 0;
				$x=1;
				foreach($data['sku_code'] as $sku):
					$sub_qty[$x] = 0;
					$sub_qty_p[$x] = 0;
					$sub_val[$x] = 0;
					$sub_val_p[$x] = 0;
					$x++;
				endforeach;
				
				$sub_total_qty = 0;
				$sub_total_val = 0;

			}

			$sheet->setCellValueByColumnAndRow($data_col, $data_row, $no);
			$sheet->setCellValueByColumnAndRow($data_col + 1, $data_row, $rows['desc_type']);
			$sheet->setCellValueByColumnAndRow($data_col + 2, $data_row, $rows['outlet_type']);
			$sheet->setCellValueByColumnAndRow($data_col + 3, $data_row, number_format($rows['RO'], 0));
			$a=1;
			$baris=4;
			foreach($data['sku_code'] as $sku):
				$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($rows['qty'.$a], 0));
				$baris = $baris + 1;
				$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($rows['%qty'.$a], 2));
				$baris = $baris + 1;
				$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($rows['val'.$a], 0));
				$baris = $baris + 1;
				$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($rows['%val'.$a], 2));
				$a++;
				$baris++;
			endforeach;
			
			$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($rows['total_qty'], 0));
			$sheet->setCellValueByColumnAndRow($data_col + $baris + 1, $data_row, number_format($rows['total_val'], 0));


			$channel = $rows['channel'];
			$sub_RO += $rows['RO'];

			$x = 1;
			foreach($data['sku_code'] as $sku):
				$sub_qty[$x] += $rows['qty'.$x];
				$sub_qty_p[$x] += $rows['%qty'.$x];
				$sub_val[$x] += $rows['val'.$x];
				$sub_val_p[$x] += $rows['%val'.$x];
				$total_qty[$x] += $rows['qty'.$x];
				$total_qty_p[$x] += $rows['%qty'.$x];
				$total_val[$x] += $rows['val'.$x];
				$total_val_p[$x] += $rows['%val'.$x];
				$x++;
			endforeach;
			
			$sub_total_qty += ($rows['total_qty']);
			$sub_total_val += ($rows['total_val']);

			$total_RO += $rows['RO'];
			$total_total_qty += ($rows['total_qty']);
			$total_total_val += ($rows['total_val']);

			
			// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
			$sheet->getStyleByColumnAndRow(1, $data_row, $last_col + 2, $data_row)->applyFromArray($style_range_row);
			$sheet->getStyleByColumnAndRow(1, $data_row, null, $data_row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyleByColumnAndRow(2, $data_row, null, $data_row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyleByColumnAndRow(3, $data_row, null, $data_row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyleByColumnAndRow(4, 10, $last_col + 2, $data_row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

			$no++; // Tambah 1 setiap kali looping
    		$row++; // Tambah 1 setiap kali looping
			$data_row++;
		endforeach;

		$sheet->setCellValueByColumnAndRow($data_col, $data_row, '');
		$sheet->setCellValueByColumnAndRow($data_col + 1, $data_row, $channel);
		$sheet->setCellValueByColumnAndRow($data_col + 2, $data_row, 'TOTAL');
		$sheet->setCellValueByColumnAndRow($data_col + 3, $data_row, number_format($sub_RO, 0));
		$a=1;
		$baris=4;
		foreach($data['sku_code'] as $sku):
			$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($sub_qty[$a], 0));
			$baris = $baris + 1;
			$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($sub_qty_p[$a], 2));
			$baris = $baris + 1;
			$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($sub_val[$a], 0));
			$baris = $baris + 1;
			$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($sub_val_p[$a], 2));
			$a++;
			$baris++;
		endforeach;
		
		$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($sub_total_qty, 0));
		$sheet->setCellValueByColumnAndRow($data_col + $baris + 1, $data_row, number_format($sub_total_val, 0));

		$sheet->getStyleByColumnAndRow(1, $data_row, $last_col + 2, $data_row)->applyFromArray($style_range);
		$sheet->getStyleByColumnAndRow(1, $data_row, $last_col + 2, $data_row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');
		
		$data_row = $data_row + 1;

		$sheet->setCellValueByColumnAndRow($data_col, $data_row, '');
		$sheet->setCellValueByColumnAndRow($data_col + 1, $data_row, 'TOTAL');
		$sheet->setCellValueByColumnAndRow($data_col + 2, $data_row, '');
		$sheet->setCellValueByColumnAndRow($data_col + 3, $data_row, number_format($total_RO, 0));
		$a=1;
		$baris=4;
		foreach($data['sku_code'] as $sku):
			$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($total_qty[$a], 0));
			$baris = $baris + 1;
			$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($total_qty_p[$a], 2));
			$baris = $baris + 1;
			$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($total_val[$a], 0));
			$baris = $baris + 1;
			$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($total_val_p[$a], 2));
			$a++;
			$baris++;
		endforeach;
		
		$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($total_total_qty, 0));
		$sheet->setCellValueByColumnAndRow($data_col + $baris + 1, $data_row, number_format($total_total_val, 0));

		$sheet->getStyleByColumnAndRow(1, $data_row, $last_col + 2, $data_row)->applyFromArray($style_range);
		$sheet->getStyleByColumnAndRow(1, $data_row, $last_col + 2, $data_row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFA07A');

		$sheet->getStyleByColumnAndRow(4, 10, $last_col + 2, $data_row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		

		$sheet->getColumnDimension('A')->setWidth(5); // Set width kolom A
		$sheet->getColumnDimension('B')->setWidth(40); // Set width kolom B
		$sheet->getColumnDimension('C')->setWidth(11); // Set width kolom C
		$sheet->getColumnDimension('D')->setWidth(10);

		// Set orientasi kertas jadi LANDSCAPE
		$sheet->getPageSetup()->setOrientation(\PhpOffice\PhpSpreadsheet\Worksheet\PageSetup::ORIENTATION_LANDSCAPE);
		// Set judul file excel nya
		$sheet->setTitle("Contribution - JORDAN");
		// Proses file excel
		header('Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet');
		header('Content-Disposition: attachment; filename="Report Contribution - JORDAN.xlsx"'); // Set nama file excel nya
		header('Cache-Control: max-age=0');

		$writer = new Xlsx($spreadsheet);
		$writer->save('php://output');


	}

	public function export_contribution_lord()
	{
		$spreadsheet = new Spreadsheet();
		$sheet = $spreadsheet->getActiveSheet();
		// Buat sebuah variabel untuk menampung pengaturan style dari header tabel
		$style_col = [
			'font' => ['bold' => true], // Set font nya jadi bold
			'alignment' => [
				'horizontal' => \PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER, // Set text jadi ditengah secara horizontal (center)
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'top' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border top dengan garis tipis
				'right' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN],  // Set border right dengan garis tipis
				'bottom' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border bottom dengan garis tipis
				'left' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN] // Set border left dengan garis tipis
			]
		];

		$style_range = [
			'font' => ['bold' => true], // Set font nya jadi bold
			'alignment' => [
				'horizontal' => \PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER, // Set text jadi ditengah secara horizontal (center)
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'allBorders' => [
					'borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN, // Set border top dengan garis tipis
				]
			]
		];

		$style_range_row = [
			'alignment' => [
				'horizontal' => \PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER, // Set text jadi ditengah secara horizontal (center)
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'allBorders' => [
					'borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN, // Set border top dengan garis tipis
				]
			]
		];

		// Buat sebuah variabel untuk menampung pengaturan style dari isi tabel
		$style_row = [
			'alignment' => [
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)
			],
			'borders' => [
				'top' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border top dengan garis tipis
				'right' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN],  // Set border right dengan garis tipis
				'bottom' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN], // Set border bottom dengan garis tipis
				'left' => ['borderStyle'  => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN] // Set border left dengan garis tipis
			]
		];


		if(isset($_POST['by_region']))
		{
			$region = $_POST['by_region'];
		}else
		{
			$region = "";
		}

		if (isset($_POST['by_area']))
		{
			$area = implode(',', $_POST['by_area']);
			$area = str_replace(",", "','", $area);;
		}
		elseif ($_SESSION['area'] != 'ALL')
		{
			$session_area = str_replace(", ", "','", $_SESSION['area']); 
			$area = $session_area;
		}

		if(isset($_POST['by_island']))
		{
			$island = $_POST['by_island'];
		}else
		{
			$island = "";
		}

		if(isset($_POST['by_month1']))
		{
			$month1 = $_POST['by_month1'];
		}else
		{
			$month1 = date('m');
		}

		if(isset($_POST['by_month2']))
		{
			$month2 = $_POST['by_month2'];
		}else
		{
			$month2 = date('m');
		}

		if(isset($_POST['by_year']))
		{
			$year = $_POST['by_year'];
		}else
		{
			$year = date('Y');
		}

		$data['sku_name'] = $this->model('SkuModel')->getItemNameSKULord();
		$data['sku_group'] = $this->model('SkuModel')->getGroupSKULord();
		$data['sku_count'] = $this->model('SkuModel')->getCountSKULord();
		$data['sku_code'] = $this->model('SkuModel')->getItemCodeSKULord();

		//$dateObj   = DateTime::createFromFormat('!m', $month);
		//$monthName = $dateObj->format('F'); // March

		$dateObj1   = DateTime::createFromFormat('!m', $month1);
		$dateObj2   = DateTime::createFromFormat('!m', $month2);
        $monthName1 = $dateObj1->format('F');
		$monthName2 = $dateObj2->format('F');

		$data['title'] = 'Contribution Summary - LORD (' . $monthName1 . ' To ' . $monthName2 . ')';

		$sheet->setCellValue('A1', "Report Contribution - LORD"); // Set kolom A1 dengan tulisan "Report Selling In - By Outlet"
		$sheet->setCellValue('A2', "Island : " . $island); // Set kolom A2 dengan tulisan "Outlet Type : EC_EC"
		$sheet->setCellValue('A3', "Region : " . $region); // Set kolom A3 dengan tulisan "Outlet Type : EC_EC"
		$sheet->setCellValue('A4', "Area : " . $area);
		$sheet->setCellValue('A5', "Month : " . $monthName1 . " to " . $monthName1 . " - " . $year);
		//$sheet->mergeCells('A1:F1'); // Set Merge Cell pada kolom A1 sampai F1
		$sheet->getStyle('A1')->getFont()->setBold(true); // Set bold kolom A1
		$sheet->getStyle('A2')->getFont()->setBold(true); // Set bold kolom A2
		$sheet->getStyle('A3')->getFont()->setBold(true); // Set bold kolom A3
		$sheet->getStyle('A4')->getFont()->setBold(true);
		$sheet->getStyle('A5')->getFont()->setBold(true);
		$sheet->getStyle('A1')->getFont()->setSize(20); // Set font size 15 untuk kolom A1
		// Buat header tabel nya pada baris ke 7
		$sheet->setCellValue('A7', "#"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('A7:A9'); // Set Merge Row pada kolom A6 sampai A8
		$sheet->setCellValue('B7', "TYPE OF OUTLET"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('B7:B9'); // Set Merge Row pada kolom A6 sampai A8
		$sheet->setCellValue('C7', "Code"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('C7:C9'); // Set Merge Row pada kolom A6 sampai A8
		$sheet->setCellValue('D7', "RO"); // Set kolom A6 dengan tulisan "NO"
		$sheet->mergeCells('D7:D9');
		$start_col = 5;

		foreach ($data['sku_group'] as $row_sku) :
			//$sheet->setCellValue('E7', $row_sku['item_group']);
			$sheet->setCellValueByColumnAndRow($start_col, 7, $row_sku['item_group']);
			$last_col = $start_col + ($row_sku['count_name']*4) - 1;
			$sheet->mergeCellsByColumnAndRow($start_col, 7, $last_col, 7);
			$start_col = $last_col + 1;
		endforeach;
		$start_col = 5;
		foreach ($data['sku_name'] as $row_sku) :
			//$sheet->setCellValue('E7', $row_sku['item_group']);
			$sheet->setCellValueByColumnAndRow($start_col, 8, $row_sku['item_name']);
			$last_col = $start_col + 3;
			$sheet->mergeCellsByColumnAndRow($start_col, 8, $last_col, 8);
			$start_col = $last_col + 1;
		endforeach;
		$sheet->setCellValueByColumnAndRow($start_col, 7, "TOTAL");
		$sheet->mergeCellsByColumnAndRow($start_col, 7, $start_col + 1, 8);

		$start_col = 5;
		foreach ($data['sku_name'] as $row_sku) :
			$sheet->setCellValueByColumnAndRow($start_col, 9, "Qty");
			$start_col = $start_col + 1;
			$sheet->setCellValueByColumnAndRow($start_col, 9, "Cont %");
			$start_col = $start_col + 1;
			$sheet->setCellValueByColumnAndRow($start_col, 9, "Value");
			$start_col = $start_col + 1;
			$sheet->setCellValueByColumnAndRow($start_col, 9, "Cont %");
			$start_col = $start_col + 1;
		endforeach;
		$sheet->setCellValueByColumnAndRow($start_col, 9, "Qty");
		$sheet->setCellValueByColumnAndRow($start_col + 1, 9, "Value");
		
		// Apply style header yang telah kita buat tadi ke masing-masing kolom header
		$sheet->getStyleByColumnAndRow(1, 8, $last_col, 8)->getAlignment()->setWrapText(true);
		$sheet->getStyleByColumnAndRow(1, 9, $last_col, 9)->getAlignment()->setWrapText(true);
		$sheet->getStyleByColumnAndRow(1, 7, $last_col + 2, 9)->applyFromArray($style_range);
		$sheet->getStyleByColumnAndRow(1, 7, $last_col, 9)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');
		$sheet->getStyleByColumnAndRow($last_col + 1, 7, $last_col + 2, 9)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FF6D6D');

		// Set height baris ke 1, 2 dan 3
		$sheet->getRowDimension('1')->setRowHeight(40);
		$sheet->getRowDimension('2')->setRowHeight(20);
		$sheet->getRowDimension('3')->setRowHeight(20);
		$sheet->getRowDimension('4')->setRowHeight(20);
		$sheet->getRowDimension('5')->setRowHeight(20);
		$sheet->getRowDimension('8')->setRowHeight(40);

		$no = 1; // Untuk penomoran tabel, di awal set dengan 1
		$row = 10;

		$data1 = array(
			'island' => $island,
			'region' => $region,
			'area' => $area,
			'month1' => $month1,
			'month2' => $month2,
			'year' => $year
		);

		$data['cont_lord'] = $this->model('ReportModel')->getCont_lord_ALL($data);

		$data_col = 1;
		$data_row = 10;

		$channel='';

		$sub_RO = 0;
		$x=1;
		foreach($data['sku_code'] as $sku):
			$sub_qty[$x] = 0;
			$sub_qty_p[$x] = 0;
			$sub_val[$x] = 0;
			$sub_val_p[$x] = 0;
			$total_qty[$x] = 0;
			$total_qty_p[$x] = 0;
			$total_val[$x] = 0;
			$total_val_p[$x] = 0;
			$x++;
		endforeach;

		$sub_total_qty = 0;
		$sub_total_val = 0;

		$total_RO = 0;
		$total_total_qty = 0;
		$total_total_val = 0;

		foreach ($data['cont_lord'] as $rows) :
			$data_col = 1;

			if ($channel != $rows['channel'] and $channel != '')
            {
				$sheet->setCellValueByColumnAndRow($data_col, $data_row, '');
				$sheet->setCellValueByColumnAndRow($data_col + 1, $data_row, $channel);
				$sheet->setCellValueByColumnAndRow($data_col + 2, $data_row, 'TOTAL');
				$sheet->setCellValueByColumnAndRow($data_col + 3, $data_row, number_format($sub_RO, 0));
				$a=1;
				$baris=4;
				foreach($data['sku_code'] as $sku):
					$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($sub_qty[$a], 0));
					$baris = $baris + 1;
					$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($sub_qty_p[$a], 2));
					$baris = $baris + 1;
					$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($sub_val[$a], 0));
					$baris = $baris + 1;
					$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($sub_val_p[$a], 2));
					$a++;
					$baris++;
				endforeach;
				$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($sub_total_qty, 0));
				$sheet->setCellValueByColumnAndRow($data_col + $baris + 1, $data_row, number_format($sub_total_val, 0));

				$sheet->getStyleByColumnAndRow(1, $data_row, $last_col + 2, $data_row)->applyFromArray($style_range);
				$sheet->getStyleByColumnAndRow(1, $data_row, $last_col + 2, $data_row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');

				$data_row++;

				$sub_RO = 0;
				$x=1;
				foreach($data['sku_code'] as $sku):
					$sub_qty[$x] = 0;
					$sub_qty_p[$x] = 0;
					$sub_val[$x] = 0;
					$sub_val_p[$x] = 0;
					$x++;
				endforeach;
				
				$sub_total_qty = 0;
				$sub_total_val = 0;

			}

			$sheet->setCellValueByColumnAndRow($data_col, $data_row, $no);
			$sheet->setCellValueByColumnAndRow($data_col + 1, $data_row, $rows['desc_type']);
			$sheet->setCellValueByColumnAndRow($data_col + 2, $data_row, $rows['outlet_type']);
			$sheet->setCellValueByColumnAndRow($data_col + 3, $data_row, number_format($rows['RO'], 0));
			$a=1;
			$baris=4;
			foreach($data['sku_code'] as $sku):
				$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($rows['qty'.$a], 0));
				$baris = $baris + 1;
				$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($rows['%qty'.$a], 2));
				$baris = $baris + 1;
				$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($rows['val'.$a], 0));
				$baris = $baris + 1;
				$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($rows['%val'.$a], 2));
				$a++;
				$baris++;
			endforeach;
			
			$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($rows['total_qty'], 0));
			$sheet->setCellValueByColumnAndRow($data_col + $baris + 1, $data_row, number_format($rows['total_val'], 0));


			$channel = $rows['channel'];
			$sub_RO += $rows['RO'];

			$x = 1;
			foreach($data['sku_code'] as $sku):
				$sub_qty[$x] += $rows['qty'.$x];
				$sub_qty_p[$x] += $rows['%qty'.$x];
				$sub_val[$x] += $rows['val'.$x];
				$sub_val_p[$x] += $rows['%val'.$x];
				$total_qty[$x] += $rows['qty'.$x];
				$total_qty_p[$x] += $rows['%qty'.$x];
				$total_val[$x] += $rows['val'.$x];
				$total_val_p[$x] += $rows['%val'.$x];
				$x++;
			endforeach;
			
			$sub_total_qty += ($rows['total_qty']);
			$sub_total_val += ($rows['total_val']);

			$total_RO += $rows['RO'];
			$total_total_qty += ($rows['total_qty']);
			$total_total_val += ($rows['total_val']);

			
			// Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)
			$sheet->getStyleByColumnAndRow(1, $data_row, $last_col + 2, $data_row)->applyFromArray($style_range_row);
			$sheet->getStyleByColumnAndRow(1, $data_row, null, $data_row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER);
			$sheet->getStyleByColumnAndRow(2, $data_row, null, $data_row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyleByColumnAndRow(3, $data_row, null, $data_row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_LEFT);
			$sheet->getStyleByColumnAndRow(4, 10, $last_col + 2, $data_row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);

			$no++; // Tambah 1 setiap kali looping
    		$row++; // Tambah 1 setiap kali looping
			$data_row++;
		endforeach;

		$sheet->setCellValueByColumnAndRow($data_col, $data_row, '');
		$sheet->setCellValueByColumnAndRow($data_col + 1, $data_row, $channel);
		$sheet->setCellValueByColumnAndRow($data_col + 2, $data_row, 'TOTAL');
		$sheet->setCellValueByColumnAndRow($data_col + 3, $data_row, number_format($sub_RO, 0));
		$a=1;
		$baris=4;
		foreach($data['sku_code'] as $sku):
			$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($sub_qty[$a], 0));
			$baris = $baris + 1;
			$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($sub_qty_p[$a], 2));
			$baris = $baris + 1;
			$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($sub_val[$a], 0));
			$baris = $baris + 1;
			$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($sub_val_p[$a], 2));
			$a++;
			$baris++;
		endforeach;
		
		$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($sub_total_qty, 0));
		$sheet->setCellValueByColumnAndRow($data_col + $baris + 1, $data_row, number_format($sub_total_val, 0));

		$sheet->getStyleByColumnAndRow(1, $data_row, $last_col + 2, $data_row)->applyFromArray($style_range);
		$sheet->getStyleByColumnAndRow(1, $data_row, $last_col + 2, $data_row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFE4B5');
		
		$data_row = $data_row + 1;

		$sheet->setCellValueByColumnAndRow($data_col, $data_row, '');
		$sheet->setCellValueByColumnAndRow($data_col + 1, $data_row, 'TOTAL');
		$sheet->setCellValueByColumnAndRow($data_col + 2, $data_row, '');
		$sheet->setCellValueByColumnAndRow($data_col + 3, $data_row, number_format($total_RO, 0));
		$a=1;
		$baris=4;
		foreach($data['sku_code'] as $sku):
			$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($total_qty[$a], 0));
			$baris = $baris + 1;
			$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($total_qty_p[$a], 2));
			$baris = $baris + 1;
			$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($total_val[$a], 0));
			$baris = $baris + 1;
			$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($total_val_p[$a], 2));
			$a++;
			$baris++;
		endforeach;
		
		$sheet->setCellValueByColumnAndRow($data_col + $baris, $data_row, number_format($total_total_qty, 0));
		$sheet->setCellValueByColumnAndRow($data_col + $baris + 1, $data_row, number_format($total_total_val, 0));

		$sheet->getStyleByColumnAndRow(1, $data_row, $last_col + 2, $data_row)->applyFromArray($style_range);
		$sheet->getStyleByColumnAndRow(1, $data_row, $last_col + 2, $data_row)->getFill()->setFillType(\PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID)->getStartColor()->setARGB('FFA07A');

		$sheet->getStyleByColumnAndRow(4, 10, $last_col + 2, $data_row)->getAlignment()->setHorizontal(\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_RIGHT);
		

		$sheet->getColumnDimension('A')->setWidth(5); // Set width kolom A
		$sheet->getColumnDimension('B')->setWidth(40); // Set width kolom B
		$sheet->getColumnDimension('C')->setWidth(11); // Set width kolom C
		$sheet->getColumnDimension('D')->setWidth(10);

		// Set orientasi kertas jadi LANDSCAPE
		$sheet->getPageSetup()->setOrientation(\PhpOffice\PhpSpreadsheet\Worksheet\PageSetup::ORIENTATION_LANDSCAPE);
		// Set judul file excel nya
		$sheet->setTitle("Contribution - LORD");
		// Proses file excel
		header('Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet');
		header('Content-Disposition: attachment; filename="Report Contribution - LORD.xlsx"'); // Set nama file excel nya
		header('Cache-Control: max-age=0');

		$writer = new Xlsx($spreadsheet);
		$writer->save('php://output');


	}
	
}